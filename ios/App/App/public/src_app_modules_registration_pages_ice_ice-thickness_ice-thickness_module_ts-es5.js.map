{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAWA,UAAMA,SAAS,GAAG,iBAAlB;;UAIaC;AAqBX,kCACUC,mBADV,EAEUC,oBAFV,EAGUC,yBAHV,EAIUC,MAJV,EAKUC,eALV,EAMUC,gBANV,EAOUC,cAPV,EAOwC;AAAA;;AAN9B;AACA;AACA;AACA;AACA;AACA;AACA;AACN;;;;eA5BJ,eAAQ;AACN,mBAAO,KAAKH,MAAZ;AACD;;;eAED,eAAuB;AACrB,mBAAO,KAAKH,mBAAZ;AACD;;;eAED,eAAmB;AACjB,mBAAO,KAAKI,eAAZ;AACD;;;eAED,eAAoB;AAClB,mBAAO,KAAKC,gBAAZ;AACD;;;eAED,eAA6B;AAC3B,mBAAO,KAAKH,yBAAZ;AACD;;;iBAYK,sBAAaK,YAAb,EAA0CC,eAA1C,EAA4EC,OAA5E,EAAgG;;;;;;;;AAClF,6BAAM,KAAKJ,gBAAL,CAAsBK,GAAtB,CAA0B,sCAA1B,EAAkEC,SAAlE,EAAN;;;AAAZC;uDACC,KAAKC,iBAAL,CAAuBD,SAAvB,EAAkCL,YAAlC,EAAgDC,eAAhD,EAAiEC,OAAjE;;;;;;;;;AACR;;;iBAEK,sBAAaF,YAAb,EAA0CC,eAA1C,EAA4EC,OAA5E,EAAgG;;;;;;;;AAClF,6BAAM,KAAKJ,gBAAL,CAAsBK,GAAtB,CAA0B,4BAA1B,EAAwDC,SAAxD,EAAN;;;AAAZC;wDACC,KAAKC,iBAAL,CAAuBD,SAAvB,EAAkCL,YAAlC,EAAgDC,eAAhD,EAAiEC,OAAjE;;;;;;;;;AACR;;;iBAEa,2BAAkBK,OAAlB,EAAmCP,YAAnC,EAAgEC,eAAhE,EAAkGC,OAAlG,EAAsH;;;;;;;;AAC7G,6BAAM,KAAKJ,gBAAL,CAAsBK,GAAtB,CAA0B,CAAC,gBAAD,EAAmB,aAAnB,CAA1B,EAA6DC,SAA7D,EAAN;;;AAAfI;;AACQ,6BAAM,KAAKX,eAAL,CAAqBY,MAArB,CAA4B;AAC9CF,+BAAO,EAAPA,OAD8C;AAE9CG,+BAAO,EAAE,CACP;AACEC,8BAAI,EAAEH,YAAY,CAAC,gBAAD,CADpB;AAEEI,8BAAI,EAAE;AAFR,yBADO,EAKP;AACED,8BAAI,EAAEH,YAAY,CAAC,aAAD;AADpB,yBALO;AAFqC,uBAA5B,CAAN;;;AAARK;;AAYN,6BAAMA,KAAK,CAACC,OAAN,EAAN;;;;AACe,6BAAMD,KAAK,CAACE,YAAN,EAAN;;;AAATC;AACAC,8BAAiBD,MAAM,CAACJ,IAAP,KAAgB;;2BACnCK;;;;;;AACF,6BAAM,KAAKA,KAAL,CAAWjB,YAAX,EAAyBC,eAAzB,EAA0CC,OAA1C,CAAN;;;wDAEKe;;;;;;;;;AACR;;;iBAEK,eAAMjB,YAAN,EAAmCC,eAAnC,EAAqEC,OAArE,EAAyF;;;;;;;;AAC7F,2BAAKgB,IAAL,CAAUC,GAAV,CAAc,YAAK;AACjB,4BAAIlB,eAAJ,EAAqB;AACnBD,sCAAY,CAACoB,OAAb,CAAqB,2GAAgBnB,eAAhB,CAArB,IAAyD,KAAI,CAACoB,eAAL,CAAqBpB,eAArB,CAAzD;;AACA,+BAAI,CAACqB,WAAL,CAAiBtB,YAAjB;AACD;;AACD,4BAAIE,OAAJ,EAAa;AACXA,iCAAO;AACR;AACF,uBARD;;AASA,6BAAM,KAAKT,mBAAL,CAAyB8B,qBAAzB,CAA+CvB,YAA/C,CAAN;;;;;;;;;AACD;;;iBAED,4BAAmBA,YAAnB,EAAgDC,eAAhD,EAAgF;AAC9E,gBAAMuB,QAAQ,GAAG,2GAAgBvB,eAAhB,CAAjB;;AACA,gBAAI,CAACD,YAAY,CAACoB,OAAb,CAAqBI,QAArB,CAAL,EAAqC;AACnC;AACAxB,0BAAY,CAACoB,OAAb,CAAqBI,QAArB,IAAiC,KAAKH,eAAL,CAAqBpB,eAArB,CAAjC;AACD;AACF;;;iBAED,yBAAgBA,eAAhB,EAAgD;AAC9C,gBAAI,uGAAYA,eAAZ,CAAJ,EAAkC;AAChC,qBAAO,EAAP;AACD,aAFD,MAEO;AACL,qBAAO,EAAP;AACD;AACF;;;iBAED,qBAAYD,YAAZ,EAAuC;AAAA;;AACrC,iBAAKN,oBAAL,CACG+B,cADH,CACkBzB,YAAY,CAAC0B,EAD/B,EAEGC,IAFH,CAEQ,2DAAU,UAACC,WAAD;AAAA,qBAAiB,gDAASA,WAAW,CAACC,GAAZ,CAAgB,UAACC,CAAD;AAAA,uBAAO,MAAI,CAACpC,oBAAL,CAA0BqC,gBAA1B,CAA2C/B,YAAY,CAAC0B,EAAxD,EAA4DI,CAAC,CAACJ,EAA9D,CAAP;AAAA,eAAhB,CAAT,CAAjB;AAAA,aAAV,CAFR,EAGGM,SAHH,CAII,YAAK;AACH,oBAAI,CAACjC,cAAL,CAAoBkC,KAApB,CAA0B,uBAA1B,EAAmD1C,SAAnD;AACD,aANL,EAOI,UAAC2C,KAAD,EAAU;AACR,oBAAI,CAACnC,cAAL,CAAoBmC,KAApB,CAA0BA,KAA1B,EAAiC3C,SAAjC,EAA4C,wBAA5C;AACD,aATL;AAWD;;;;;;;yBAzGUC,kBAAe2C;AAAA;;;eAAf3C;AAAe4C,iBAAf5C,gBAAe;AAAA6C,oBAFd;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCJQC;;;;;AAMpB,2BAAYrC,eAAZ,EAA8CsC,eAA9C,EAAgFC,cAAhF,EAA8G;AAAA;;AAAA;;AAC5G;AACA,iBAAKD,eAAL,GAAuBA,eAAvB;AACA,iBAAKC,cAAL,GAAsBA,cAAtB;AACA,iBAAKvC,eAAL,GAAuBA,eAAvB;AAJ4G;AAK7G;;;;iBAED,oBAAQ,CAAK;;;iBAEb,2BAAe;AAAA;;AACb,gBAAMyB,EAAE,GAAG,KAAKc,cAAL,CAAoBC,QAApB,CAA6BC,MAA7B,CAAoC,IAApC,CAAX;AACA,iBAAKH,eAAL,CAAqBI,yBAArB,CAA+CC,0BAA/C,CAA0ElB,EAA1E,EACGC,IADH,CAEI,sDAAK,CAAL,CAFJ,EAGI,qDAAI,UAACkB,GAAD,EAAQ;AACV,oBAAI,CAACN,eAAL,CAAqBO,kBAArB,CAAwCD,GAAxC,EAA6C,MAAI,CAAC5C,eAAlD;;AACA,qBAAO4C,GAAP;AACD,aAHD,CAHJ,EAOI,qDAAI,UAACA,GAAD,EAAQ;AACV,oBAAI,CAAC7C,YAAL,GAAoB6C,GAApB;AACD,aAFD,CAPJ,EAUI,2DAAU;AAAA,qBAAM,MAAI,CAACE,oBAAL,EAAN;AAAA,aAAV,CAVJ,EAWI,2DAAU,KAAKC,UAAf,CAXJ,EAaGhB,SAbH;AAcD,YAUD;;;;iBACM,oBAAQ;;;;;;;;;;AAEE,6BAAMiB,OAAO,CAACC,OAAR,CAAgB,KAAKC,OAAL,GAAe,KAAKA,OAAL,EAAf,GAAgC,IAAhD,CAAN;;;AAARC;;AAEU,6BAAMH,OAAO,CAACC,OAAR,CAAgB,KAAKG,OAAL,EAAhB,CAAN;;;AAAVA;;4BACF,CAACA,OAAD,IAAY,CAACD;;;;;wDACR,KAAKb,eAAL,CAAqBe,YAArB,CAAkC,KAAKtD,YAAvC,EAAqD,KAAKC,eAA1D,EAA2E;AAAA,+BAAO,MAAI,CAACC,OAAL,GAAe,MAAI,CAACA,OAAL,EAAf,GAAgC,IAAvC;AAAA,uBAA3E;;;wDAEF;;;;;;;;;AACR;;;iBAEO,gCAAoB;AAC1B,gBAAI,KAAKqD,MAAT,EAAiB;AACf,qBAAO,4CAAKN,OAAO,CAACC,OAAR,CAAgB,KAAKK,MAAL,EAAhB,CAAL,CAAP;AACD;;AACD,mBAAO,2CAAG,EAAH,CAAP;AACD;;;iBAEK,4BAAgB;;;;;;2BAChB,KAAKC;;;;;;AACP,6BAAMP,OAAO,CAACC,OAAR,CAAgB,KAAKM,aAAL,EAAhB,CAAN;;;;AAEF,6BAAM,KAAKC,IAAL,CAAU,IAAV,CAAN;;;;;;;;;AACD;;;iBAED,gBAAkB;AAAA,gBAAbC,KAAa,uEAAL,KAAK;AAChB,iBAAK1D,YAAL,CAAkB2D,UAAlB,GAA+BC,qGAA/B;AACA,mBAAO,KAAKrB,eAAL,CAAqBsB,mBAArB,CAAyCtC,qBAAzC,CAA+D,KAAKvB,YAApE,EAAkF0D,KAAlF,CAAP;AACD;;;iBAED,uBAAW;AAAA;;AACT,mBAAO;AAAA,qBAAM,MAAI,CAACD,IAAL,EAAN;AAAA,aAAP;AACD;;;iBAEK,mBAAO;;;;;;;AACF,6BAAM,KAAKlB,eAAL,CAAqBI,yBAArB,CAA+CmB,mCAA/C,CACb,KAAK9D,YADQ,EAEb,KAAKC,eAFQ,EAIZ0B,IAJY,CAIP,sDAAK,CAAL,CAJO,EAKZvB,SALY,EAAN;;;;;;;;;;;;AAMV;;;iBAED,iBAAK;AAAA;;AACH,mBAAO,KAAKmC,eAAL,CAAqBwB,YAArB,CAAkC,KAAK/D,YAAvC,EAAqD,KAAKC,eAA1D,EAA2E;AAAA,qBAAO,MAAI,CAACC,OAAL,GAAe,MAAI,CAACA,OAAL,EAAf,GAAgC,IAAvC;AAAA,aAA3E,CAAP;AACD;;;iBAED,0BAAc;AACZ,mBACE,MACA,KAAKsC,cAAL,CAAoBC,QAApB,CAA6BuB,YAA7B,CACGnC,GADH,CACO,UAACoC,CAAD;AAAA,qBAAOA,CAAC,CAACC,GAAF,CAAMrC,GAAN,CAAU,UAACsC,OAAD;AAAA,uBAAaA,OAAO,CAACC,QAAR,EAAb;AAAA,eAAV,EAA2CC,IAA3C,CAAgD,GAAhD,CAAP;AAAA,aADP,EAEGC,MAFH,CAEU,UAACC,IAAD;AAAA,qBAAU,CAAC,CAACA,IAAZ;AAAA,aAFV,EAGGF,IAHH,CAGQ,GAHR,CAFF;AAOD;;;;QAjGoCG;;;yBAAjBlC,WAAQmC;AAAA;;;cAARnC;AAAQoC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCAjBC;;;;;yBAAAA;AAAkB;;;cAAlBA;;;kBAJF,CAACC,6EAAD;;;;4HAIED,qBAAkB;AAAAE,yBAHdC,yDAGc;AAHFC,oBADjBH,6EACiB;AAGE;AAJG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCIrBI;AAUX,+BACUC,eADV,EAEUrF,MAFV,EAEwB;AAAA;;AADd;AACA;AATV,uBAAQ,KAAR;AAUI;;;;eATJ,eAAW;AACT,mBAAO,KAAKsF,SAAL,CAAeC,iBAAf,KAAqCC,SAA5C;AACD;;;iBASD,oBAAQ;AACN,gBAAI,CAAC,KAAKC,iBAAV,EAA6B;AAC3B,mBAAKH,SAAL,GAAiB,EAAjB;AACA,mBAAKI,KAAL,GAAa,IAAb;AACD,aAHD,MAGO;AACL,mBAAKJ,SAAL,GAAcK,kBAAQ,KAAKF,iBAAb,CAAd;AACD;AACF;;;iBAED,kBAAM;AACJ,iBAAKJ,eAAL,CAAqBO,OAArB;AACD;;;iBAED,cAAE;AACA,iBAAKP,eAAL,CAAqBO,OAArB,CAA6B,KAAKN,SAAlC;AACD;;;iBAED,mBAAM;AACJ,iBAAKD,eAAL,CAAqBO,OAArB,CAA6B;AAAE,wBAAQ;AAAV,aAA7B;AACD;;;;;;;yBAlCUR,eAAYS;AAAA;;;cAAZT;AAAYU;AAAAC;AAAAN;AAAA;AAAAO;AAAAC;AAAAC;AAAAC;AAAA;ACTzBN;;AACEA;;AACEA;;AACEA;;AAAYA;AAAA,qBAASO,YAAT;AAAiB,aAAjB;;AAAmBP;;;;AAAkCA;;AACnEA;;AACAA;;AAAWA;;;;AAA8DA;;AAC3EA;;AACFA;;AAEAA;;AACEA;;AACEA;;AACEA;;AACEA;;;;AACFA;;AACFA;;AACAA;;AACEA;AAAA;AAAA;;;;AAAkCA;;AACpCA;;AAAmBA;AAAA;AAAA;;AAGnBA;;AACFA;;AACAA;;AAA4DA;AAAA,qBAAeO,QAAf;AAAmB,aAAnB,EAAoB,eAApB,EAAoB;AAAA,qBAAkBA,eAAlB;AAA0B,aAA9C;;AAE5DP;;AACFA;;;;AAvBqCA;;AAAAA;;AAEtBA;;AAAAA;;AAQPA;;AAAAA;;AAGYA;;AAAAA;;AACdA;;AACiBA;;AAAAA,+GAAuC,KAAvC,EAAuC,CAAvC,EAAuC,KAAvC,EAAuC,GAAvC,EAAuC,eAAvC,EAAuC,CAAvC,EAAuC,cAAvC,EAAuC,GAAvC;;AAKaA;;AAAAA,mGAAyB,YAAzB,EAAyB,UAAzB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBpC,UAAMQ,MAAM,GAAW,CACrB;AACE1B,YAAI,EAAE,EADR;AAEE2B,iBAAS,EAAEC,iEAFb;AAGEC,qBAAa,EAAE,CAACC,gFAAD;AAHjB,OADqB,CAAvB;;UAgBaC;;;;;yBAAAA;AAAsB;;;cAAtBA;;;kBAPF,CACPC,6EADO,EAEPC,2EAFO,EAGPC,mEAAsBR,MAAtB,CAHO;;;;4HAOEK,yBAAsB;AAAAzB,yBAFlBsB,iEAEkB;AAFFpB,oBAJ7BwB,6EAI6B,EAH7BC,2EAG6B,EAHXC,yDAGW;AAEE;AALb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACQdC;;AAAUA;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAERA;;AAAYA;;;;;;;;AACmCA;;AAC/CA;;AACFA;;;;;;AAHcA;;AAAAA;;;;;;;;AAchBA;;AAA2CA;AAAAA;;AAAA;;AAAA;AAAA;;AAEyBA;;;;;;AAFzBA,uIAA6D,KAA7D,EAA6D,CAA7D,EAA6D,KAA7D,EAA6D,GAA7D,EAA6D,eAA7D,EAA6D,CAA7D,EAA6D,cAA7D,EAA6D,GAA7D;;;;;;;;AAK3CA;;AACEA;AAAAA;;AAAA;;AAAA;AAAA;;AAGFA;;;;;;AAHEA,sIAA4D,OAA5D,EAA4DC,gJAA5D,EAA4D,KAA5D,EAA4D,CAA5D,EAA4D,KAA5D,EAA4D,GAA5D,EAA4D,eAA5D,EAA4D,CAA5D,EAA4D,cAA5D,EAA4D,GAA5D;;;;;;;;AArCND;;AACoEA;AAAAA;;AAAA;;AAAA;AAAA;;AAClEA;;AACEA;;AAAmBA;AAAAA;;AAAA;;AAAA;AAAA;;AAEiDA;;AACpEA;;AAAmBA;AAAAA;;AAAA;;AAAA;AAAA;;AAEiDA;;AACpEA;;AACEA;;AACEA;;;;AACFA;;AACFA;;AACAA;;AAAoCA;AAAAA;;AAAA;;AAAA;AAAA;;AAClCA;;AAMFA;;AACAA;;AAAUA;AAAAA;;AAAA;;AAAA;AAAA;;AACRA;;AACAA;;AAAWA;;;;AAA8DA;;AAC3EA;;AACAA;;AAAqCA;AAAAA;;AAAA;;AAAA;AAAA;;AAEFA;;AACnCA;;AAAmBA;AAAAA;;AAAA;;AAAA;AAAA;;AACnBA;;AACAA;;AAGAA;;AAAmBA;AAAAA;;AAAA;;AAAA;AAAA;;AACnBA;;AACAA;;AAKAA;;AACEA;;AACEA;;;;AACFA;;AACFA;;AACAA;;AAAkBA;AAAAA;;AAAA;;AAAA;AAAA;;;;AACkEA;;AACpFA;;AACEA;;AACEA;;;;AACFA;;AACFA;;AACAA;;AAGFA;;AACFA;;;;;;AAxDEA,yGAA6B,iBAA7B,EAA6BE,sBAA7B;;AAEqBF;;AAAAA,iIAAuD,KAAvD,EAAuD,CAAvD,EAAuD,KAAvD,EAAuD,GAAvD,EAAuD,eAAvD,EAAuD,CAAvD,EAAuD,cAAvD,EAAuD,GAAvD;;AAGAA;;AAAAA,iIAAuD,KAAvD,EAAuD,CAAvD,EAAuD,KAAvD,EAAuD,GAAvD,EAAuD,eAAvD,EAAuD,CAAvD,EAAuD,cAAvD,EAAuD,GAAvD;;AAKfA;;AAAAA;;AAKkBA;;AAAAA;;AAQTA;;AAAAA;;AAEMA;;AAAAA,sFAAiB,OAAjB,EAAiBE,wDAAjB,EAAiB,KAAjB,EAAiB,CAAjB,EAAiB,KAAjB,EAAiB,GAAjB,EAAiB,eAAjB,EAAiB,CAAjB,EAAiB,cAAjB,EAAiB,GAAjB;;AAGAF;;AAAAA;;AAECA;;AAAAA;;AAGDA;;AAAAA;;AAECA;;AAAAA;;AAOhBA;;AAAAA;;AAIFA;;AAAAA;;AADgBA;;AAIdA;;AAAAA;;AAGkBA;;AAAAA,gHAAoC,gBAApC,EAAoCE,sBAApC,EAAoC,iBAApC,EAAoCA,sBAApC,EAAoC,aAApC,EAAoCA,oBAApC;;;;UCjDfC;;;;;AAIX,mCACEtE,eADF,EAEEC,cAFF,EAGUyC,eAHV,EAIUrF,MAJV,EAIwB;AAAA;;AAAA;;AAEtB,sCAAMkH,iHAAN,EAAoCvE,eAApC,EAAqDC,cAArD;AAHQ;AACA;AAPV,mCAA2B4C,SAA3B;AACA,kCAA0BA,SAA1B;AAMwB;AAGvB;;;;iBAED,kBAAM;AACJ,gBAAI,CAAC,KAAKpF,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAA5C,EAAgE;AAC9D,mBAAKhH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,GAA4D,EAA5D;AACD;;AACD,gBAAI,KAAKhH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD,CAA7D,EAAgE;AAC9D,mBAAKjH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GACE,KAAKjH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD,CAAC,CAD5D;AAEA,mBAAKC,eAAL,GAAuB,IAAvB;AACD,aAJD,MAIO,IAAI,KAAKlH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,KAA2D,CAA/D,EAAkE;AACvE,mBAAKC,eAAL,GAAuB,KAAvB;AACD;;AACD,gBAAI,KAAKlH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GAAwD,CAA5D,EAA+D;AAC7D,mBAAKC,cAAL,GAAsB,KAAtB;AACD,aAFD,MAEO,IAAI,KAAKpH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GAAwD,CAA5D,EAA+D;AACpE,mBAAKnH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GACE,KAAKnH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GAAwD,CAAC,CAD3D;AAEA,mBAAKC,cAAL,GAAsB,IAAtB;AACD;AACF;;;iBAED,yBAAa;AACX,gBAAI,KAAKpH,YAAT,EAAuB;AACrB,kBAAI,KAAKkH,eAAL,KAAyB,IAA7B,EAAmC;AACjC,qBAAKlH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD7B,SAAzD;AACD,eAFD,MAEO,IAAI,KAAKpF,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD,CAA7D,EAAgE;AACrE,qBAAKjH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GACE,KAAKjH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD,CAAC,CAD5D;AAED,eAHM,MAGA;AACL,qBAAKjH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCE,eAAvC,GAAyD,CAAzD;AACD;;AACD,kBAAI,KAAKG,cAAL,KAAwBhC,SAA5B,EAAuC;AACrC,qBAAKpF,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GAAwD/B,SAAxD;AACD,eAFD,MAEO,IACL,KAAKgC,cAAL,KAAwB,IAAxB,IACAC,gFACE,KAAKrH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cADzC,CAFK,EAKL;AACA,qBAAKnH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GACE,KAAKnH,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCI,cAAvC,GAAwD,CAAC,CAD3D;AAED;AACF;AACF;;;iBAEK,mBAAO;;;;;;;;AAEP,6BAAM,KAAK5E,eAAL,CAAqBI,yBAArB,CAA+CmB,mCAA/C,CACN,KAAK9D,YADC,EAEN,KAAKC,eAFC,CAAN;;;;;;;;;;qCAIF,KAAKmH,cAAL,KAAwBhC;;;;;;;;;;qCACxB,KAAK8B,eAAL,KAAyB9B;;;AANrBkC;wDAOCA;;;;;;;;;AACR;;;iBAED,mBAAO;AACL,iBAAKF,cAAL,GAAsBhC,SAAtB;AACA,iBAAK8B,eAAL,GAAuB9B,SAAvB;AACA,iBAAKpF,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,GAA4D,EAA5D;AACD;;;iBAEK,iCAAwBO,KAAxB,EAAsC;;;;;;;;AAC5B,6BAAM,KAAKtC,eAAL,CAAqBxE,MAArB,CAA4B;AAC9CyF,iCAAS,EAAEsB,mEADmC;AAE9CC,sCAAc,EAAE;AACdpC,2CAAiB,EAAE,KAAKrF,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAChBC,kBADgB,CACGO,KADH;AADL;AAF8B,uBAA5B,CAAN;;;AAARG;AAONA,2BAAK,CAAC5G,OAAN;;AACe,6BAAM4G,KAAK,CAAC3G,YAAN,EAAN;;;AAATC;;AACN,0BAAIA,MAAM,CAAC2G,IAAX,EAAiB;AACf,4BAAI3G,MAAM,CAAC2G,IAAP,UAAJ,EAAwB;AACtB,+BAAKC,kBAAL,CAAwBL,KAAxB;AACD,yBAFD,MAEO;AACCM,+CADD,GACqD7G,MAAM,CAAC2G,IAD5D;;AAEL,8BAAIJ,KAAK,KAAKnC,SAAd,EAAyB;AACvB,iCAAK0C,oBAAL,CAA0BP,KAA1B,EAAiCM,qBAAjC;AACD,2BAFD,MAEO;AACL,iCAAKE,oBAAL,CAA0BF,qBAA1B;AACD;AACF;AACF;;;;;;;;;AACF;;;iBAED,+BAAsBG,KAAtB,EAAwC;AAAA;;AACtC,iBAAKpI,MAAL,CAAYuB,GAAZ,CAAgB,YAAK;AACnB,oBAAI,CAAC8G,WAAL,CACE,MAAI,CAACjI,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBADzC,EAEEgB,KAAK,CAACE,MAAN,CAAaC,IAFf,EAGEH,KAAK,CAACE,MAAN,CAAaE,EAHf;AAKD,aAND;AAOAJ,iBAAK,CAACE,MAAN,CAAaG,QAAb;AACD;;;iBAED,qBAAYC,KAAZ,EAA+BC,SAA/B,EAAkDC,OAAlD,EAAiE;AAC/DF,iBAAK,CAACG,MAAN,CAAaD,OAAb,EAAsB,CAAtB,EAAyBF,KAAK,CAACG,MAAN,CAAaF,SAAb,EAAwB,CAAxB,EAA2B,CAA3B,CAAzB;AACD;;;iBAED,8BAAqBhB,KAArB,EAAoClC,iBAApC,EAAiF;AAAA;;AAC/E,iBAAKzF,MAAL,CAAYuB,GAAZ,CAAgB,YAAK;AACnB,qBAAI,CAACnB,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,CACEO,KADF,IAEIlC,iBAFJ;AAGD,aAJD;AAKA,iBAAKqD,wBAAL;AACD;;;iBAED,8BAAqBrD,iBAArB,EAAkE;AAAA;;AAChE,iBAAKzF,MAAL,CAAYuB,GAAZ,CAAgB,YAAK;AACnB,qBAAI,CAACnB,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,CAA0D2B,IAA1D,CACEtD,iBADF;AAGD,aAJD;AAKA,iBAAKqD,wBAAL;AACD;;;iBAED,oCAAwB;AAAA;;AACtB,gBAAME,MAAM,GAAG,CACb,KAAK5I,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,IAA6D,EADhD,EAEb6B,MAFa,CAEN,UAACC,CAAD,EAAIC,CAAJ;AAAA,qBAAUD,CAAC,IAAIC,CAAC,CAAC5D,iBAAF,IAAuB,CAA3B,CAAX;AAAA,aAFM,EAEoC,CAFpC,CAAf;AAGA,iBAAKvF,MAAL,CAAYuB,GAAZ,CAAgB,YAAK;AACnB,qBAAI,CAACnB,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCiC,eAAvC,GAAyDJ,MAAzD;AACD,aAFD;AAGD;;;iBAED,4BAAmBrB,KAAnB,EAAgC;AAAA;;AAC9B,iBAAK3H,MAAL,CAAYuB,GAAZ,CAAgB,YAAK;AACnB,qBAAI,CAACnB,YAAL,CAAkBoB,OAAlB,CAA0B2F,YAA1B,CAAuCC,kBAAvC,CAA0DyB,MAA1D,CAAiElB,KAAjE,EAAwE,CAAxE;AACD,aAFD;AAGA,iBAAKmB,wBAAL;AACD;;;;QAjJmCO;;;yBAAzBpC,mBAAgBH;AAAA;;;cAAhBG;AAAgBnB;AAAAhB;AAAAkB;AAAAC;AAAAC;AAAAC;AAAA;ADf7BW;;AACEA;;AACEA;;AACEA;;AACFA;;AACAA;;AACEA;;;;AACFA;;AACFA;;AACFA;;AACAA;;AACEA;;AA0DFA;;;;AA/DMA;;AAAAA;;AAK+BA;;AAAAA;;;;;;;;;","names":["DEBUG_TAG","BasePageService","registrationService","newAttachmentService","commonRegistrationService","ngZone","alertController","translateService","loggingService","registration","registrationTid","onReset","get","toPromise","leaveText","createResetDialog","message","translations","create","buttons","text","role","alert","present","onDidDismiss","result","reset","Zone","run","request","getDefaultValue","resetImages","saveRegistrationAsync","propName","getAttachments","id","pipe","attachments","map","a","removeAttachment","subscribe","debug","error","_angular_core__WEBPACK_IMPORTED_MODULE_7__","factory","providedIn","BasePage","basePageService","activatedRoute","snapshot","params","CommonRegistrationService","getRegistrationByIdShared$","reg","createDefaultProps","createInitObservable","ngDestroy$","Promise","resolve","isValid","valid","isEmpty","confirmLeave","onInit","onBeforeLeave","save","clean","syncStatus","src_app_modules_common_registration_registration_models__WEBPACK_IMPORTED_MODULE_1__","RegistrationService","hasAnyDataToShowInRegistrationTypes","confirmReset","pathFromRoot","v","url","segment","toString","join","filter","path","_core_helpers_observable_helper__WEBPACK_IMPORTED_MODULE_2__","_angular_core__WEBPACK_IMPORTED_MODULE_11__","features","IceLayerPageModule","_shared_components_module__WEBPACK_IMPORTED_MODULE_0__","declarations","_ice_layer_page__WEBPACK_IMPORTED_MODULE_1__","imports","IceLayerPage","modalController","layerCopy","IceLayerThickness","undefined","iceThicknessLayer","isNew","Object","dismiss","_angular_core__WEBPACK_IMPORTED_MODULE_4__","selectors","inputs","decls","vars","consts","template","ctx","routes","component","_ice_thickness_page__WEBPACK_IMPORTED_MODULE_0__","canDeactivate","_can_deactivate_route_guard__WEBPACK_IMPORTED_MODULE_3__","IceThicknessPageModule","_shared_components_module__WEBPACK_IMPORTED_MODULE_1__","_ice_layer_ice_layer_module__WEBPACK_IMPORTED_MODULE_2__","_angular_router__WEBPACK_IMPORTED_MODULE_5__","_angular_core__WEBPACK_IMPORTED_MODULE_13__","ctx_r3","ctx_r0","IceThicknessPage","src_app_modules_common_registration_registration_models__WEBPACK_IMPORTED_MODULE_0__","IceThickness","IceThicknessLayers","IceHeightBefore","iceHeightBefore","IceHeightAfter","iceHeightAfter","_core_helpers_number_helper__WEBPACK_IMPORTED_MODULE_4__","isEmptyResult","index","_ice_layer_ice_layer_page__WEBPACK_IMPORTED_MODULE_2__","componentProps","modal","data","removeLayerAtIndex","iceThicknessLayerCopy","setIceThicknessLayer","addIceThicknessLayer","event","reorderList","detail","from","to","complete","array","fromIndex","toIndex","splice","calculateIceThicknessSum","push","newSum","reduce","p","c","IceThicknessSum","_base_page__WEBPACK_IMPORTED_MODULE_1__"],"sources":["webpack:///src/app/modules/registration/pages/base-page-service.ts","webpack:///src/app/modules/registration/pages/base.page.ts","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-layer/ice-layer.module.ts","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-layer/ice-layer.page.ts","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-layer/ice-layer.page.html","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-thickness.module.ts","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-thickness.page.html","webpack:///src/app/modules/registration/pages/ice/ice-thickness/ice-thickness.page.ts"],"sourcesContent":["import { Injectable, NgZone } from '@angular/core';\r\nimport { IRegistration, RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\nimport { getPropertyName, isArrayType } from 'src/app/modules/common-registration/registration.helpers';\r\nimport { NewAttachmentService, RegistrationService as CommonRegistrationService } from 'src/app/modules/common-registration/registration.services';\r\nimport { RegistrationService } from '../services/registration.service';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { forkJoin } from 'rxjs';\r\nimport { LoggingService } from '../../shared/services/logging/logging.service';\r\n\r\nconst DEBUG_TAG = 'BasePageService';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class BasePageService {\r\n  get Zone() {\r\n    return this.ngZone;\r\n  }\r\n\r\n  get RegistrationService() {\r\n    return this.registrationService;\r\n  }\r\n\r\n  get AlertController() {\r\n    return this.alertController;\r\n  }\r\n\r\n  get TranslateService() {\r\n    return this.translateService;\r\n  }\r\n\r\n  get CommonRegistrationService() {\r\n    return this.commonRegistrationService;\r\n  }\r\n\r\n  constructor(\r\n    private registrationService: RegistrationService,\r\n    private newAttachmentService: NewAttachmentService,\r\n    private commonRegistrationService: CommonRegistrationService,\r\n    private ngZone: NgZone,\r\n    private alertController: AlertController,\r\n    private translateService: TranslateService,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  async confirmLeave(registration: IRegistration, registrationTid: RegistrationTid, onReset?: () => void) {\r\n    const leaveText = await this.translateService.get('REGISTRATION.REQUIRED_FIELDS_MISSING').toPromise();\r\n    return this.createResetDialog(leaveText, registration, registrationTid, onReset);\r\n  }\r\n\r\n  async confirmReset(registration: IRegistration, registrationTid: RegistrationTid, onReset?: () => void) {\r\n    const leaveText = await this.translateService.get('REGISTRATION.CONFIRM_RESET').toPromise();\r\n    return this.createResetDialog(leaveText, registration, registrationTid, onReset);\r\n  }\r\n\r\n  private async createResetDialog(message: string, registration: IRegistration, registrationTid: RegistrationTid, onReset?: () => void) {\r\n    const translations = await this.translateService.get(['DIALOGS.CANCEL', 'DIALOGS.YES']).toPromise();\r\n    const alert = await this.alertController.create({\r\n      message,\r\n      buttons: [\r\n        {\r\n          text: translations['DIALOGS.CANCEL'],\r\n          role: 'cancel'\r\n        },\r\n        {\r\n          text: translations['DIALOGS.YES']\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n    const result = await alert.onDidDismiss();\r\n    const reset: boolean = result.role !== 'cancel';\r\n    if (reset) {\r\n      await this.reset(registration, registrationTid, onReset);\r\n    }\r\n    return reset;\r\n  }\r\n\r\n  async reset(registration: IRegistration, registrationTid: RegistrationTid, onReset?: () => void) {\r\n    this.Zone.run(() => {\r\n      if (registrationTid) {\r\n        registration.request[getPropertyName(registrationTid)] = this.getDefaultValue(registrationTid);\r\n        this.resetImages(registration);\r\n      }\r\n      if (onReset) {\r\n        onReset();\r\n      }\r\n    });\r\n    await this.registrationService.saveRegistrationAsync(registration);\r\n  }\r\n\r\n  createDefaultProps(registration: IRegistration, registrationTid: RegistrationTid) {\r\n    const propName = getPropertyName(registrationTid);\r\n    if (!registration.request[propName]) {\r\n      // Init to new object if null\r\n      registration.request[propName] = this.getDefaultValue(registrationTid);\r\n    }\r\n  }\r\n\r\n  getDefaultValue(registrationTid: RegistrationTid) {\r\n    if (isArrayType(registrationTid)) {\r\n      return [];\r\n    } else {\r\n      return {};\r\n    }\r\n  }\r\n\r\n  resetImages(registration: IRegistration) {\r\n    this.newAttachmentService\r\n      .getAttachments(registration.id)\r\n      .pipe(switchMap((attachments) => forkJoin(attachments.map((a) => this.newAttachmentService.removeAttachment(registration.id, a.id)))))\r\n      .subscribe(\r\n        () => {\r\n          this.loggingService.debug('Reset images complete', DEBUG_TAG);\r\n        },\r\n        (error) => {\r\n          this.loggingService.error(error, DEBUG_TAG, 'Could not reset images');\r\n        }\r\n      );\r\n  }\r\n}\r\n","import { Directive, OnInit } from '@angular/core';\r\nimport { from, of } from 'rxjs';\r\nimport { BasePageService } from './base-page-service';\r\nimport { IRegistration, RegistrationTid, SyncStatus } from 'src/app/modules/common-registration/registration.models';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { take, takeUntil, map, switchMap, tap } from 'rxjs/operators';\r\nimport { NgDestoryBase } from '../../../core/helpers/observable-helper';\r\n\r\n@Directive()\r\nexport abstract class BasePage extends NgDestoryBase implements OnInit {\r\n  registration: IRegistration;\r\n  basePageService: BasePageService;\r\n  registrationTid: RegistrationTid;\r\n  activatedRoute: ActivatedRoute;\r\n\r\n  constructor(registrationTid: RegistrationTid, basePageService: BasePageService, activatedRoute: ActivatedRoute) {\r\n    super();\r\n    this.basePageService = basePageService;\r\n    this.activatedRoute = activatedRoute;\r\n    this.registrationTid = registrationTid;\r\n  }\r\n\r\n  ngOnInit() {}\r\n\r\n  ionViewDidEnter() {\r\n    const id = this.activatedRoute.snapshot.params['id'];\r\n    this.basePageService.CommonRegistrationService.getRegistrationByIdShared$(id)\r\n      .pipe(\r\n        take(1),\r\n        map((reg) => {\r\n          this.basePageService.createDefaultProps(reg, this.registrationTid);\r\n          return reg;\r\n        }),\r\n        tap((reg) => {\r\n          this.registration = reg;\r\n        }),\r\n        switchMap(() => this.createInitObservable()),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  onInit?(): void | Promise<any>;\r\n\r\n  onBeforeLeave?(): void | Promise<any>;\r\n\r\n  onReset?(): void;\r\n\r\n  isValid?(): boolean | Promise<boolean>;\r\n\r\n  // NOTE: Remember to add canDeactivate: [CanDeactivateRouteGuard] in page module\r\n  async canLeave() {\r\n    // Check if implementation page has implemented custom isValid logic\r\n    const valid = await Promise.resolve(this.isValid ? this.isValid() : true);\r\n    // Only return alert if page is not empty and invalid\r\n    const isEmpty = await Promise.resolve(this.isEmpty());\r\n    if (!isEmpty && !valid) {\r\n      return this.basePageService.confirmLeave(this.registration, this.registrationTid, () => (this.onReset ? this.onReset() : null));\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private createInitObservable() {\r\n    if (this.onInit) {\r\n      return from(Promise.resolve(this.onInit()));\r\n    }\r\n    return of({});\r\n  }\r\n\r\n  async ionViewWillLeave() {\r\n    if (this.onBeforeLeave) {\r\n      await Promise.resolve(this.onBeforeLeave());\r\n    }\r\n    await this.save(true);\r\n  }\r\n\r\n  save(clean = false) {\r\n    this.registration.syncStatus = SyncStatus.Draft;\r\n    return this.basePageService.RegistrationService.saveRegistrationAsync(this.registration, clean);\r\n  }\r\n\r\n  getSaveFunc() {\r\n    return () => this.save();\r\n  }\r\n\r\n  async isEmpty(): Promise<boolean> {\r\n    return !(await this.basePageService.CommonRegistrationService.hasAnyDataToShowInRegistrationTypes(\r\n      this.registration,\r\n      this.registrationTid\r\n    )\r\n      .pipe(take(1))\r\n      .toPromise());\r\n  }\r\n\r\n  reset() {\r\n    return this.basePageService.confirmReset(this.registration, this.registrationTid, () => (this.onReset ? this.onReset() : null));\r\n  }\r\n\r\n  getResolvedUrl(): string {\r\n    return (\r\n      '/' +\r\n      this.activatedRoute.snapshot.pathFromRoot\r\n        .map((v) => v.url.map((segment) => segment.toString()).join('/'))\r\n        .filter((path) => !!path)\r\n        .join('/')\r\n    );\r\n  }\r\n\r\n  // getConfiguredUrl(): string {\r\n  //     return '/' + this.activatedRoute.snapshot.pathFromRoot\r\n  //         .filter(v => v.routeConfig)\r\n  //         .map(v => v.routeConfig.path)\r\n  //         .join('/');\r\n  // }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { SharedComponentsModule } from '../../../../shared-components.module';\r\nimport { IceLayerPage } from './ice-layer.page';\r\n\r\n@NgModule({\r\n  imports: [SharedComponentsModule],\r\n  declarations: [IceLayerPage],\r\n  entryComponents: [IceLayerPage]\r\n})\r\nexport class IceLayerPageModule {}\r\n","import { Component, OnInit, Input, NgZone } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { IceThicknessLayerEditModel } from '@varsom-regobs-common/regobs-api';\r\n\r\n@Component({\r\n  selector: 'app-ice-layer',\r\n  templateUrl: './ice-layer.page.html',\r\n  styleUrls: ['./ice-layer.page.scss']\r\n})\r\nexport class IceLayerPage implements OnInit {\r\n  @Input() iceThicknessLayer: IceThicknessLayerEditModel;\r\n\r\n  isNew = false;\r\n  get isValid() {\r\n    return this.layerCopy.IceLayerThickness !== undefined;\r\n  }\r\n\r\n  layerCopy: IceThicknessLayerEditModel; // Using object copy so cancel does not change input object\r\n\r\n  constructor(\r\n    private modalController: ModalController,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.iceThicknessLayer) {\r\n      this.layerCopy = {};\r\n      this.isNew = true;\r\n    } else {\r\n      this.layerCopy = { ...this.iceThicknessLayer };\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  ok() {\r\n    this.modalController.dismiss(this.layerCopy);\r\n  }\r\n\r\n  delete() {\r\n    this.modalController.dismiss({ delete: true });\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>{{'REGISTRATION.ICE.ICE_THICKNESS.ADD_ICE_LAYER' | translate}}</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-list lines=\"full\">\r\n    <ion-list-header>\r\n      <ion-label>\r\n        {{'REGISTRATION.ICE.ICE_THICKNESS.ADD_ICE_LAYER_TITLE' | translate}}\r\n      </ion-label>\r\n    </ion-list-header>\r\n    <app-kdv-select title=\"{{'REGISTRATION.ICE.ICE_THICKNESS.ICE_TYPE' | translate}}\" kdvKey=\"Ice_IceLayerKDV\"\r\n      [(value)]=\"layerCopy.IceLayerTID\"></app-kdv-select>\r\n    <app-numeric-input [(value)]=\"layerCopy.IceLayerThickness\"\r\n      title=\"REGISTRATION.ICE.ICE_THICKNESS.ICE_LAYER_THICKNESS\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\"\r\n      [convertRatio]=\"100\" suffix=\"cm\" placeholder=\"REGISTRATION.SNOW.WEATHER.AIR_TEMPERATURE_PLACEHOLDER\">\r\n    </app-numeric-input>\r\n  </ion-list>\r\n  <app-modal-save-or-delete-buttons [saveDisabled]=\"!isValid\" (saveClicked)=\"ok()\" (deleteClicked)=\"delete()\"\r\n    [showDelete]=\"!isNew\">\r\n  </app-modal-save-or-delete-buttons>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { IceThicknessPage } from './ice-thickness.page';\r\nimport { SharedComponentsModule } from '../../../shared-components.module';\r\nimport { IceLayerPageModule } from './ice-layer/ice-layer.module';\r\nimport { CanDeactivateRouteGuard } from '../../can-deactivate-route.guard';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: IceThicknessPage,\r\n    canDeactivate: [CanDeactivateRouteGuard]\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedComponentsModule,\r\n    IceLayerPageModule,\r\n    RouterModule.forChild(routes)\r\n  ],\r\n  declarations: [IceThicknessPage]\r\n})\r\nexport class IceThicknessPageModule {}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button text=\"\" defaultHref=\"/\"></ion-back-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{'REGISTRATION.ICE.ICE_THICKNESS.TITLE' | translate}}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <app-registration-content-wrapper *ngIf=\"registration && registration.request.IceThickness\"\r\n    [registration]=\"registration\" [registrationTid]=\"registrationTid\" (reset)=\"reset()\">\r\n    <ion-list lines=\"full\" reorder=\"true\">\r\n      <app-numeric-input [(value)]=\"registration.request.IceThickness.SnowDepth\"\r\n        title=\"REGISTRATION.ICE.ICE_THICKNESS.DRY_SNOW_BEFORE_DRILL\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\"\r\n        [convertRatio]=\"100\" placeholder=\"REGISTRATION.IN_CM\" suffix=\"cm\"></app-numeric-input>\r\n      <app-numeric-input [(value)]=\"registration.request.IceThickness.SlushSnow\"\r\n        title=\"REGISTRATION.ICE.ICE_THICKNESS.SLUSH_SNOW_BEFORE_DRILL\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\"\r\n        [convertRatio]=\"100\" placeholder=\"REGISTRATION.IN_CM\" suffix=\"cm\"></app-numeric-input>\r\n      <ion-list-header class=\"ion-text-uppercase\">\r\n        <ion-label>\r\n          {{ 'REGISTRATION.ICE.ICE_THICKNESS.ICE_LAYER' | translate }}\r\n        </ion-label>\r\n      </ion-list-header>\r\n      <ion-reorder-group disabled=\"false\" (ionItemReorder)=\"onIceThicknessReorder($event)\">\r\n        <ion-item (click)=\"addOrEditThicknessLayer(i)\"\r\n          *ngFor=\"let layer of registration.request.IceThickness.IceThicknessLayers; let i = index\">\r\n          <ion-label> {{ layer.IceLayerTID | kdvDescription:'Ice_IceLayerKDV' | async }} -\r\n            {{ layer.IceLayerThickness | metersToCm }} cm</ion-label>\r\n          <ion-reorder slot=\"end\"></ion-reorder>\r\n        </ion-item>\r\n      </ion-reorder-group>\r\n      <ion-item (click)=\"addOrEditThicknessLayer()\">\r\n        <ion-icon color=\"primary\" name=\"add-circle-outline\" slot=\"start\"></ion-icon>\r\n        <ion-label>{{'REGISTRATION.ICE.ICE_THICKNESS.ADD_ICE_LAYER' | translate}}</ion-label>\r\n      </ion-item>\r\n      <app-numeric-input [readonly]=\"true\" [(value)]=\"registration.request.IceThickness.IceThicknessSum\"\r\n        title=\"REGISTRATION.ICE.ICE_THICKNESS.ICE_THICKNESS_SUM\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\"\r\n        [convertRatio]=\"100\" suffix=\"cm\"></app-numeric-input>\r\n      <app-yes-no-select [(value)]=\"iceHeightBefore\" title=\"REGISTRATION.ICE.ICE_THICKNESS.ICE_HEIGHT_BEFORE_TOGGLE\">\r\n      </app-yes-no-select>\r\n      <app-numeric-input *ngIf=\"iceHeightBefore\" [(value)]=\"registration.request.IceThickness.IceHeightBefore\"\r\n        title=\"REGISTRATION.ICE.ICE_THICKNESS.ICE_HEIGHT_BEFORE_INPUT\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\"\r\n        [convertRatio]=\"100\" placeholder=\"REGISTRATION.IN_CM\" suffix=\"cm\"></app-numeric-input>\r\n      <app-yes-no-select [(value)]=\"iceHeightAfter\" title=\"REGISTRATION.ICE.ICE_THICKNESS.ICE_HEIGHT_AFTER_TOGGLE\">\r\n      </app-yes-no-select>\r\n      <app-numeric-input *ngIf=\"iceHeightAfter !== undefined\"\r\n        [(value)]=\"registration.request.IceThickness.IceHeightAfter\"\r\n        [title]=\"iceHeightAfter === true ? 'REGISTRATION.ICE.ICE_THICKNESS.ICE_HEIGHT_BEFORE_INPUT' : 'REGISTRATION.ICE.ICE_THICKNESS.ICE_HEIGHT_AFTER_NO'\"\r\n        [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"2\" [convertRatio]=\"100\" suffix=\"cm\" placeholder=\"REGISTRATION.IN_CM\">\r\n      </app-numeric-input>\r\n      <ion-list-header class=\"ion-text-uppercase\">\r\n        <ion-label>\r\n          {{ 'REGISTRATION.GENERAL_COMMENT.COMMENT_TITLE' | translate}}\r\n        </ion-label>\r\n      </ion-list-header>\r\n      <app-text-comment [(value)]=\"registration.request.IceThickness.Comment\"\r\n        placeholder=\"{{'REGISTRATION.GENERAL_COMMENT.COMMENT_PLACEHOLDER' | translate }}\"></app-text-comment>\r\n      <ion-list-header class=\"ion-text-uppercase\">\r\n        <ion-label>\r\n          {{ 'REGISTRATION.ADD_IMAGES' | translate}}\r\n        </ion-label>\r\n      </ion-list-header>\r\n      <app-add-picture-item [geoHazard]=\"registration.geoHazard\" [registrationId]=\"registration.id\"\r\n        [registrationTid]=\"registrationTid\" [onBeforeAdd]=\"getSaveFunc()\">\r\n      </app-add-picture-item>\r\n    </ion-list>\r\n  </app-registration-content-wrapper>\r\n</ion-content>","import { Component, NgZone } from '@angular/core';\r\nimport { RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\nimport { BasePage } from '../../base.page';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { IceLayerPage } from './ice-layer/ice-layer.page';\r\nimport { IceThicknessLayerEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport { BasePageService } from '../../base-page-service';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { NumberHelper } from '../../../../../core/helpers/number-helper';\r\n\r\n@Component({\r\n  selector: 'app-ice-thickness',\r\n  templateUrl: './ice-thickness.page.html',\r\n  styleUrls: ['./ice-thickness.page.scss']\r\n})\r\nexport class IceThicknessPage extends BasePage {\r\n  iceHeightBefore: boolean = undefined;\r\n  iceHeightAfter: boolean = undefined;\r\n\r\n  constructor(\r\n    basePageService: BasePageService,\r\n    activatedRoute: ActivatedRoute,\r\n    private modalController: ModalController,\r\n    private ngZone: NgZone\r\n  ) {\r\n    super(RegistrationTid.IceThickness, basePageService, activatedRoute);\r\n  }\r\n\r\n  onInit() {\r\n    if (!this.registration.request.IceThickness.IceThicknessLayers) {\r\n      this.registration.request.IceThickness.IceThicknessLayers = [];\r\n    }\r\n    if (this.registration.request.IceThickness.IceHeightBefore < 0) {\r\n      this.registration.request.IceThickness.IceHeightBefore =\r\n        this.registration.request.IceThickness.IceHeightBefore * -1;\r\n      this.iceHeightBefore = true;\r\n    } else if (this.registration.request.IceThickness.IceHeightBefore === 0) {\r\n      this.iceHeightBefore = false;\r\n    }\r\n    if (this.registration.request.IceThickness.IceHeightAfter > 0) {\r\n      this.iceHeightAfter = false;\r\n    } else if (this.registration.request.IceThickness.IceHeightAfter < 0) {\r\n      this.registration.request.IceThickness.IceHeightAfter =\r\n        this.registration.request.IceThickness.IceHeightAfter * -1;\r\n      this.iceHeightAfter = true;\r\n    }\r\n  }\r\n\r\n  onBeforeLeave() {\r\n    if (this.registration) {\r\n      if (this.iceHeightBefore !== true) {\r\n        this.registration.request.IceThickness.IceHeightBefore = undefined;\r\n      } else if (this.registration.request.IceThickness.IceHeightBefore > 0) {\r\n        this.registration.request.IceThickness.IceHeightBefore =\r\n          this.registration.request.IceThickness.IceHeightBefore * -1;\r\n      } else {\r\n        this.registration.request.IceThickness.IceHeightBefore = 0;\r\n      }\r\n      if (this.iceHeightAfter === undefined) {\r\n        this.registration.request.IceThickness.IceHeightAfter = undefined;\r\n      } else if (\r\n        this.iceHeightAfter === true &&\r\n        NumberHelper.isNumeric(\r\n          this.registration.request.IceThickness.IceHeightAfter\r\n        )\r\n      ) {\r\n        this.registration.request.IceThickness.IceHeightAfter =\r\n          this.registration.request.IceThickness.IceHeightAfter * -1;\r\n      }\r\n    }\r\n  }\r\n\r\n  async isEmpty() {\r\n    const isEmptyResult = \r\n      (!await this.basePageService.CommonRegistrationService.hasAnyDataToShowInRegistrationTypes(\r\n        this.registration,\r\n        this.registrationTid\r\n      )) &&\r\n      this.iceHeightAfter === undefined &&\r\n      this.iceHeightBefore === undefined;\r\n    return isEmptyResult;\r\n  }\r\n\r\n  onReset() {\r\n    this.iceHeightAfter = undefined;\r\n    this.iceHeightBefore = undefined;\r\n    this.registration.request.IceThickness.IceThicknessLayers = [];\r\n  }\r\n\r\n  async addOrEditThicknessLayer(index?: number) {\r\n    const modal = await this.modalController.create({\r\n      component: IceLayerPage,\r\n      componentProps: {\r\n        iceThicknessLayer: this.registration.request.IceThickness\r\n          .IceThicknessLayers[index]\r\n      }\r\n    });\r\n    modal.present();\r\n    const result = await modal.onDidDismiss();\r\n    if (result.data) {\r\n      if (result.data.delete) {\r\n        this.removeLayerAtIndex(index);\r\n      } else {\r\n        const iceThicknessLayerCopy: IceThicknessLayerEditModel = result.data;\r\n        if (index !== undefined) {\r\n          this.setIceThicknessLayer(index, iceThicknessLayerCopy);\r\n        } else {\r\n          this.addIceThicknessLayer(iceThicknessLayerCopy);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  onIceThicknessReorder(event: CustomEvent) {\r\n    this.ngZone.run(() => {\r\n      this.reorderList(\r\n        this.registration.request.IceThickness.IceThicknessLayers,\r\n        event.detail.from,\r\n        event.detail.to\r\n      );\r\n    });\r\n    event.detail.complete();\r\n  }\r\n\r\n  reorderList(array: Array<any>, fromIndex: number, toIndex: number) {\r\n    array.splice(toIndex, 0, array.splice(fromIndex, 1)[0]);\r\n  }\r\n\r\n  setIceThicknessLayer(index: number, iceThicknessLayer: IceThicknessLayerEditModel) {\r\n    this.ngZone.run(() => {\r\n      this.registration.request.IceThickness.IceThicknessLayers[\r\n        index\r\n      ] = iceThicknessLayer;\r\n    });\r\n    this.calculateIceThicknessSum();\r\n  }\r\n\r\n  addIceThicknessLayer(iceThicknessLayer: IceThicknessLayerEditModel) {\r\n    this.ngZone.run(() => {\r\n      this.registration.request.IceThickness.IceThicknessLayers.push(\r\n        iceThicknessLayer\r\n      );\r\n    });\r\n    this.calculateIceThicknessSum();\r\n  }\r\n\r\n  calculateIceThicknessSum() {\r\n    const newSum = (\r\n      this.registration.request.IceThickness.IceThicknessLayers || []\r\n    ).reduce((p, c) => p + (c.IceLayerThickness || 0), 0);\r\n    this.ngZone.run(() => {\r\n      this.registration.request.IceThickness.IceThicknessSum = newSum;\r\n    });\r\n  }\r\n\r\n  removeLayerAtIndex(index: number) {\r\n    this.ngZone.run(() => {\r\n      this.registration.request.IceThickness.IceThicknessLayers.splice(index, 1);\r\n    });\r\n    this.calculateIceThicknessSum();\r\n  }\r\n}\r\n"]}