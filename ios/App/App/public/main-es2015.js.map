{"version":3,"file":"main-es2015.js","mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,6CAA6C;AAC7C;AACA;AACA;;;;;;;;;;;;;;;;;ACXuD;;;AAEvD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,YAAY,EAAE,GAAG,EAAE,CACjB,8QAAkC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC;KACnE;IACD;QACE,IAAI,EAAE,iBAAiB;QACvB,YAAY,EAAE,GAAG,EAAE,CACjB,0TAAwD,CAAC,IAAI,CAC3D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,wBAAwB,CAClC;KACJ;IACD;QACE,IAAI,EAAE,eAAe;QACrB,YAAY,EAAE,GAAG,EAAE,CACjB,yMAAoD,CAAC,IAAI,CACvD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAChC;KACJ;IACD;QACE,IAAI,EAAE,UAAU;QAChB,YAAY,EAAE,GAAG,EAAE,CACjB,qLAA0C,CAAC,IAAI,CAC7C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAC3B;KACJ;IACD;QACE,IAAI,EAAE,cAAc;QACpB,YAAY,EAAE,GAAG,EAAE,CACjB,qMAAkD,CAAC,IAAI,CACrD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,qBAAqB,CAC/B;KACJ;IACD;QACE,IAAI,EAAE,sBAAsB;QAC5B,YAAY,EAAE,GAAG,EAAE,CACjB,qNAA0D,CAAC,IAAI,CAC7D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,yBAAyB,CACnC;KACJ;IACD;QACE,IAAI,EAAE,kBAAkB;QACxB,YAAY,EAAE,GAAG,EAAE,CACjB,6NAA0D,CAAC,IAAI,CAC7D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,yBAAyB,CACnC;KACJ;IACD;QACE,IAAI,EAAE,aAAa;QACnB,YAAY,EAAE,GAAG,EAAE,CACjB,iMAAgD,CAAC,IAAI,CACnD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,oBAAoB,CAC9B;KACJ;IACD;QACE,IAAI,EAAE,OAAO;QACb,YAAY,EAAE,GAAG,EAAE,CACjB,6KAAsC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,WAAW,CAAC;KACpE;IACD;QACE,IAAI,EAAE,cAAc;QACpB,YAAY,EAAE,GAAG,EAAE,CACjB,6IAAoD,CAAC,IAAI,CACvD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,kBAAkB,CAC5B;KACJ;IACD;QACE,IAAI,EAAE,aAAa;QACnB,YAAY,EAAE,GAAG,EAAE,CACjB,0SAAgD,CAAC,IAAI,CACnD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,oBAAoB,CAC9B;KACJ;CACF,CAAC;AAMK,MAAM,gBAAgB;;gFAAhB,gBAAgB;6GAAhB,gBAAgB;iHAHlB,CAAC,iEAAoB,CAAC,MAAM,EAAE,EAAE,sBAAsB,EAAE,QAAQ,EAAE,CAAC,CAAC,EACnE,yDAAY;mIAEX,gBAAgB,oFAFjB,yDAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChFkB;AACc;AAC+B;AACG;AACA;AACT;AAC3B;AAC6B;AACL;AACL;AACG;AACN;AACU;AAEY;AAChD;AACa;AACc;AACe;;;;;;;;;;;;;;;;;AAEtF,MAAM,SAAS,GAAG,cAAc,CAAC;AACjC,MAAM,gBAAgB,GAAG,QAAQ,CAAC;AAM3B,MAAM,YAAY;IAGvB,YACU,QAAkB,EAClB,YAAgC,EAChC,mBAAwC,EACxC,mBAAwC,EACxC,gBAAkC,EAClC,cAA8B,EAC9B,eAAgC,EAChC,iBAAoC,EACpC,eAAgC,EAChC,kBAAsC,EACtC,IAAiB,EACjB,MAAc;QAXd,aAAQ,GAAR,QAAQ,CAAU;QAClB,iBAAY,GAAZ,YAAY,CAAoB;QAChC,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAChC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,oBAAe,GAAf,eAAe,CAAiB;QAChC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,SAAI,GAAJ,IAAI,CAAa;QACjB,WAAM,GAAN,MAAM,CAAQ;QAEtB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC;QACjE,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,aAAa;QACX,2CAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,0DAAS,CAAC,GAAG,EAAE,CACzD,IAAI,CAAC,eAAe,EAAE;aACnB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;aAC7B,SAAS,CAAC,EAAE,IAAI,EAAE,GAAG,EAAE;gBACtB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,mCAAmC,EAAE,SAAS,CAAC,CAAC;gBAC1E,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC7B,CAAC,EAAE,KAAK,EAAE,CAAC,GAAG,EAAE,EAAE;gBAChB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,sBAAsB,CAAC,CAAC;gBAClE,IAAI,CAAC,mBAAmB,EAAE,CAAC;YAC7B,CAAC,EAAC,CAAC,CAAC;IACR,CAAC;IAEO,mBAAmB;QACzB,uEAAiB,EAAE,CAAC;IACtB,CAAC;IAEO,qBAAqB;QAC3B,IAAI,mFAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC3E;IACH,CAAC;IAEO,YAAY;QAClB,OAAO,CAAC,GAA4B,EAAE,EAAE,CACtC,GAAG,CAAC,IAAI,CACN,0DAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CACzB,+CAAQ,CAAC;YACP,yCAAE,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC,IAAI,CACnC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,sCAAsC,CACvC,CACF,CACF;YACD,2CAAI,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CACpC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,mBAAmB,CAAC,CAC/D,CACF;YACD,yCAAE,CAAC,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CACjE,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,6BAA6B,CAC9B,CACF,CACF;YACD,2CAAI,CAAC,sEAAkB,CAAC,EAAE,KAAK,EAAE,8DAAU,EAAE,CAAC,CAAC,CAAC,IAAI,CAClD,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;gBACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,iCAAiC,CAClC,CAAC;gBACF,OAAO,yCAAE,CAAC,KAAK,IAAI,CAAC,CAAC;YACvB,CAAC,CACA,CACF;YACD,2CAAI,CAAC,gFAA4B,CAAC,EAAE,KAAK,EAAE,WAAW,EAAC,CAAC,CAAC,CAAC,IAAI,CAC5D,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;gBACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,0CAA0C,CAC3C,CAAC;gBACF,OAAO,yCAAE,CAAC,KAAK,IAAI,CAAC,CAAC;YACvB,CAAC,CACA,CACF;YACD,2CAAI,CAAC,gFAA4B,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,IAAI,CACzD,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;gBAEjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,+BAA+B,CAChC,CAAC;gBACF,OAAO,yCAAE,CAAC,KAAK,IAAI,CAAC,CAAC;YACvB,CAAC,CACA,CACF;YACD,2CAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,eAAe,EAAE,CAAC,CAAC,IAAI,CACnD,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,6BAA6B,CAC9B,CACF,CACF;YACD,yCAAE,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAClC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,gCAAgC,CACjC,CACF,CACF;YACD,2CAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CACzB,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,6BAA6B,CAC9B,CACF,CACF;YACD,yCAAE,CAAE,IAAI,CAAC,mBAAmB,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CACvC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,oCAAoC,CACrC,CACF,CACF;YACD,yCAAE,CAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC,CAAC,IAAI,CACzC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,yCAAyC,CAC1C,CACF,CACF;SACF,CAAC,CACH,CACF,CAAC;IACN,CAAC;IAEO,eAAe;QACrB,OAAO,2CAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,CACrC,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,YAAY,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAC9D,CAAC;IACJ,CAAC;IAEa,yBAAyB;;YACrC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CACrB,uDAAM,CAAC,CAAC,CAAC,EAAoB,EAAE,CAAC,CAAC,YAAY,yDAAW,CAAC,CAC1D,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE;gBACpB,MAAM,SAAS,GAAG,oGAAuB,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,CAAC;gBAC5D,IAAI,KAAK,YAAY,6DAAe,EAAE;oBACpC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,EAAE,gBAAgB,EAAE,SAAS,CAAC,CAAC;iBACrE;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;iBACtC;YACH,CAAC,CAAC,CAAC;QACL,CAAC;KAAA;;wEA7KU,YAAY;2GAAZ,YAAY;QC5BzB,2EAAS;QACP,+EAA8E;QAC5E,+EAAa;QACX,4EAA+B;QACjC,6DAAc;QAChB,6DAAW;QACX,mFAAoG;;QACpG,4EAA+B;QACjC,6DAAU;;QAF6B,2DAA0C;QAA1C,kKAA0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLvB;AACb;AACE;AACS;AACF;AACE;AACR;AAEQ;AACX;AACiB;AACkB;AAC2B;AAC7D;AACiC;AACT;AACC;AACD;AACjB;AACG;AAGG;AAGjB;;;;;;;;;AA6BnC,MAAM,SAAS;;kEAAT,SAAS;uGAAT,SAAS,cAHR,wDAAY;4GADb,yDAAa,YArBf;YACP,qEAAa;YACb,0FAAuB;YACvB,mEAAgB;YAChB,wDAAW;YACX,gEAAmB,EAAE;YACrB,iEAAgB;YAChB,yEAAuB,EAAE;YACzB,iEAAsB,EAAE;YACxB,2EAA4B,EAAE;YAC9B,uEAAY;YACZ,8DAAS;YACT,mEAAa;YACb,yFAAkB;YAClB,oHAAyB;YACzB,+EAAc;YACd,+EAAc;YACd,wFAAuB,EAAE;YACzB,gGAAiC,EAAE;YACnC,yGAAgC,EAAE;SACnC;oIAKU,SAAS,mBA1BL,wDAAY,aAEzB,qEAAa;QACb,0FAAuB;QACvB,mEAAgB;QAChB,wDAAW,4DAEX,iEAAgB,qMAIhB,uEAAY;QACZ,8DAAS;QACT,mEAAa;QACb,yFAAkB;QAClB,oHAAyB;QACzB,+EAAc;QACd,+EAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9C2C;AACgB;AACqD;AACN;AACP;AACvE;AAC6B;AACiC;AAC5G,sHAAsH;AACtH,4HAA4H;AAChF;AACY;AACQ;AACuB;AAQhE;AACoD;AAC7B;AACY;AACW;AACnB;AACe;AACG;AACsB;AACrC;AACC;AACJ;AACe;AACb;AAC+B;AACF;AACiB;AACxC;AACe;AACW;AACZ;AACQ;AACtB;AACO;AACQ;AACF;AAC3B;AACqB;AACuB;AAIlC;AACM;AACzB;AACqC;AACqC;AACtB;AAEvF,sDAAsD;AACtD,gCAAgC;AAChC,mDAAmD;AACnD,gBAAgB;AAChB,KAAK;AAEE,MAAM,eAAgB,SAAQ,MAAM;IACzC,YAAsB,OAAyB;QAC7C,KAAK,CAAC,EAAE,CAAC,CAAC;QADU,YAAO,GAAP,OAAO,CAAkB;IAE/C,CAAC;IACD,QAAQ;QACN,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC;IAClC,CAAC;CACF;AAED,SAAS,qBAAqB,CAAC,IAAgB;IAC7C,OAAO,IAAI,4EAAmB,CAAC,IAAI,EAAE,iBAAiB,EAAE,OAAO,CAAC,CAAC;AACnE,CAAC;AAEM,SAAS,gBAAgB;IAC9B,OAAO,EAAE,MAAM,EAAE,8DAAuC,EAAE,CAAC;AAC7D,CAAC;AAEM,SAAS,kBAAkB,CAAC,kBAAsC;IACvE,OAAO,EAAE,QAAQ,EAAE,kBAAkB,CAAC,QAAQ,EAAG,CAAC;AACpD,CAAC;AAED,wCAAwC;AACxC,0BAA0B;AAC1B,uCAAuC;AACvC,+CAA+C;AAC/C,IAAI;AACG,SAAS,6BAA6B;IAE3C,MAAM,OAAO,GAAG;QACd,QAAQ,EAAE,KAAK;QACf,OAAO,EAAE,KAAK;QACd,oBAAoB,EAAE,KAAK;KAC5B,CAAC;IACF,OAAO,OAAO,CAAC;AACjB,CAAC;AAEM,SAAS,MAAM,CAAC,SAA2B;IAChD,OAAO,GAAkB,EAAE;QACzB,OAAO,8KAA6B,CAAC,IAAI,CAAC,8CAAW,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;IACnG,CAAC,CAAC;AACJ,CAAC;AAED,iGAAiG;AACjG,mBAAmB;AACnB,wFAAwF;AACxF,MAAM;AACN,IAAI;AAEG,MAAM,aAAa,GAAG;IAC3B,8EAAgB;IAChB,+DAAS;IACT,EAAE,OAAO,EAAE,gEAAkB,EAAE,QAAQ,EAAE,+DAAkB,EAAE;IAC7D;QACE,OAAO,EAAE,qDAAS;QAClB,QAAQ,EAAE,eAAe;QACzB,IAAI,EAAE,CAAC,kEAAgB,CAAC;KACzB;IACD,oFAAiB;IACjB,wDAAI;IACJ,qFAAkB;IAClB,sDAAG;IACH,kEAAS;IACT,6DAAM;IACN,0EAAY;IACZ,2FAAoB;IACpB,yDAAI;IACJ,qEAAO;IACP,4EAAa;IACb,iEAAQ;IACR,6DAAM;IACN,4EAAa;IACb,+DAAO;IACP,oFAAiB;IACjB,qEAAU;IACV;QACE,OAAO,EAAE,oEAAiB;QAC1B,QAAQ,EAAE,kFAAc;QACxB,KAAK,EAAE,IAAI;KACZ;IACD,4BAA4B;IAC5B,mEAAmE;IAEnE,EAAE,OAAO,EAAE,wDAAY,EAAE,QAAQ,EAAE,qFAAe,EAAE;IACpD;QACE,OAAO,EAAE,6FAAc;QACvB,QAAQ,EAAE,8EAAsB,CAAC,CAAC,CAAC,2FAAa,CAAC,CAAC,CAAC,4GAAqB;KACzE;IACD;QACE,OAAO,EAAE,iEAAe;QACxB,UAAU,EAAE,qBAAqB;QACjC,IAAI,EAAE,CAAC,6DAAU,CAAC;KACnB;IAED,mBAAmB;IACnB;QACE,OAAO,EAAE,2DAAe;QACxB,UAAU,EAAE,2EAAoB;QAChC,IAAI,EAAE,CAAC,kEAAgB,EAAE,gGAAkB,CAAC;QAC5C,KAAK,EAAE,IAAI;KACZ;IACD;QACE,OAAO,EAAE,2DAAe;QACxB,UAAU,EAAE,iFAAa;QACzB,IAAI,EAAE,CAAC,qDAAQ,EAAE,kDAAM,EAAE,uDAAW,EAAE,0DAAa,EAAE,oDAAM,CAAC;QAC5D,KAAK,EAAE,IAAI;KACZ;IAED,kCAAkC;IAClC;QACE,OAAO,EAAE,4EAAa;QACtB,UAAU,EAAE,gBAAgB;KAC7B;IACD;QACE,OAAO,EAAE,uEAAc;QACvB,UAAU,EAAE,kBAAkB;QAC9B,IAAI,EAAE,CAAC,gGAAkB,CAAC;KAC3B;IACD,IAAI;IACJ,qCAAqC;IACrC,sCAAsC;IACtC,uBAAuB;IACvB,KAAK;IACL;QACE,OAAO,EAAE,gGAA0C;QACnD,UAAU,EAAE,6BAA6B;QACzC,IAAI,EAAE,EAAE;KACT;IACD;QACE,OAAO,EAAE,2DAAe;QACxB,UAAU,EAAE,MAAM;QAClB,KAAK,EAAE,IAAI;QACX,IAAI,EAAE,CAAC,iGAAgB,CAAC;KACzB;IACD,IAAI;IACJ,8BAA8B;IAC9B,6BAA6B;IAC7B,iBAAiB;IACjB,+CAA+C;IAC/C,KAAK;IAEL,4BAA4B;IAC5B,EAAE,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,oGAAmB,EAAE,KAAK,EAAE,IAAI,EAAE;IACrE,EAAE,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,gGAAkB,EAAE,KAAK,EAAE,IAAI,EAAE;IACpE,EAAE,OAAO,EAAE,SAAS,EAAE,WAAW,EAAE,8FAAiB,EAAE,KAAK,EAAE,IAAI,EAAE;IAEnE,8BAA8B;IAC9B;QACE,OAAO,EAAE,8HAA4B;QACrC,QAAQ,EAAE,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC;YACxC,CAAC,CAAC,2IAAkC;YACpC,CAAC,CAAC,qIAA+B;KACpC;IACD;QACE,OAAO,EAAE,qHAAyB;QAClC,6CAA6C;QAC7C,sCAAsC;QACtC,mCAAmC;QACnC,+CAA+C;QAC/C,QAAQ,EAAE,uHAAyB;KACpC;CACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;IE/NI,yEAC4D;;IAA1D,2IAA8C;;;IAFlD,wEAAgD;IAC9C,uJAC4D;IAC9D,qEAAe;;;;;IAFF,0DAA8B;IAA9B,mGAA8B;;;;IAF7C,wEAA4D;IAC1D,gJAGe;IACjB,qEAAe;;IAJmB,0DAAc;IAAd,0IAAc;;;IAOhD,yEAAsG;;IAA1D,2IAA8C;;;IAG1F,+EAA8B;IAAA,uDAAsC;;IAAA,4DAAY;;IAAlD,0DAAsC;IAAtC,iKAAsC;;ADL/D,MAAM,mBAAmB;IAK9B;QAJS,uBAAkB,GAAG,CAAC,CAAC;QAEvB,oBAAe,GAAG,CAAC,CAAC;IAEd,CAAC;IAEhB,QAAQ,KAAI,CAAC;;sFAPF,mBAAmB;iHAAnB,mBAAmB;QCPhC,yEAAgC;QAC9B,iIAKe;QACjB,4DAAM;QACN,2MAEc;QACd,2MAEc;;;QAZG,0DAA0B;QAA1B,yFAA0B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACWpB;AACoB;AAEI;AACJ;;;;;;;;;ICXrC,wFAA+F;IAAlC,2dAAiC;IAC9F,4DAAoB;;;IADuB,6EAAiB;;;;IAE5D,oFAA6F;IAA5B,gXAA2B;IAAC,4DAAgB;;;IAAnE,kFAAsB;;;IAHlE,+EAA+E;IAC7E,yKACoB;IACpB,kKAA6G;IAC/G,4DAAY;;;IAJ2C,mFAAuB;IACxD,0DAAqB;IAArB,iFAAqB;IAEzB,0DAAwB;IAAxB,oFAAwB;;;;;IAN5C,gFAE6C;IAD3C,sXAAgD;IAEhD,6IAIY;IACd,4DAAa;;;IARgB,wFAAwB;IAGtB,0DAAW;IAAX,kFAAW;;;;IAM1C,wFAA4G;IAApD,sWAA6B,CAAC,MAAG;IACzF,4DAAoB;;;IADsE,iFAAiB;;;;IAE3G,oFAAoG;IAA5B,uVAA2B;IACnG,4DAAgB;;;IADkC,qFAAqB;;;IAGrE,2EAAmD;IAAA,uDAAwC;IAAA,4DAAO;;;IAA/C,0DAAwC;IAAxC,gIAAwC;;;IAEV,wEACrC;IAAA,mEAC1C;IAAA,qEAAe;;;;IAHjB,2EACqC;IAAA,uDAA4C;;IAAA,0JAEhE;IAAA,4DAAO;;;IAHlB,2LAAoE;IACrC,0DAA4C;IAA5C,4KAA4C;IAC5E,0DAAqC;IAArC,iHAAqC;;;IAE1C,wEAAsD;IAAA,uDAAqC;IAAA,qEAAe;;;IAApD,0DAAqC;IAArC,gHAAqC;;;IAN7F,gFAA8D;IAC5D,mIAAkG;IAClG,kIAGwB;IACxB,mJAA0G;IAC5G,4DAAY;;;IAPiB,2JAAgC;IACzB,0DAAe;IAAf,kFAAe;IAE9C,0DAAgC;IAAhC,0GAAgC;IAGpB,0DAAqC;IAArC,+GAAqC;;;;IApBxD,yEAAsH;IACpH,kIAQa;IACb,gJACoB;IACpB,wIACgB;IAChB,gIAOY;IACd,4DAAM;;;IAtBuC,kLAAwE;IACtG,0DAAc;IAAd,iFAAc;IASP,0DAAmB;IAAnB,sFAAmB;IAEvB,0DAAiB;IAAjB,oFAAiB;IAErB,0DAAe;IAAf,kFAAe;;ADWtB,MAAM,kBAAkB;IA4F7B,YAAoB,GAAsB;QAAtB,QAAG,GAAH,GAAG,CAAmB;QA3FjC,WAAM,GAAa,EAAE,CAAC;QACtB,eAAU,GAAG,IAAI,CAAC;QAClB,gBAAW,GAAa,EAAE,CAAC;QAC3B,eAAU,GAAa,EAAE,CAAC;QACzB,aAAQ,GAGb,IAAI,uDAAY,EAAE,CAAC;QAEd,kBAAa,GAAgC,IAAI,uDAAY,EAAE,CAAC;QAE1E,iBAAY,GAAG;YACb,QAAQ,EAAE,KAAK;YACf,aAAa,EAAE,MAAM;YACrB,IAAI,EAAE,KAAK;SACZ,CAAC;QAGF,UAAK,GAMgB,SAAS,CAAC;QAE/B,gBAAW,GAAG,CAAC,CAAC;QAER,eAAU,GAAG,IAAI,yCAAO,EAAQ,CAAC;QACjC,gBAAW,GAAG,IAAI,yCAAO,EAAQ,CAAC;IA8DG,CAAC;IA1D9C,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,KAAK,KAAK,OAAO,CAAC;IAChC,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,KAAK,KAAK,SAAS,IAAI,IAAI,CAAC,KAAK,KAAK,gBAAgB,CAAC;IACrE,CAAC;IAED,IAAI,cAAc;QAChB,OAAO,IAAI,CAAC,KAAK,KAAK,cAAc,CAAC;IACvC,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,KAAK,KAAK,cAAc,IAAI,IAAI,CAAC,KAAK,KAAK,gBAAgB,CAAC;IAC1E,CAAC;IAED,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,KAAK,KAAK,aAAa,CAAC;IACtC,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,KAAK,KAAK,WAAW,CAAC;IACpC,CAAC;IAED,IAAI,SAAS;QACX,OAAO,CACL,IAAI,CAAC,MAAM;YACX,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;YAC7B,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,MAAM;gBACnC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,WAAW,CAAC,CAC7C,CAAC;IACJ,CAAC;IAED,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;IAChE,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9C,CAAC;IAED,IAAI,UAAU;QACZ,IACE,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;YAC7B,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,IAAI,KAAK,OAAO,EAC9C;YACA,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,GAAa,CAAC,CAAC;SACxE;QACD,OAAO,CAAC,CAAC;IACX,CAAC;IAED,IAAI,SAAS;QACX,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;YACzC,OAAO,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SACpD;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAID,QAAQ,KAAI,CAAC;IAEb,WAAW;QACT,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC;IACpB,CAAC;IAED,YAAY,CAAC,EAAO;QAClB,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC;QAC/B,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;YACrB,8CAAQ,CAAC,GAAG,CAAC;iBACV,IAAI,CAAC,yDAAS,CAAC,0CAAI,CAAC,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;iBACxD,SAAS,CAAC,GAAG,EAAE;gBACd,IAAI,CAAC,gCAAgC,EAAE,CAAC;YAC1C,CAAC,CAAC,CAAC;SACN;QACD,IAAI,CAAC,KAAK,GAAG,cAAc,CAAC;QAC5B,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAED,WAAW,CAAC,OAAsB;QAChC,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;QACvB,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;YACtB,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;SACzB;QACD,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,UAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC;IACnC,CAAC;IAEO,IAAI;QACV,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;QACjB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC;gBACf,IAAI,EAAE,UAAU;gBAChB,GAAG,EAAE,IAAI,CAAC,QAAQ;gBAClB,MAAM,EAAE,iCAAiC;aAC1C,CAAC,CAAC;SACJ;QACD,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,IAAI,CAAC,iBAAiB,EAAE,EAAE,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC;QACtE,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QACrB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACtC,IAAI,CAAC,QAAQ,EAAE,CAAC;IAClB,CAAC;IAEO,QAAQ;QACd,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE;YAC1B,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;SAC1B;IACH,CAAC;IAEO,iBAAiB;QACvB,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE;YAC/D,OAAO,WAAW,CAAC;SACpB;aAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,EAAE;YACpE,OAAO,aAAa,CAAC;SACtB;aAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,CAAC,EAAE;YACvE,OAAO,OAAO,CAAC;SAChB;aAAM;YACL,OAAO,gBAAgB,CAAC;SACzB;IACH,CAAC;IAEO,iBAAiB;QACvB,OAAO,IAAI,CAAC,QAAQ;YAClB,CAAC,CAAC;gBACA;oBACE,IAAI,EAAE,UAAU;oBAChB,GAAG,EAAE,IAAI,CAAC,QAAQ;oBAClB,MAAM,EAAE,iCAAiC;iBAC1C;aACF;YACD,CAAC,CAAC,EAAE,CAAC;IACT,CAAC;IAEO,cAAc;QACpB,OAAO,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;YAC9C,IAAI,EAAE,OAAO;YACb,GAAG;YACH,MAAM,EAAE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC;YAC9B,WAAW,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC;SACrC,CAAC,CAAC,CAAC;IACN,CAAC;IAEO,gCAAgC;QACtC,IAAI,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,IAAI,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE;YACtE,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,SAAS,GAAG,6BAA6B,CAAC;SAC3E;IACH,CAAC;IAED,aAAa,CAAC,GAAW;QACvB,OAAO,IAAI,CAAC,MAAM,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC;YAC1C,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC;YAC1B,CAAC,CAAC,CAAC,CAAC,CAAC;IACT,CAAC;IAED,YAAY,CAAC,SAAiB;QAC5B,MAAM,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QAC5C,IAAI,KAAK,IAAI,CAAC,EAAE;YACd,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;SAClD;IACH,CAAC;IAED,eAAe;QACb,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACzC,CAAC;IAED,iBAAiB;QACf,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;IAC1B,CAAC;IAEK,cAAc;;YAClB,MAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACrE,MAAM,KAAK,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM;gBAC9B,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;gBACrB,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;YAC5B,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QACpE,CAAC;KAAA;IAEK,oBAAoB;;YACxB,IAAI,CAAC,WAAW,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;YAC/C,IAAI,CAAC,QAAQ,EAAE,CAAC;QAClB,CAAC;KAAA;;oFAxNU,kBAAkB;gHAAlB,kBAAkB;kEAgClB,qDAAS;;;;;QCzDtB,8GAsBM;;QAtBuB,8EAAc;;;;;;;;;;;;;;;;;;;;;;;ACOpC,MAAM,mBAAmB;IAC9B,gBAAe,CAAC;IAEhB,QAAQ,KAAI,CAAC;;sFAHF,mBAAmB;iHAAnB,mBAAmB;QCPhC,8EAAuC;QACrC,6EAAgC;QAC9B,6EAAmD;QACjD,yEAAwB;QAAA,kEACxB;QAAA,4DAAM;QACR,4DAAU;QACZ,4DAAU;QACV,6EAAgC;QAC9B,6EAAwB;QACtB,qEAAI;QAAA,uDAAoC;;QAAA,4DAAK;QAC7C,yEAAyC;QACvC,sEAAI;QACF,sEAAI;QAAA,wDAAoC;;QAAA,4DAAK;QAC7C,sEAAI;QAAA,wDAAoC;;QAAA,4DAAK;QAC7C,sEAAI;QAAA,wDAAoC;;QAAA,4DAAK;QAC/C,4DAAK;QACP,4DAAK;QACP,4DAAU;QACZ,4DAAU;QACZ,4DAAW;;QAVD,0DAAoC;QAApC,sJAAoC;QAGhC,0DAAoC;QAApC,uJAAoC;QACpC,0DAAoC;QAApC,uJAAoC;QACpC,0DAAoC;QAApC,wJAAoC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACR3B;AACgC;AACP;AAMC;AAC6C;AAC2B;AACxD;AACgC;AAC3C;AACzB;AACuE;AACb;AACK;AACJ;AAEnE;AACkD;AACjC;AACgD;;;;;;;;;;;;;;;;;;ICG5E,0EAA0D;IACxD,2EAC4D;IAC5D,wDACF;IAAA,6DAAM;;;IAFF,2DAA8C;IAA9C,6IAA8C;IAChD,2DACF;IADE,yGACF;;;;;IApCV,4EAAyB;IACvB,mFAAiB;IACf,yEAAmB;IAAA,wDAAY;IAAA,6DAAK;IACtC,6DAAkB;IAClB,oFAAkB;IAChB,+EAAiC;IAC/B,8EAAmC;IACjC,8EAAmB;IACjB,0EAA4B;IAC1B,0EAC4D;IAC5D,yDAEF;;;IAAA,6DAAM;IACN,2EAA4B;IAC1B,2EACW;IACX,+EAAwD;IAC1D,6DAAM;IACN,2EAA4B;IAC1B,2EAC4D;IAC5D,yDAGF;;IAAA,6DAAM;IACN,2EAA4B;IAC1B,4EAC4D;IAC5D,yDACA;IAAA,kFAAqE;IACvE,6DAAM;IACN,uIAIM;IACR,6DAAU;IACZ,6DAAU;IACV,4EAAS;IACP,gFAA0C;IACxC,uFAC0G;IAAtE,mWAA8B;IAClE,6DAAiB;IACnB,6DAAU;IACZ,6DAAU;IAcV,+EAAmC;IACjC,+EAAmB;IACjB,+EAAyE;IAC3E,6DAAU;IACZ,6DAAU;IACZ,6DAAW;IACX,iFAA+C;IAC7C,mFAA2E;IAApB,2UAAmB;IACxE,yDACF;;IAAA,6DAAa;IACb,mFAAgF;IAAlB,yUAAiB;IAC7E,yDACA;IAAA,4EAAuE;IACzE,6DAAa;IACf,6DAAW;IACb,6DAAmB;IACrB,6DAAW;;;IAzEY,2DAAY;IAAZ,+EAAY;IAQrB,2DAA8C;IAA9C,8IAA8C;IAChD,2DAEF;IAFE,qOAEF;IAEwC,2DAAY;IAAZ,6EAAY;IAEpC,2DAA0B;IAA1B,kKAA0B;IAItC,2DAA8C;IAA9C,8IAA8C;IAChD,2DAGF;IAHE,sNAGF;IAGI,2DAA8C;IAA9C,8IAA8C;IAChD,2DACA;IADA,yGACA;IAAgB,2DAAmC;IAAnC,oGAAmC;IAExB,2DAA2B;IAA3B,+FAA2B;IASxC,2DAAqB;IAArB,sFAAqB;IAoBxB,2DAAuB;IAAvB,wFAAuB;IAMtC,2DACF;IADE,qLACF;IAEE,2DACA;IADA,iGACA;;ADlCD,MAAM,4BAA4B;IAoBvC,YACU,eAAgC,EAChC,mBAAwC,EACxC,kBAAsC,EACtC,aAA4B,EAC5B,GAAsB,EACtB,eAAgC,EAChC,iBAAoC;QANpC,oBAAe,GAAf,eAAe,CAAiB;QAChC,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,kBAAa,GAAb,aAAa,CAAe;QAC5B,QAAG,GAAH,GAAG,CAAmB;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAChC,sBAAiB,GAAjB,iBAAiB,CAAmB;QAtB9C,aAAQ,GAAG,+CAAQ,CAAC;QAEpB,cAAS,GAAc,EAAE,CAAC;QAC1B,gBAAW,GAAG,IAAI,CAAC;QACnB,WAAM,GAAG,KAAK,CAAC;QACf,gBAAW,GAAG,EAAE,CAAC;QACjB,oBAAe,GAAG,EAAE,CAAC;QAIrB,cAAS,GAAa,EAAE,CAAC;QACzB,iBAAY,GAAa,EAAE,CAAC;QAC5B,sBAAiB,GAAa,EAAE,CAAC;IAW9B,CAAC;IAEU,IAAI;;YAChB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;YACxC,IAAI,CAAC,SAAS,GAAc,IAAI,CAAC,GAAG,CAAC,YAAY,CAAC;YAClD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC;YACzC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC3C,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC;YACpC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACxD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC;YACpC,IAAI,CAAC,eAAe,GAAG,8EAAY,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,mBAAmB,CAAC,CAAC;YAC3E,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;YAC3B,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YAEnB,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QAC1B,CAAC;KAAA;IAEO,WAAW,CAAC,GAA0B;QAC5C,OAAO;YACL,MAAM,EAAE,2CAAQ,CACd,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,QAAQ,EAC7B,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,SAAS,CAC/B;YACD,SAAS,EAAE,IAAI,CAAC,SAAS;YACzB,iBAAiB,EAAE,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC;YACjD,eAAe,EAAE,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC;SAC9C,CAAC;IACJ,CAAC;IAEO,oBAAoB,CAC1B,GAA0B;QAE1B,IAAI,GAAG,CAAC,YAAY,EAAE;YACpB,OAAO;gBACL,KAAK,EACH,GAAG,CAAC,YAAY,CAAC,QAAQ,IAAI,GAAG,CAAC,YAAY,CAAC,SAAS;oBACrD,CAAC,CAAC,2CAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,CAAC,YAAY,CAAC,SAAS,CAAC;oBACjE,CAAC,CAAC,SAAS;gBACf,IAAI,EACF,GAAG,CAAC,YAAY,CAAC,QAAQ,IAAI,GAAG,CAAC,YAAY,CAAC,QAAQ;oBACpD,CAAC,CAAC,2CAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC;oBAC/D,CAAC,CAAC,SAAS;aAChB,CAAC;SACH;QACD,IAAI,GAAG,CAAC,YAAY,EAAE;YACpB,OAAO;gBACL,KAAK,EACH,GAAG,CAAC,YAAY,CAAC,QAAQ,IAAI,GAAG,CAAC,YAAY,CAAC,SAAS;oBACrD,CAAC,CAAC,2CAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,GAAG,CAAC,YAAY,CAAC,SAAS,CAAC;oBACjE,CAAC,CAAC,SAAS;gBACf,IAAI,EACF,GAAG,CAAC,YAAY,CAAC,OAAO,IAAI,GAAG,CAAC,YAAY,CAAC,QAAQ;oBACnD,CAAC,CAAC,2CAAQ,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,EAAE,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC;oBAC/D,CAAC,CAAC,SAAS;aAChB,CAAC;SACH;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAEO,kBAAkB,CAAC,GAA0B;QACnD,IAAI,GAAG,IAAI,GAAG,CAAC,SAAS,IAAI,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,cAAc,CAAC,EAAE;YACvE,OAAO,GAAG,CAAC,SAAS,CAAC,MAAM,CACzB,CAAC,CAAC,EAAE,EAAE,CACJ,CAAC,CAAC,cAAc;gBAChB,CAAC,CAAC,cAAc,CAAC,QAAQ;gBACzB,CAAC,CAAC,cAAc,CAAC,SAAS,CAC7B,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CACV,2CAAQ,CAAC,CAAC,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,CAAC,cAAc,CAAC,SAAS,CAAC,CAChE,CAAC;SACH;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,WAAW;QACT,IAAI,CAAC,IAAI,EAAE,CAAC;IACd,CAAC;IAED,sBAAsB,CAAC,SAAoB;QACzC,QAAQ,SAAS,EAAE;YACnB,KAAK,uEAAc;gBACjB,OAAO,8BAA8B,CAAC;YACxC,KAAK,sEAAa;gBAChB,OAAO,6BAA6B,CAAC;YACvC,KAAK,uEAAc;gBACjB,OAAO,8BAA8B,CAAC;YACxC,KAAK,wEAAe;gBAClB,OAAO,+BAA+B,CAAC;SACxC;IACH,CAAC;IAED,YAAY,CAAC,OAAe;QAC1B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC;QACxE,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;QACpE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAC9C,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CACpB,CAAC;IACJ,CAAC;IAED,WAAW,CACT,UAA+B,EAC/B,OAA8D,OAAO;QAErE,OAAO,UAAU,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,UAAU,CAAC,GAAG,CAAC;IACvD,CAAC;IAED,oBAAoB;QAClB,OAAO,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC1E,CAAC;IAEK,SAAS,CAAC,KAAwC;;YACtD,MAAM,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAChD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,2HAAwB;gBACnC,cAAc,EAAE;oBACd,MAAM,EAAE,GAAG,IAAI,CAAC,WAAW,CACzB,KAAK,EACL,UAAU,CACX,MAAM,8DAAU,EAAE,EAAE;oBACrB,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,gBAAgB;oBAC1D,WAAW,EAAE,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,OAAO;iBACvD;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAEK,YAAY,CAAC,QAGlB;;YACC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,sGAAiB;gBAC5B,cAAc,EAAE;oBACd,QAAQ;iBACT;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAEa,UAAU;;YACtB,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC3D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,OAAO,sEAA+B,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAC9D,CAAC;KAAA;IAEO,kBAAkB,CAAC,OAAe,EAAE,SAAkB;QAC5D,OAAO,GAAG,OAAO,iBAAiB,IAAI,CAAC,GAAG,CAAC,KAAK,GAC9C,SAAS,CAAC,CAAC,CAAC,eAAe,SAAS,EAAE,CAAC,CAAC,CAAC,EAC3C,EAAE,CAAC;IACL,CAAC;IAEK,OAAO;;YACX,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;YACxC,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,wBAAwB,EAAE,CAAC;YACrE,MAAM,GAAG,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACzD,IAAI,CAAC,eAAe,CAAC,UAAU,CAC7B,2GAA6B,EAC7B,iGAAoB,EACpB,GAAG,EACH,IAAI,CAAC,GAAG,CAAC,KAAK,CACf,CAAC;YACF,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;QACjD,CAAC;KAAA;IAEK,KAAK;;YACT,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;YACxC,MAAM,GAAG,GAAG,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;YAC7C,IAAI,CAAC,eAAe,CAAC,UAAU,CAC7B,2GAA6B,EAC7B,iGAAoB,EACpB,GAAG,EACH,IAAI,CAAC,GAAG,CAAC,KAAK,CACf,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;QAClD,CAAC;KAAA;;wGA1MU,4BAA4B;2HAA5B,4BAA4B;QCrCzC,qIA2EW;;QA3EA,6EAAY;;;;;;;;;;;;;;;;;;;;;;;;;;ACOhB,MAAM,4BAA4B;IACvC,gBAAe,CAAC;IAEhB,QAAQ,KAAI,CAAC;;wGAHF,4BAA4B;0HAA5B,4BAA4B;QCPzC,2EAAU;QACR,kFAAiB;QACf,qEAAI;QACF,kFAAwE;QAAC,8DAAE;QAAA,kFACpB;QACzD,4DAAK;QACP,4DAAkB;QAClB,mFAAkB;QAChB,8EAAiC;QAC/B,6EAAmC;QACjC,6EAAmB;QACjB,0EAA4B;QAC1B,0EAC4D;QAC5D,mFAAsE;QACxE,4DAAM;QACN,0EAA4B;QAC1B,0EAC4D;QAC5D,mFAAqE;QACvE,4DAAM;QACN,0EAA4B;QAC1B,0EAC4D;QAC5D,oFAAsE;QACxE,4DAAM;QACN,0EAA4B;QAC1B,2EAC4D;QAC5D,oFAA2E;QAC7E,4DAAM;QACR,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,+EAA0C;QACxC,oFAAuE;QACzE,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,0EACU;QACZ,4DAAU;QACZ,4DAAW;QACX,gFAA+C;QAC7C,kFAAuD;QACrD,wDACF;;QAAA,4DAAa;QACb,kFAA8D;QAC5D,mEAAM;QAAA,2EAAuE;QAC/E,4DAAa;QACf,4DAAW;QACb,4DAAmB;QACrB,4DAAW;;QAvCG,2DAA8C;QAA9C,2IAA8C;QAK9C,0DAA8C;QAA9C,2IAA8C;QAK9C,0DAA8C;QAA9C,2IAA8C;QAK9C,0DAA8C;QAA9C,4IAA8C;QAiBpD,0DACF;QADE,kLACF;;;;;;;;;;;;;;;;;;;;;AC5CgE;;;;;ICEhE,0EAAiC;IAAA,6EAAkB;IAAA,4DAAO;;;IAC1D,mEACe;;;IAHjB,wEAA4E;IAC1E,kJAA0D;IAC1D,kKACe;IACjB,qEAAe;;;;;;IAHN,0DAAS;IAAT,0EAAS;IACD,0DAAsC;IAAtC,iFAAsC;;;IAJzD,wEAAmD;IACjD,qEAAI;IAAA,uDAA8B;IAAA,4DAAK;IACvC,mJAIe;IACjB,qEAAe;;;IANT,0DAA8B;IAA9B,4FAA8B;IACK,0DAAsB;IAAtB,yFAAsB;;;IAHjE,yEAAwE;IACtE,oIAOe;IACjB,4DAAM;;;IARW,0DAAkC;IAAlC,iGAAkC;;;IAY7C,mEAA6D;;;IAD/D,wEAA+C;IAC7C,4JAA6D;IAC/D,qEAAe;;;;IADE,0DAA6B;IAA7B,kFAA6B;;;IAG5C,mEAA4D;;;IAD9D,wEAA8C;IAC5C,4JAA4D;IAC9D,qEAAe;;;;IADE,0DAA4B;IAA5B,kFAA4B;;;IAG3C,mEAAsD;;;IADxD,wEAA+C;IAC7C,4JAAsD;IACxD,qEAAe;;;;IADE,0DAAsB;IAAtB,kFAAsB;;;IAIvC,uEAA0B;IAAA,uDAAmB;IAAA,4DAAO;;;IAA1B,0DAAmB;IAAnB,2FAAmB;;;IAA7C,0IAAoD;IAAA,uEAAM;IAAA,uDAAW;IAAA,4DAAO;;;;IAArE,qFAAiB;IAAkC,0DAAW;IAAX,0EAAW;;;IAGrE,wFAAiC;IAAA,uDAAU;IAAA,4DAAoB;;;;;IAA5C,0EAAa;IAAC,0DAAU;IAAV,2EAAU;;;IAIzC,0EAAiC;IAAA,6EAAkB;IAAA,4DAAO;;;IAC1D,mEAAkF;;;IAFpF,wEAAwD;IACtD,yJAA0D;IAC1D,yKAAkF;IACpF,qEAAe;;;;;;IAFN,0DAAS;IAAT,2EAAS;IACD,0DAAsC;IAAtC,iFAAsC;;;IAFvD,0JAGe;;;IAHgB,8EAAU;;;IAlB3C,2EAAgC;IAC9B,4IAEe;IACf,4IAEe;IACf,4IAEe;IACjB,qEAAe;IACf,uNAEc;IACd,uNAEc;IACd,uNAKc;;;;IAtBA,8EAAiB;IACd,0DAA8B;IAA9B,iGAA8B;IAG9B,0DAA6B;IAA7B,gGAA6B;IAG7B,0DAA8B;IAA9B,iGAA8B;;ADT1C,MAAM,gBAAgB;IAM3B;QAJS,gBAAW,GAAG,IAAI,CAAC;QAE5B,gBAAW,GAAG,wEAAW,CAAC;IAEX,CAAC;IAEhB,QAAQ,KAAI,CAAC;;gFARF,gBAAgB;8GAAhB,gBAAgB;QCT7B,4GASM;QACN,yMAwBc;;QAlC6B,kFAAc;;;;;;;;;;;;;;;;;;;;;;ACAX;AACmB;AAE1D,MAAM,gBAAgB,GAAG,GAAG,CAAC;AAC7B,MAAM,gBAAgB,GAAG,wCAAwC,CAAC;AAClE,MAAM,WAAW,GAAG,aAAa,CAAC;AAElC,MAAM,eAAe;IAC1B,MAAM,CAAC,yBAAyB,CAAC,SAAS,GAAG,CAAC,EAAE,WAAW,GAAG,CAAC;QAC7D,OAAO,0DAAK,CAAC;YACX,SAAS,EAAE,WAAW,SAAS,IAAI,SAAS,KAAK;YACjD,OAAO,EAAE,WAAW;SACrB,CAAC,CAAC,CAAC,UAAU;IAChB,CAAC;IAED,MAAM,CAAC,sBAAsB,CAC3B,KAAK,GAAG,CAAC,EACT,WAAmB,gBAAgB,EACnC,MAAM,GAAG,WAAW;QAEpB,OAAO,4DAAO,CACZ,GAAG,QAAQ,MAAM,KAAK,MAAM,MAAM,EAAE,EACpC,0DAAK,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CACnD,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,uBAAuB,CAC5B,KAAK,GAAG,CAAC,EACT,WAAmB,gBAAgB,EACnC,MAAM,GAAG,WAAW,EACpB,SAAS,GAAG,CAAC,EACb,WAAW,GAAG,CAAC;QAEf,OAAO;YACL,eAAe,CAAC,yBAAyB,CAAC,SAAS,EAAE,WAAW,CAAC;YACjE,eAAe,CAAC,sBAAsB,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,CAAC;SAChE,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,2BAA2B,CAChC,KAAK,GAAG,CAAC,EACT,WAAmB,gBAAgB,EACnC,MAAM,GAAG,WAAW,EACpB,SAAS,GAAG,CAAC,EACb,WAAW,GAAG,CAAC;QAEf,OAAO;YACL,+DAAU,CACR,QAAQ,EACR,eAAe,CAAC,uBAAuB,CACrC,KAAK,EACL,QAAQ,EACR,MAAM,EACN,SAAS,EACT,WAAW,CACZ,CACF;SACF,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,YAAY,CAAC,MAAmB,EAAE,IAAU;QACjD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;QAE/C,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEpE,gBAAgB;aACb,YAAY,CAAC,EAAE,SAAS,EAAE,sBAAsB,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;aAClE,MAAM,CAAC,WAAW,EAAE,sBAAsB,EAAE,gBAAgB,CAAC;aAC7D,MAAM,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QAE9B,OAAO,OAAO,CAAC,OAAO,CACpB,aAAa;aACV,UAAU,CAAC,MAAM,CAAC;aAClB,MAAM,CAAC,gBAAgB,CAAC;aACxB,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,cAAc,CAAC,YAAY,CAAC;aAC5B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAClC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,cAAc,CAAC,MAAmB,EAAE,IAAU;QACnD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC,EAAE,GAAG,CAAC,CAAC;QAE5C,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEpE,gBAAgB;aACb,YAAY,CAAC,EAAE,SAAS,EAAE,oBAAoB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;aAC7D,MAAM,CAAC,WAAW,EAAE,oBAAoB,EAAE,gBAAgB,CAAC;aAC3D,MAAM,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAE3B,OAAO,OAAO,CAAC,OAAO,CACpB,aAAa;aACV,UAAU,CAAC,MAAM,CAAC;aAClB,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,cAAc,CAAC,YAAY,CAAC;aAC5B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAClC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,YAAY,CAAC,MAAmB,EAAE,IAAU;QACjD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;QAE9C,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEpE,gBAAgB;aACb,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;aAClD,YAAY,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;aACzD,MAAM,CAAC,WAAW,EAAE,gBAAgB,EAAE,sBAAsB,CAAC;aAC7D,MAAM,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAE3B,OAAO,OAAO,CAAC,OAAO,CACpB,aAAa;aACV,UAAU,CAAC,MAAM,CAAC;aAClB,MAAM,CAAC,6BAA6B,CAAC;aACrC,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAClC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,cAAc,CAAC,MAAmB,EAAE,IAAU;QACnD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;QAE9C,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEpE,gBAAgB;aACb,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;aAClD,YAAY,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC;aACzD,MAAM,CAAC,WAAW,EAAE,gBAAgB,EAAE,oBAAoB,CAAC;aAC3D,MAAM,CAAC,SAAS,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QAE3B,OAAO,OAAO,CAAC,OAAO,CACpB,aAAa;aACV,UAAU,CAAC,MAAM,CAAC;aAClB,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAClC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,gBAAgB,CAAC,MAAmB,EAAE,IAAU;QACrD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;QAE/C,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEpE,gBAAgB;aACb,YAAY,CAAC,EAAE,SAAS,EAAE,kBAAkB,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;aAC9D,MAAM,CAAC,WAAW,EAAE,kBAAkB,EAAE,eAAe,CAAC;aACxD,MAAM,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QAE9B,OAAO,aAAa;aACjB,UAAU,CAAC,MAAM,CAAC;aAClB,MAAM,CAAC,SAAS,CAAC;aACjB,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,cAAc,CAAC,YAAY,CAAC;aAC5B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAAC;IACpC,CAAC;IAED,MAAM,CAAC,eAAe,CAAC,MAAmB,EAAE,IAAU;QACpD,MAAM,aAAa,GAAG,4DAAe,EAAE,CAAC;QAExC,MAAM,iBAAiB,GAAG,4DAAe,EAAE,CAAC;QAC5C,iBAAiB,CAAC,UAAU,CAAC,MAAM,CAAC,aAAa,CAAC,cAAc,CAAC,CAAC,CAAC;QAEnE,iBAAiB,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;QAC9C,MAAM,mBAAmB,GAAG,MAAM,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;QAEnE,MAAM,gBAAgB,GAAG,4DAAe,EAAE,CAAC;QAC3C,gBAAgB,CAAC,UAAU,CAAC,mBAAmB,CAAC,CAAC;QACjD,MAAM,iBAAiB,GAAG,MAAM,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC;QAC/D,MAAM,cAAc,GAAG,MAAM,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;QAE3D,gBAAgB;aACb,MAAM,CACL,WAAW,EACX,cACE,iBAAiB,CAAC,CAAC,CAAC,QAAQ,CAAC,iBAAiB,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CACxD,IAAI,EACJ,kBAAkB,CACnB;aACA,MAAM,CAAC,SAAS,EAAE,cAAc,CAAC,CAAC,CAAC,QAAQ,CAAC,cAAc,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAE3E,OAAO,aAAa;aACjB,UAAU,CAAC,MAAM,CAAC;aAClB,MAAM,CAAC,UAAU,CAAC;aAClB,QAAQ,CAAC,gBAAgB,CAAC;aAC1B,cAAc,CAAC,YAAY,CAAC;aAC5B,YAAY,CAAC,iBAAiB,CAAC;aAC/B,YAAY,CAAC,gBAAgB,CAAC,CAAC;IACpC,CAAC;CACF;;;;;;;;;;;;;;;;;AC3NoC;AAE9B,SAAS,aAAa,CAC3B,QAAkB,EAClB,MAAc,EACd,WAAwB,EACxB,aAA4B,EAC5B,MAAc;IAEd,OAAO,GAAG,EAAE;QACV,IAAI,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE;YACzB,2DAAe,CAAC,YAAY,EAAE,CAAC,IAAS,EAAE,EAAE;gBAC1C,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;oBACd,IAAI,KAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,GAAG,CAAC,OAAO,CAAC,mBAAmB,CAAC,KAAI,CAAC,EAAE;wBAC/C,WAAW,CAAC,qBAAqB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;qBAC7C;yBAAM;wBACL,MAAM,aAAa,GAAG,MAAM,CAAC,aAAa,CAAC;4BACzC,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,GAAG,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC;yBACnC,CAAC,CAAC;wBACH,aAAa,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;qBAC9C;gBACH,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;SACJ;IACH,CAAC,CAAC;AACJ,CAAC;;;;;;;;;;;;;;;;;;AC5BsF;;;AAGhF,MAAM,eAAe;IAC1B,YAAoB,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;IAAG,CAAC;IAEtD,WAAW,CAAC,KAAY;QACtB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,KAAK,EACL,oBAAoB,EACpB,sCAAsC,CACvC,CAAC;QACF,MAAM,KAAK,CAAC;IACd,CAAC;;8EAVU,eAAe;gHAAf,eAAe,WAAf,eAAe;;;;;;;;;;;;;;;;;;;;;ACEH;AAC2D;;;;AAK7E,MAAM,SAAS;IACpB,YAAoB,MAAc,EAAU,WAA8B;QAAtD,WAAM,GAAN,MAAM,CAAQ;QAAU,gBAAW,GAAX,WAAW,CAAmB;IAAG,CAAC;IAExE,WAAW,CACf,CAAyB,EACzB,KAA0B;;YAE1B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,wBAAwB,EAAE,CAAC;YACvE,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;gBAC5B,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;aAC3B;YACD,OAAO,YAAY,CAAC,UAAU,CAAC;QACjC,CAAC;KAAA;;kEAZU,SAAS;0GAAT,SAAS,WAAT,SAAS,mBAFR,MAAM;;;;;;;;;;;;;;;;;;;;;;ACJK;AAC0D;AAC7C;;;;AAK/B,MAAM,gBAAgB;IAC3B,YACU,MAAc,EACd,kBAAsC;QADtC,WAAM,GAAN,MAAM,CAAQ;QACd,uBAAkB,GAAlB,kBAAkB,CAAoB;IAC7C,CAAC;IAEE,WAAW,CACf,IAA4B,EAC5B,KAA0B;;YAE1B,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC3D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,WAAW,CAAC,oBAAoB,EAAE;gBACrC,UAAU,CAAC,GAAG,EAAE;oBACd,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC;gBACzC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,8EAA8E;aACxF;YAED,OAAO,WAAW,CAAC,oBAAoB,CAAC;QAC1C,CAAC;KAAA;;gFApBU,gBAAgB;iHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;ACXb,MAAM,kBAAmB,SAAQ,OAAa;IACnD,MAAM,CAAC,wBAAwB,CAAC,SAAiB;QAC/C,OAAO,IAAI,OAAO,CAAO,CAAC,OAAO,EAAE,EAAE;YACnC,MAAM,EAAE,GAAG,UAAU,CAAC,GAAG,EAAE;gBACzB,YAAY,CAAC,EAAE,CAAC,CAAC;gBACjB,OAAO,EAAE,CAAC;YACZ,CAAC,EAAE,SAAS,CAAC,CAAC;QAChB,CAAC,CAAC,CAAC;IACL,CAAC;CACF;;;;;;;;;;;;;;;;ACTM,SAAS,YAAY,CAAC,eAAuB;IAClD,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,CAAC,CAAC;KACV;IACD,OAAO,eAAe,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,MAAM,CAAC;AACnE,CAAC;;;;;;;;;;;;;;;;;;ACHD,MAAM,aAAa,GAAG,UAAU,CAAC;AAE1B,MAAM,aAAa;IACxB,MAAM,CAAO,iBAAiB,CAC5B,IAAU,EACV,QAAgB;;YAEhB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;YACrD,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,OAAO,EAAE,CAAC;QACtC,CAAC;KAAA;IAED,MAAM,CAAO,gCAAgC,CAC3C,MAAmB,EACnB,QAAgB;;YAEhB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,SAAS,CAClC,IAAI,IAAI,CAAC,CAAC,IAAI,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC,EACxD,QAAQ,CACT,CAAC;YACF,OAAO,EAAE,IAAI,EAAE,MAAM,CAAC,UAAU,EAAE,OAAO,EAAE,CAAC;QAC9C,CAAC;KAAA;IAED,MAAM,CAAC,oBAAoB,CACzB,GAAW,EACX,QAAQ,GAAG,YAAY;QAEvB,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YACrC,MAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;YACjC,GAAG,CAAC,MAAM,GAAG,GAAS,EAAE,CAAC;gBACvB,MAAM,MAAM,GAAG,MAAM,aAAa,CAAC,SAAS,CACpC,GAAG,CAAC,QAAQ,EAClB,QAAQ,CACT,CAAC;gBACF,OAAO,CAAC,MAAM,CAAC,CAAC;YAClB,CAAC,EAAC;YACF,GAAG,CAAC,OAAO,GAAG,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;YAC7B,GAAG,CAAC,OAAO,GAAG,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;YAC7B,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,CAAC,CAAC;YACrB,GAAG,CAAC,YAAY,GAAG,MAAM,CAAC;YAC1B,GAAG,CAAC,IAAI,EAAE,CAAC;QACb,CAAC,CAAC,CAAC;IACL,CAAC;IAED,MAAM,CAAC,SAAS,CAAC,IAAU,EAAE,QAAgB;QAC3C,OAAO,IAAI,OAAO,CAAS,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;YAC7C,MAAM,MAAM,GAAG,IAAI,UAAU,EAAE,CAAC;YAChC,MAAM,CAAC,SAAS,GAAG,GAAG,EAAE,CACtB,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC,MAAgB,EAAE,QAAQ,CAAC,CAAC,CAAC;YACzE,MAAM,CAAC,OAAO,GAAG,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;YAChC,MAAM,CAAC,OAAO,GAAG,GAAG,EAAE,CAAC,MAAM,EAAE,CAAC;YAChC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,MAAM,CAAC,qBAAqB,CAAC,OAAe,EAAE,QAAgB;QACpE,IAAI,OAAO,CAAC,UAAU,CAAC,QAAQ,QAAQ,GAAG,CAAC,EAAE;YAC3C,OAAO,OAAO,CAAC;SAChB;aAAM;YACL,MAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,aAAa,CAAC,MAAM,CAAC;YACpE,OAAO,QAAQ,QAAQ,GAAG,aAAa,GAAG,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC;SACnE;IACH,CAAC;IAED,MAAM,CAAC,sBAAsB,CAAC,OAAe;QAC3C,MAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,aAAa,CAAC,MAAM,CAAC;QACpE,MAAM,MAAM,GAAG,OAAO,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;QACxC,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC;QACzB,MAAM,SAAS,GAAG,GAAG,CAAC,MAAM,CAAC;QAC7B,MAAM,KAAK,GAAG,IAAI,UAAU,CAAC,SAAS,CAAC,CAAC;QAExC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,EAAE,CAAC,EAAE,EAAE;YAClC,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;SAC9B;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,MAAM,CAAC,oBAAoB,CAAC,OAAe;QACzC,MAAM,IAAI,GAAG,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;QAClD,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;CACF;;;;;;;;;;;;;;;;AChFM,SAAS,cAAc,CAAC,QAAkB;IAC/C,OAAO,CACL,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,IAAI,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CACxE,CAAC;AACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACN4B;AACmB;AACtB;AAON;AACb,MAAM,eAAe,GAAG,iDAAc,CAC3C,4EAAqC,CAAC,CAAC,UAAU,EAAE,EAAE,CACnD,2CAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC,CACvC,CACF,CAAC;AACK,MAAM,gBAAgB,GAAG,0GACT,CAAC;AACxB,sEAAsE;AAE/D,MAAM,YAAY;IACvB,MAAM,CAAC,YAAY,CAAC,MAAgB,EAAE,MAAM,GAAG,eAAe;QAC5D,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;IACjC,CAAC;IAED,MAAM,CAAC,UAAU,CAAC,MAAgB;QAChC,MAAM,CAAC,GAAG,iDAAK,CAAC,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;QAC1C,OAAO,yDAAa,CAAC,CAAC,EAAE,gBAAgB,CAAC,CAAC;IAC5C,CAAC;IAED,MAAM,CAAC,kBAAkB;QACvB,OAAO,uDAAW,CAAC,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,CAAC;IACnD,CAAC;IAED,MAAM,CAAC,4CAA4C,CAAC,MAAgB;QAClE,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;YAC9B,CAAC,CAAC,wCAAE,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;YAC1C,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;gBACvB,CAAC,CAAC,wCAAE,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;gBAC3C,CAAC,CAAC,wCAAE,CAAC,EAAE,UAAU,EAAE,KAAK,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC;IACnD,CAAC;IAED,MAAM,CAAC,MAAM,CACX,YAA4B;QAE5B,OAAO;YACL,YAAY,CAAC,YAAY,EAAE,CAAC,GAAG;YAC/B,YAAY,CAAC,YAAY,EAAE,CAAC,GAAG;YAC/B,YAAY,CAAC,YAAY,EAAE,CAAC,GAAG;YAC/B,YAAY,CAAC,YAAY,EAAE,CAAC,GAAG,CAAC,OAAO;SACxC,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,QAAQ,CACb,YAA4B,EAC5B,QAAiC;QAEjC,OAAO,yDAAa,CAAC,uDAAW,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAC;IACzE,CAAC;CACF;;;;;;;;;;;;;;;;;;AC1D4B;AAItB,MAAM,UAAU;IAmBrB,YAAY,GAAU,EAAE,QAAkB;QAV1C,wBAAmB,GAAG;YACpB,MAAM,EAAE,IAAI;YACZ,KAAK,EAAE,MAAM;YACb,MAAM,EAAE,CAAC;YACT,OAAO,EAAE,GAAG;YACZ,WAAW,EAAE,IAAI;YACjB,SAAS,EAAE,MAAM;YACjB,SAAS,EAAE,KAAK;SACjB,CAAC;QAGA,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,cAAc,GAAG,4CAAS,CAAC;YAC9B,SAAS,EAAE,oBAAoB;YAC/B,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YAClB,IAAI,EAAE,sDAAsD;SAC7D,CAAC,CAAC;QACH,MAAM,MAAM,GAAG;YACb,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,QAAQ;YAC7B,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,SAAS;SAC/B,CAAC;QACF,IAAI,CAAC,UAAU,GAAG,2CAAQ,CAAC,MAAM,EAAE,EAAE,IAAI,EAAE,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC;QAClE,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;IAC7B,CAAC;IAED,WAAW;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC;IACvB,CAAC;IAED,cAAc,CAAC,QAAkB;QAC/B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,MAAM,MAAM,GAAG;YACb,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,QAAQ;YAC7B,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,SAAS;SAC/B,CAAC;QACF,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QAClC,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QAC3B,0CAA0C;QAC1C,gDAAgD;QAChD,IAAI;QACJ,8CAA8C;IAChD,CAAC;IAED,UAAU,CAAC,OAAe;QACxB,MAAM,OAAO,GAAgB,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;aACtD,UAAU,CAAC,CAAC,CAAgB,CAAC;QAChC,MAAM,OAAO,GAAG,OAAO,GAAG,EAAE,CAAC;QAC7B,OAAO,CAAC,KAAK,CAAC,mBAAmB,CAAC;YAChC,SAAS,GAAG,OAAO,GAAG,uBAAuB,CAAC;QAChD,OAAO,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;IAClC,CAAC;IAEO,WAAW,CAAC,QAAkB;QACpC,MAAM,MAAM,GAAG;YACb,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,QAAQ;YAC7B,GAAG,EAAE,QAAQ,CAAC,MAAM,CAAC,SAAS;SAC/B,CAAC;QACF,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACxB,IAAI,CAAC,cAAc,GAAG,2CAAQ,CAC5B,MAAM,EACN,QAAQ,CAAC,MAAM,CAAC,QAAQ,EACxB,IAAI,CAAC,mBAAmB,CACzB,CAAC;YACF,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACrC;aAAM;YACL,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;YACxD,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;SACvC;IACH,CAAC;CACF;;;;;;;;;;;;;;;;;ACnFiC;AAE3B,MAAM,wBAA4B,SAAQ,4CAAa;IAC5D,YAAY,KAA4B;QACtC,KAAK,CAAC,CAAC,QAAQ,EAAE,EAAE;YACjB,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;gBACtB,IAAI,GAAG,EAAE;oBACP,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;iBACrB;qBAAM;oBACL,QAAQ,CAAC,IAAI,CAAE,GAAoB,CAAC,CAAC;iBACtC;YACH,CAAC,CAAC,CAAC;YACH,OAAO,GAAG,EAAE,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC;CACF;;;;;;;;;;;;;;;;AChBM,MAAM,YAAY;IACvB,MAAM,CAAC,SAAS,CAAC,CAAM;QACrB,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,CAAC;IAC9C,CAAC;IAED,MAAM,CAAC,gBAAgB,CAAC,CAAS,EAAE,aAAsB;QACvD,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;YACrB,+CAA+C;YAC/C,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7B,OAAO,UAAU,CACf,CACE,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,aAAa,CAAC,GAAG,IAAI,GAAG,MAAM,CAAC;gBAC3D,IAAI,CAAC,GAAG,CAAC,EAAE,EAAE,aAAa,CAAC,CAC5B,CAAC,OAAO,CAAC,aAAa,CAAC,CACzB,CAAC;SACH;aAAM;YACL,OAAO,CAAC,CAAC;SACV;IACH,CAAC;IAED,MAAM,CAAC,aAAa,CAAC,CAAM;QACzB,OAAO,CAAC,KAAK,SAAS,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;IACnD,CAAC;IAED,MAAM,CAAC,OAAO,CACZ,CAAM,EACN,GAAY,EACZ,GAAY,EACZ,QAAQ,GAAG,KAAK,EAChB,OAAO,GAAG,KAAK;QAEf,IAAI,QAAQ,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;YACrC,OAAO,KAAK,CAAC;SACd;QACD,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,EAAE;YACtC,OAAO,IAAI,CAAC;SACb;QACD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE;YACtB,OAAO,KAAK,CAAC;SACd;QACD,MAAM,YAAY,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;QACnC,IAAI,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,YAAY,CAAC,EAAE;YAC9C,OAAO,KAAK,CAAC;SACd;QACD,IAAI,GAAG,KAAK,SAAS,IAAI,YAAY,GAAG,GAAG,EAAE;YAC3C,OAAO,KAAK,CAAC;SACd;QACD,IAAI,GAAG,KAAK,SAAS,IAAI,YAAY,GAAG,GAAG,EAAE;YAC3C,OAAO,KAAK,CAAC;SACd;QACD,OAAO,IAAI,CAAC;IACd,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;;ACpDwD;AACK;AACrB;;AAElC,SAAS,mBAAmB,CACjC,UAAyB,EACzB,MAAsB,EACtB,WAAoB;IAEpB,OAAO,IAAI,OAAO,CAAI,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QACxC,IAAI,YAAY,GAAiB,SAAS,CAAC;QAC3C,YAAY;YACZ,CAAC,WAAW,IAAI,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,uDAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC;gBACnF,IAAI,EAAE,CAAC,MAAM,EAAE,EAAE;oBACf,IAAG,YAAY,EAAE;wBACf,YAAY,CAAC,WAAW,EAAE,CAAC;qBAC5B;oBACD,OAAO,CAAC,MAAM,CAAC,CAAC;gBAClB,CAAC;gBACD,KAAK,EAAE,CAAC,KAAK,EAAE,EAAE;oBACf,IAAG,YAAY,EAAE;wBACf,YAAY,CAAC,WAAW,EAAE,CAAC;qBAC5B;oBACD,MAAM,CAAC,KAAK,CAAC,CAAC;gBAChB,CAAC;aACF,CAAC,CAAC;QACH,IAAI,MAAM,EAAE;YACV,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE;gBACf,IAAG,YAAY,EAAE;oBACf,YAAY,CAAC,WAAW,EAAE,CAAC;iBAC5B;gBACD,MAAM,CAAC,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC;SACJ;IACH,CAAC,CAAC,CAAC;AACL,CAAC;AAEM,SAAS,SAAS,CAAC,IAAY;IACpC,OAAO,CAAI,MAAqB,EAAE,EAAE,CAClC,IAAI,4CAAU,CAAI,CAAC,QAAQ,EAAE,EAAE,CAC7B,MAAM,CAAC,SAAS,CAAC;QACf,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC7C,KAAK,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC;QACnC,QAAQ,EAAE,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE;KACpC,CAAC,CACH,CAAC;AACN,CAAC;AAEM,SAAS,oBAAoB;IAClC,OAAO,CAAI,MAAqB,EAAE,EAAE,CAClC,IAAI,4CAAU,CAAI,CAAC,QAAQ,EAAE,EAAE,CAC7B,MAAM,CAAC,SAAS,CAAC;QACf,IAAI,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/C,KAAK,EAAE,CAAC,GAAG,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC;QACnC,QAAQ,EAAE,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE;KACpC,CAAC,CACH,CAAC;AACN,CAAC;AAGM,MAAM,aAAa;IAExB;QACE,IAAI,CAAC,UAAU,GAAG,IAAI,yCAAO,EAAE,CAAC;IAClC,CAAC;IACD,WAAW;QACT,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;;0EARU,aAAa;8GAAb,aAAa,WAAb,aAAa;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5DuC;AAOnC;AACiB;AAEF;AAC4C;AAI9B;AACV;;;;;AAEjD;;;GAGG;AAEI,MAAM,cAAc;IACzB,YACU,iBAAoC,EACpC,aAA6B,EAC7B,OAAuB;QAFvB,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,kBAAa,GAAb,aAAa,CAAgB;QAC7B,YAAO,GAAP,OAAO,CAAgB;IAC9B,CAAC;IAEI,WAAW,CAAC,GAAW;QAC7B,OAAO,CACL,GAAG,CAAC,UAAU,CACZ,GAAG,2EAAuC,eAAe,CAC1D;YACD,GAAG,CAAC,UAAU,CACZ,GAAG,2EAAuC,eAAe,CAC1D;YACD,GAAG,CAAC,UAAU,CACZ,GAAG,2EAAuC,eAAe,CAC1D;YACD,GAAG,CAAC,UAAU,CAAC,GAAG,2EAAuC,UAAU,CAAC;YACpE,GAAG,CAAC,UAAU,CAAC,GAAG,2EAAuC,UAAU,CAAC;YACpE,GAAG,CAAC,UAAU,CAAC,GAAG,2EAAuC,UAAU,CAAC,CACrE,CAAC;IACJ,CAAC;IAEO,QAAQ,CAAC,GAAW;QAC1B,OAAO,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;IACpC,CAAC;IAED,SAAS,CACP,GAAyB,EACzB,IAAiB;QAEjB,IAAI,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,CAAC,EAAE;YAC1B,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAC1B,mDAAG,CAAC,CAAC,QAAQ,EAAE,EAAE;gBACf,IAAI,QAAQ,CAAC,IAAI,KAAK,wEAAsB,EAAE;oBAC5C,IAAI,CAAC,OAAO,CAAC,OAAO,CAClB,sGAAuB,EACvB,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,CAC9B,CAAC;iBACH;YACH,CAAC,CAAC,CACH,CAAC;SACH;QACD,IAAI,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,EAAE;YAClE,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC,IAAI,CACjC,yDAAS,CAAC,CAAC,qBAAqB,EAAE,EAAE;gBAClC,OAAO,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC,IAAI,CAC5C,0DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;oBACjB,OAAO,IAAI,CAAC,mBAAmB,CAAC,GAAG,EAAE,qBAAqB,EAAE,IAAI,CAAC,CAAC;gBACpE,CAAC,CAAC,CACH,CAAC;YACJ,CAAC,CAAC,CACH,CAAC;SACH;QACD,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;IAC1B,CAAC;IAEO,aAAa,CACnB,OAA6B;QAE7B,OAAO,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,IAAI,CAC9C,0DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,aAAa,CAAC,KAAK,CACtB,2BAA2B,EAC3B,iBAAiB,EACjB,GAAG,CACJ,CAAC;YACF,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;YAChC,OAAO,uCAAK,CAAC,CAAC,iBAAiB;QACjC,CAAC,CAAC,EACF,mDAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACX,MAAM,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,CACjC,eAAe,EACf,UAAU,IAAI,CAAC,KAAK,EAAE,CACvB,CAAC;YACF,OAAO,OAAO,CAAC,KAAK,CAAC,EAAE,OAAO,EAAE,CAAC,CAAC;QACpC,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,mBAAmB,CACzB,KAAK,EACL,OAAO,EACP,IAAiB;QAEjB,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;YACxB,6DAA6D;YAC7D,IAAI,CAAC,aAAa,CAAC,KAAK,CACtB,kEAAkE,CACnE,CAAC;YACF,OAAO,2CAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,CAAC,CAAC,IAAI,CACrD,yDAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,EAC5C,yDAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CACrC,CAAC;SACH;QACD,MAAM,KAAK,CAAC;IACd,CAAC;;4EAjGU,cAAc;gHAAd,cAAc,WAAd,cAAc;;;;;;;;;;;;;;;;ACvB3B,IAAY,WAIX;AAJD,WAAY,WAAW;IACrB,6CAAQ;IACR,6CAAQ;IACR,2CAAO;AACT,CAAC,EAJW,WAAW,KAAX,WAAW,QAItB;;;;;;;;;;;;;;;;ACJD,IAAY,OASX;AATD,WAAY,OAAO;IACjB,sCAA2B;IAC3B,gCAAqB;IACrB,wCAA6B;IAC7B,8CAAmC;IACnC,gDAAqC;IACrC,sCAA2B;IAC3B,8CAAmC;IACnC,oDAAyC;AAC3C,CAAC,EATW,OAAO,KAAP,OAAO,QASlB;;;;;;;;;;;;;;;;;;ACHM,MAAM,iBAAiB;IAC5B,aAAa;QACX,IAAI;YACF,2CAA2C;YAC3C,OAAO,mBAAO,CAAC,kDAAuC,CAAC,CAAC;SACzD;QAAC,WAAM;YACN,OAAO;gBACL,OAAO,EAAE,OAAO;gBAChB,WAAW,EAAE,CAAC;gBACd,QAAQ,EAAE,EAAE;gBACZ,MAAM,EAAE,EAAE;gBACV,IAAI,EAAE,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE;aAC/B,CAAC;SACH;IACH,CAAC;;kFAdU,iBAAiB;kHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;;;ACCb,MAAe,yBAAyB;;kGAAzB,yBAAyB;0HAAzB,yBAAyB,WAAzB,yBAAyB;;;;;;;;;;;;;;;;;;;ACL8D;AAGvE;;;AAK/B,MAAM,yBAAyB;IAEpC,YAAoB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IACpC,CAAC;IAED,QAAQ,CAAC,GAAW;QAClB,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;YACxB,cAAc,EAAE,IAAI;YACpB,OAAO,EAAE,QAAQ;YACjB,YAAY,EAAE,MAAM;SACrB,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,QAA0B,EAAE,KAAsB,EAAoB,EAAE;YACpF,IAAI,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,EAAE;gBACnC,OAAO;oBACL,QAAQ,EAAE,KAAK,CAAC,KAAK;wBACnB,CAAC,CAAE,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,KAAK,CAAC;wBAC/B,CAAC,CAAC,QAAQ,CAAC,QAAQ;oBACrB,KAAK,EAAE,aAAa;oBACpB,MAAM,EAAE,KAAK,CAAC,MAAM;oBACpB,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,OAAO,EAAE,IAAI;iBACd,CAAC;aACH;YACD,IAAI,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;gBAC9B,OAAO;oBACL,QAAQ,EAAE,GAAG;oBACb,KAAK,EAAE,MAAM;oBACb,KAAK,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI;oBACtB,MAAM,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI;oBACvB,OAAO,EAAE,KAAK,CAAC,IAAI;iBACpB,CAAC;aACH;YACD,OAAO,QAAQ,CAAC;QAClB,CAAC,EACD,EAAC,KAAK,EAAE,SAAS,EAAE,QAAQ,EAAE,CAAC,EAAE,MAAM,EAAE,CAAC,EAAE,OAAO,EAAE,IAAI,EAAC,CACxD,CAAC,CAAC;IACL,CAAC;IAEO,cAAc,CAAI,KAAmB;QAC3C,OAAO,KAAK,CAAC,IAAI,KAAK,wEAAsB,CAAC;IAC/C,CAAC;IAEO,mBAAmB,CAAC,KAAyB;QACnD,OAAO,KAAK,CAAC,IAAI,KAAK,gFAA8B;eAC7C,KAAK,CAAC,IAAI,KAAK,8EAA4B,CAAC;IACrD,CAAC;;kGA5CU,yBAAyB;0HAAzB,yBAAyB,WAAzB,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;ACNtC,qHAAqH;AAC3E;AAC6B;AAChB;AAGmC;;;;;;AAE1F,MAAM,SAAS,GAAG,oCAAoC,CAAC;AAGhD,MAAM,kCAAkC;IAI7C,YACU,QAAkB,EAClB,UAA6B,EAC7B,gBAAkC,EAClC,WAAwB,EACxB,cAA8B;QAJ9B,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAmB;QAC7B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YAC9B,IAAI,CAAC,qBAAqB,GAAS,MAAO,CAAC,qBAAqB,CAAC;QACnE,CAAC,CAAC,CAAC;IACL,CAAC;IAEa,8BAA8B;;YAC1C,MAAM,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;YAC5B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC;gBACH,wCAAwC;gBACxC,uCAAuC;aACxC,CAAC;iBACD,SAAS,EAAE,CAAC;YACf,gDAAgD;YAChD,iHAAiH;YACjH,uEAAuE;YACvE,4BAA4B;YAC5B,0BAA0B;YAC1B,uFAAuF;YACvF,0GAA0G;YAC1G,6BAA6B;YAC7B,iFAAiF;YACjF,+EAA+E;YAC/E,uCAAuC;YACvC,wGAAwG;YACxG,KAAK;YACL,uDAAuD;YACvD,qFAAqF;YACrF,kBAAkB;YAClB,kGAAkG;YAClG,MAAM;QACR,CAAC;KAAA;IAED,gEAAgE;IAChE,+CAA+C;IAC/C,uCAAuC;IACvC,yCAAyC;IACzC,oCAAoC;IACpC,uCAAuC;IACvC,uCAAuC;IACvC,qCAAqC;IACrC,gCAAgC;IAChC,UAAU;IACV,IAAI;IAEE,KAAK;;YACT,2DAA2D;YAC3D,+CAA+C;YAC/C,2FAA2F;YAC3F,oCAAoC;YACpC,kDAAkD;YAClD,4CAA4C;YAC5C,gEAAgE;YAChE,uCAAuC;YACvC,oCAAoC;YACpC,wDAAwD;YACxD,gBAAgB;YAChB,uDAAuD;YACvD,4BAA4B;YAC5B,4FAA4F;YAC5F,sBAAsB;YACtB,2DAA2D;YAC3D,YAAY;YACZ,UAAU;YACV,MAAM;YACN,4DAA4D;YAC5D,iCAAiC;YACjC,4EAA4E;YAC5E,0DAA0D;YAC1D,8DAA8D;YAC9D,MAAM;YACN,iDAAiD;YACjD,8FAA8F;YAC9F,MAAM;YACN,gDAAgD;YAChD,8FAA8F;YAC9F,MAAM;YACN,+DAA+D;YAC/D,kGAAkG;YAClG,8DAA8D;YAC9D,+DAA+D;YAC/D,QAAQ;YACR,MAAM;YACN,uDAAuD;YACvD,4FAA4F;YAC5F,gFAAgF;YAChF,+BAA+B;YAC/B,+EAA+E;YAC/E,QAAQ;YACR,MAAM;QACR,CAAC;KAAA;IAEK,IAAI;;YACR,+BAA+B;YAC/B,0DAA0D;YAC1D,qCAAqC;YACrC,mEAAmE;YACnE,gCAAgC;YAChC,6BAA6B;YAC7B,MAAM;YACN,6BAA6B;YAC7B,8CAA8C;YAC9C,kDAAkD;YAClD,oDAAoD;YACpD,kDAAkD;YAClD,kDAAkD;YAClD,4CAA4C;YAC5C,6CAA6C;YAC7C,gDAAgD;YAChD,UAAU;YACV,IAAI;YACJ,oDAAoD;YACpD,2DAA2D;YAC3D,mEAAmE;YACnE,IAAI;QACN,CAAC;KAAA;IAED,SAAS;QACP,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC9B,oCAAoC;QACpC,2DAA2D;QAC3D,qCAAqC;QACrC,UAAU;QACV,MAAM;IACR,CAAC;;oHAvIU,kCAAkC,2aAQtB,WAAW;mIARvB,kCAAkC,WAAlC,kCAAkC;;;;;;;;;;;;;;;;;;;;;ACV/C,WAAW;AACX,iBAAiB;AACjB,iBAAiB;AACjB,kBAAkB;AAClB,0CAA0C;AAC6B;AAEmB;;;;AAE1F,oKAAoK;AAE7J,MAAM,+BAA+B;IAI1C,YACU,WAAwB,EACxB,UAA6B,EAC7B,cAA8B;QAF9B,gBAAW,GAAX,WAAW,CAAa;QACxB,eAAU,GAAV,UAAU,CAAmB;QAC7B,mBAAc,GAAd,cAAc,CAAgB;IACrC,CAAC;IAEE,KAAK;;YACT,2DAA2D;YAC3D,4CAA4C;YAC5C,oEAAoE;YACpE,gBAAgB;YAChB,6CAA6C;YAC7C,6CAA6C;YAC7C,OAAO;QACT,CAAC;KAAA;IAED,gEAAgE;IAChE,6EAA6E;IAC7E,4BAA4B;IAC5B,6BAA6B;IAC7B,qCAAqC;IACrC,sBAAsB;IACtB,wCAAwC;IACxC,uCAAuC;IACvC,yCAAyC;IACzC,uCAAuC;IACvC,uCAAuC;IACvC,iCAAiC;IACjC,kCAAkC;IAClC,oCAAoC;IACpC,UAAU;IACV,MAAM;IACN,IAAI;IAEJ,wCAAwC;IACxC,yEAAyE;IACzE,IAAI;IAEE,IAAI;;YACR,0DAA0D;YAC1D,wCAAwC;YACxC,iCAAiC;QACnC,CAAC;KAAA;IAED,SAAS;QACP,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC9B,oDAAoD;IACtD,CAAC;;8GAnDU,+BAA+B,yDAKnB,WAAW;gIALvB,+BAA+B,WAA/B,+BAA+B;;;;;;;;;;;;;;;;;;ACXrC,MAAe,4BAA4B;;wGAA5B,4BAA4B;6HAA5B,4BAA4B,WAA5B,4BAA4B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHC;AACS;AACY;AACxB;AACwB;AACE;AAC1B;AACN;AACwD;AACG;AAC9B;AACmB;AAC7C;AAQrB;AAE+D;AACvB;AACgC;AACT;AAC9C;;;;;;;;;;;;;;AACzC,MAAM,SAAS,GAAG,qBAAqB,CAAC;AAKjC,MAAM,mBAAmB;IAgB9B,YACU,MAAc,EACd,cAA8B,EAC9B,kBAAsC,EACtC,UAAsB,EACtB,eAAgC,EAChC,kBAAsC,EACtC,iBAAoC,EACpC,QAAkB,EAClB,mBAAwC,EACxC,iBAAoC,EACpC,cAA8B,EAC9B,eAAgC,EAChC,MAAc;QAZd,WAAM,GAAN,MAAM,CAAQ;QACd,mBAAc,GAAd,cAAc,CAAgB;QAC9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,eAAU,GAAV,UAAU,CAAY;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAChC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,aAAQ,GAAR,QAAQ,CAAU;QAClB,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAChC,WAAM,GAAN,MAAM,CAAQ;QA1BhB,kBAAa,GAAmB,EAAE,CAAC;QA4BzC,IAAI,CAAC,+BAA+B,GAAG,IAAI,0CAAO,EAAW,CAAC;IAChE,CAAC;IA3BD,IAAI,uBAAuB;QACzB,OAAO,IAAI,CAAC,+BAA+B,CAAC;IAC9C,CAAC;IAED,IAAI,yBAAyB;QAC3B,OAAO,IAAI,CAAC,+BAA+B;aACxC,YAAY,EAAE;aACd,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;aACb,SAAS,EAAE,CAAC;IACjB,CAAC;IAoBD,IAAI;QACF,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,GAAG,EAAE;YACjC,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,+BAA+B,EAAE,CAAC,SAAS,CAAC,GAAG,EAAE;gBACpD,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,8DAA8D,EAC9D,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,kBAAkB,EAAE,CAAC;YAC5B,CAAC,CAAC,CACH,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,SAAS,CAAC,GAAG,EAAE;gBACzD,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE,CAAC;gBACpC,IAAI,CAAC,eAAe,CAAC,eAAe,EAAE,CAAC;gBACvC,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,sEAAsE,EACtE,SAAS,CACV,CAAC;YACJ,CAAC,CAAC,CACH,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,mCAAmC,CAAC,SAAS,CACnE,CAAC,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC,EAAE,EAAE;gBACjC,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,sFAAsF,EACtF,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,4GAA2B,EAC3B,gEAAO,CAAC,OAAO,CAAC,CACjB,CAAC;gBACF,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,2GAA0B,EAC1B,OAAO,CACR,CAAC;gBACF,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,6GAA4B,EAC5B,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,kEAAS,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAChD,CAAC;gBACF,IAAI,CAAC,kBAAkB,EAAE,CAAC;gBAC1B,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC;YACvC,CAAC,CACF,CACF,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBACjC,IAAI,CACH,oDAAG,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC,0BAA0B,CAAC,EAC5D,qEAAoB,EAAE,CACvB;iBACA,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;gBACrB,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;oBAC9B,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC;oBAC7B,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,oHAAmC,EACnC,OAAO,CACR,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,oHAAmC,EACnC,OAAO,CACR,CAAC;oBACF,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;oBAC/B,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,CAAC;iBAC/B;YACH,CAAC,CAAC,CACL,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,aAAa,EAAE,EAAE;gBACjE,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,iHAAgC,EAChC,aAAa,CAAC,QAAQ,EAAE,CACzB,CAAC;YACJ,CAAC,CAAC,CACH,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBACjC,IAAI,CACH,oDAAG,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC,OAAO,CAAC,EACzC,qEAAoB,EAAE,CACvB;iBACA,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;gBACrB,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,2GAA0B,EAC1B,OAAO,CACR,CAAC;YACJ,CAAC,CAAC,CACL,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,aAAa;iBAClC,IAAI,CACH,oDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CACT,EAAE;iBACC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC;iBACxB,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;iBAClB,IAAI,CAAC,GAAG,CAAC,CACb,EACD,qEAAoB,EAAE,CACvB;iBACA,SAAS,CAAC,CAAC,UAAU,EAAE,EAAE;gBACxB,IAAI,CAAC,eAAe,CAAC,cAAc,CACjC,8GAA6B,EAC7B,UAAU,CACX,CAAC;YACJ,CAAC,CAAC,CACL,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CACtD,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAClC,CACF,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CACrD,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAC9C,CACF,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE;gBACjC,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,sCAAsC,EACtC,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAC9B,CAAC,CAAC,CACH,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,EAAE;gBAClC,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,4DAA4D,IAAI,CAAC,MAAM,CAAC,GAAG,GAAG,EAC9E,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC/B,CAAC,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QACH,gCAAgC;QAChC,0GAA0G;IAC5G,CAAC;IAED,UAAU;QACR,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,6BAA6B,EAAE,SAAS,CAAC,CAAC;QACpE,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,4CAA4C;IAC3D,CAAC;IAEO,cAAc;QACpB,KAAK,MAAM,YAAY,IAAI,IAAI,CAAC,aAAa,EAAE;YAC7C,YAAY,CAAC,WAAW,EAAE,CAAC;SAC5B;QACD,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAC1B,CAAC;IAED,wBAAwB;QACtB,IAAI,CAAC,+BAA+B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAClD,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;IAC7E,CAAC;IAED;;OAEG;IACK,+BAA+B;QACrC,OAAO,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC,IAAI,CACnD,0DAAS,CAAC,CAAC,gBAAgB,EAAE,EAAE,CAC7B,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,IAAI,CACpC,oDAAG,CACD,CAAC,GAAG,EAAE,EAAE,CACN,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,KAAK,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAChE,EACD,qEAAoB,EAAE,EACtB,yDAAQ,EAAE,EACV,uDAAM,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE,CAAC,IAAI,GAAG,IAAI,CAAC,CACtC,CACF,CACF,CAAC;IACJ,CAAC;IAED,qBAAqB;QACnB,IAAI,IAAI,CAAC,wBAAwB,EAAE;YACjC,IAAI,CAAC,oBAAoB,EAAE,CAAC;SAC7B;QACD,IAAI,CAAC,wBAAwB,GAAG,WAAW,CAAC,GAAG,EAAE;YAC/C,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC/B,CAAC,EAAE,0EAAmC,CAAC,CAAC;QACxC,IAAI,CAAC,qBAAqB,EAAE,CAAC,CAAC,mBAAmB;IACnD,CAAC;IAED,oBAAoB;QAClB,YAAY,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;IAC9C,CAAC;IAED,qBAAqB,CAAC,UAAU,GAAG,KAAK;QACtC,OAAO,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC,GAAS,EAAE,CAAC;YAC/C,MAAM,WAAW,GAAG,UAAU;gBAC5B,CAAC,CAAC,sGAA2C,CAC3C,sEAA+B,CAChC;gBACD,CAAC,CAAC,IAAI,CAAC;YACT,iFAAiF;YACjF,MAAM,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;YAC9D,MAAM,4BAA4B,GAAG,WAAW;gBAC9C,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,yBAAyB,EAAE,WAAW,CAAC,CAAC;gBAC7D,CAAC,CAAC,IAAI,CAAC,yBAAyB,CAAC;YACnC,MAAM,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAC9C,4BAA4B,CAC7B,CAAC;YACF,MAAM,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;YACtD,MAAM,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;YACrD,MAAM,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;YACxD,MAAM,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,EAAE,CAAC;YACpD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,6BAA6B,EAAE,SAAS,CAAC,CAAC;QACtE,CAAC,EAAC,CAAC;IACL,CAAC;;sFA/PU,mBAAmB;qHAAnB,mBAAmB,WAAnB,mBAAmB,mBAFlB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzBc;AACQ;AACM;AACH;AAC6C;AACpD;AACQ;AACsC;AACf;;;;;AACrE,MAAM,SAAS,GAAG,mBAAO,CAAC,gCAAqB,CAAC,CAAC;AAEjD,MAAM,aAAa,GAAG,iBAAiB,CAAC;AAKjC,MAAM,eAAe;IAG1B,YACU,MAAc,EACd,QAAkB,EAClB,cAA8B;QAF9B,WAAM,GAAN,MAAM,CAAQ;QACd,aAAQ,GAAR,QAAQ,CAAU;QAClB,mBAAc,GAAd,cAAc,CAAgB;IACrC,CAAC;IAEE,IAAI;;YACR,IAAI,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBACjC,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,oDAAoD,EACpD,aAAa,CACd,CAAC;gBACF,MAAM,MAAM,GAAyB;oBACnC,IAAI,EAAE,iEAA0B;oBAChC,QAAQ,EAAE,SAAS;iBACpB,CAAC;gBACF,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,gCACrC,MAAM,KACT,uBAAuB,EAAE,QAAQ,GAClC,CAAC,CAAC;gBAEH,IAAI;oBACF,MAAM,IAAI,CAAC,SAAS,CAAC,UAAU,CAC7B,wDAAwD,EACxD,EAAE,CACH,CAAC;iBACH;gBAAC,OAAO,GAAG,EAAE;oBACZ,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,0BAA0B,EAC1B,GAAG,EACH,8FAAgB,EAChB,aAAa,CACd,CAAC;iBACH;aACF;QACH,CAAC;KAAA;IAED;;;;OAIG;IACG,WAAW,CAAI,KAAa,EAAE,EAAmB,EAAE,QAAQ,GAAG,IAAI;;YACtE,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,OAAO,IAAI,CAAC,kBAAkB,CAAI,KAAK,EAAE,EAAE,EAAE,QAAQ,CAAC,CAAC;aACxD;iBAAM;gBACL,OAAO,IAAI,CAAC,mBAAmB,CAAI,KAAK,EAAE,EAAE,EAAE,QAAQ,CAAC,CAAC;aACzD;QACH,CAAC;KAAA;IAEK,OAAO,CAAC,OAAgD;;YAC5D,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI;oBACF,MAAM,IAAI,CAAC,SAAS,CAAC,UAAU,CAC7B,2EAA2E,CAC5E,CAAC;iBACH;gBAAC,OAAO,GAAG,EAAE;oBACZ,IAAI,OAAO,EAAE;wBACX,OAAO,CAAC,4BAA4B,EAAE,GAAG,CAAC,CAAC;qBAC5C;iBACF;aACF;YACD,MAAM,qDAAe,CAAC,OAAO,CAAC,CAAC;YAC/B,qBAAqB;QACvB,CAAC;KAAA;IAEa,kBAAkB,CAC9B,KAAa,EACb,EAAmB,EACnB,QAAQ,GAAG,IAAI;;YAEf,MAAM,MAAM,GAAG,qBAAqB,KAAK,iBAAiB,CAAC;YAC3D,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;YAChE,IAAI,SAAS,CAAC,IAAI,IAAI,SAAS,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC/C,MAAM,UAAU,GAAG,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;gBAC/C,IAAI,UAAU,EAAE;oBACd,MAAM,MAAM,GAAM,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;oBACzC,OAAO,MAAM,CAAC;iBACf;aACF;QACH,CAAC;KAAA;IAEa,mBAAmB,CAC/B,KAAa,EACb,EAAmB,EACnB,QAAQ,GAAG,IAAI;;YAEf,MAAM,aAAa,GAAG,MAAM,oDAAI,CAAC,KAAK,CAAC;iBACpC,KAAK,CAAC,QAAQ,EAAE,CAAC,GAAG,QAAQ,EAAE,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;iBACzC,IAAI,EAAE,CAAC;YACV,OAAU,aAAa,CAAC,CAAC,CAAC,CAAC;QAC7B,CAAC;KAAA;IAEK,UAAU,CACd,KAAa,EACb,IAAS,EACT,UAA6B,EAC7B,cAAc,GAAG,KAAK;;YAEtB,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,MAAM,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC;aACvD;iBAAM;gBACL,MAAM,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,IAAI,EAAE,UAAU,CAAC,CAAC;aACvD;YACD,IAAI,cAAc,EAAE;gBAClB,oDAAI,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,IAAI,EAAE,CAAC;gBAC5C,4EAA4E;aAC7E;QACH,CAAC;KAAA;IAEO,iBAAiB,CACvB,KAAa,EACb,IAAS,EACT,UAA6B;QAE7B,MAAM,WAAW,GAAG,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,KAAQ,EAAE,EAAE,CAAO,KAAM,CAAC,EAAE,CAAC;QAC5E,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC;YACnC,0BAA0B,KAAK,kBAAkB;YACjD,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,SAAS,CAAC,GAAG,CAAC,CAAC;SACnC,CAAC,CAAC;QACH,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;IAC7C,CAAC;IAEO,iBAAiB,CACvB,KAAa,EACb,IAAS,EACT,UAA6B;QAE7B,OAAO,oDAAI,EAAE,CAAC,SAAS,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE,IAAI,EAAE,EAAE,KAAK,CAAC,CAAC;IACpD,CAAC;;8EApIU,eAAe;gHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClB4C;AACgB;AACtC;AACgD;AACN;;;;;;AAEpF,MAAM,SAAS,GAAG,qBAAqB,CAAC;AACxC,MAAM,mBAAmB,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AACvC,MAAM,iBAAiB,GAAG,SAAS,CAAC;AACpC,MAAM,gBAAgB,GAAG,SAAS,CAAC;AACnC,MAAM,oBAAoB,GAAG,SAAS,CAAC;AACvC,MAAM,yBAAyB,GAAG,SAAS,CAAC;AAK5C,MAAM,mBAAmB;IAC9B,YACU,YAA0B,EAC1B,oBAA0C,EAC1C,cAA8B,EAC9B,QAAkB;QAHlB,iBAAY,GAAZ,YAAY,CAAc;QAC1B,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,mBAAc,GAAd,cAAc,CAAgB;QAC9B,aAAQ,GAAR,QAAQ,CAAU;IACzB,CAAC;IAEE,gBAAgB,CAAC,GAAW;;YAChC,MAAM,YAAY,GAAG,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC;YAChD,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE;gBAC/B,IAAI,CAAC,wBAAwB,CAAC,YAAY,CAAC,CAAC;gBAC5C,OAAO;aACR;YACD,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,EAAE,CAAC;YAChE,IAAI,CAAC,SAAS,EAAE;gBACd,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,uFAAuF,EACvF,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,wBAAwB,CAAC,YAAY,CAAC,CAAC;gBAC5C,OAAO;aACR;YACD,IAAI,CAAC,oBAAoB;iBACtB,IAAI,CAAC;gBACJ,GAAG,EAAE,YAAY;gBACjB,SAAS,EAAE,iBAAiB;gBAC5B,QAAQ,EAAE,gBAAgB;gBAC1B,YAAY,EAAE,oBAAoB;gBAClC,gBAAgB,EAAE,yBAAyB;aAC5C,CAAC;iBACD,SAAS,CACR,GAAG,EAAE;gBACH,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,oEAAoE,EACpE,SAAS,CACV,CAAC;YACJ,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;gBACR,2CAA2C;gBAC3C,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,wGAAwG,EACxG,KAAK,EACL,8FAAgB,EAChB,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,wBAAwB,CAAC,YAAY,CAAC,CAAC;YAC9C,CAAC,CACF,CAAC;QACN,CAAC;KAAA;IAED,wBAAwB,CAAC,GAAW;QAClC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,GAAG,EAAE,SAAS,EAAE,+BAA+B,CAAC,CAAC;IAC5E,CAAC;IAEO,gBAAgB,CAAC,GAAW;QAClC,IAAI,GAAG,KAAK,IAAI,EAAE;YAChB,IACE,mBAAmB,CAAC,IAAI,CAAC,CAAC,aAAa,EAAE,EAAE,CACzC,GAAG,CAAC,WAAW,EAAE,CAAC,UAAU,CAAC,aAAa,CAAC,CAC5C,EACD;gBACA,OAAO,GAAG,CAAC;aACZ;YACD,OAAO,UAAU,GAAG,EAAE,CAAC;SACxB;QACD,OAAO,GAAG,CAAC;IACb,CAAC;;sFAnEU,mBAAmB;oHAAnB,mBAAmB,WAAnB,mBAAmB,mBAFlB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;ACdyB;AACS;AACJ;AACc;AACtB;AAC2B;;;AAK9D,MAAM,iBAAkB,SAAQ,qEAAa;IAOlD,YAAoB,QAAkB;QACpC,KAAK,EAAE,CAAC;QADU,aAAQ,GAAR,QAAQ,CAAU;QAEpC,IAAI,CAAC,QAAQ,GAAG,IAAI,iDAAe,CAAC,KAAK,CAAC,CAAC;QAC3C,IAAI,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;gBAC9B,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,yDAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,0CAAI,CAAC,YAAY,CAAC,CAAC,CAAC,iEAAc,EAAE,CAAC,CAAC,CAAC,iEAAc,EAAE,CAAC,CAAC,EACrF,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC3B,CAAC,SAAS,EAAE,CAAC;YAChB,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAfD,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;IACtC,CAAC;IAeD,gBAAgB;QACd,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC3C,CAAC;;kFAtBU,iBAAiB;kHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;ACTpB,IAAY,oBAKX;AALD,WAAY,oBAAoB;IAC9B,qEAAW;IACX,uFAAoB;IACpB,6FAAuB;IACvB,qEAAW;AACb,CAAC,EALW,oBAAoB,KAApB,oBAAoB,QAK/B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACMa;AAMU;AAKQ;AACgB;AAC0C;AAC/B;AACJ;AAC6B;AAEnB;AACrC;AACyC;AACI;;;;;;AAEzE,MAAM,SAAS,GAAG,oBAAoB,CAAC;AAEvC;;GAEG;AAII,MAAM,kBAAkB;IA0B7B,YACU,iBAAoC,EACpC,QAAkB,EAClB,cAA8B,EAC9B,eAAgC,EAChC,gBAAkC;QAJlC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,aAAQ,GAAR,QAAQ,CAAU;QAClB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;QA9BpC,wBAAmB,GAAG,IAAI,iDAAe,CAAC,IAAI,CAAC,CAAC;QAChD,mBAAc,GAAkC,IAAI,+CAAa,CAAC,EAAE,CAAC,CAAC;QACtE,oBAAe,GAA8B,IAAI,iDAAe,CACtE,IAAI,CACL,CAAC;QACM,mBAAc,GAA4B,IAAI,iDAAe,CAAC,IAAI,CAAC,CAAC;QAE3D,uBAAkB,GAAG,IAAI,iDAAe,CAAW,EAAE,CAAC,CAAC;QAExE,gBAAgB;QACR,4BAAuB,GAAe,IAAI,CAAC;QAsBjD,IAAI,CAAC,oCAAoC,EAAE,CAAC;IAC9C,CAAC;IApBD,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,uDAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC;IAChE,CAAC;IAED,IAAI,eAAe;QACjB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,uDAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC;IAC/D,CAAC;IAED,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE,CAAC;IAC5C,CAAC;IAYD,WAAW;QACT,IAAI,CAAC,iBAAiB,EAAE,CAAC;IAC3B,CAAC;IAED;;;OAGG;IACH,wBAAwB;QACtB,+CAA+C;QAC/C,OAAO,qDAAc,CAAW,IAAI,CAAC,eAAe,CAAC,CAAC;IACxD,CAAC;IAEO,oCAAoC;QAC1C,MAAM,qBAAqB,GAAG,IAAI,CAAC,kBAAkB,CAAC,IAAI,CACxD,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,EAC5B,qEAAoB,EAAE,CACvB,CAAC;QACF,oDAAa,CAAC,CAAC,IAAI,CAAC,6BAA6B,EAAE,EAAE,qBAAqB,CAAC,CAAC;aACzE,IAAI,CACH,oDAAG,CAAC,CAAC,CAAC,gBAAgB,EAAE,qBAAqB,CAAC,EAAE,EAAE,CAChD,gBAAgB,IAAI,qBAAqB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CACzD,CACF;aACA,SAAS,CAAC,CAAC,QAAQ,EAAE,EAAE;YACtB,IAAI,QAAQ,EAAE;gBACZ,IAAI,CAAC,kBAAkB,EAAE,CAAC;aAC3B;iBAAM;gBACL,IAAI,CAAC,iBAAiB,EAAE,CAAC;aAC1B;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,6BAA6B;QACnC,IAAI,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,OAAO,4CAAK,CACV,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,EAC1C,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,CAAC,CAC3C,CAAC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,CAAC,CAAC;SACzB;QACD,OAAO,yCAAE,CAAC,IAAI,CAAC,CAAC;IAClB,CAAC;IAEO,mBAAmB,CACzB,OAAe,EACf,OAA6B,kFAA4B,EACzD,mBAAmB,GAAG,IAAI;QAE1B,OAAO;YACL,SAAS,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YAC1B,MAAM,EAAE,eAAe;YACvB,GAAG,EAAE,SAAS;YACd,mBAAmB;YACnB,GAAG,EAAE;gBACH,IAAI;gBACJ,OAAO;aACR;SACF,CAAC;IACJ,CAAC;IAED,YAAY,CAAC,MAAgB;QAC3B,IAAI,MAAM,IAAI,MAAM,CAAC,SAAS,GAAG,CAAC,EAAE;YAClC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE;gBACzD,OAAO,MAAM,CAAC,SAAS,GAAG,IAAI,CAAC;aAChC;YACD,OAAO,MAAM,CAAC,SAAS,CAAC;SACzB;QACD,OAAO,6CAAM,EAAE,CAAC,IAAI,EAAE,CAAC;IACzB,CAAC;IAEO,2BAA2B,CAAC,GAAa;QAC/C,MAAM,GAAG,GAAmB;YAC1B,SAAS,EAAE,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC;YACjC,MAAM,EAAE,CAAC,GAAG,CAAC,MAAM,KAAK,SAAS;gBAC/B,CAAC,CAAC,eAAe;gBACjB,CAAC,CAAC,gBAAgB,CAAuC;YAC3D,GAAG;YACH,mBAAmB,EAAE,IAAI;YACzB,GAAG,EACD,GAAG,CAAC,MAAM,KAAK,SAAS;gBACtB,CAAC,CAAG,GAAiC;gBACrC,CAAC,CAAC,SAAS;SAChB,CAAC;QACF,OAAO,GAAG,CAAC;IACb,CAAC;IAEO,yBAAyB,CAAC,MAA8C;QAC9E,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC;YACvB,SAAS,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YAC1B,MAAM;YACN,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,KAAK;SACpD,CAAC,CAAC;IACL,CAAC;IAEY,sBAAsB,CACjC,IAAY,EACZ,qBAAqB,GAAG,KAAK;;YAE7B,IAAI,qBAAqB,EAAE;gBACzB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC5C,IAAI,CAAC,KAAK,EAAE;oBACV,IAAI,CAAC,cAAc,CAAC,IAAI,CACtB,IAAI,CAAC,mBAAmB,CACtB,mBAAmB,EACnB,2FAAqC,CACtC,CACF,CAAC;oBACF,OAAO;iBACR;aACF;YACD,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC;gBAC3B,GAAG,IAAI,CAAC,kCAAkC,CAAC,IAAI,CAAC;gBAChD,IAAI;aACL,CAAC,CAAC;QACL,CAAC;KAAA;IAEM,qBAAqB,CAAC,IAAY;QACvC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC;YAC3B,GAAG,IAAI,CAAC,kCAAkC,CAAC,IAAI,CAAC;SACjD,CAAC,CAAC;IACL,CAAC;IAEO,kCAAkC,CAAC,IAAY;QACrD,OAAO,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,IAAI,CAAC,CAAC;IACjE,CAAC;IAEO,kBAAkB;QACxB,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC7B,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAC9B,CAAC;IAEO,iBAAiB;QACvB,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAC3B,IAAI,CAAC,oBAAoB,EAAE,CAAC;IAC9B,CAAC;IAEO,oBAAoB;QAC1B,IAAI,IAAI,CAAC,uBAAuB,KAAK,IAAI,EAAE;YACzC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,kEAAkE,IAAI,CAAC,uBAAuB,EAAE,EAAE,SAAS,CAAC,CAAC;YACvI,IAAI,CAAC,yBAAyB,CAAC,iBAAiB,CAAC,CAAC;YAClD,MAAM,OAAO,GAAuB,EAAE,EAAE,EAAG,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAC1E,0EAAsB,CAAC,OAAO,CAAC,CAAC;YAChC,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;SACrC;IACH,CAAC;IAGa,qBAAqB;;YACjC,MAAM,qBAAqB,GAA0B,CAAC,QAAkB,EAAE,GAAQ,EAAE,EAAE;gBACpF,IAAI,GAAG,EAAE;oBACP,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,0BAA0B,EAC1B,GAAG,EACH,8FAAgB,EAChB,SAAS,EACT,GAAG,CACJ,CAAC;oBACF,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,CAAC,CAAC;iBACrE;gBACD,IAAI,QAAQ,KAAK,IAAI,EAAE;oBACrB,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,2BAA2B,CAAC,QAAQ,CAAC,CAAC,CAAC;oBACrE,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,EAAE;wBAClC,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;qBACrC;iBACF;YACH,CAAC,CAAC;YACF,IAAI,CAAC,yBAAyB,CAAC,kBAAkB,CAAC,CAAC;YACnD,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,kDAAkD;YAC/E,IAAI,CAAC,uBAAuB,GAAG,MAAM,6EAAyB,CAAC,+EAAwC,EAAE,qBAAqB,CAAC,CAAC;YAChI,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,mEAAmE,IAAI,CAAC,uBAAuB,EAAE,EAAE,SAAS,CAAC,CAAC;QAC1I,CAAC;KAAA;IAEO,eAAe,CAAC,GAAa;QACnC,OAAO,CACL,GAAG,KAAK,SAAS;YACjB,GAAG,KAAK,IAAI;YACZ,GAAG,CAAC,MAAM,KAAK,SAAS;YACxB,GAAG,CAAC,MAAM,KAAK,IAAI;YACnB,GAAG,CAAC,MAAM,CAAC,QAAQ,IAAI,CAAC,EAAE;YAC1B,GAAG,CAAC,MAAM,CAAC,QAAQ,IAAI,EAAE;YACzB,GAAG,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,GAAG;YAC5B,GAAG,CAAC,MAAM,CAAC,SAAS,IAAI,GAAG,CAC5B,CAAC;IACJ,CAAC;IAEO,cAAc,CAAC,OAAe;QACpC,OAAO,OAAO,IAAI,CAAC,IAAI,OAAO,IAAI,GAAG,CAAC;IACxC,CAAC;IAGa,gBAAgB;;YAC5B,iEAAiE;YACjE,IAAI;gBACF,MAAM,kBAAkB,GAAG,MAAM,gFAA4B,EAAE,CAAC;gBAChE,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,oCAAoC,kBAAkB,aAAlB,kBAAkB,uBAAlB,kBAAkB,CAAE,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;gBACzG,MAAM,UAAU,GAAG,kBAAkB,CAAC,QAAQ,KAAK,SAAS,CAAC;gBAC7D,IAAI,CAAC,UAAU,EAAE;oBACf,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,EAAE;wBAC3B,MAAM,IAAI,CAAC,yBAAyB,EAAE,CAAC;wBACvC,OAAO,KAAK,CAAC;qBACd;oBACD,sEAAsE;oBACtE,MAAM,0BAA0B,GAAG,MAAM,kFAA8B,EAAE,CAAC;oBAC1E,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,sDAAsD,0BAA0B,aAA1B,0BAA0B,uBAA1B,0BAA0B,CAAE,QAAQ,EAAE,EAAE,SAAS,CAAC,CAAC;oBACnI,IAAI,2BAA0B,aAA1B,0BAA0B,uBAA1B,0BAA0B,CAAE,QAAQ,MAAK,QAAQ,EAAE;wBACrD,MAAM,IAAI,CAAC,yBAAyB,EAAE,CAAC;wBACvC,OAAO,KAAK,CAAC;qBACd;iBACF;gBACD,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,SAAS,EACT,uCAAuC,CACxC,CAAC;gBACF,OAAO,IAAI,CAAC,CAAC,4BAA4B;aAC1C;QACH,CAAC;KAAA;IAEa,yBAAyB;;YACrC,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC;gBACH,UAAU;gBACV,mCAAmC;gBACnC,oCAAoC;aACrC,CAAC;iBACD,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,mCAAmC,CAAC;gBACzD,OAAO,EAAE,YAAY,CAAC,oCAAoC,CAAC;gBAC3D,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAEO,oBAAoB;QAC1B,IAAI,IAAI,CAAC,mBAAmB,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;YAChE,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;SACxC;QACD,sGAAsG;QACtG,kEAAkE;QAClE,wEAAwE;QACxE,IAAI,CAAC,mBAAmB,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE;YACtC,CAAC,CAAC,IAAI,CAAC,gBAAgB,EAAE;YACzB,CAAC,CAAC,IAAI,CAAC,uBAAuB,EAAE,CACjC,CAAC,SAAS,CAAC,CAAC,OAAe,EAAE,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAAC,CAAC;IACxE,CAAC;IAEO,KAAK;QACX,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;IAC/D,CAAC;IAEO,gBAAgB;QACtB,OAAO,IAAI,CAAC,iBAAiB;aAC1B,YAAY,CAAC,EAAC,MAAM,EAAE,CAAC,EAAC,CAAC,CAAC,iDAAiD;aAC3E,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAE,eAAe,CAAC,CAAC,CAAC;IAC9C,CAAC;IAEO,uBAAuB;QAC7B,OAAO,4CAAK,CACV,gDAAS,CAAM,MAAM,EAAE,2BAA2B,CAAC,EACnD,gDAAS,CAAM,MAAM,EAAE,mBAAmB,CAAC,CAC5C,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,KAA6B,EAAE,EAAE;YACpC,MAAM,YAAY,GAAS,KAAM,CAAC,oBAAoB,CAAC;YACvD,MAAM,OAAO,GAAW,YAAY,IAAI,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC;YACvE,OAAO,OAAO,CAAC;QACjB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAED,mEAAmE;IACnE,kEAAkE;IAClE,sDAAsD;IACtD,+CAA+C;IAC/C,8DAA8D;IAC9D,yHAAyH;IACzH,wEAAwE;IAExE,2CAA2C;IAC3C,qDAAqD;IACrD,eAAe;IACf,oDAAoD;IACpD,mCAAmC;IACnC,WAAW;IACX,mBAAmB;IACnB,gCAAgC;IAChC,IAAI;IACJ,IAAI;IAEI,kBAAkB,CAAC,KAA6B;QACtD,OAAO,KAAK,CAAC,KAAK,KAAK,SAAS,IAAI,KAAK,CAAC,QAAQ;YAChD,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC,KAAK;YACnB,CAAC,CAAC,SAAS,CAAC;IAChB,CAAC;IAEO,qBAAqB,CAAC,OAAe;QAC3C,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE;YAChC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACnC;IACH,CAAC;IAEO,mBAAmB;QACzB,IAAI,IAAI,CAAC,mBAAmB,IAAI,CAAC,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE;YAChE,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,CAAC;SACxC;IACH,CAAC;;oFAvVU,kBAAkB;oHAAlB,kBAAkB,WAAlB,kBAAkB,mBAFjB,MAAM;;;;;;;;;;;;;;;;;;ACnCb,MAAM,aAAa;IACxB,gBAAe,CAAC;IAEhB,eAAe,CAAC,eAAuB,EAAE,WAAW,GAAG,CAAC;QACtD,MAAM,OAAO,GAAG;YACd,qBAAqB,EAAE,WAAW;YAClC,qBAAqB,EAAE,WAAW;SACnC,CAAC;QACF,IAAI,eAAe,GAAG,IAAI,EAAE;YAC1B,OAAO,GAAG,CAAC,eAAe,GAAG,IAAI,CAAC,CAAC,cAAc,CAC/C,SAAS,EACT,OAAO,CACR,MAAM,CAAC;SACT;aAAM;YACL,OAAO,GAAG,CAAC,eAAe,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC;SACjD;IACH,CAAC;IAED,cAAc,CAAC,QAAgB,EAAE,gBAAgB,GAAG,KAAK;QACvD,MAAM,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC;QACzD,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC;QACnD,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,GAAG,CAAC,IAAI,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QAC1D,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,QAAQ,GAAG,CAAC,IAAI,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;QAE7D,OAAO,CACL,GAAG,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,KAAK,EAAE;YACrC,IAAI,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,EAAE;YAC5C,IAAI,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,EAAE;YAC5C,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,YAAY,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAC7C,CAAC;IACJ,CAAC;IAED,qBAAqB,CAAC,KAAa,EAAE,cAAc,GAAG,CAAC,EAAE,EAAE,GAAG,IAAI;QAChE,MAAM,MAAM,GAAG,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;QAChC,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,MAAM,EAAE;YAC5B,OAAO,KAAK,GAAG,IAAI,CAAC;SACrB;QACD,MAAM,KAAK,GAAG,EAAE;YACd,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;YAClD,CAAC,CAAC,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,CAAC,CAAC;QAC7D,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;QACX,GAAG;YACD,KAAK,IAAI,MAAM,CAAC;YAChB,EAAE,CAAC,CAAC;SACL,QAAQ,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,MAAM,IAAI,CAAC,GAAG,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QAC5D,OAAO,KAAK,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;IACxD,CAAC;;0EA9CU,aAAa;8GAAb,aAAa,WAAb,aAAa,mBAFZ,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACF0C;AACd;AAC0B;AACZ;AAChB;AAEG;AACkB;AACqB;AAC5D;AAC0C;AACoB;AACC;;;;;;AAE3F,MAAM,SAAS,GAAG,YAAY,CAAC;AAKxB,MAAM,UAAU;IAOrB,YACU,aAA2C,EAC3C,kBAAsC,EACtC,eAAgC,EAChC,cAA8B;QAH9B,kBAAa,GAAb,aAAa,CAA8B;QAC3C,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;IACvD,CAAC;IAXD,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAWK,iBAAiB,CAAC,MAAsB;;YAC5C,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC3D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,MAAM,IAAI,CAAC,qCAAqC,CAC9C,WAAW,CAAC,OAAO,EACnB,WAAW,CAAC,QAAQ,EACpB,MAAM,CACP,CAAC;QACJ,CAAC;KAAA;IAEO,aAAa,CAAC,OAAgB,EAAE,QAAiB;QACvD,OAAO,GAAG,sEAAgC,IAAI,OAAO,IAAI,QAAQ,EAAE,CAAC;IACtE,CAAC;IAEa,qCAAqC,CACjD,OAAgB,EAChB,QAAiB,EACjB,MAAsB;;YAEtB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,CAClD,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,QAAQ,CAAC,CACtC,CAAC;YACF,MAAM,gBAAgB,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACxC,0EAAmC,EACnC,cAAc,CACf,CAAC;YACF,IACE,QAAQ,CAAC,SAAS;gBAClB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,EACtD;gBACA,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,yCAAyC,EACzC,SAAS,CACV,CAAC;aACH;iBAAM;gBACL,MAAM,eAAe,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACvC,4EAAqC,EACrC,KAAK,CACN,CAAC;gBACF,IACE,CAAC,QAAQ,CAAC,WAAW;oBACrB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,EACtD;oBACA,MAAM,IAAI,CAAC,4BAA4B,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;iBACpE;aACF;QACH,CAAC;KAAA;IAEK,4BAA4B,CAChC,OAAgB,EAChB,QAAiB,EACjB,MAAsB;;YAEtB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YACzD,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,IAAI;gBACF,MAAM,WAAW,GAAG,MAAM,+EAAmB,CAC3C,IAAI,CAAC,aAAa,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,CAAC,EAC5D,MAAM,EACN,KAAK,CACN,CAAC;gBACF,MAAM,yDAAmB,CAAC,sEAAgC,EAAE,OAAO,CAAC;qBACjE,KAAK,CAAC,QAAQ,kBAAI,OAAO,EAAE,QAAQ,IAAK,WAAW,EAAG;qBACtD,IAAI,EAAE,CAAC;gBACV,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;gBACxD,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,GAAG,EAAE;gBACZ,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;gBACjE,OAAO,KAAK,CAAC;aACd;QACH,CAAC;KAAA;IAED,+BAA+B,CAAC,GAAW;QACzC,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACxE,CAAC;IAED,gCAAgC,CAAC,GAAW;QAC1C,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACzE,CAAC;IAEO,wBAAwB;QAC9B,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,kBAAkB,CAAC,QAAQ;YAChC,IAAI,CAAC,kBAAkB,CAAC,SAAS;SAClC,CAAC,CAAC,IAAI,CACL,0DAAS,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,CAC/B,IAAI,CAAC,4BAA4B,CAAC,OAAO,EAAE,OAAO,CAAC,CACpD,EACD,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,4BAA4B,CAAC,OAAgB,EAAE,OAAgB;QACrE,OAAO,IAAI,gGAAwB,CACjC,yDAAmB,CAAC,sEAAgC,EAAE,OAAO,CAAC;aAC3D,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,SAAS,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;aAChC,MAAM,EAAE,CACZ,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,GAA6B,EAAE,EAAE,CACpC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,CAC9D,CACF,CAAC;IACJ,CAAC;IAEO,qBAAqB,CAAC,OAAgB;QAC5C,MAAM,WAAW,GAAG,gEAAO,CAAC,OAAO,CAAC,CAAC;QACrC,MAAM,kBAAkB,GAA2B,2BAAQ,eAAqC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;QACtH,OAAO,kBAAkB,CAAC;IAC5B,CAAC;;oEA9HU,UAAU;4GAAV,UAAU,WAAV,UAAU,mBAFT,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjB4B;AAEsB;AAC1C;AACH;AACqB;AAStB;AACkD;AACc;AAEf;AACR;AAIvB;AAC4B;AACoB;AACzB;AACmB;AACO;;;;;;;AAE3F,MAAM,SAAS,GAAG,oBAAoB,CAAC;AAKhC,MAAM,kBAAkB;IAe7B,YACU,aAA4B,EAC5B,kBAAsC,EACtC,eAAgC,EAChC,cAA8B,EAC9B,eAAgC;QAJhC,kBAAa,GAAb,aAAa,CAAe;QAC5B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAExC,IAAI,CAAC,kBAAkB,GAAG,IAAI,kDAAe,CAAC,EAAE,CAAC,CAAC;QAClD,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,2BAA2B,EAAE,CAAC;QAClE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;IAC1D,CAAC;IAlBD,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,mBAAmB,CAAC;IAClC,CAAC;IAcK,kBAAkB,CAAC,MAAqB;;YAC5C,IAAI,SAAS,GAAG,KAAK,CAAC;YACtB,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE;oBACf,SAAS,GAAG,IAAI,CAAC;gBACnB,CAAC,CAAC,CAAC;aACJ;YACD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC5D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,SAAS,EAAE;gBACd,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,qCAAqC,CAC7D,YAAY,CAAC,gBAAgB,EAC7B,YAAY,EACZ,MAAM,CACP,CAAC;gBACF,OAAO,MAAM,CAAC;aACf;iBAAM;gBACL,OAAO,CAAC,CAAC;aACV;QACH,CAAC;KAAA;IAEO,aAAa,CACnB,OAAgB,EAChB,UAAuB,EACvB,OAAgB;QAEhB,OAAO,GAAG,qEAA+B,IAAI,UAAU,CAAC,IAAI,CAC1D,GAAG,CACJ,IAAI,OAAO,IAAI,OAAO,EAAE,CAAC;IAC5B,CAAC;IAEO,qBAAqB;QAC3B,OAAO,IAAI,CAAC,kBAAkB,CAAC,mCAAmC,CAAC,IAAI,CACrE,oDAAG,CAAC,CAAC,CAAC,OAAO,EAAE,QAAQ,EAAE,gBAAgB,CAAC,EAAE,EAAE,CAC5C,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CACxD,CACF,CAAC;IACJ,CAAC;IAEa,qCAAqC,CACjD,UAAuB,EACvB,WAAwB,EACxB,MAAsB;;YAEtB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CACnC,WAAW,CAAC,OAAO,EACnB,UAAU,EACV,WAAW,CAAC,QAAQ,CACrB,CAAC;YACF,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YACjE,MAAM,gBAAgB,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACxC,0EAAmC,EACnC,cAAc,CACf,CAAC;YACF,IACE,QAAQ,CAAC,SAAS;gBAClB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,EACtD;gBACA,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,kCAAkC,EAAE,SAAS,CAAC,CAAC;gBACzE,OAAO,CAAC,CAAC;aACV;iBAAM;gBACL,MAAM,eAAe,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;gBACzD,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,wBAAwB,CAClD,WAAW,EACX,UAAU,CACX,CAAC;gBACF,IACE,CAAC,QAAQ,CAAC,WAAW;oBACrB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC;oBACtD,6CAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,EAChD;oBACA,OAAO,IAAI,CAAC,8BAA8B,CACxC,UAAU,EACV,WAAW,EACX,MAAM,CACP,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,qBAAqB,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC;2BACzB,QAAQ,CAAC,WAAW,EAAE,EACvC,SAAS,CACV,CAAC;oBACF,OAAO,CAAC,CAAC;iBACV;aACF;QACH,CAAC;KAAA;IAED,6CAA6C;QAC3C,OAAO,IAAI,CAAC,kBAAkB,CAAC,mCAAmC,CAAC,IAAI,CACrE,0DAAS,CAAC,CAAC,CAAC,OAAO,EAAE,QAAQ,EAAE,gBAAgB,CAAC,EAAE,EAAE,CAClD,IAAI,CAAC,eAAe,CAAC,oBAAoB,CACvC,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CACxD,CACF,EACD,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CACV,GAAG,IAAI,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,6CAAM,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CACjE,CACF,CAAC;IACJ,CAAC;IAEK,0CAA0C,CAAC,MAAqB;;YACpE,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC5D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,OAAO,IAAI,CAAC,8BAA8B,CACxC,YAAY,CAAC,gBAAgB,EAC7B,YAAY,EACZ,MAAM,CACP,CAAC;QACJ,CAAC;KAAA;IAEa,wBAAwB,CACpC,WAAwB,EACxB,UAAuB;;YAEvB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,uBAAuB,CACjD,WAAW,EACX,UAAU,CACX,CAAC;YACF,MAAM,QAAQ,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACpE,OAAO,QAAQ,CAAC,MAAM,EAAE,CAAC;QAC3B,CAAC;KAAA;IAEK,8BAA8B,CAClC,UAAuB,EACvB,WAAwB,EACxB,MAAqB;;YAErB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,wCAAwC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAC/D,SAAS,CACV,CAAC;YACF,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CACnC,WAAW,CAAC,OAAO,EACnB,UAAU,EACV,WAAW,CAAC,QAAQ,CACrB,CAAC;YACF,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,wBAAwB,CAClD,WAAW,EACX,UAAU,CACX,CAAC;YACF,IAAI,UAAU,GAAG,KAAK,CAAC;YACvB,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE;oBACf,UAAU,GAAG,IAAI,CAAC;gBACpB,CAAC,CAAC,CAAC;aACJ;YACD,IAAI;gBACF,MAAM,YAAY,GAAG,MAAM,+EAAmB,CAC5C,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC;oBAC9B,aAAa,EAAE,QAAQ,CAAC,WAAW,EAAE;oBACrC,kBAAkB,EAAE,UAAU;oBAC9B,eAAe,EAAE,mFAA4C;oBAC7D,OAAO,EAAE,WAAW,CAAC,QAAQ;oBAC7B,QAAQ,EAAE,6CAAM,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC;iBAC/B,CAAC,EACF,MAAM,EACN,KAAK,CACN,CAAC;gBACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,OACE,YAAY,CAAC,MACf,oCAAoC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,EAC3D,SAAS,CACV,CAAC;gBACF,IAAI,CAAC,UAAU,EAAE;oBACf,IAAI,CAAC,wBAAwB,CAC3B,WAAW,CAAC,OAAO,EACnB,WAAW,CAAC,QAAQ,EACpB,UAAU,EACV,YAAY,CACb,CAAC;oBACF,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CACzC,UAAU,EACV,YAAY,CAAC,MAAM,EACnB,QAAQ,EACR,IAAI,IAAI,EAAE,CACX,CAAC;oBACF,IAAI,CAAC,gCAAgC,CACnC,QAAQ,EACR,UAAU,EACV,WAAW,EACX,YAAY,CACb,CAAC;oBACF,OAAO,YAAY,CAAC,MAAM,CAAC;iBAC5B;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,yCAAyC,EACzC,SAAS,CACV,CAAC;oBACF,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CACrC,UAAU,EACV,qBAAqB,CACtB,CAAC;oBACF,OAAO,CAAC,CAAC;iBACV;aACF;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,UAAU,EAAE;oBACd,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,qBAAqB,CAAC,CAAC;iBAClE;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,sCAAsC,EACtC,GAAG,EACH,8FAAgB,CACjB,CAAC;iBACH;gBACD,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;gBACjE,OAAO,CAAC,CAAC;aACV;QACH,CAAC;KAAA;IAEO,wBAAwB,CAC9B,OAAgB,EAChB,OAAgB,EAChB,UAAuB,EACvB,YAAqC;QAErC,MAAM,SAAS,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE,CAAC;QACrD,MAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;QACnE,SAAS,CAAC,GAAG,CAAC,GAAG,YAAY,CAAC;QAC9B,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAC1C,CAAC;IAEa,gCAAgC,CAC5C,QAAc,EACd,UAAuB,EACvB,WAAwB,EACxB,MAA+B;;YAE/B,MAAM,YAAY,GAAG,6DAAuB,CAC1C,qEAA+B,EAC/B,WAAW,CAAC,OAAO,CACpB,CAAC;YACF,MAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;YACvB,MAAM,IAAI,CAAC,eAAe,CAAC,UAAU,CACnC,YAAY,EACZ,MAAM,EACN,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,KAAK,CACrB,CAAC;YACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,mBAAmB,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,GAAG,CAAC,OAAO,EAAE,KAAK,EAC5D,SAAS,CACV,CAAC;YACF,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,iCAAiC,CAC/D,WAAW,CAAC,OAAO,EACnB,UAAU,EACV,QAAQ,EACR,MAAM,CACP,CAAC;YACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,2CAA2C,EAC3C,SAAS,EACT,YAAY,CACb,CAAC;YACF,MAAM,IAAI,CAAC,qBAAqB,CAAC,WAAW,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC;QACpE,CAAC;KAAA;IAED,6BAA6B,CAC3B,OAAgB,EAChB,OAAgB,EAChB,MAAe,EACf,eAAe,GAAG,EAAE;QAEpB,OAAO,IAAI,CAAC,aAAa;aACtB,YAAY,CAAC;YACZ,eAAe,EAAE,eAAe;YAChC,OAAO,EAAE,OAAO;YAChB,MAAM,EAAE,CAAC,MAAM,IAAI,CAAC,CAAC,GAAG,eAAe;YACvC,YAAY,EAAE,WAAW;YACzB,QAAQ,EAAE,6CAAM,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC;SAC/B,CAAC;aACD,IAAI,CAAC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,4CAA4C;IACpF,CAAC;IAEK,qBAAqB,CACzB,KAAa,EACb,OAAgB,EAChB,OAAgB,EAChB,iBAA8B;;YAE9B,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,6BAA6B,CACrD,KAAK,EACL,OAAO,EACP,OAAO,CACR,CAAC,SAAS,EAAE,CAAC;YACd,IAAI,MAAM,EAAE;gBACV,MAAM,yDAAmB,CAAC,qEAA+B,EAAE,OAAO,CAAC;qBAChE,KAAK,CAAC,QAAQ,EAAE,MAAM,CAAC;qBACvB,IAAI,EAAE,CAAC;gBACV,kFAAkF;gBAClF,IAAI,CAAC,wBAAwB,CAC3B,OAAO,EACP,OAAO,EACP,iBAAiB,EACjB,SAAS,CACV,CAAC;aACH;YACD,OAAO,MAAM,CAAC;QAChB,CAAC;KAAA;IAEO,6BAA6B,CACnC,KAAa,EACb,OAAgB,EAChB,OAAgB;QAEhB,OAAO,IAAI,CAAC,aAAa;aACtB,YAAY,CAAC,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC;aAChD,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACtC,CAAC;IAED,uBAAuB,CACrB,YAAyB,EACzB,UAAuB;QAEvB,MAAM,2BAA2B,GAAG,YAAY,CAAC,mBAAmB,CAAC,IAAI,CACvE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,SAAS,KAAK,UAAU,CAAC,CAAC,CAAC,CACjD,CAAC;QACF,MAAM,QAAQ,GAAG,2BAA2B;YAC1C,CAAC,CAAC,2BAA2B,CAAC,QAAQ;YACtC,CAAC,CAAC,CAAC,CAAC,CAAC,sCAAsC;QAC7C,OAAO,QAAQ,CAAC;IAClB,CAAC;IAEO,4BAA4B,CAAC,YAAyB;QAC5D,MAAM,QAAQ,GAAG,IAAI,CAAC,uBAAuB,CAC3C,YAAY,EACZ,YAAY,CAAC,gBAAgB,CAC9B,CAAC;QACF,MAAM,QAAQ,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACpE,OAAO,QAAQ,CAAC,MAAM,EAAE,CAAC;IAC3B,CAAC;IAEO,iCAAiC,CACvC,OAAgB,EAChB,UAAuB,EACvB,QAAc,EACd,KAA8B;QAE9B,OAAO,yDAAmB,CAAC,qEAA+B,EAAE,OAAO,CAAC;aACjE,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,GAA0B,EAAE,EAAE;YACpC,OAAO,CACL,GAAG;gBACH,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC;gBACzC,6CAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,aAAa,CAAC,QAAQ,CAAC;gBAC7C,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,KAAK,KAAK,GAAG,CAAC,KAAK,CAAC,CAChD,CAAC;QACJ,CAAC,CAAC;aACD,IAAI,EAAE,CAAC;IACZ,CAAC;IAEa,qBAAqB,CACjC,OAAgB,EAChB,UAAuB;;YAEvB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,0BAA0B,CAAC,UAAU,CAAC,CAAC;YACnE,MAAM,oBAAoB,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,QAAQ,GAAG,CAAC,EAAE,MAAM,CAAC,CAAC;YACrE,OAAO,yDAAmB,CAAC,qEAA+B,EAAE,OAAO,CAAC;iBACjE,KAAK,CAAC,QAAQ,CAAC;iBACf,KAAK,CAAC,CAAC,GAA0B,EAAE,EAAE;gBACpC,OAAO,CACL,GAAG;oBACH,6CAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,QAAQ,CAAC,oBAAoB,CAAC;oBACpD,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,CAC1C,CAAC;YACJ,CAAC,CAAC;iBACD,IAAI,EAAE,CAAC;QACZ,CAAC;KAAA;IAEO,0BAA0B,CAAC,UAAuB;QACxD,MAAM,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;QACzD,MAAM,2BAA2B,GAC/B,qEAA8B,CAAC,eAAe,CAAC,CAAC;QAClD,OAAO,IAAI,CAAC,GAAG,CAAC,GAAG,2BAA2B,CAAC,CAAC;IAClD,CAAC;IAEO,qDAAqD;QAC3D,OAAO,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CAC9C,qEAAoB,CAClB,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,KAAK,CAAC,EAClC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,2CAA2C,CAAC,CAAC,CAAC,CAC3D,CACF,CAAC;IACJ,CAAC;IAEO,eAAe,CAAC,UAAuB;QAC7C,OAAO,kEAAS,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;IAClC,CAAC;IAEO,mBAAmB,CACzB,OAAgB,EAChB,QAAiB,EACjB,UAAuB;QAEvB,OAAO,GAAG,OAAO,IAAI,QAAQ,IAAI,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,EAAE,CAAC;IACtE,CAAC;IAEO,2BAA2B;QACjC,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,qDAAqD,EAAE;YAC5D,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE;SACvC,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CACV,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,uDAAuD,EACvD,SAAS,EACT,GAAG,CACJ,CACF,EACD,0DAAS,CAAC,CAAC,CAAC,WAAW,EAAE,kBAAkB,CAAC,EAAE,EAAE;YAC9C,MAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAClC,WAAW,CAAC,OAAO,EACnB,WAAW,CAAC,QAAQ,EACpB,WAAW,CAAC,gBAAgB,CAC7B,CAAC;YACF,IAAI,kBAAkB,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;gBACzC,MAAM,oBAAoB,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAClE,IAAI,CAAC,4BAA4B,CAC/B,GAAG,EACH,WAAW,CAAC,QAAQ,EACpB,WAAW,CAAC,gBAAgB,EAC5B,IAAI,CAAC,4BAA4B,CAAC,WAAW,CAAC,CAC/C,CACF,CAAC;gBACF,OAAO,yCAAE,CAAC,oBAAoB,CAAC,CAAC;aACjC;YACD,OAAO,IAAI,CAAC,uCAAuC,CACjD,WAAW,CAAC,OAAO,EACnB,WAAW,CAAC,QAAQ,EACpB,WAAW,CAAC,gBAAgB,EAC5B,IAAI,CAAC,4BAA4B,CAAC,WAAW,CAAC,CAC/C,CAAC;QACJ,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,2CAA2C,CACjD,WAAwB;QAExB,MAAM,UAAU,GAAG,IAAI,CAAC,4BAA4B,CAClD,WAAW,CACZ,CAAC,WAAW,EAAE,CAAC;QAChB,OAAO,GAAG,WAAW,CAAC,OAAO,IAC3B,WAAW,CAAC,QACd,IAAI,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,UAAU,EAAE,CAAC;IAC7D,CAAC;IAEO,gCAAgC,CACtC,OAAgB,EAChB,OAAgB,EAChB,UAAwB,EACxB,QAAe;QAEf,OAAO,yDAAmB,CAAC,qEAA+B,EAAE,OAAO,CAAC;aACjE,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,GAA0B,EAAE,EAAE,CACpC,IAAI,CAAC,4BAA4B,CAC/B,GAAG,EACH,OAAO,EACP,UAAU,EACV,QAAQ,CACT,CACF,CAAC;IACN,CAAC;IAEO,4BAA4B,CAClC,GAA0B,EAC1B,OAAgB,EAChB,UAAwB,EACxB,QAAe,EACf,YAAqB;QAErB,OAAO,CACL,CAAC,CAAC,GAAG;YACL,CAAC,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAC/D,CAAC,QAAQ,CAAC,CAAC,CAAC,6CAAM,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAC5D,CAAC;IACJ,CAAC;IAED,kHAAkH;IAClH;;;;;;OAMG;IACH,uCAAuC,CACrC,OAAgB,EAChB,OAAgB,EAChB,UAAwB,EACxB,QAAe;QAEf,OAAO,IAAI,iGAAwB,CACjC,IAAI,CAAC,gCAAgC,CACnC,OAAO,EACP,OAAO,EACP,UAAU,EACV,QAAQ,CACT,CAAC,MAAM,CAAC;YACP,QAAQ,EAAE,GAAG;YACb,MAAM,EAAE,IAAI;YACZ,SAAS,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,OAAO,CAAC;SACrD,CAAC,CACH,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CACZ,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,6CAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,6CAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CACpE,EACD,oDAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CACZ,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,qCAAqC,EACrC,SAAS,EACT,KAAK,CACN,CACF,CACF,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,KAA8B,EAAE,KAA8B,EAAE,OAAgB;QAC1F,OAAO,CACL,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,KAAK,IAAI,CAAC,qBAAqB,CAAC,KAAK,EAAE,OAAO,CAAC,CAC1F,CAAC;IACJ,CAAC;IAED,iBAAiB,CAAC,GAA0B,EAAE,OAAgB;QAC5D,OAAO,GAAG,GAAG,CAAC,KAAK,IAAI,OAAO,IAAI,GAAG,CAAC,YAAY,EAAE,CAAC;IACvD,CAAC;IAED,qBAAqB,CAAC,IAA6B,EAAE,OAAgB;QACnE,IAAI,CAAC,IAAI,EAAE;YACT,OAAO,EAAE,CAAC;SACX;QACD,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACvE,CAAC;IAEK,kBAAkB,CAAC,EAAU,EAAE,OAAgB,EAAE,OAAgB;;YACrE,MAAM,MAAM,GAAG,MAAM,yDAAmB,CACtC,qEAA+B,EAC/B,OAAO,CACR;iBACE,KAAK,CAAC,QAAQ,CAAC;iBACf,KAAK,CAAC,CAAC,OAAO,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;iBACzB,IAAI,EAAE,CAAC;YACV,OAAO,MAAM,CAAC,CAAC,CAA0B,CAAC;QAC5C,CAAC;KAAA;IAED,iBAAiB,CAAC,OAAgB;QAChC,OAAO,IAAI,iGAAwB,CACjC,yDAAmB,CAAC,qEAA+B,EAAE,OAAO,CAAC;aAC1D,KAAK,CAAC,QAAQ,EAAE,CAAC,mBAAmB,CAAC,CAAC;aACtC,MAAM,CAAC;YACN,QAAQ,EAAE,GAAG;SACd,CAAC,CACL,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,GAAe,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,EACtC,qEAAoB,EAAE,CACvB,CAAC;IACJ,CAAC;;oFA3kBU,kBAAkB;oHAAlB,kBAAkB,WAAlB,kBAAkB,mBAFjB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjC0B;AAClB;AAE8D;AAC7C;AACP;AAC8C;AACtB;;;AAE9D,MAAM,SAAS,GAAG,qBAAqB,CAAC;AAKjC,MAAM,mBAAmB;IAC9B,YAAoB,cAA8B;QAA9B,mBAAc,GAAd,cAAc,CAAgB;IAAG,CAAC;IAEhD,eAAe,CAAC,GAAW;;YAC/B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;YAC3D,IAAI,YAAY,EAAE;gBAChB,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;gBACpC,OAAO,YAAY,CAAC,OAAO,CAAC;aAC7B;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;QACH,CAAC;KAAA;IAEO,gBAAgB,CAAC,YAA2B;QAClD,YAAY,CAAC,UAAU,GAAG,6CAAM,EAAE,CAAC,IAAI,EAAE,CAAC;QAC1C,OAAO,oDAAI,CAAC,uEAAiC,CAAC;aAC3C,KAAK,CAAC,QAAQ,EAAE,YAAY,CAAC;aAC7B,IAAI,EAAE,CAAC;IACZ,CAAC;IAEK,uBAAuB,CAC3B,GAAW,EACX,OAAe,EACf,IAAI,GAAG,WAAW;;YAElB,IAAI;gBACF,MAAM,IAAI,GAAG,wFAAkC,CAAC,OAAO,CAAC,CAAC;gBAEzD,MAAM,YAAY,GAAkB;oBAClC,GAAG;oBACH,IAAI;oBACJ,UAAU,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;oBAC3B,IAAI;oBACJ,OAAO;iBACR,CAAC;gBACF,MAAM,oDAAI,CAAC,uEAAiC,CAAC;qBAC1C,KAAK,CAAC,QAAQ,EAAE,YAAY,CAAC;qBAC7B,IAAI,EAAE,CAAC;gBACV,OAAO,YAAY,CAAC;aACrB;YAAC,OAAO,KAAK,EAAE;gBACd,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,8BAA8B,EAC9B,KAAK,EACL,8FAAgB,EAChB,SAAS,EACT,GAAG,CACJ,CAAC;gBACF,OAAO,IAAI,CAAC;aACb;QACH,CAAC;KAAA;IAEK,qBAAqB,CAAC,GAAW;;YACrC,MAAM,MAAM,GAAG,CAAC,MAAM,oDAAI,CAAC,uEAAiC,CAAC;iBAC1D,KAAK,CAAC,QAAQ,CAAC;iBACf,KAAK,CAAC,CAAC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;iBACxB,IAAI,EAAE,CAAoB,CAAC;YAC9B,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC;aAClB;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;QACH,CAAC;KAAA;IAEK,eAAe;;YACnB,MAAM,QAAQ,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;YACtD,OAAO,oDAAI,CAAC,uEAAiC,CAAC;iBAC3C,KAAK,CAAC,QAAQ,CAAC;iBACf,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,UAAU,GAAG,QAAQ,CAAC;iBACrC,IAAI,EAAE,CAAC;QACZ,CAAC;KAAA;IAEK,KAAK;;YACT,MAAM,oDAAI,CAAC,uEAAiC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,CAAC;QACvE,CAAC;KAAA;;sFAzEU,mBAAmB;oHAAnB,mBAAmB,WAAnB,mBAAmB,mBAFlB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZoD;AACd;AACC;AACJ;AAC7B;AACE;AACoE;AAC5B;AAEgB;AACM;AACrB;AAC0B;AACrC;AAEM;AACX;;;;;;;;AAGrD,MAAM,SAAS,GAAG,mBAAmB,CAAC;AACtC,MAAM,aAAa,GAAG,eAAe,CAAC;AACtC,MAAM,YAAY,GAAG,MAAM,CAAC;AAE5B,SAAS,mBAAmB,CAAC,MAAmB;IAC9C,IAAI,MAAM,GAAG,EAAE,CAAC;IAChB,IAAI,UAAU,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,MAAM,IAAI,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9E,OAAO,IAAI,CAAC,MAAM,CAAC,CAAC;AACtB,CAAC;AAKM,MAAM,iBAAiB;IAqB5B,YACU,cAA8B,EAC9B,OAAgB,EAChB,yBAAoD,EACpD,QAAkB,EAClB,aAA4B,EAC5B,gBAAkC,EAClC,eAAgC;QANhC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,YAAO,GAAP,OAAO,CAAS;QAChB,8BAAyB,GAAzB,yBAAyB,CAA2B;QACpD,aAAQ,GAAR,QAAQ,CAAU;QAClB,kBAAa,GAAb,aAAa,CAAe;QAC5B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QA3BlC,aAAQ,GAAyC,IAAI,kDAAe,CAAC,EAAE,CAAC,CAAC;QACjF,cAAS,GAAoC,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC;QAElE,uBAAkB,GAAoB,IAAI,0CAAO,EAAE,CAAC;QAE5D;;WAEG;QACH,wBAAmB,GAAuB,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;QAEzE,6BAAwB,GAAyC,IAAI,kDAAe,CAAC,EAAE,CAAC,CAAC;QACjG,8BAAyB,GAAG,IAAI,CAAC,wBAAwB,CAAC,YAAY,EAAE,CAAC;QAIjE,WAAM,GAAG,KAAK,CAAC;QAEf,gBAAW,GAAG,EAAE,CAAC;QACzB,yBAAoB,GAAG,IAAI,yEAAoB,EAAE,CAAC;QAWhD,6CAA6C;QAC7C,IAAI,CAAC,cAAc,EAAE;aAClB,IAAI,CAAC,CAAC,QAAQ,EAAE,EAAE;YACjB,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC/B,CAAC,CAAC;aACD,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;YACb,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,4BAA4B,CAAC,CAAC;QAC1E,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,SAAS;aACX,IAAI,CACH,0DAAS,CAAC,CAAC,QAAQ,EAAE,EAAE,CACrB,2CAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE,CAAC,CAAC,IAAI,CACtC,oDAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;YAClB,SAAS;YACT,IAAI,EAAE,IAAI,CAAC,0CAA0C,CAAC,QAAQ,CAAC;SAChE,CAAC,CAAC,CACJ,CACF,CACF;aACA,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,UAAU,CAAC,GAAG,EAAE;gBACd,IAAI,CAAC,kBAAkB,GAAG,GAAG,CAAC;YAChC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,QAAQ,EAAE,EAAE,CACpC,IAAI,CAAC,0BAA0B,CAAC,QAAQ,CAAC,CAC1C,CAAC;IACJ,CAAC;IAEa,cAAc;;YAC1B,uEAAuE;YACvE,IAAI,CAAC,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBAClC,OAAO,EAAE,CAAC;aACX;YAED,iCAAiC;YACjC,MAAM,aAAa,GAAG,MAAM,qEAAkB,CAAC;gBAC7C,IAAI,EAAE,MAAM,IAAI,CAAC,cAAc,EAAE;aAClC,CAAC,CAAC;YACH,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,8BAA8B,CAC5D,aAAa,CAAC,KAAK,CACpB,CAAC;YACF,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,cAAc,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;YAEnE,4BAA4B;YAC5B,MAAM,QAAQ,GAAG,MAAM,OAAO,CAAC,GAAG,CAChC,YAAY,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CACnD,CAAC;YAEF,OAAO,QAAQ,CAAC;QAClB,CAAC;KAAA;IAEO,0BAA0B,CAAC,WAAgC;QACjE,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,4BAA4B,EAAE,SAAS,CAAC,CAAC;QAEnE,IAAI,CAAC,oBAAoB,CAAC,KAAK,EAAE,CAAC;QAClC,KAAK,MAAM,UAAU,IAAI,WAAW,EAAE;YACpC,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SAC3C;IACH,CAAC;IAEO,0CAA0C,CAChD,QAA6B;QAE7B,OAAO,QAAQ,CAAC,MAAM,CACpB,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,CAAC,gBAAgB,IAAI,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,EACvE,CAAC,CACF,CAAC;IACJ,CAAC;IAEa,8BAA8B,CAAC,OAAiB;;YAC5D,OAAO,CACL,MAAM,OAAO,CAAC,GAAG,CACf,OAAO,CAAC,GAAG,CAAC,CAAC,MAAc,EAAE,EAAE,CAC7B,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,EAAE,CAC3C,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CACvB,CACF,CACF,CACF,CAAC,MAAM,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,IAAI,IAAI,CAAC,CAAC;QACjD,CAAC;KAAA;IAEY,eAAe,CAC1B,uBAAwC,EACxC,uBAAuB,GAAG,KAAK;;YAE/B,IAAI,uBAAuB,EAAE;gBAC3B,mEAAmE;gBACnE,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,uBAAuB,CACvD,uBAAuB,CACxB,CAAC;gBACF,IAAI,CAAC,cAAc,EAAE;oBACnB,OAAO;iBACR;aACF;YAED,IAAI,MAAM,IAAI,CAAC,6BAA6B,EAAE,EAAE;gBAC9C,OAAO;aACR;YAED,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,CAAC,uBAAuB,CAAC,CAAC;YAEzE,0CAA0C;YAC1C,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC;gBACjC,GAAG,IAAI,CAAC,wBAAwB,CAAC,KAAK;gBACtC,UAAU;aACX,CAAC,CAAC;YAEH,IAAI,IAAI,CAAC,oBAAoB,IAAI,IAAI,EAAE;gBACrC,qDAAqD;gBACrD,IAAI,CAAC,4BAA4B,EAAE,CAAC;aACrC;QACH,CAAC;KAAA;IAEa,6BAA6B;;YACzC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,EAAE;gBAChC,OAAO,KAAK,CAAC,CAAC,wCAAwC;aACvD;YACD,MAAM,gBAAgB,GAAG,MAAM,8EAA2B,EAAE,CAAC;YAC7D,IAAI,gBAAgB,CAAC,aAAa,KAAK,SAAS,EAAE;gBAChD,MAAM,4BAA4B,GAChC,MAAM,gFAA6B,EAAE,CAAC;gBACxC,IAAI,4BAA4B,CAAC,aAAa,KAAK,SAAS,EAAE;oBAC5D,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,8BAA8B,4BAA4B,CAAC,aAAa,EAAE,EAC1E,SAAS,CACV,CAAC;oBACF,OAAO,IAAI,CAAC;iBACb;aACF;YACD,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;IAEO,4BAA4B;QAClC,MAAM,WAAW,GAAG,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CAC5D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,KAAK,uEAAoB,CAChD,CAAC,CAAC,CAAC,CAAC;QACL,IAAI,WAAW,IAAI,IAAI,EAAE;YACvB,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE;gBAC3B,IAAI,EAAE,wEAAqB;gBAC3B,UAAU,EAAE,CAAC;gBACb,WAAW,EAAE,EAAE;aAChB,CAAC,CAAC;YAEH,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC;SACxC;IACH,CAAC;IAEO,oBAAoB,CAAC,iBAAoC;QAC/D,kDAAkD;QAClD,MAAM,KAAK,GAAG,iBAAiB,CAAC,uBAAuB,CAAC,QAAQ,EAAE,CAAC;QAEnE,qCAAqC;QACrC,IAAI,CAAC,oBAAoB,CACvB,KAAK,CAAC,CAAC,CAAC,EACR,KAAK,EACL,iBAAiB,EACjB,CAAC,CACF,CAAC;IACJ,CAAC;IAEM,qBAAqB,CAAC,iBAAoC;;QAC/D,IAAI,iBAAiB,CAAC,QAAQ,CAAC,IAAI,KAAK,uEAAoB,EAAE;YAC5D,IAAI,CAAC,oCAAoC,CAAC,iBAAiB,CAAC,CAAC;SAC9D;aAAM,IAAI,iBAAiB,CAAC,KAAK,EAAE;YAClC,IAAI,CAAC,WAAW,CAAC,iBAAiB,CAAC,CAAC;SACrC;aAAM,IACL,iBAAiB,CAAC,QAAQ,CAAC,IAAI,KAAK,wEAAqB;YACzD,iBAAiB,CAAC,QAAQ,CAAC,IAAI,KAAK,0EAAuB,EAC3D;YACA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,UAAI,CAAC,oBAAoB,0CAAE,WAAW,EAAE,CAAC;SAC1C;IACH,CAAC;IAEO,oCAAoC,CAC1C,iBAAoC;QAEpC,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAChC,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CACxC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,KAAK,iBAAiB,CAAC,IAAI,CAC3D,CACF,CAAC;IACJ,CAAC;IAEO,oBAAoB,CAC1B,IAAU,EACV,KAAa,EACb,UAA6B,EAC7B,UAAkB;QAElB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,yBAAyB;aACvD,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC;aAClB,IAAI,CACH,yDAAQ,CAAC,GAAG,EAAE;YACZ,IAAI,IAAI,CAAC,MAAM,EAAE;gBACf,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;aAC9B;QACH,CAAC,CAAC,CACH;aACA,SAAS,CACR,CAAO,gBAAgB,EAAE,EAAE,CAAC;YAC1B,QAAQ,gBAAgB,CAAC,KAAK,EAAE;gBAChC,KAAK,aAAa;oBAChB,MAAM,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE,gBAAgB,CAAC,QAAQ,EAAE,UAAU,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;oBACnG,MAAM;gBACR,KAAK,MAAM;oBACT,MAAM,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,gBAAgB,CAAC,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC;oBACtF,MAAM;gBACR;oBACE,MAAM;aACP;QACH,CAAC,GACD,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE,GAAG,EAAE,IAAI,CAAC,CAC5D,CAAC;IACN,CAAC;IAEa,WAAW,CACvB,UAA6B,EAC7B,IAAU,EACV,IAAU,EACV,UAAkB,EAClB,KAAa;;YAEb,MAAM,MAAM,GAAG,GAAG,UAAU,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE,CAAC;YACjD,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC;YAChC,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;YACzC,MAAM,IAAI,CAAC,SAAS,CAClB,IAAI,EACJ,IAAI,EACJ,MAAM,EACN,GAAG,EAAE,CAAC,IAAI,CAAC,mBAAmB,CAAC,KAAK,EAAE,UAAU,EAAE,UAAU,CAAC,EAC7D,CAAO,QAAQ,EAAE,EAAE;gBACjB,WAAI,CAAC,UAAU,CAAC,UAAU,EAAE;oBAC1B,IAAI,EAAE,0EAAuB;oBAC7B,UAAU,EAAE,IAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE,WAAW,CAAC;oBACtF,WAAW,EAAE,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CACzD,sCAAsC,EAAE;wBACtC,CAAC,EAAE,UAAU,GAAG,CAAC;wBACjB,UAAU;qBACX,CAAC,CAAC;iBACN,CAAC;cAAA,EACJ,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE,KAAK,EAAE,KAAK,CAAC,CACjE,CAAC;QACJ,CAAC;KAAA;IAEa,sBAAsB,CAAC,UAA6B,EAChE,QAAgB,EAChB,UAAkB,EAClB,UAAkB;;YAElB,IAAI,CAAC,UAAU,CAAC,UAAU,EAAE;gBAC1B,IAAI,EAAE,wEAAqB;gBAC3B,UAAU,EAAE,IAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE,aAAa,CAAC;gBACxF,WAAW,EAAE,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CACzD,4CAA4C,EAAE;oBAC5C,CAAC,EAAE,UAAU,GAAG,CAAC;oBACjB,UAAU;iBACX,CAAC,CAAC;aACN,CAAC,CAAC;QACL,CAAC;KAAA;IAEM,sBAAsB,CAC3B,eAAuB,EACvB,WAAmB,EACnB,UAAkB,EAClB,UAAuC;QAEvC,MAAM,gBAAgB,GAAG,CAAC,CAAC,CAAC,qBAAqB;QACjD,MAAM,gBAAgB,GAAG,UAAU,GAAG,gBAAgB,CAAC;QACvD,MAAM,iBAAiB,GACrB,CAAC,WAAW,GAAG,gBAAgB;YAC7B,CAAC,UAAU,KAAK,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzC,gBAAgB,CAAC;QACnB,MAAM,qBAAqB,GACzB,eAAe,GAAG,gBAAgB,GAAG,iBAAiB,CAAC;QACzD,OAAO,qBAAqB,CAAC;IAC/B,CAAC;IAEO,mBAAmB,CAAC,KAAa,EAAE,UAA6B,EAAE,UAAkB;QAC1F,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YAC7B,OAAO;SACR;QAED,MAAM,QAAQ,GAAG,UAAU,GAAG,CAAC,CAAC;QAChC,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,CAAC;QAChC,IAAI,QAAQ,GAAG,UAAU,EAAE;YACzB,IAAI,CAAC,oBAAoB,CACvB,KAAK,CAAC,QAAQ,CAAC,EACf,KAAK,EACL,UAAU,EACV,QAAQ,CACT,CAAC;SACH;aAAM;YACL,IAAI,CAAC,0BAA0B,CAAC,UAAU,CAAC,CAAC;SAC7C;IACH,CAAC;IAEY,uBAAuB,CAClC,uBAAwC;;YAExC,IAAI,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,kBAAkB,IAAI,IAAI,EAAE;gBACpE,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,4BAA4B,CACzD,uBAAuB,CACxB,CAAC;gBAEF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,wBAAwB,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAC9D,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAClC;cACK,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,WAAW,CAAC,EAAE,EAC7D,SAAS,CACV,CAAC;gBAEF,IAAI,IAAI,CAAC,kBAAkB,CAAC,SAAS,GAAG,WAAW,EAAE;oBACnD,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,mDAAmD,EACnD,IAAI,EACJ,8FAAgB,EAChB,SAAS,CACV,CAAC;oBAEF,MAAM,IAAI,CAAC,2CAA2C,EAAE,CAAC;oBACzD,OAAO,KAAK,CAAC;iBACd;aACF;iBAAM;gBACL,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;aAC9B;YACD,OAAO,IAAI,CAAC;QACd,CAAC;KAAA;IAEY,4BAA4B,CACvC,uBAAwC,EACxC,iBAAiB,GAAG,GAAG;;YAEvB,MAAM,4BAA4B,GAChC,uBAAuB,CAAC,YAAY,EAAE,GAAG,IAAI,GAAG,IAAI,GAAG,iBAAiB,CAAC;YAC3E,MAAM,0BAA0B,GAAG,MAAM,IAAI,CAAC,6BAA6B,CAAC,iBAAiB,CAAC,CAAC;YAC/F,OAAO,4BAA4B,GAAG,0BAA0B,CAAC;QACnE,CAAC;KAAA;IAEa,6BAA6B,CAAC,iBAAiB;;YAC3D,OAAO,qDAAc,CAAC,IAAI,CAAC,yBAAyB;iBACjD,IAAI,CACH,oDAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CACZ,KAAK;iBACF,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,gBAAgB,IAAI,IAAI,IAAI,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC;iBAC5D,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,IAAI,GAAG,iBAAiB,CAAC,EAAE,CAAC,CAAC,CAC9D,CACF,CAAC,CAAC;QACP,CAAC;KAAA;IAEa,2CAA2C;;YACvD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC,CAAC,qCAAqC,EAAE,UAAU,CAAC,CAAC;iBACxD,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,OAAO,EAAE,YAAY,CAAC,qCAAqC,CAAC;gBAC5D,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,YAAY,CAAC,UAAU,CAAC;qBAC/B;iBACF;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAEa,+BAA+B,CAAC,aAAsB;;;YAClE,IAAI,UAAU,GAAG,IAAI,CAAC;YACtB,IAAI,aAAa,EAAE;gBACjB,UAAU,GAAG,oCAAoC,CAAC;aACnD;iBAAM,IAAI,WAAI,CAAC,kBAAkB,0CAAE,SAAS,IAAG,SAAS,EAAE;gBACzD,mCAAmC;gBACnC,UAAU,GAAG,yCAAyC,CAAC;aACxD;iBAAM;gBACL,UAAU,GAAG,+CAA+C,CAAC;aAC9D;YACD,MAAM,YAAY,GAAG,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;YAC/F,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,OAAO,EAAE,YAAY,CAAC,UAAU,CAAC;gBACjC,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,YAAY,CAAC,UAAU,CAAC;qBAC/B;iBACF;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;;KACjB;IAEO,sBAAsB,CAAC,eAAe,GAAG,KAAK;QACpD,IAAI,CAAC,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YAClC,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;SAC3B;QAED,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;;YACrC,8DAA8D;YAC9D,YAAC,MAAc,0CAAE,eAAe,0CAAE,IAAI,CACpC,EAAE,QAAQ,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,EACrC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,EAClC,CAAC,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CACrB,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,aAAa,CAAC,UAA6B;QACjD,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;QACrC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,GAAG,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC;IAChD,CAAC;IAEK,sBAAsB,CAAC,mBAA2B;;YACtD,eAAe;YACf,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;YACzC,MAAM,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,mBAAmB,CAAC,CAAC;YACtD,sDAAsD;YACtD,IAAI,CAAC,QAAQ,CAAC,IAAI,CAChB,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CACxB,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,KAAK,mBAAmB,CACxD,CACF,CAAC;YACF,6DAA6D;YAC7D,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAChC,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CACxC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,KAAK,mBAAmB,CACxD,CACF,CAAC;QACJ,CAAC;KAAA;IAEa,gBAAgB,CAC5B,WAAmB;;YAEnB,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;YACxD,IAAI;gBACF,MAAM,WAAW,GAAG,MAAM,sEAAmB,CAAC;oBAC5C,IAAI;oBACJ,QAAQ,EAAE,iEAAc;iBACzB,CAAC,CAAC;gBACH,MAAM,QAAQ,GAAG,MAAM,kEAAe,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;gBACjD,OAAO,EAAE,IAAI,EAAE,CAAC,WAAW,CAAC,IAAI,EAAE,gBAAgB,EAAE,QAAQ,CAAC,KAAK,GAAG,IAAI,EAAE,CAAC;aAC7E;YAAC,OAAO,KAAK,EAAE;gBACd,MAAM,SAAS,GAAG,IAAI,KAAK,CAAC,gCAAgC,IAAI,EAAE,CAAC,CAAC;gBACpE,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;gBAC9B,MAAM,SAAS,CAAC;aACjB;QACH,CAAC;KAAA;IAEa,eAAe,CAAC,WAAmB;;YAC/C,IAAI;gBACF,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,CAAC;gBACxD,MAAM,GAAG,GAAG,CAAC,MAAM,kEAAe,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC;gBAClD,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,YAAY,WAAW,wBAAwB,GAAG,EAAE,EACpD,SAAS,CACV,CAAC;gBACF,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,GAAG,EAAE;gBACZ,sCAAsC;gBACtC,OAAO,KAAK,CAAC;aACd;QACH,CAAC;KAAA;IAEa,sBAAsB,CAAC,WAAmB;;YACtD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC;YAC1D,MAAM,SAAS,GAAG,MAAM,CAAC,MAAM,qEAAkB,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;YACnE,2FAA2F;YAC3F,OAAO,SAAS,CAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,IAAI,UAAU,CAAC,CAAC;QAChE,CAAC;KAAA;IAED;;OAEG;IACW,WAAW,CAAC,WAAmB;;YAC3C,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,+BAA+B,EAC/B,SAAS,EACT,WAAW,CACZ,CAAC;YACF,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC;YAC1D,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;YAE9D,MAAM,iBAAiB,GAAsB;gBAC3C,IAAI,EAAE,WAAW;gBACjB,gBAAgB,EAAE,YAAY,CAAC,gBAAgB;gBAC/C,IAAI,EAAE,YAAY,CAAC,IAAI;gBACvB,IAAI,EAAE,EAAE;aACT,CAAC;YAEF,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC,WAAW,CAAC,CAAC;YAC5D,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE;gBACtB,MAAM,YAAY,GAAG,GAAG,IAAI,IAAI,GAAG,IAAI,aAAa,EAAE,CAAC;gBACvD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,gBAAgB,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;gBACrE,MAAM,cAAc,GAAG,MAAM,sEAAmB,CAAC;oBAC/C,IAAI,EAAE,YAAY;oBAClB,QAAQ,EAAE,gEAAa;iBACxB,CAAC,CAAC;gBACH,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,IAAI,CAAyB,CAAC;gBACzE,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,WAAW,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;gBAE5D,iBAAiB,CAAC,IAAI,CAAC,GAAG,CAAC,mCACtB,QAAQ,KACX,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,cAAc,CAAC,GAAG,IAAI,IAAI,GAAG,EAAE,CAAC,GACnD,CAAC;aACH;YAED,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,gCAAgC,EAChC,SAAS,EACT,iBAAiB,CAClB,CAAC;YAEF,OAAO,iBAAiB,CAAC;QAC3B,CAAC;KAAA;IAEO,uBAAuB,CAC7B,uBAAwC;QAExC,MAAM,UAAU,GAAsB;YACpC,IAAI,EAAE,uBAAuB,CAAC,OAAO,EAAE;YACvC,IAAI,EAAE,uBAAuB,CAAC,YAAY,EAAE,GAAG,IAAI,GAAG,IAAI;YAC1D,aAAa,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YAC9B,QAAQ,EAAE;gBACR,UAAU,EAAE,CAAC;gBACb,IAAI,EAAE,uEAAoB;gBAC1B,WAAW,EAAE,aAAa;aAC3B;YACD,gBAAgB,EAAE,IAAI;YACtB,IAAI,EAAE,EAAE;YACR,uBAAuB;SACxB,CAAC;QACF,OAAO,UAAU,CAAC;IACpB,CAAC;IAEK,SAAS,CACb,OAAa,EACb,IAAY,EACZ,MAAc,EACd,UAAsB,EACtB,UAAsC,EACtC,OAA+B;;YAE/B,IAAI;gBACF,MAAM,GAAG,GAAG,IAAI,8CAAK,EAAE,CAAC;gBACxB,MAAM,OAAO,GAAG,MAAM,GAAG,CAAC,SAAS,CAAC,OAAO,EAAE;oBAC3C,aAAa,EAAE,IAAI;iBACpB,CAAC,CAAC;gBACH,MAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;gBAC9C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,UAAU,UAAU,CAAC,MAAM,cAAc,EAAE,SAAS,CAAC,CAAC;gBAEhF,IAAI,CAAC,GAAG,CAAC,CAAC;gBACV,MAAM,KAAK,GAAG,UAAU,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;gBACpE,MAAM,GAAG,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC;gBAE3C,MAAM,SAAS,GAAG,CAAO,QAAgB,EAAE,EAAE,CAAC;oBAC5C,IAAI,IAAI,CAAC,MAAM,EAAE;wBACf,OAAO;qBACR;oBACD,MAAM,UAAU,GAAsB,OAAO,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;oBAC9D,MAAM,IAAI,GAAS,MAAM,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;oBAClD,MAAM,gBAAgB,GAAG,GAAG,IAAI,IAAI,MAAM,IAAI,QAAQ,EAAE,CAAC;oBACzD,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;oBAE7C,CAAC,EAAE,CAAC;oBACJ,IAAI,CAAC,GAAG,GAAG,KAAK,CAAC,EAAE;wBACjB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,iBAAiB,CAAC,OAAO,KAAK,CAAC,MAAM,sBAAsB,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,GAAG,EACtF,SAAS,CACV,CAAC;wBAEF,UAAU,CAAC,CAAC,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC;qBAC9B;gBACH,CAAC,EAAC;gBAEF,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;gBAC7C,MAAM,2CAAI,CAAC,KAAK,CAAC;qBACd,IAAI,CAAC,yDAAQ,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC;qBAC7C,SAAS,EAAE,CAAC;gBACf,UAAU,EAAE,CAAC;aACd;YAAC,OAAO,GAAG,EAAE;gBACZ,OAAO,CAAC,GAAG,CAAC,CAAC;aACd;QACH,CAAC;KAAA;IAEa,SAAS,CAAC,IAAU,EAAE,IAAY;;YAC9C,IAAI,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBACjC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;gBACxC,MAAM,MAAM,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC;gBAE3C,IAAI,IAAI,GAAG,KAAK,CAAC;gBACjB,IAAI,eAAe,GAAG,CAAC,CAAC;gBACxB,OAAO,CAAC,IAAI,IAAI,eAAe,GAAG,CAAC,EAAE;oBACnC,IAAI;wBACF,MAAM,uEAAoB,CAAC;4BACzB,IAAI;4BACJ,IAAI,EAAE,MAAM;4BACZ,SAAS,EAAE,IAAI;yBAChB,CAAC,CAAC;wBACH,IAAI,GAAG,IAAI,CAAC;qBACb;oBAAC,OAAO,KAAK,EAAE;wBACd,eAAe,EAAG,CAAC;wBACnB,MAAM,OAAO,GAAG,YAAY,IAAI,YAAY,eAAe,gBAAgB,CAAC;wBAC5E,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;wBACrD,IAAI,eAAe,KAAK,CAAC,EAAE;4BACzB,MAAM,mBAAmB,GAAG,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;4BAC/C,mBAAmB,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC;4BACxC,MAAM,mBAAmB,CAAC;yBAC3B;qBACF;iBACF;aACF;QACH,CAAC;KAAA;IAEO,UAAU,CAAC,QAA2B,EAAE,QAAkB;QAChE,QAAQ,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAC7B,MAAM,aAAa,GAAG,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CAC9D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,CAChC,CAAC;QACF,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC,GAAG,aAAa,EAAE,QAAQ,CAAC,CAAC,CAAC;IACnE,CAAC;IAEa,sBAAsB,CAClC,QAA2B,EAC3B,KAAY,EACZ,aAAsB;;YAEtB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,KAAK,EACL,SAAS,EACT,yBAAyB,QAAQ,CAAC,IAAI,EAAE,CACzC,CAAC;YACF,QAAQ,CAAC,KAAK,GAAG,KAAK,IAAI,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;YACrD,MAAM,eAAe,GAAG,aAAa,CAAC,CAAC,CAAC,mCAAmC,CAAC,CAAC,CAAC,gCAAgC,CAAC;YAC/G,QAAQ,CAAC,QAAQ,CAAC,WAAW,GAAG,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC,CAAC;YACjG,MAAM,aAAa,GAAG,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CAC9D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,CAChC,CAAC;YACF,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,CAAC,GAAG,aAAa,EAAE,QAAQ,CAAC,CAAC,CAAC;YACjE,IAAI,CAAC,kCAAkC,EAAE,CAAC;YAC1C,IAAI,CAAC,+BAA+B,CAAC,aAAa,CAAC,CAAC;QACtD,CAAC;KAAA;IAEa,0BAA0B,CAAC,UAA6B;;YACpE,IAAI,CAAC,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBAClC,IAAI,CAAC,sBAAsB,CACzB,UAAU,EACV,IAAI,KAAK,CAAC,uCAAuC,CAAC,EAClD,KAAK,CACN,CAAC;gBACF,OAAO;aACR;YACD,UAAU,CAAC,gBAAgB,GAAG,6CAAM,EAAE,CAAC,IAAI,EAAE,CAAC;YAC9C,UAAU,CAAC,QAAQ,GAAG,EAAE,UAAU,EAAE,GAAG,EAAE,CAAC;YAE1C,8BAA8B;YAC9B,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YAC5D,MAAM,uEAAoB,CAAC;gBACzB,IAAI;gBACJ,IAAI,EAAE,GAAG,UAAU,CAAC,IAAI,EAAE;gBAC1B,QAAQ,EAAE,iEAAc;aACzB,CAAC,CAAC;YAEH,gCAAgC;YAChC,MAAM,aAAa,GAAG,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,MAAM,CAC9D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,UAAU,CAAC,IAAI,CAClC,CAAC;YACF,IAAI,CAAC,wBAAwB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAElD,8BAA8B;YAC9B,IAAI,CAAC,kCAAkC,EAAE,CAAC;YAE1C,MAAM,YAAY,GAAG,UAAU,CAAC,gBAAgB,GAAG,UAAU,CAAC,aAAa,CAAC;YAC5E,MAAM,IAAI,GAAG,UAAU,CAAC,IAAI,GAAG,IAAI,GAAG,YAAY,CAAC;YACnD,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,YAAY,UAAU,CAAC,IAAI,gBAAgB,YAAY,aAAa,IAAI,MAAM,EAC9E,SAAS,CACV,CAAC;YAEF,gCAAgC;YAChC,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YAC3D,UAAU,CAAC,GAAG,EAAE;gBACd,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAChD,CAAC;KAAA;IAEO,WAAW,CAAC,UAA6B;QAC/C,IAAI,CAAC,sBAAsB,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QAC7C,IAAI,CAAC,kCAAkC,EAAE,CAAC;IAC5C,CAAC;IAEO,kCAAkC;QACxC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,4BAA4B,EAAE,CAAC;IACtC,CAAC;IAED,mCAAmC;IAEnC;;;;OAIG;IACW,gBAAgB;;YAC5B,qCAAqC;YACrC,0EAA0E;YAC1E,mHAAmH;YACnH,iBAAiB;YACjB,8CAA8C;YAC9C,MAAM;YACN,IAAI;YACJ,OAAO,iEAAc,CAAC;QACxB,CAAC;KAAA;IAED;;;;;OAKG;IACW,cAAc;;YAC1B,IAAI,IAAI,CAAC,WAAW,KAAK,EAAE,EAAE;gBAC3B,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBACpD,MAAM,aAAa,GAAG,MAAM,qEAAkB,CAAC;oBAC7C,IAAI,EAAE,EAAE;oBACR,SAAS,EAAE,aAAa;iBACzB,CAAC,CAAC;gBACH,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE;oBAC/C,MAAM,mEAAgB,CAAC;wBACrB,IAAI,EAAE,YAAY;wBAClB,SAAS,EAAE,aAAa;qBACzB,CAAC,CAAC;iBACJ;gBACD,MAAM,SAAS,GAAG,MAAM,oEAAiB,CAAC;oBACxC,IAAI,EAAE,YAAY;oBAClB,SAAS,EAAE,aAAa;iBACzB,CAAC,CAAC;gBACH,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC;gBAEjC,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE;oBAClC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;iBAClD;aACF;YACD,OAAO,IAAI,CAAC,WAAW,CAAC;QAC1B,CAAC;KAAA;IAED;;;;;OAKG;IACW,oBAAoB,CAAC,IAAY;;YAC7C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;YACzC,OAAO,GAAG,IAAI,IAAI,IAAI,EAAE,CAAC;QAC3B,CAAC;KAAA;IAED;;;;;OAKG;IACW,kBAAkB,CAAC,WAAmB;;YAClD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC;YAC1D,OAAO,GAAG,IAAI,WAAW,CAAC;QAC5B,CAAC;KAAA;IAEa,eAAe,CAAC,IAAY,EAAE,OAAe;;YACzD,IAAI,CAAC,8EAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;gBAClC,OAAO;aACR;YACD,MAAM,SAAS,GAAG,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC;YACvC,MAAM,mEAAgB,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;iBACzD,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,mBAAmB,SAAS,EAAE,CAAC,CAAC;YAC5D,CAAC,CAAC;iBACD,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;gBACb,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,GAAG,EACH,4BAA4B,EAC5B,yBAAyB,SAAS,EAAE,CACrC,CAAC;YACJ,CAAC,CAAC,CAAC;QACP,CAAC;KAAA;;kFA/yBU,iBAAiB;mHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;ACzBpB;;;;;;;;;;;;;;;GAeG;AACI,MAAM,oBAAoB;IAAjC;QACU,aAAQ,GAAoC,IAAI,GAAG,EAAE,CAAC;QAGtD,gBAAW,GAAG,CAAC,CAAC;IAgF1B,CAAC;IA9EC,KAAK;QACH,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;IACxB,CAAC;IAED,GAAG,CAAC,UAA6B;QAC/B,KAAK,MAAM,OAAO,IAAI,UAAU,CAAC,IAAI,EAAE;YACrC,MAAM,GAAG,GAAG,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YACrC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;gBAC/B,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;aACvC;YACD,MAAM,kBAAkB,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;YACtD,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAChF,kBAAkB,CAAC,GAAG,CAAC,WAAW,EAAE,EAAE,GAAG,EAAE,GAAG,CAAC,GAAG,EAAE,IAAI,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAC,CAAC,CAAC;YAC3F,IAAI,CAAC,IAAI,CAAC,eAAe,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,eAAe,EAAE;gBAClE,IAAI,CAAC,eAAe,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;aACvC;YACD,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,IAAI,CAAC,gBAAgB,EAAE;gBACpE,IAAI,CAAC,gBAAgB,GAAG,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;aACxC;YACD,IAAI,GAAG,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE;gBAC/B,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,IAAI,CAAC;aAC7B;SACF;IACH,CAAC;IAED;;;;;;OAMG;IACH,MAAM,CAAC,OAAe,EAAE,CAAS,EAAE,CAAS,EAAE,CAAS;QACrD,IAAI,CAAC,GAAG,IAAI,CAAC,WAAW,EAAE;YACxB,OAAO,SAAS,CAAC;SAClB;QACD,MAAM,WAAW,GAAG,IAAI,CAAC,qBAAqB,CAAC,OAAO,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACjE,IAAI,WAAW,IAAI,WAAW,CAAC,IAAI,IAAI,CAAC,EAAE;YACxC,OAAO,WAAW,CAAC,GAAG,CAAC;SACxB;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED;;;OAGG;IACH,qBAAqB,CAAC,OAAe,EAAE,CAAS,EAAE,CAAS,EAAE,CAAS;QACpE,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE;YAC/B,OAAO,SAAS,CAAC;SAClB;QAED,IAAI,EAAE,GAAG,CAAC,CAAC;QACX,IAAI,EAAE,GAAG,CAAC,CAAC;QACX,IAAI,EAAE,GAAG,CAAC,CAAC;QAEX,2BAA2B;QAC3B,OAAO,EAAE,GAAG,IAAI,CAAC,gBAAgB,EAAE;YACjC,EAAE,EAAE,CAAC;YACL,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACxB,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;SACzB;QACD,OAAO,EAAE,IAAI,IAAI,CAAC,eAAe,EAAE;YACjC,MAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;YAC5C,MAAM,YAAY,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YACjE,IAAI,YAAY,EAAE;gBAChB,OAAO,YAAY,CAAC;aACrB;YACD,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACxB,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC;YACxB,EAAE,EAAE,CAAC;SACN;QACD,OAAO,SAAS,CAAC,CAAC,iCAAiC;IACrD,CAAC;IAEO,MAAM,CAAC,CAAS,EAAE,CAAS,EAAE,CAAS;QAC5C,OAAO,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;IAC1B,CAAC;CACF;;;;;;;;;;;;;;;;AC1GD,IAAY,YAIX;AAJD,WAAY,YAAY;IACtB,qDAAW;IACX,uDAAY;IACZ,2DAAc;AAChB,CAAC,EAJW,YAAY,KAAZ,YAAY,QAIvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHyE;AACL;AACzC;AACqB;AACM;AACX;AACI;;;;;AAKzC,MAAM,gBAAgB;IAC3B,YACU,kBAAsC,EACtC,eAAgC,EAChC,gBAAkC;QAFlC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;IACzC,CAAC;IAEJ,yBAAyB,CAAC,IAAY,IAAI,EAAE,OAAO,GAAG,IAAI;QACxD,OAAO,IAAI,CAAC,cAAc,CACxB,OAAO,EACP,yCAAyC,EACzC,QAAQ,EACR,2CAA2C,EAC3C,4CAA4C,EAC5C,iCAAiC,CAClC,CAAC;IACJ,CAAC;IAED,wBAAwB,CAAC,IAAY,IAAI,EAAE,OAAO,GAAG,IAAI;QACvD,OAAO,IAAI,CAAC,cAAc,CACxB,OAAO,EACP,wCAAwC,EACxC,QAAQ,EACR,2CAA2C,EAC3C,4CAA4C,EAC5C,iCAAiC,CAClC,CAAC;IACJ,CAAC;IAED,+BAA+B,CAAC,IAAY,EAAE,OAAO,GAAG,IAAI;QAC1D,OAAO,IAAI,CAAC,cAAc,CACxB,OAAO,EACP,+CAA+C,EAC/C,IAAI,EACJ,mDAAmD,EACnD,oDAAoD,EACpD,iCAAiC,CAClC,CAAC;IACJ,CAAC;IAED,kBAAkB,CAChB,OAAe,EACf,aAAsB,EACtB,YAAY,GAAG,IAAI;QAEnB,IAAI,aAAa,KAAK,SAAS,IAAI,aAAa,KAAK,IAAI,EAAE;YACzD,OAAO,YAAY,CAAC;SACrB;QACD,MAAM,KAAK,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,OAAO,EAAE,cAAc,CAAC,CAAC;QACzD,OAAO,kDAAW,CAAC,aAAa,CAAC,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACpD,CAAC;IAEK,SAAS,CACb,MAAc,EACd,OAAe,EACf,MAAc;;YAEd,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM;gBACN,OAAO;gBACP,OAAO,EAAE,CAAC,MAAM,CAAC;aAClB,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAED,mBAAmB,CACjB,SAAiB,EACjB,UAAkB,EAClB,KAAa;QAEb,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC,CAAC,IAAI,CACnE,mDAAG,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;YACrB,MAAM,EAAE,YAAY,CAAC,SAAS,CAAC;YAC/B,OAAO,EAAE,YAAY,CAAC,UAAU,CAAC;YACjC,MAAM,EAAE,YAAY,CAAC,KAAK,CAAC;SAC5B,CAAC,CAAC,CACJ,CAAC;IACJ,CAAC;IAEK,8BAA8B,CAAC,aAAqB,EAAE,aAAqB;;YAC/E,IAAI,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC1D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,YAAY,mCACP,YAAY,KACf,CAAC,aAAa,CAAC,EAAE,aAAa,IAAI,YAAY,CAAC,CAAC,iCAC3C,YAAY,CAAC,aAAa,CAAC,KAC9B,CAAC,aAAa,CAAC,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE,IAChC,CAAC,CAAC,EAAC,CAAC,aAAa,CAAC,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE,EAAC,GACvC,CAAC;YACF,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QACzD,CAAC;KAAA;IAEO,cAAc,CACpB,OAAO,GAAG,IAAI,EACd,aAAqB,EACrB,aAAqB,EACrB,MAAc,EACd,GAAW,EACX,MAAc,EACd,gBAAwB,2EAAoC;QAE5D,OAAO,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CAC9C,oDAAI,CAAC,CAAC,CAAC,EACP,qDAAK,CAAC,OAAO,CAAC,EACd,sDAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CACZ,IAAI,CAAC,kBAAkB,CACrB,aAAa,EACb,aAAa,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,aAAa,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAC9D,CACF,EACD,yDAAS,CAAC,GAAG,EAAE,CACb,IAAI,CAAC,mBAAmB,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,CAAC,CAC9C,EACD,yDAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CACzB,0CAAI,CACF,IAAI,CAAC,SAAS,CACZ,YAAY,CAAC,MAAM,EACnB,YAAY,CAAC,OAAO,EACpB,YAAY,CAAC,MAAM,CACpB,CACF,CACF,EACD,yDAAS,CAAC,GAAG,EAAE,CAAC,0CAAI,CAAC,IAAI,CAAC,8BAA8B,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC,CAAC,CACzF,CAAC;IACJ,CAAC;;gFA7HU,gBAAgB;kHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;ACTsB;AACgD;AACnC;AAC6B;AACc;AAC3C;;;;;;AAEvD,MAAM,SAAS,GAAG,iBAAiB,CAAC;AACpC,MAAM,uBAAuB,GAAG,QAAQ,CAAC;AAKlC,MAAM,eAAe;IAC1B,YACU,QAAkB,EAClB,cAA8B,EAC9B,gBAAkC,EAClC,gBAAkC;QAHlC,aAAQ,GAAR,QAAQ,CAAU;QAClB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,qBAAgB,GAAhB,gBAAgB,CAAkB;IACzC,CAAC;IAEJ,IAAI;QACF,MAAM,CAAC,GAAQ,MAAM,CAAC;QACtB,IACE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;YAC1B,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC;YAC3B,CAAC,CAAC,OAAO;YACT,CAAC,CAAC,OAAO,CAAC,SAAS,EACnB;YACA,IAAI,CAAC,qBAAqB,EAAE,CAAC;YAC7B,OAAO;SACR;QACD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,iCAAiC,EAAE,SAAS,CAAC,CAAC;IAC1E,CAAC;IAEO,QAAQ,CAAC,SAAoB;QACnC,QAAQ,SAAS,EAAE;YACnB,KAAK,sEAAc;gBACjB,OAAO,SAAS,CAAC;YACnB,KAAK,sEAAc;gBACjB,OAAO,SAAS,CAAC;YACnB,KAAK,qEAAa;gBAChB,OAAO,QAAQ,CAAC;YAClB,KAAK,uEAAe;gBAClB,OAAO,UAAU,CAAC;SACnB;IACH,CAAC;IAEa,YAAY;;YACxB,MAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;YAC5D,MAAM,cAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;YAC5E,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC;gBACH,0BAA0B;gBAC1B,0BAA0B;gBAC1B,GAAG,cAAc;aAClB,CAAC;iBACD,SAAS,EAAE,CAAC;YAEf,MAAM,uBAAuB,GAAG,CAAC,aAAqB,EAAE,EAAE,CACxD,GACE,YAAY,CAAC,0BAA0B,CACzC,IAAI,aAAa,CAAC,WAAW,EAAE,IAC7B,YAAY,CAAC,0BAA0B,CACzC,EAAE,CAAC;YACL,MAAM,aAAa,GAAG,CAAC,aAAqB,EAAE,EAAE,CAAC,KAAK,aAAa,EAAE,CAAC;YAEtE,OAAO,UAAU,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;gBACpC,EAAE,EAAE,oCAAoC,SAAS,EAAE;gBACnD,GAAG,EAAE,6BAA6B,SAAS,EAAE;gBAC7C,UAAU,EAAE,aAAa,CACvB,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC,CACjE;gBACD,SAAS,EAAE,uBAAuB,CAChC,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC,CACjE;gBACD,gBAAgB,EAAE,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;aAC3C,CAAC,CAAC,CAAC;QACN,CAAC;KAAA;IAEO,qBAAqB;QAC3B,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,4CAA4C,EAC5C,SAAS,CACV,CAAC;QACF,MAAM,CAAC,GAAQ,MAAM,CAAC;QACtB,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,eAAe,CACjC,CAAO,SAAS,EAAE,EAAE,CAAC;YACnB,IAAI,CAAC,SAAS,EAAE;gBACd,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,iCAAiC,EACjC,SAAS,CACV,CAAC;gBACF,OAAO;aACR;YACD,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,EAAE,CAAC;YAC5C,MAAM,aAAa,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,iCACtC,CAAC,KACJ,MAAM,EAAE;oBACN,MAAM,EAAE,4BAA4B;oBACpC,KAAK,EAAE,uBAAuB;oBAC9B,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,4BAA4B;iBACzC,IACD,CAAC,CAAC;YACJ,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,2BAA2B,EAC3B,SAAS,EACT,aAAa,CACd,CAAC;YACF,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,UAAU,CAC5B,aAAa,EACb,GAAG,EAAE;gBACH,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,qCAAqC,EACrC,SAAS,CACV,CAAC;YACJ,CAAC,EACD,CAAC,KAAK,EAAE,EAAE;gBACR,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,kCAAkC,EAClC,KAAK,EACL,8FAAgB,EAChB,SAAS,CACV,CAAC;YACJ,CAAC,CACF,CAAC;QACJ,CAAC,GACD,CAAC,KAAK,EAAE,EAAE;YACR,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,oDAAoD,EACpD,KAAK,EACL,8FAAgB,EAChB,SAAS,CACV,CAAC;QACJ,CAAC,CACF,CAAC;IACJ,CAAC;;8EA3HU,eAAe;gHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;ACXuB;AACE;;AAKtC,MAAM,gBAAgB;IAK3B;QACE,IAAI,CAAC,QAAQ,GAAG,IAAI,yCAAO,EAAW,CAAC;QACvC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,2DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3E,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC3B,CAAC;IAED,eAAe;QACb,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC3B,CAAC;IAED,gBAAgB;QACd,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;;gFAjBU,gBAAgB;iHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHQ;AAGkB;AACuB;AACS;AAStD;AACkD;AACR;AACX;AAEmC;AACpD;AACqD;;;;;;;AAG3F,MAAM,SAAS,GAAG,mBAAmB,CAAC;AAK/B,MAAM,iBAAiB;IAO5B,YACU,WAAwB,EACxB,kBAAsC,EACtC,gBAAkC,EAClC,eAAgC,EAChC,cAA8B,EAC9B,eAAgC;QALhC,gBAAW,GAAX,WAAW,CAAa;QACxB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QARlC,uBAAkB,GAAG,IAAI,iDAAe,CAAC,KAAK,CAAC,CAAC;QAUtD,IAAI,CAAC,kBAAkB,CAAC,QAAQ;aAC7B,IAAI,CACH,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,0CAAI,CAAC,IAAI,CAAC,4BAA4B,CAAC,OAAO,CAAC,CAAC,CAAC,CACzE;aACA,SAAS,CAAC,CAAC,UAAU,EAAE,EAAE;YACxB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;IACP,CAAC;IArBD,IAAI,cAAc;QAChB,OAAO,IAAI,CAAC,kBAAkB,CAAC,YAAY,EAAE,CAAC;IAChD,CAAC;IAqBD,eAAe,CAAC,IAAiB;QAC/B,OAAO,oDAAI,CAAC,kEAA4B,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;IACzE,CAAC;IAED,sBAAsB;QACpB,OAAO,IAAI,gGAAwB,CACjC,oDAAI,CAAC,kEAA4B,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAC5D,CAAC;IACJ,CAAC;IAED,WAAW,CAAC,KAAmB;QAC7B,OAAO,oDAAI,CAAC,2EAAqC,CAAC;aAC/C,KAAK,CAAC,QAAQ,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC;aACtD,IAAI,EAAE,CAAC;IACZ,CAAC;IAED,2BAA2B;QACzB,OAAO,IAAI,gGAAwB,CACjC,oDAAI,CAAC,2EAAqC,CAAC;aACxC,KAAK,CAAC,QAAQ,CAAC;aACf,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC;aACrB,KAAK,CAAC,CAAC,CAAC;aACR,MAAM,CAAC,EAAE,CAAC,CACd,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7B,CAAC;IAED,8BAA8B;QAC5B,OAAO,IAAI,gGAAwB,CACjC,oDAAI,CAAC,2EAAqC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CACrE,CAAC;IACJ,CAAC;IAED,yBAAyB;QACvB,OAAO,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAC1C,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,0CAAI,CAAC,IAAI,CAAC,4BAA4B,CAAC,OAAO,CAAC,CAAC,CAAC,CACzE,CAAC;IACJ,CAAC;IAEK,4BAA4B,CAAC,OAAgB;;YACjD,MAAM,MAAM,GAAG,CAAC,MAAM,yDAAmB,CACvC,yEAAmC,EACnC,OAAO,CACR;iBACE,KAAK,CAAC,QAAQ,CAAC;iBACf,IAAI,EAAE,CAAiB,CAAC;YAC3B,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC;QACnB,CAAC;KAAA;IAED,eAAe,CAAC,OAAsB;QACpC,MAAM,UAAU,GAAe;YAC7B,EAAE,EAAE,YAAY;YAChB,SAAS,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YAC1B,OAAO,EAAE,OAAO;SACjB,CAAC;QACF,OAAO,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAC1C,qDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CACpB,IAAI,CAAC,WAAW;aACb,QAAQ,CAAC,OAAO,CAAC;aACjB,IAAI,CACH,yDAAS,CAAC,GAAG,EAAE,CACb,0CAAI,CACF,yDAAmB,CACjB,yEAAmC,EACnC,OAAO,CACR;aACE,KAAK,CAAC,QAAQ,EAAE,UAAU,CAAC;aAC3B,IAAI,EAAE,CACV,CACF,CACF,CACJ,EACD,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EAC7C,yDAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,EACvC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACpC,OAAO,iDAAU,CAAC,GAAG,CAAC,CAAC;QACzB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAED,cAAc,CAAC,WAAW,GAAG,IAAI;QAC/B,IAAI,WAAW,EAAE;YACf,IAAI,CAAC,eAAe,EAAE,CAAC;SACxB;aAAM;YACL,IAAI,CAAC,oCAAoC,EAAE,CAAC;SAC7C;IACH,CAAC;IAEK,oBAAoB,CAAC,KAAc;;YACvC,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC,CAAC,sBAAsB,EAAE,UAAU,EAAE,YAAY,EAAE,gBAAgB,CAAC,CAAC;iBACzE,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,sBAAsB,CAAC;gBAC5C,OAAO,EAAE,KAAK;oBACZ,CAAC,CAAC,YAAY,CAAC,YAAY,CAAC;oBAC5B,CAAC,CAAC,YAAY,CAAC,gBAAgB,CAAC;gBAClC,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;YACH,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;KAAA;IAEK,8BAA8B;;YAClC,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC,CAAC,sBAAsB,EAAE,UAAU,EAAE,qBAAqB,CAAC,CAAC;iBAChE,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,sBAAsB,CAAC;gBAC5C,OAAO,EAAE,YAAY,CAAC,qBAAqB,CAAC;gBAC5C,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;YACH,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;KAAA;IAEa,eAAe;;YAC3B,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC;gBACH,gBAAgB;gBAChB,6BAA6B;gBAC7B,UAAU;gBACV,cAAc;aACf,CAAC;iBACD,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,gBAAgB,CAAC,GAAG,GAAG;gBAC5C,OAAO,EAAE,YAAY,CAAC,6BAA6B,CAAC;gBACpD,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,YAAY,CAAC,cAAc,CAAC;wBAClC,IAAI,EAAE,QAAQ;wBACd,QAAQ,EAAE,WAAW;qBACtB;oBACD;wBACE,IAAI,EAAE,YAAY,CAAC,UAAU,CAAC;wBAC9B,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,oCAAoC,EAAE;qBAC3D;iBACF;aACF,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAEO,oCAAoC;QAC1C,IAAI,CAAC,yBAAyB,EAAE;aAC7B,IAAI,CACH,qDAAI,CAAC,CAAC,CAAC,EACP,uDAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,EACxB,0DAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CACjB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,UAAU,EAAE,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,CAClE,EACD,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,EAC/C,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CACzC;aACA,SAAS,CACR,GAAG,EAAE;YACH,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACtC,CAAC,EACD,CAAO,KAAK,EAAE,EAAE,CAAC;YACf,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,KAAK,EAAE,SAAS,EAAE,qBAAqB,CAAC,CAAC;YACnE,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACpC,MAAM,IAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,CAAC;QACzC,CAAC,EACF,CAAC;IACN,CAAC;IAEO,uBAAuB;QAC7B,OAAO,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAC1C,0DAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CACpB,0CAAI,CACF,yDAAmB,CAAC,yEAAmC,EAAE,OAAO,CAAC;aAC9D,KAAK,CAAC,QAAQ,CAAC;aACf,IAAI,EAAE,CACV,CACF,CACF,CAAC;IACJ,CAAC;IAED,oBAAoB;QAClB,OAAO,IAAI,CAAC,yBAAyB,EAAE;aACpC,IAAI,CACH,uDAAM,CACJ,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,IAAI,IAAI,CAAC,SAAS,GAAG,6CAAM,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,EAAE,CAClE,EACD,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,EAC/C,qDAAI,CAAC,CAAC,CAAC,CACR;aACA,SAAS,EAAE,CAAC;IACjB,CAAC;IAEO,WAAW,CAAC,OAAgB;QAClC,MAAM,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,cAAc,CAAC;QACtD,OAAO,IAAI,CAAC,gBAAgB;aACzB,GAAG,CAAC,GAAG,CAAC;aACR,IAAI,CAAC,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,0CAAI,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;IACpE,CAAC;IAEK,YAAY,CAAC,OAAe;;YAChC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,OAAO;gBACP,IAAI,EAAE,IAAI;gBACV,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YACH,OAAO,KAAK,CAAC,OAAO,EAAE,CAAC;QACzB,CAAC;KAAA;;kFAnOU,iBAAiB;mHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3BmC;AACkB;AACzB;AACF;AAC8B;AAYpD;AACkE;AACpD;AAEF;AAC4B;AACoB;AACpB;AACX;AACL;AACA;AACA;AACA;AACA;AACA;;;;AAKhD,MAAM,SAAS,GAAG,oBAAoB,CAAC;AAKhC,MAAM,kBAAmB,SAAQ,qEAAa;IAyCnD,YACU,SAA2B,EAC3B,cAA8B;QAEtC,KAAK,EAAE,CAAC;QAHA,cAAS,GAAT,SAAS,CAAkB;QAC3B,mBAAc,GAAd,cAAc,CAAgB;QAzBhC,wBAAmB,GAAG,IAAI,kDAAe,CAAc,IAAI,CAAC,CAAC;QA4BnE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,EAAE,CAAC,IAAI,CAC9D,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAChB,GAAG,CAAC,CAAC,CAAC,yCAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,sCAAsC,EAAE,CAC9D,EACD,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;;YACV,UAAI,CAAC,cAAc,0CAAE,KAAK,CAAC,oBAAoB,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QACnE,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QACF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAC7C,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,EAClC,qEAAoB,CAAC,wDAAK,CAAC,EAC3B,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;;YACV,iBAAI,CAAC,cAAc,0CAAE,KAAK,CACxB,iCAAiC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,EAChD,SAAS,CACV;SAAA,CACF,EACD,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CACpC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,EACzB,qEAAoB,EAAE,EACtB,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;;YACV,UAAI,CAAC,cAAc,0CAAE,KAAK,CAAC,eAAe,EAAE,SAAS,EAAE,GAAG,CAAC,CAAC;QAC9D,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAC1C,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,aAAa,CAAC,EAC/B,qEAAoB,EAAE,EACtB,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CACrC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,EAC1B,qEAAoB,EAAE,EACtB,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,mBAAmB,GAAG,oDAAa,CAAC;YACvC,IAAI,CAAC,QAAQ;YACb,IAAI,CAAC,SAAS;SACf,CAAC,CAAC,IAAI,CAAC,4DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAExB,IAAI,CAAC,mCAAmC,GAAG,oDAAa,CAAC;YACvD,IAAI,CAAC,QAAQ;YACb,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,iBAAiB;SACvB,CAAC,CAAC,IAAI,CAAC,4DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAExB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CACrC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,mBAAmB,CAAC,EACrC,qEAAoB,CAAC,wDAAK,CAAC,EAC3B,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,WACV,iBAAI,CAAC,cAAc,0CAAE,KAAK,CAAC,uBAAuB,EAAE,SAAS,EAAE,GAAG,CAAC,IACpE,EACD,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAC7C,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,EAClC,qEAAoB,EAAE,EACtB,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IA9FD,0DAA0D;IAE1D,6BAA6B;IAC7B,kDAAkD;IAClD,IAAI;IAEJ,0BAA0B;IAC1B,gDAAgD;IAChD,IAAI;IAEJ,0CAA0C;IAC1C,gCAAgC;IAChC,IAAI;IAEJ,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;IACpF,CAAC;IAED,IAAI,yBAAyB;QAC3B,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,EAAE,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;IACrF,CAAC;IA4EM,IAAI;QACT,IAAI,CAAC,4BAA4B,EAAE,CAAC;QACpC,4CAA4C;QAC5C,IAAI,CAAC,8BAA8B,EAAE,CAAC;IACxC,CAAC;IAEO,4BAA4B;QAClC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;YACpE,MAAM,IAAI,GAAG,gEAAO,CAAC,OAAO,CAAC,CAAC;YAC9B,QAAQ,OAAO,EAAE;gBACjB,KAAK,mEAAU;oBACb,oEAAkB,CAAC,mEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,KAAK,mEAAU;oBACb,oEAAkB,CAAC,oEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,KAAK,mEAAU;oBACb,oEAAkB,CAAC,oEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,KAAK,mEAAU;oBACb,oEAAkB,CAAC,mEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,KAAK,mEAAU;oBACb,oEAAkB,CAAC,oEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,KAAK,mEAAU;oBACb,oEAAkB,CAAC,oEAAM,CAAC,CAAC;oBAC3B,MAAM;gBACR,8CAA8C;gBAC9C,mBAAmB;gBACnB,gCAAgC;gBAChC,WAAW;aACV;YACD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,8BAA8B;QACpC,IAAI,CAAC,mBAAmB;aACrB,IAAI,CACH,uDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,EAC5B,6DAAY,CAAC,GAAG,CAAC,EACjB,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE;;YACb,iBAAI,CAAC,cAAc,0CAAE,KAAK,CACxB,gDAAgD,EAChD,SAAS,EACT,MAAM,CACP;SAAA,CACF,EACD,0DAAS,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,EACxD,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC3B;aACA,SAAS,EAAE,CAAC;IACjB,CAAC;IAED,gBAAgB,CAAC,WAAwB;QACvC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;IAC7C,CAAC;IAED,sBAAsB,CAAC,EAAe,EAAE,IAAI,GAAG,IAAI;QACjD,MAAM,+BAA+B,GAAkB,6EAAsC,CAC3F,CAAC,OAAO,EAAE,EAAE,CAAC,EAAE,CAAC,gBAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,CACnE,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;YACb,MAAM,aAAa,GAAG,EAAE,CAAC,YAAY,CAAC,IAAI,CACxC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,IAAI,CACxC,CAAC;YACF,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;YAC3B,IAAI,OAAO,IAAI,aAAa,IAAI,aAAa,CAAC,OAAO,EAAE;gBACrD,OAAO,mCAAO,IAAI,CAAC,OAAO,GAAK,aAAa,CAAC,OAAO,CAAC,CAAC;aACvD;YACD,uCACK,CAAC,aAAa,CAAC,CAAC,iCAAK,IAAI,GAAK,aAAa,EAAE,CAAC,CAAC,IAAI,CAAC,KACvD,OAAO,EAAE,OAAO,IAChB;QACJ,CAAC,CAAC,CAAC;QAEH,IAAI,IAAI,EAAE;YACR,+BAA+B;iBAC5B,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC;iBAC9B,OAAO,CAAC,CAAC,IAAI,EAAE,EAAE;gBAChB,+BAA+B,CAAC,IAAI,iCAC/B,IAAI,CAAC,OAAO,KACf,OAAO,EAAE,IAAI,CAAC,OAAO,EACrB,WAAW,EAAE,IAAI,CAAC,WAAW,IAC7B,CAAC;gBACH,OAAO,IAAI,CAAC,OAAO,CAAC;YACtB,CAAC,CAAC,CAAC;SACN;QAED,OAAO,+BAA+B,CAAC;IACzC,CAAC;IAEO,sCAAsC;QAC5C,OAAO,IAAI,CAAC,qBAAqB,EAAE,CAAC,IAAI,CACtC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,6EAAqB,CAAC,IAAI,CAAC,CAAC,CAAC,CACjE,CAAC;IACJ,CAAC;IAEO,qBAAqB;QAC3B,OAAO,2CAAI,CACT,oDAAI,CAAC,uEAAiC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,EAE3D,CACF,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrC,CAAC;IAEO,oBAAoB,CAC1B,WAAwB;QAExB,OAAO,2CAAI,CACT,oDAAI,CAAC,uEAAiC,CAAC;aACpC,KAAK,CAAC,QAAQ,kBAAI,EAAE,EAAE,cAAc,IAAK,WAAW,EAAG;aACvD,IAAI,EAA4B,CACpC,CAAC,IAAI,CACJ,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;;YACjB,UAAI,CAAC,cAAc,0CAAE,GAAG,CACtB,4CAA4C,EAC5C,GAAG,EACH,8FAAgB,EAChB,SAAS,CACV,CAAC;YACF,OAAO,yCAAE,CAAC,IAAI,CAAC,CAAC;QAClB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAED,gEAAgE;IAChE,UAAU,KAAI,CAAC;IAEf,kBAAkB;QAChB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,0CAA0C,EAC1C,SAAS,CACV,CAAC;QACF,uDAAuD;QACvD,0CAA0C;QAC1C,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,6BAA6B;IACpE,CAAC;;oFA5PU,kBAAkB;oHAAlB,kBAAkB,WAAlB,kBAAkB,mBAFjB,MAAM;;;;;;;;;;;;;;;;;;;ACvCqD;AACzB;AACK;AAE9C,MAAM,qBAAqB,GAAsC,CACtE,OAAgB,EAChB,EAAE,CAAC,CAAC;IACJ,OAAO,EAAE,oEAAY;IACrB,QAAQ,EAAE,OAAO,IAAI,kEAAU;IAC/B,gBAAgB,EAAE,CAAC,sEAAc,CAAC;IAClC,mBAAmB,EAAE;QACnB,EAAE,SAAS,EAAE,sEAAc,EAAE,QAAQ,EAAE,CAAC,EAAE;QAC1C,EAAE,SAAS,EAAE,qEAAa,EAAE,QAAQ,EAAE,CAAC,EAAE;QACzC,EAAE,SAAS,EAAE,sEAAc,EAAE,QAAQ,EAAE,CAAC,EAAE;QAC1C,EAAE,SAAS,EAAE,uEAAe,EAAE,QAAQ,EAAE,CAAC,EAAE;KAC5C;IACD,oBAAoB,EAAE,KAAK;IAC3B,YAAY,EAAE,EAAE;IAChB,aAAa,EAAE,KAAK;IACpB,gBAAgB,EAAE,mEAA4B;IAC9C,gBAAgB,EAAE,IAAI;IACtB,YAAY,EAAE,IAAI;IAClB,OAAO,EAAE,kEAAe;IACxB,iBAAiB,EAAE,IAAI;IACvB,YAAY,EAAE,KAAK;IACnB,0BAA0B,EAAE,IAAI;IAChC,yCAAyC,EAAE,KAAK;IAChD,oBAAoB,EAAE,KAAK;IAC3B,0BAA0B,EAAE,KAAK;CAClC,CAAC,CAAC;;;;;;;;;;;;;;;;;;AC7ByB;AAGrB,MAAM,YAAY;IA6FvB,YAAY,KAAoB;QAC9B,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;IAC7B,CAAC;IA5FD,IAAI,GAAG;QACL,OAAO;YACL,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,SAAS;YACvC,OAAO,EAAE,IAAI,CAAC,aAAa,CAAC,QAAQ;YACpC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,UAAU;SACzC,CAAC;IACJ,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;IACrC,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC;IACvC,CAAC;IAED,IAAI,GAAG;QACL,OAAO,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC;IAChC,CAAC;IAED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC;IACrC,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC;IACtC,CAAC;IAED,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;IACpC,CAAC;IAED,IAAI,SAAS;QACX,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC;IACtC,CAAC;IAED,gBAAgB,CAAC,IAAU;QACzB,MAAM,cAAc,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAC9D,6CAAM,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,CAAC,CAC3D,CAAC;QACF,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;YAC7B,OAAO,cAAc,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,EAAE;gBACrC,IAAI,EAAE,IAAI,EAAE,CAAC,YAAY,GAAG,CAAC,CAAC,YAAY,EAAE;oBAC1C,OAAO,EAAE,CAAC;iBACX;qBAAM;oBACL,OAAO,CAAC,CAAC;iBACV;YACH,CAAC,CAAC,CAAC;SACJ;aAAM;YACL,OAAO,cAAc,CAAC,CAAC,CAAC,CAAC;SAC1B;IACH,CAAC;IAED,aAAa,CAAC,SAAiB;QAC7B,MAAM,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,6CAAM,EAAE,CAAC,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,CAAC;QAClE,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC;IAC7C,CAAC;IAEO,eAAe,CAAC,CAAgB;QACtC,OAAO,CAAC,CAAC,KAAK,EAAE,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACnD,CAAC;IAED,cAAc,CAAC,SAAS,GAAG,CAAC;QAC1B,OAAO,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;IAC/C,CAAC;IAED,aAAa,CAAC,SAAS,GAAG,CAAC;QACzB,IAAI,GAAG,GAAG,CAAC,CAAC;QACZ,IAAI,UAAU,GAAG,KAAK,CAAC;QACvB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,SAAS,EAAE,CAAC,EAAE,EAAE;YACnC,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;YACzC,IAAI,UAAU,IAAI,UAAU,CAAC,YAAY,GAAG,GAAG,EAAE;gBAC/C,GAAG,GAAG,UAAU,CAAC,YAAY,CAAC;gBAC9B,UAAU,GAAG,KAAK,CAAC;aACpB;YACD,IACE,UAAU;gBACV,UAAU,CAAC,YAAY,KAAK,GAAG;gBAC/B,UAAU,CAAC,gBAAgB,EAC3B;gBACA,UAAU,GAAG,IAAI,CAAC;aACnB;SACF;QACD,OAAO,EAAE,GAAG,EAAE,UAAU,EAAE,CAAC;IAC7B,CAAC;IAED,cAAc;QACZ,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,IAAI,IAAI,CAAC,aAAa,CAAC,QAAQ,IAAI,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,CAAC;IAC3G,CAAC;CAKF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnG+C;AAC0B;AACpC;AACb;AACuC;AACd;AACJ;AAQtB;AAE6B;AAGiB;AAEkB;AAG9C;AACI;AAC6B;AAEL;AAEoB;AACzB;AAC3B;AAC8C;AAEO;;;;;;;;;;AAE3F,MAAM,SAAS,GAAG,gBAAgB,CAAC;AAK5B,MAAM,cAAc;IAkBzB,YACU,UAAsB,EACtB,kBAAsC,EACtC,UAAsB,EACtB,eAAgC,EAChC,QAAkB,EAClB,UAAgB,EAChB,cAA8B,EAC9B,eAAgC;QAPhC,eAAU,GAAV,UAAU,CAAY;QACtB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,eAAU,GAAV,UAAU,CAAY;QACtB,oBAAe,GAAf,eAAe,CAAiB;QAChC,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAM;QAChB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,oBAAe,GAAf,eAAe,CAAiB;QAExC,IAAI,CAAC,cAAc,GAAG,IAAI,kDAAe,CAAC,EAAE,CAAC,CAAC;QAC9C,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,yCAAyC,EAAE,CAAC;QAC5E,IAAI,CAAC,sCAAsC,GAAG,IAAI,CAAC,gDAAgD,EAAE,CAAC;QACtG,IAAI,CAAC,gCAAgC,GAAG,IAAI,CAAC,wCAAwC,EAAE,CAAC;IAC1F,CAAC;IA1BD,IAAI,mBAAmB;QACrB,OAAO,IAAI,CAAC,mBAAmB,CAAC;IAClC,CAAC;IAED,IAAI,sCAAsC;QACxC,OAAO,IAAI,CAAC,sCAAsC,CAAC;IACrD,CAAC;IAED,IAAI,gCAAgC;QAClC,OAAO,IAAI,CAAC,gCAAgC,CAAC;IAC/C,CAAC;IAkBO,aAAa,CAAC,SAAoB,EAAE,QAAiB;QAC3D,OAAO,GAAG,iEAA2B,IAAI,IAAI,CAAC,mBAAmB,CAC/D,SAAS,EACT,QAAQ,CACT,EAAE,CAAC;IACN,CAAC;IAEO,mBAAmB,CAAC,SAAoB,EAAE,OAAgB;QAChE,OAAO,GAAG,SAAS,IAAI,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,EAAE,CAAC;IAC9D,CAAC;IAEO,oBAAoB,CAC1B,SAAoB,EACpB,OAAgB,EAChB,MAAuB;QAEvB,MAAM,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC;QACpD,YAAY,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,GAAG,MAAM,CAAC;QACpE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IACzC,CAAC;IAEK,cAAc,CAAC,MAAsB;;YACzC,IAAI,SAAS,GAAG,KAAK,CAAC;YACtB,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE;oBACf,SAAS,GAAG,IAAI,CAAC;gBACnB,CAAC,CAAC,CAAC;aACJ;YACD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,+BAA+B,EAAE,SAAS,CAAC,CAAC;YACtE,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC5D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC;YAClE,KAAK,MAAM,SAAS,IAAI,UAAU,EAAE;gBAClC,IAAI,CAAC,SAAS,EAAE;oBACd,MAAM,IAAI,CAAC,qCAAqC,CAC9C,SAAS,EACT,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,QAAQ,CAAC,EAChD,MAAM,CACP,CAAC;iBACH;aACF;YACD,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,6BAA6B,EAAE,SAAS,CAAC,CAAC;QACtE,CAAC;KAAA;IAEK,iCAAiC,CAAC,MAAsB;;YAC5D,IAAI,SAAS,GAAG,KAAK,CAAC;YACtB,IAAI,MAAM,EAAE;gBACV,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE;oBACf,SAAS,GAAG,IAAI,CAAC;gBACnB,CAAC,CAAC,CAAC;aACJ;YACD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC5D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC;YAClE,KAAK,MAAM,SAAS,IAAI,UAAU,EAAE;gBAClC,IAAI,CAAC,SAAS,EAAE;oBACd,MAAM,IAAI,CAAC,0BAA0B,CACnC,SAAS,EACT,IAAI,CAAC,oBAAoB,CAAC,YAAY,CAAC,QAAQ,CAAC,EAChD,MAAM,CACP,CAAC;iBACH;aACF;QACH,CAAC;KAAA;IAEa,qBAAqB,CAAC,WAAwB;;YAC1D,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,yBAAyB,EAAE;iBACtD,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,MAAM,iBAAiB,GAAG,WAAW,CAAC,gBAAgB,CAAC;YACvD,MAAM,mBAAmB,GAAG,UAAU,CAAC,MAAM,CAC3C,CAAC,GAAgB,EAAE,OAAkD,EAAE,EAAE,CACvE,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE,OAAO,CAAC,SAAS,CAAC,EACzE,EAAE,CACH,CAAC;YACF,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,CAAC,GAAG,iBAAiB,EAAE,GAAG,mBAAmB,CAAC,CAAC,CAAC,CAAC;QAC7E,CAAC;KAAA;IAEa,qCAAqC,CACjD,SAAoB,EACpB,OAAgB,EAChB,MAAsB;;YAEtB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,CAClD,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,OAAO,CAAC,CACvC,CAAC;YACF,MAAM,gBAAgB,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACxC,0EAAmC,EACnC,cAAc,CACf,CAAC;YACF,IACE,QAAQ,CAAC,SAAS;gBAClB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,EACtD;gBACA,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,qCAAqC,EACrC,SAAS,CACV,CAAC;aACH;iBAAM;gBACL,MAAM,eAAe,GAAG,6CAAM,EAAE,CAAC,QAAQ,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;gBACrD,IACE,CAAC,QAAQ,CAAC,WAAW;oBACrB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,EACtD;oBACA,MAAM,IAAI,CAAC,0BAA0B,CAAC,SAAS,EAAE,OAAO,EAAE,MAAM,CAAC,CAAC;iBACnE;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,qBAAqB,SAAS,sBAAsB,QAAQ,CAAC,WAAW,EAAE,EAC1E,SAAS,CACV,CAAC;iBACH;aACF;QACH,CAAC;KAAA;IAED,0BAA0B,CACxB,SAAoB,EACpB,OAAgB,EAChB,MAAsB;QAEtB,IAAI,SAAS,KAAK,uEAAc,EAAE;YAChC,OAAO,IAAI,CAAC,uBAAuB,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,CAAC;SAClE;aAAM,IAAI,SAAS,KAAK,sEAAa,EAAE;YACtC,OAAO,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;SACxC;aAAM;YACL,OAAO,IAAI,CAAC,+BAA+B,CACzC,SAAS,EACT,OAAO,EACP,IAAI,EACJ,IAAI,EACJ,MAAM,CACP,CAAC;SACH;IACH,CAAC;IAED,cAAc,CAAC,OAAe,EAAE,SAAoB;QAClD,MAAM,EAAE,GAAG,GAAG,SAAS,IAAI,OAAO,EAAE,CAAC;QACrC,OAAO,qDAAI,CAAC,2EAAqC,CAAC;aAC/C,KAAK,CAAC,QAAQ,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE,SAAS,EAAE,CAAC;aAC3C,IAAI,EAAE,CAAC;IACZ,CAAC;IAED,mBAAmB,CAAC,OAAe,EAAE,SAAoB;QACvD,MAAM,EAAE,GAAG,GAAG,SAAS,IAAI,OAAO,EAAE,CAAC;QACrC,OAAO,qDAAI,CAAC,2EAAqC,CAAC;aAC/C,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC;aACzB,IAAI,EAAE,CAAC;IACZ,CAAC;IAED,wBAAwB,CACtB,OAAe,EACf,SAAoB;QAEpB,MAAM,EAAE,GAAG,GAAG,SAAS,IAAI,OAAO,EAAE,CAAC;QACrC,OAAO,IAAI,iGAAwB,CAGjC,qDAAI,CAAC,2EAAqC,CAAC;aACxC,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,IAAI,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC;aACtB,MAAM,EAAE,CACZ,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAC7C,qEAAoB,EAAE,CACvB,CAAC;IACJ,CAAC;IAEO,8BAA8B,CAAC,SAAoB;QACzD,OAAO,IAAI,iGAAwB,CACjC,qDAAI,CAAC,iEAA2B,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC;YACvD,QAAQ,EAAE,GAAG;SACd,CAAC,CACH,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CACpB,aAAa,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,SAAS,KAAK,SAAS,CAAC,CACzD,EACD,oDAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CACpB,aAAa,CAAC,MAAM,KAAK,CAAC;YACxB,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,SAAS,CAAC;YACzC,CAAC,CAAC,aAAa,CAClB,CACF,CAAC;IACJ,CAAC;IAEO,uBAAuB;QAC7B,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,kBAAkB,CAAC,mCAAmC;YAC3D,IAAI,CAAC,cAAc,CAAC,YAAY,EAAE;SACnC,CAAC,CAAC,IAAI,CACL,0DAAS,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE,CAAC,EAAE,cAAc,CAAC,EAAE,EAAE,CAC/C,oDAAa,CACX;YACE,uEAAc;YACd,sEAAa;YACb,wEAAe;YACf,uEAAc;SACf,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAClB,IAAI,CAAC,oCAAoC,CACvC,cAAc,EACd,SAAS,EACT,OAAO,CACR,CACF,CACF,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,EAAE,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAC9C,EACD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CACb,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,6BAA6B,EAC7B,SAAS,EACT,MAAM,CACP,CACF,CACF,CAAC;IACJ,CAAC;IAEO,oCAAoC,CAC1C,cAAkD,EAClD,SAAoB,EACpB,OAAgB;QAEhB,IACE,cAAc,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,KAAK,SAAS,EAC1E;YACA,OAAO,yCAAE,CAAC,cAAc,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC;SACzE;QACD,OAAO,IAAI,CAAC,8BAA8B,CAAC,SAAS,CAAC,CAAC;IACxD,CAAC;IAEO,uBAAuB,CAAC,SAAoB;QAClD,QAAQ,SAAS,EAAE;YACnB,KAAK,uEAAc;gBACjB,OAAO,IAAI,CAAC,gCAAgC,EAAE,CAAC;YACjD,KAAK,sEAAa;gBAChB,OAAO,IAAI,CAAC,0BAA0B,EAAE,CAAC;YAC3C;gBACE,OAAO,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,CAAC;SAC/C;IACH,CAAC;IAEO,0BAA0B;QAChC,MAAM,qBAAqB,GAAG,IAAI,CAAC,4BAA4B,EAAE,CAAC;QAClE,MAAM,SAAS,GAAG,sEAAa,CAAC;QAChC,MAAM,YAAY,GAAoB,qBAAqB,CAAC,eAAe,CAAC,GAAG,CAC7E,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;YAClB,EAAE,EAAE,GAAG,MAAM,CAAC,IAAI,IAAI,SAAS,EAAE;YACjC,QAAQ,EAAE,MAAM,CAAC,IAAI;YACrB,UAAU,EAAE,MAAM,CAAC,IAAI;YACvB,QAAQ,EAAE,MAAM,CAAC,QAAQ;YACzB,GAAG,EAAE,MAAM,CAAC,GAAG;YACf,SAAS,EAAE,IAAI;YACf,OAAO,EAAE,IAAI;YACb,SAAS;YACT,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE,KAAK;SACjB,CAAC,CACH,CAAC;QACF,OAAO,YAAY,CAAC;IACtB,CAAC;IAEO,sBAAsB,CAAC,SAAoB;QACjD,MAAM,OAAO,GAAG,mBAAO,CAAC,iDAAsC,CAAC,CAAC;QAChE,MAAM,YAAY,GAAoB,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YAC7D,EAAE,EAAE,GAAG,MAAM,CAAC,EAAE,IAAI,SAAS,EAAE;YAC/B,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,UAAU,EAAE,MAAM,CAAC,IAAI;YACvB,QAAQ,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC;YACrB,SAAS,EAAE,SAAS;YACpB,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,EAAE,CAAC;SACnD,CAAC,CAAC,CAAC;QACJ,OAAO,YAAY,CAAC;IACtB,CAAC;IAEO,uBAAuB,CAAC,QAAgB;QAC9C,MAAM,QAAQ,GAAG,QAAQ,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;QACxC,2DAA2D;QAC3D,MAAM,mBAAmB,GAAG,QAAQ,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC;QAC5D,oEAAoE;QACpE,OAAO,mBAAmB,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC,sCAAsC;IAC9E,CAAC;IAEO,gCAAgC;QACtC,MAAM,OAAO,GAAG,mBAAO,CAAC,2DAAgD,CAAC,CAAC;QAC1E,MAAM,gBAAgB,GAAoB,OAAO,CAAC,QAAQ,CAAC,GAAG,CAC5D,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YACX,EAAE,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,IAAI,uEAAc,EAAE;YACrD,QAAQ,EAAE,GAAG,MAAM,CAAC,UAAU,CAAC,QAAQ,EAAE;YACzC,UAAU,EAAE,MAAM,CAAC,UAAU,CAAC,UAAU;YACxC,UAAU,EAAE,MAAM,CAAC,UAAU,CAAC,UAAU;YACxC,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE,uEAAc;YACzB,QAAQ,EAAE,EAAE;YACZ,SAAS,EAAE,MAAM,CAAC,UAAU,CAAC,MAAM;SACpC,CAAC,CACH,CAAC;QACF,OAAO,gBAAgB,CAAC;IAC1B,CAAC;IAEO,yBAAyB;QAC/B,OAAO,IAAI,iGAAwB,CAEjC,qDAAI,CAAC,2EAAqC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;IAC1E,CAAC;IAED,mCAAmC;QACjC,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,uBAAuB,EAAE;YAC9B,IAAI,CAAC,yBAAyB,EAAE;SACjC,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE,EAAE,CAC5B,IAAI,CAAC,UAAU,CACb,OAAO,CAAC,MAAM,CACZ,CAAC,MAAM,EAAE,EAAE,CACT,CAAC,CAAC,UAAU,CAAC,IAAI,CACf,CAAC,CAAC,EAAE,EAAE,CACJ,CAAC,CAAC,OAAO,KAAK,MAAM,CAAC,QAAQ;YAC7B,CAAC,CAAC,SAAS,KAAK,MAAM,CAAC,SAAS,CACnC,CACJ,CACF,CACF,CACF,CAAC;IACJ,CAAC;IAEO,UAAU,CAAC,WAA4B;QAC7C,OAAO,WAAW;aACf,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,8DAAY,CAAC,KAAK,CAAC,CAAC;aACvC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACb,IAAI,CAAC,CAAC,SAAS,KAAK,CAAC,CAAC,SAAS,EAAE;gBAC/B,OAAO,CAAC,CAAC,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,GAAG,CAAC,SAAS,CAAC;aAC1C;iBAAM;gBACL,OAAO,CAAC,CAAC,SAAS,GAAG,CAAC,CAAC,SAAS,CAAC;aAClC;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,yCAAyC;QAC/C,OAAO,IAAI,CAAC,uBAAuB,EAAE,CAAC,IAAI,CACxC,oDAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,EACtD,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,gDAAgD;QACtD,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,yCAAyC,EAAE;YAChD,IAAI,CAAC,kBAAkB,CAAC,iBAAiB;SAC1C,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,CAAC,aAAa,EAAE,gBAAgB,CAAC,EAAE,EAAE;YACxC,OAAO,aAAa,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CACjC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,EAAE,CAAC,GAAG,CAAC,SAAS,CAAC,CACrD,CAAC;QACJ,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,wCAAwC;QAC9C,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,UAAU,CAAC,yBAAyB;YACzC,IAAI,CAAC,uBAAuB,EAAE;SAC/B,CAAC,CAAC,IAAI,CACL,0DAAS,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,EAAE,EAAE,CAC7B,IAAI,CAAC,4BAA4B,CAAC,WAAW,CAAC,CAC/C,EACD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,EACvB,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;YACV,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,kDAAkD,EAClD,SAAS,EACT,GAAG,CACJ,CAAC;QACJ,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,eAAe,CAAC,YAA0B,EAAE,QAAgB;QAClE,MAAM,GAAG,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,YAAY,CAAC,QAAQ,CAAC,CAAC;QACjE,OAAO,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;IACpC,CAAC;IAEO,kBAAkB,CACxB,WAA4B,EAC5B,YAA0B;QAE1B,OAAO,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,WAAW,CAAC,cAAc,CAAC,CAAC;IACxE,CAAC;IAEO,mBAAmB,CACzB,WAA4B,EAC5B,YAA0B;QAE1B,OAAO,CACL,WAAW,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAChD,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,CAC3C,CAAC,MAAM,GAAG,CAAC,CACb,CAAC;IACJ,CAAC;IAEO,mBAAmB,CACzB,WAA4B,EAC5B,YAA0B;QAE1B,OAAO,CACL,WAAW,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAChD,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,MAAM,CAAC,CAC3C,CAAC,MAAM,GAAG,CAAC,CACb,CAAC;IACJ,CAAC;IAEO,4BAA4B,CAClC,WAA4B;QAE5B,OAAO,IAAI,CAAC,sCAAsC,CAAC,IAAI,CACrD,oDAAG,CAAC,CAAC,QAAQ,EAAE,EAAE;YACf,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,CAAC,YAAY,EAAE,EAAE,CAC9C,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,YAAY,CAAC,CACnD,CAAC;YACF,MAAM,UAAU,GAAG,QAAQ,CAAC,MAAM,CAChC,CAAC,YAAY,EAAE,EAAE,CACf,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,YAAY,CAAC;gBACnD,CAAC,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,YAAY,CAAC,CACtD,CAAC;YACF,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,CAC5B,CAAC,YAAY,EAAE,EAAE,CACf,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,YAAY,CAAC;gBACnD,CAAC,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,YAAY,CAAC;gBACpD,CAAC,IAAI,CAAC,kBAAkB,CAAC,WAAW,EAAE,YAAY,CAAC,CACtD,CAAC;YACF,OAAO;gBACL,MAAM;gBACN,UAAU;gBACV,MAAM;aACP,CAAC;QACJ,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEa,+BAA+B,CAC3C,SAAoB,EACpB,QAAiB,EACjB,QAAe,EACf,MAAa,EACb,aAA6B;;YAE7B,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,YAAY,kEAAS,CAAC,SAAS,CAAC,WAAW,EAC3C,SAAS,CACV,CAAC;YACF,MAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAC7D,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;YAC3D,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,MAAM,GAAG,GACP,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;gBAC/B,gBAAgB,QAAQ,EAAE;gBAC1B,IAAI,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,2EAAoC,CAAC,EAAE;gBACjE,IAAI,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,2EAAoC,CAAC,EAAE,CAAC;YAClE,IAAI;gBACF,MAAM,cAAc,GAAG,MAAM,+EAAmB,CAC9C,IAAI,CAAC,UAAU,CAAC,GAAG,CAAsB,GAAG,CAAC,EAC7C,aAAa,EACb,KAAK,CACN,CAAC;gBACF,MAAM,OAAO,GAAG,IAAI,CAAC,uBAAuB,CAC1C,cAAc,EACd,SAAS,EACT,QAAQ,EACR,6CAAM,EAAE,CACT,CAAC;gBACF,IAAI,CAAC,oBAAoB,CAAC,SAAS,EAAE,QAAQ,EAAE,OAAO,CAAC,CAAC;gBACxD,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CACzC,UAAU,EACV,OAAO,CAAC,MAAM,EACd,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,EACvB,IAAI,IAAI,EAAE,CACX,CAAC;gBACF,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;aACjD;YAAC,OAAO,GAAG,EAAE;gBACZ,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;aAClE;QACH,CAAC;KAAA;IAED,oBAAoB,CAAC,QAAkB,EAAE,UAAoB;QAC3D,IAAI,6CAAM,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,EAAE;YACxE,OAAO,IAAI,CAAC;SACb;QACD,IACE,6CAAM,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC;YACnE,UAAU,CAAC,YAAY,GAAG,QAAQ,CAAC,YAAY,EAC/C;YACA,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,mBAAmB,CAAC,cAAmC;QACrD,MAAM,SAAS,GAAG,IAAI,GAAG,EAA+B,CAAC;QACzD,KAAK,MAAM,IAAI,IAAI,cAAc,EAAE;YACjC,MAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YACvC,MAAM,UAAU,GAAG,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAC3C,IAAI,CAAC,UAAU,EAAE;gBACf,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;aACjC;iBAAM;gBACL,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACvB;SACF;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED,eAAe,CACb,cAA4D;QAE5D,MAAM,aAAa,GAAG,IAAI,GAAG,EAG1B,CAAC;QACJ,KAAK,MAAM,IAAI,IAAI,cAAc,EAAE;YACjC,MAAM,GAAG,GAAG,6CAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,WAAW,EAAE,CAAC;YACtE,MAAM,UAAU,GAAG,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;YAC1C,IAAI,CAAC,UAAU,EAAE;gBACf,aAAa,CAAC,GAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;aAChC;iBAAM;gBACL,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;aACvB;SACF;QACD,OAAO,aAAa,CAAC;IACvB,CAAC;IAED,kCAAkC,CAChC,cAA4D;QAE5D,MAAM,YAAY,GAAG,IAAI,GAAG,EAAoB,CAAC;QACjD,KAAK,MAAM,IAAI,IAAI,cAAc,EAAE;YACjC,MAAM,OAAO,GAAG,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YACnD,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,EAAE;gBAChE,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;aAClD;SACF;QACD,OAAO,YAAY,CAAC;IACtB,CAAC;IAED,sBAAsB,CACpB,cAA4D;QAE5D,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,EAAE,CACzE,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,CACtC,CAAC;IACJ,CAAC;IAED,yBAAyB,CACvB,cAA4D;QAE5D,MAAM,qBAAqB,GAAG,IAAI,CAAC,kCAAkC,CACnE,cAAc,CACf,CAAC;QACF,MAAM,0BAA0B,GAAG,KAAK,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC,GAAG,CACtE,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,KAAK,CACtB,CAAC;QACF,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAClB,GAAG,0BAA0B,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC,CACzD,CAAC;QACF,OAAO,0BAA0B,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,YAAY,KAAK,GAAG,CAAC,CAAC;IACxE,CAAC;IAED,uBAAuB,CACrB,cAAmC,EACnC,SAAoB,EACpB,QAAiB,EACjB,GAAkB;QAElB,MAAM,YAAY,GAAG,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC,CAAC;QAC9D,OAAO,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,EAAE,EAAE,CAAC,CAAC;YACrD,EAAE,EAAE,GAAG,GAAG,IAAI,SAAS,EAAE;YACzB,QAAQ,EAAE,GAAG;YACb,UAAU,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI;YACvC,QAAQ,EAAE,CAAC,GAAG,CAAC;YACf,SAAS;YACT,QAAQ,EAAE,IAAI,CAAC,sBAAsB,CACnC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;gBAChB,WAAW,EAAE,CAAC,CAAC,qBAAqB;gBACpC,OAAO,EAAE;oBACP,QAAQ;oBACR,QAAQ,EAAE,CAAC,CAAC,QAAQ;oBACpB,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC;oBACpC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC;oBAChC,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,WAAW,CAAC;oBACxC,YAAY,EAAE,QAAQ,CAAC,CAAC,CAAC,aAAa,EAAE,EAAE,CAAC;iBAC5C;aACF,CAAC,CAAC,CACJ;YACD,SAAS,EAAE,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC;SAC7C,CAAC,CAAC,CAAC;IACN,CAAC;IAEa,sBAAsB,CAClC,SAAoB,EACpB,YAA6B;;YAE7B,IAAI;gBACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,cAAc,kEAAS,CAAC,SAAS,CAAC,WAAW,EAC7C,SAAS,EACT,YAAY,CACb,CAAC;gBACF,MAAM,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;gBACvB,MAAM,IAAI,CAAC,eAAe,CAAC,UAAU,CACnC,iEAA2B,EAC3B,YAAY,EACZ,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,EAAE,CAClB,CAAC;gBACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,mBAAmB,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,GAAG,CAAC,OAAO,EAAE,KAAK,EAC5D,SAAS,CACV,CAAC;gBACF,MAAM,IAAI,CAAC,6BAA6B,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC,CAAC,iCAAiC;aACrG;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,mCAAmC,EACnC,GAAG,EACH,+FAAgB,EAChB,SAAS,CACV,CAAC;aACH;QACH,CAAC;KAAA;IAEO,oBAAoB,CAAC,QAAiB;QAC5C,OAAO,QAAQ,KAAK,mEAAU,CAAC,CAAC,CAAC,mEAAU,CAAC,CAAC,CAAC,mEAAU,CAAC;IAC3D,CAAC;IAEa,uBAAuB,CACnC,QAAiB,EACjB,QAAe,EACf,MAAa,EACb,aAA6B;;YAE7B,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,6BAA6B,EAAE,SAAS,CAAC,CAAC;YACpE,IAAI,SAAS,GAAG,KAAK,CAAC;YACtB,IAAI,aAAa,EAAE;gBACjB,aAAa,CAAC,IAAI,CAAC,GAAG,EAAE;oBACtB,SAAS,GAAG,IAAI,CAAC;gBACnB,CAAC,CAAC,CAAC;aACJ;YACD,MAAM,aAAa,GAAG,wCAAI,CAAC;YAC3B,MAAM,SAAS,GAAG,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAC7D,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,uEAAc,EAAE,QAAQ,CAAC,CAAC;YAChE,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,MAAM,GAAG,GACP,GAAG,IAAI,CAAC,UAAU,CAAC,uEAAc,CAAC,EAAE;gBACpC,yBAAyB,QAAQ,EAAE;gBACnC,IAAI,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,2EAAoC,CAAC,EAAE;gBACjE,IAAI,SAAS,CAAC,EAAE,CAAC,MAAM,CAAC,2EAAoC,CAAC,EAAE,CAAC;YAClE,IAAI;gBACF,MAAM,cAAc,GAAG,MAAM,+EAAmB,CAC9C,IAAI,CAAC,UAAU,CAAC,GAAG,CAA+B,GAAG,CAAC,EACtD,aAAa,EACb,KAAK,CACN,CAAC;gBACF,IAAI,CAAC,SAAS,EAAE;oBACd,MAAM,YAAY,GAAoB,cAAc,CAAC,GAAG,CACtD,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;wBAClB,EAAE,EAAE,GAAG,MAAM,CAAC,EAAE,IAAI,uEAAc,EAAE;wBACpC,QAAQ,EAAE,MAAM,CAAC,EAAE,CAAC,QAAQ,EAAE;wBAC9B,UAAU,EAAE,MAAM,CAAC,IAAI;wBACvB,UAAU,EAAE,MAAM,CAAC,QAAQ;wBAC3B,SAAS,EAAE,uEAAc;wBACzB,QAAQ,EAAE,EAAE;wBACZ,QAAQ,EAAE,MAAM,CAAC,oBAAoB,CAAC,GAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CAC1D,IAAI,CAAC,gCAAgC,CAAC,QAAQ,EAAE,aAAa,CAAC,CAC/D;wBACD,SAAS,EAAE,KAAK;qBACjB,CAAC,CACH,CAAC;oBACF,IAAI,CAAC,oBAAoB,CAAC,uEAAc,EAAE,QAAQ,EAAE,YAAY,CAAC,CAAC;oBAClE,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CACzC,UAAU,EACV,YAAY,CAAC,MAAM,EACnB,SAAS,CAAC,IAAI,CAAC,MAAM,EAAE,EACvB,IAAI,IAAI,EAAE,CACX,CAAC;oBACF,IAAI,CAAC,sBAAsB,CAAC,uEAAc,EAAE,YAAY,CAAC,CAAC;iBAC3D;qBAAM;oBACL,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CACrC,UAAU,EACV,qBAAqB,CACtB,CAAC;iBACH;aACF;YAAC,OAAO,GAAG,EAAE;gBACZ,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;aAClE;QACH,CAAC;KAAA;IAEO,gCAAgC,CACtC,QAAiB,EACjB,aAAsC;QAEtC,OAAO;YACL,YAAY,EAAE,QAAQ,CAAC,aAAa,CAAC,WAAW,EAAE,EAAE,CAAC;YACrD,WAAW,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,CAAC;YACpD,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,SAAS,CAAC;YAChD,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,OAAO,CAAC;YAC5C,QAAQ,EAAE,aAAa,CAAC,QAAQ;YAChC,QAAQ;YACR,gBAAgB,EACd,aAAa,CAAC,gBAAgB;gBAC9B,CAAC,QAAQ,KAAK,mEAAU,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC;gBACnD,CAAC,CAAC,aAAa,CAAC,gBAAgB;gBAChC,CAAC,CAAC,IAAI;SACX,CAAC;IACJ,CAAC;IAEa,6BAA6B,CACzC,SAAoB,EACpB,OAAwB;;YAExB,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACtB,MAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;gBACrC,MAAM,YAAY,GAAG,MAAM,qDAAI,CAAC,iEAA2B,CAAC;qBACzD,KAAK,CAAC,QAAQ,CAAC;qBACf,KAAK,CACJ,CAAC,MAAqB,EAAE,EAAE,CACxB,MAAM,CAAC,SAAS,KAAK,SAAS,IAAI,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,CAC/D;qBACA,IAAI,EAAE,CAAC;gBACV,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,sCAAsC,EACtC,SAAS,EACT,YAAY,CACb,CAAC;aACH;QACH,CAAC;KAAA;IAEa,iBAAiB,CAAC,QAAiB;;YAC/C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;YAC9D,MAAM,SAAS,GAAG,sEAAa,CAAC;YAChC,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;YAC3D,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,IAAI;gBACF,MAAM,GAAG,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;gBACvC,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;gBACrD,MAAM,YAAY,GAAoB,MAAM,CAAC,eAAe,CAAC,GAAG,CAC9D,CAAC,MAAM,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;oBAClB,EAAE,EAAE,GAAG,MAAM,CAAC,IAAI,IAAI,SAAS,EAAE;oBACjC,QAAQ,EAAE,MAAM,CAAC,IAAI;oBACrB,UAAU,EAAE,MAAM,CAAC,IAAI;oBACvB,QAAQ,EAAE,MAAM,CAAC,QAAQ;oBACzB,GAAG,EAAE,MAAM,CAAC,GAAG;oBACf,SAAS,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC;oBACzC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC;oBACrC,SAAS;oBACT,QAAQ,EAAE,EAAE;oBACZ,SAAS,EAAE,KAAK;iBACjB,CAAC,CACH,CAAC;gBACF,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,+BAA+B,EAC/B,SAAS,EACT,YAAY,CACb,CAAC;gBAEF,IAAI,CAAC,oBAAoB,CAAC,SAAS,EAAE,QAAQ,EAAE,YAAY,CAAC,CAAC;gBAC7D,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CACzC,UAAU,EACV,YAAY,CAAC,MAAM,EACnB,IAAI,EACJ,IAAI,CACL,CAAC;gBACF,IAAI,CAAC,sBAAsB,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;aACtD;YAAC,OAAO,GAAG,EAAE;gBACZ,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;aAClE;QACH,CAAC;KAAA;IAEO,qBAAqB,CAAC,GAAW;QACvC,IACE,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;YAC1B,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,EACxD;YACA,OAAO,IAAI,CAAC,2BAA2B,CAAC,GAAG,CAAC,CAAC;SAC9C;aAAM;YACL,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,4BAA4B,EAAE,CAAC,CAAC;SAC7D;IACH,CAAC;IAEa,2BAA2B,CACvC,GAAW;;YAEX,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,MAAM,CAAC,CAAC;YAC1C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CACtC,GAAG,EACH,EAAE,EACF;gBACE,cAAc,EAAE,kBAAkB;aACnC,CACF,CAAC;YACF,IAAI,MAAM,CAAC,MAAM,KAAK,GAAG,EAAE;gBACzB,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC;aACvC;iBAAM;gBACL,MAAM,KAAK,CACT,qCAAqC,GAAG,aAAa,MAAM,CAAC,MAAM,cAAc,MAAM,CAAC,KAAK,EAAE,CAC/F,CAAC;aACH;QACH,CAAC;KAAA;IAEO,4BAA4B;QAClC,iGAAiG;QACjG,OAAO,mBAAO,CAAC,8DAAmD,CAAC,CAAC;IACtE,CAAC;IAEO,OAAO,CAAC,UAAkB;QAChC,OAAO,gDAAS,CAAC,UAAU,EAAE,yEAAkC,CAAC,CAAC,MAAM,EAAE,CAAC;IAC5E,CAAC;IAEO,UAAU,CAAC,SAAoB;QACrC,OAAO,gEAAyB,CAAC,kEAAS,CAAC,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC;IAChE,CAAC;IAEO,mBAAmB,CAAC,QAAe,EAAE,MAAa;QACxD,MAAM,UAAU,GAAG,QAAQ,CAAC,CAAC,CAAC,6CAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,6CAAM,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QACzE,gFAAgF;QAChF,MAAM,QAAQ,GAAG,MAAM;YACrB,CAAC,CAAC,6CAAM,CAAC,MAAM,CAAC;YAChB,CAAC,CAAC,6CAAM,EAAE;iBACP,KAAK,CAAC,KAAK,CAAC;iBACZ,GAAG,CAAC,wFAAiD,EAAE,MAAM,CAAC,CAAC;QACpE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,EAAE,QAAQ,EAAE,CAAC;IAC5C,CAAC;;4EA91BU,cAAc;gHAAd,cAAc,WAAd,cAAc,mBAFb,MAAM;;;;;;;;;;;;;;;;;ACxCmB;AAGhC,SAAS,oBAAoB,CAClC,gBAAkC,EAClC,kBAAsC;IAEtC,OAAO,GAAG,EAAE;QACV,gBAAgB,CAAC,QAAQ,CACvB,+EAAwC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CACxD,CAAC;QACF,gBAAgB,CAAC,cAAc,CAAC,qEAA8B,CAAC,CAAC;QAChE,kBAAkB,CAAC,IAAI,EAAE,CAAC;IAC5B,CAAC,CAAC;AACJ,CAAC;;;;;;;;;;;;;;;;;;;ACVsB;AACuC;;AAgBvD,MAAM,eAAe;IAC1B,MAAM,CAAC,OAAO;QACZ,OAAO;YACL,QAAQ,EAAE,eAAe;SAC1B,CAAC;IACJ,CAAC;;8EALU,eAAe;4GAAf,eAAe;iHAVf;QACT,uEAAe;QACf;YACE,OAAO,EAAE,0DAAe;YACxB,UAAU,EAAE,yBAAyB;YACrC,KAAK,EAAE,IAAI;YACX,IAAI,EAAE,CAAC,uEAAe,CAAC;SACxB;KACF,YAXQ,EAAE;AAqBN,SAAS,yBAAyB,CAAC,eAAgC;IACxE,OAAO,GAAG,EAAE,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC;AACtC,CAAC;;;;;;;;;;;;;;;;AChCD,IAAY,kBAUX;AAVD,WAAY,kBAAkB;IAC5B,yCAAmB;IACnB,+CAAyB;IACzB,6CAAuB;IACvB,4CAAsB;IACtB,8CAAwB;IACxB,+CAAyB;IACzB,kDAA4B;IAC5B,4CAAsB;IACtB,qDAA+B;AACjC,CAAC,EAVW,kBAAkB,KAAlB,kBAAkB,QAU7B;;;;;;;;;;;;;;;;ACVD,IAAY,cAGX;AAHD,WAAY,cAAc;IACxB,iCAAe;IACf,iCAAe;AACjB,CAAC,EAHW,cAAc,KAAd,cAAc,QAGzB;;;;;;;;;;;;;;;;ACHD,IAAY,gBAGX;AAHD,WAAY,gBAAgB;IAC1B,iDAA6B;IAC7B,yCAAqB;AACvB,CAAC,EAHW,gBAAgB,KAAhB,gBAAgB,QAG3B;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHoD;AACG;AACW;AACnB;AAC0C;AACN;AACjB;AACwB;AAIT;;;;AAElF,MAAM,SAAS,GAAG,iBAAiB,CAAC;AAI7B,MAAM,eAAe;IAK1B,YACU,QAAkB,EAClB,cAA8B,EAC9B,iBAAoC;QAFpC,aAAQ,GAAR,QAAQ,CAAU;QAClB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,sBAAiB,GAAjB,iBAAiB,CAAmB;IAC3C,CAAC;IARJ,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,mDAAM,CAAC,CAAC;IACnC,CAAC;IAQD,SAAS,CAAC,GAAW;QACnB,IAAI,EAAE,EAAE;YACN,MAAM,OAAO,GAAG,2FAAuB,CAAC,GAAG,CAAC,CAAC;YAC7C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,qBAAqB,OAAO,EAAE,EAAE,SAAS,CAAC,CAAC;YACrE,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC;YACvB,EAAE,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;SACxB;IACH,CAAC;IAED,cAAc,CACZ,SAA6B,EAC7B,KAAgC;QAEhC,IAAI,EAAE,EAAE;YACN,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,sBAAsB,SAAS,KAAK,KAAK,EAAE,EAC3C,SAAS,CACV,CAAC;YACF,EAAE,CAAC,KAAK,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;YAC5B,EAAE,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;SACxB;IACH,CAAC;IAED,UAAU,CACR,aAA+B,EAC/B,WAA2B,EAC3B,UAAmB,EACnB,UAAmB;QAEnB,IAAI,EAAE,EAAE;YACN,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,gCAAgC,aAAa,iBAAiB,WAAW,GAAG;gBAC1E,eAAe,UAAU,IAAI,EAAE,iBAAiB,UAAU,IAAI,EAAE,EAAE,EACpE,SAAS,CACV,CAAC;YACF,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE;gBAClB,aAAa;gBACb,WAAW;gBACX,UAAU;gBACV,UAAU;aACX,CAAC,CAAC;SACJ;IACH,CAAC;IAED,OAAO;QACL,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,0BAA0B,EAAE,SAAS,CAAC,CAAC;QACjE,MAAM,CAAC,cAAc,yEAAkC,EAAE,CAAC,GAAG,IAAI,CAAC;IACpE,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,2BACE,6EAAsB;YACpB,CAAC,CAAC,EAAE;YACJ,CAAC,CAAC,mDACN,EAAE,EACF,SAAS,CACV,CAAC;QACF,IAAI,6EAAsB,EAAE;YAC1B,MAAM,CAAC,cAAc,yEAAkC,EAAE,CAAC,GAAG,KAAK,CAAC;SACpE;IACH,CAAC;IAED,IAAI;QACF,IAAI,CAAC,EAAE,EAAE;YACP,IAAI,CAAC,cAAc,CAAC,GAAG,CACrB,wEAAwE,EACxE,IAAI,EACJ,8FAAgB,EAChB,SAAS,CACV,CAAC;YACF,OAAO;SACR;QACD,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,yBACE,6EAAsB;YACpB,CAAC,CAAC,EAAE;YACJ,CAAC,CAAC,mDACN,EAAE,EACF,SAAS,CACV,CAAC;QACF,IAAI,CAAC,6EAAsB,EAAE;YAC3B,iDAAiD;YACjD,IAAI,CAAC,OAAO,EAAE,CAAC;SAChB;QAED,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,wBAAwB,EAAE,SAAS,CAAC,CAAC;QAC/D,IAAI,MAAM,CAAC,YAAY,EAAE;YACvB,EAAE,CAAC,QAAQ,EAAE,yEAAkC,EAAE,MAAM,EAAE;gBACvD,OAAO,EAAE,MAAM;gBACf,QAAQ,EAAE,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,CAAC;aACrD,CAAC,CAAC;YACH,EAAE,CAAC,KAAK,EAAE,mBAAmB,EAAE,IAAI,CAAC,CAAC;YACrC,EAAE,CAAC,UAAU,OAAO;gBAClB,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,aAAa,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YACtE,CAAC,CAAC,CAAC;SACJ;aAAM;YACL,EAAE,CAAC,QAAQ,EAAE,yEAAkC,EAAE,MAAM,CAAC,CAAC;SAC1D;QAED,MAAM,UAAU,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;QAC1D,EAAE,CAAC,KAAK,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;QAChC,EAAE,CAAC,KAAK,EAAE,aAAa,EAAE,2EAAoC,CAAC,CAAC;QAC/D,EAAE,CAAC,KAAK,EAAE,YAAY,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC;QAC5C,EAAE,CAAC,MAAM,EAAE,UAAU,CAAC,CAAC;QAEvB,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAC9B,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,kCAAkC,EAAE,SAAS,CAAC,CAAC;IAC3E,CAAC;IAEO,sBAAsB;QAC5B,IAAI,CAAC,MAAM,CAAC,MAAM;aACf,IAAI,CAAC,sDAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,YAAY,0DAAa,CAAC,CAAC;aACvD,IAAI,CACH,mDAAG,CAAC,CAAC,GAAkB,EAAE,EAAE,CAAC,GAAG,CAAC,iBAAiB,CAAC,EAClD,oEAAoB,EAAE,CACvB;aACA,SAAS,CAAC,CAAC,GAAW,EAAE,EAAE;YACzB,MAAM,OAAO,GAAG,2FAAuB,CAAC,GAAG,CAAC,CAAC;YAC7C,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;;8EApIU,eAAe;iHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;ACdmC;;;AAEvD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,eAAe;QACrB,YAAY,EAAE,GAAG,EAAE,CACjB,sNAAoD,CAAC,IAAI,CACvD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAChC;KACJ;IACD,6IAA6I;CAC9I,CAAC;AAMK,MAAM,iBAAiB;;kFAAjB,iBAAiB;8GAAjB,iBAAiB;kHAHnB,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC,EAC9B,yDAAY;mIAEX,iBAAiB,oFAFlB,yDAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChByB;AACF;AACa;AACF;AACL;AACE;AACb;AACa;AACL;AACW;AAC8B;AAC5B;;AAkCxD,MAAM,UAAU;;oEAAV,UAAU;uGAAV,UAAU;4GA7BV;QACT;YACE,OAAO,EAAE,2DAAc;YACvB,UAAU,EAAE,sEAAc;YAC1B,IAAI,EAAE,CAAC,oDAAQ,CAAC;SACjB;QACD;YACE,OAAO,EAAE,sDAAS;YAClB,UAAU,EAAE,gEAAW;YACvB,IAAI,EAAE,CAAC,oDAAQ,EAAE,6DAAU,CAAC;SAC7B;QACD;YACE,OAAO,EAAE,kDAAO;YAChB,QAAQ,EAAE,yEAAgB;SAC3B;QACD;YACE,OAAO,EAAE,sDAAW;YACpB,UAAU,EAAE,gEAAW;YACvB,IAAI,EAAE;gBACJ,oDAAQ;gBACR,iDAAM;gBACN,sDAAS;gBACT,kDAAO;gBACP,2DAAc;gBACd,gGAAkB;aACnB;SACF;KACF,YA5BQ,CAAC,0DAAY,EAAE,mEAAiB,CAAC;mIA8B/B,UAAU,cA9BX,0DAAY,EAAE,mEAAiB;;;;;;;;;;;;;;;;;;;ACVK;AAEqC;AAE9E,MAAM,kBAAkB,GAAG,eAAe,CAAC;AAE3C,MAAM,WAAW,GAAG,CACzB,QAAkB,EAClB,MAAc,EACd,SAAoB,EACpB,OAAgB,EAChB,OAAuB,EACvB,kBAAsC,EACzB,EAAE;IACf,MAAM,WAAW,GAAG,IAAI,6FAAyB,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;IAC/E,kBAAkB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAgB,EAAE,EAAE;QACzD,WAAW,CAAC,UAAU,GAAG,0DAAmB,CAAC,OAAO,CAAC,CAAC;QACtD,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,EAAE;YAC3B,MAAM,GAAG,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,MAAM,IAAI,kBAAkB,EAAE,CAAC;YAC9D,WAAW,CAAC,UAAU,CAAC,YAAY,GAAG,GAAG,CAAC;YAC1C,WAAW,CAAC,UAAU,CAAC,wBAAwB,GAAG,GAAG,CAAC;SACvD;IACH,CAAC,CAAC,CAAC;IACH,OAAO,WAAW,CAAC;AACrB,CAAC,CAAC;;;;;;;;;;;;;;;;;AC3BF,gEAAgE;AACb;AAE5C,MAAM,WAAW,GAAG,CAAC,QAAkB,EAAE,UAAsB,EAAE,EAAE;IACxE,0FAA0F;IAC1F,OAAO,IAAI,2DAAa,CAAC,UAAU,CAAC,CAAC,CAAC,yDAAyD;AACjG,CAAC,CAAC;;;;;;;;;;;;;;;;;;ACPF,oEAAoE;AACpE,kEAAkE;AACZ;AAE/C,MAAM,cAAc,GAAG,CAAC,QAAkB,EAAE,EAAE;IACnD,OAAO,IAAI,gEAAmB,EAAE,CAAC;IACjC,uFAAuF;AACzF,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;ACN6D;;;AAMxD,MAAM,aAAa;IACxB,YAAoB,IAAgB;QAAhB,SAAI,GAAJ,IAAI,CAAY;IAAG,CAAC;IAE3B,GAAG,CAAI,QAAqB;;YACvC,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;gBACpB,QAAQ,CAAC,MAAM,GAAG,KAAK,CAAC;aACzB;YAED,QAAQ,QAAQ,CAAC,MAAM,EAAE;gBACzB,KAAK,KAAK;oBACR,OAAO,IAAI,CAAC,IAAI;yBACb,GAAG,CAAI,QAAQ,CAAC,GAAG,EAAE,EAAE,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC;yBACpE,SAAS,EAAE,CAAC;gBACjB,KAAK,MAAM;oBACT,OAAO,IAAI,CAAC,IAAI;yBACb,IAAI,CAAI,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,IAAI,EAAE;wBACpC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC;qBAC3C,CAAC;yBACD,SAAS,EAAE,CAAC;gBACjB,KAAK,KAAK;oBACR,OAAO,IAAI,CAAC,IAAI;yBACb,GAAG,CAAI,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,IAAI,EAAE;wBACnC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC;qBAC3C,CAAC;yBACD,SAAS,EAAE,CAAC;gBACjB,KAAK,QAAQ;oBACX,OAAO,IAAI,CAAC,IAAI;yBACb,MAAM,CAAI,QAAQ,CAAC,GAAG,EAAE;wBACvB,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,OAAO,CAAC;qBAC3C,CAAC;yBACD,SAAS,EAAE,CAAC;aAChB;QACH,CAAC;KAAA;IAEO,UAAU,CAAC,OAAY;QAC7B,IAAI,WAAW,GAAgB,IAAI,6DAAW,EAAE,CAAC;QAEjD,IAAI,OAAO,KAAK,SAAS,EAAE;YACzB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;gBACnC,WAAW,GAAG,WAAW,CAAC,MAAM,CAAC,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;YACtD,CAAC,CAAC,CAAC;SACJ;QAED,OAAO,WAAW,CAAC;IACrB,CAAC;;0EA5CU,aAAa;8GAAb,aAAa,WAAb,aAAa,mBAFZ,MAAM;;;;;;;;;;;;;;;;;;;;;;;;ACNqC;AACyC;AACV;AACwB;AACtD;AAE1D;;;;GAIG;AACI,MAAM,yBAA0B,SAAQ,sDAAW;IACxD,YACY,UAAmB,IAAI,yDAAc,EAAE,EACvC,UAA0B,IAAI,gEAAmB,EAAE,EACnD,YAAuB,IAAI,4DAAe,EAAE;QAEtD,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC,CAAC;QAJzB,YAAO,GAAP,OAAO,CAAgC;QACvC,YAAO,GAAP,OAAO,CAA4C;QACnD,cAAS,GAAT,SAAS,CAAmC;IAGxD,CAAC;IAEe,kBAAkB,CAAC,IAAY,EAAE,YAAqB;;;;;;YACpE,IAAI;gBACF,MAAM,OAAM,kBAAkB,YAAC,IAAI,EAAE,YAAY,CAAC,CAAC;aACpD;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,gBAAG,CAAC,KAAK,0CAAE,iBAAiB,0CAAE,OAAO,CAAC,aAAa,CAAC,KAAI,CAAC,EAAE;oBAC7D,IAAI,CAAC,mBAAmB,CAAC,0EAA+B,CAAC,IAAI,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;oBACpF,wDAAwD;oBACxD,uFAAuF;iBACxF;qBAAM;oBACL,IAAI,CAAC,mBAAmB,CAAC,0EAA+B,CAAC,GAAG,CAAC,CAAC,CAAC;iBAChE;aACF;;KACF;IAED;;;OAGG;IACU,YAAY;;;;;YACvB,MAAM,OAAM,mBAAmB,YAAG,KAAK,CAAC,CAAC,KAAK,EAAE,EAAE;gBAChD,IAAI,CAAC,kCAAkC,CAAC,KAAK,CAAC,CAAC;YACjD,CAAC,CAAC,CAAC;QACL,CAAC;KAAA;IAEa,kCAAkC,CAAC,KAAc;;YAC7D,IAAI,KAAK,IAAI,KAAK,YAAY,mEAAiB,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,IAAI,KAAK,CAAC,MAAM,KAAK,GAAG,EAAE;gBAC/F,sHAAsH;gBACtH,MAAM,uBAAuB,GAAkB,MAAM,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,sGAAuB,CAAC,CAAC;gBACnG,IAAI,uBAAuB,IAAI,IAAI,EAAE;oBACnC,MAAM,iBAAiB,GAAG,IAAI,mEAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,CAAC,CAAC;oBACrF,IAAI,iBAAiB,CAAC,mBAAmB,EAAE,EAAE;wBAC3C,OAAO,CAAC,kEAAkE;qBAC3E;iBACF;aACF;YACD,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,iGAAkB,CAAC,CAAC;YAClD,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,sGAAuB,CAAC,CAAC;YACvD,IAAI,CAAC,mBAAmB,CAAC,0EAA+B,CAAC,KAAK,CAAC,CAAC,CAAC;QACnE,CAAC;KAAA;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1DwC;AACiC;AACnB;AACE;AACkD;AACX;AAC3C;AACyC;AAEK;AACpB;AACpC;AACoB;AACa;;;;;;;;;;;AAE5E,MAAM,SAAS,GAAG,mBAAmB,CAAC;AAC/B,MAAM,cAAc,GAAG,eAAe,CAAC;AACvC,MAAM,kBAAkB,GAAG,gBAAgB,CAAC;AAC5C,MAAM,uBAAuB,GAAG,qBAAqB,CAAC;AAKtD,MAAM,iBAAiB;IAY5B,YACU,WAAwB,EACxB,kBAAsC,EACtC,MAAsB,EACtB,gBAAkC,EAClC,eAAgC,EAChC,MAAc,EACd,OAAsB,EACtB,QAAkB,EAClB,cAA8B,EAC9B,OAAuB,EACvB,QAAkB,EAClB,UAA0B;QAX1B,gBAAW,GAAX,WAAW,CAAa;QACxB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,WAAM,GAAN,MAAM,CAAgB;QACtB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QAChC,WAAM,GAAN,MAAM,CAAQ;QACd,YAAO,GAAP,OAAO,CAAe;QACtB,aAAQ,GAAR,QAAQ,CAAU;QAClB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,YAAO,GAAP,OAAO,CAAgB;QACvB,aAAQ,GAAR,QAAQ,CAAU;QAClB,eAAU,GAAV,UAAU,CAAgB;QAvB5B,wBAAmB,GAAG,IAAI,iDAAe,CAAU,KAAK,CAAC,CAAC;QAC1D,sBAAiB,GAAG,IAAI,+CAAa,EAAc,CAAC;QAwB1D,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,IAAI,CACtD,sDAAM,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,EAClC,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,mBAAmB,EAAE,CAAC;QAEhD,MAAM,OAAO,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,yDAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;QAEnF,OAAO;aACJ,IAAI,CAAC,sDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,KAAK,mEAAwB,IAAI,MAAM,CAAC,KAAK,KAAK,sBAAsB,CAAC,CAAC;aAC/G,SAAS,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;QAEnE,OAAO;aACJ,IAAI,CAAC,sDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,KAAK,oEAAyB,IAAI,MAAM,CAAC,KAAK,KAAK,aAAa,CAAC,CAAC;aACvG,SAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,oFAAoF;QAE5H,OAAO,CAAC,IAAI,CAAC,sDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,KAAK,oEAAyB,CAAC,CAAC,CAAC,SAAS,CAAC,GAAS,EAAE,CAAC;YAClG,MAAM,IAAI,CAAC,mBAAmB,EAAE,CAAC;YACjC,MAAM,IAAI,CAAC,2BAA2B,EAAE,CAAC;QAC3C,CAAC,EAAC,CAAC;QAEH,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE;YAC5D,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,gGAAgG;QACjH,CAAC,CAAC,CAAC;QAEH,qEAAqE;QACrE,gFAAgF;QAChF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CACxC,yDAAS,CAAC,CAAC,YAAY,EAAE,EAAE;YACzB,IAAI,YAAY,CAAC,UAAU,EAAE;gBAC3B,OAAO,IAAI,CAAC,UAAU,CAAC,oBAAoB,EAAE,CAAC;aAC/C;iBAAM;gBACL,OAAO,yCAAE,CAAC,SAAS,CAAC,CAAC;aACtB;QACH,CAAC,CAAC,EACF,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QAEF,IAAI,CAAC,yBAAyB,EAAE,CAAC;IACnC,CAAC;IA1DD,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,mBAAmB,CAAC,YAAY,EAAE,CAAC;IACjD,CAAC;IA0DO,mBAAmB;QACzB,MAAM,gBAAgB,GAAG,IAAI,CAAC,sBAAsB,EAAE,CAAC;QACvD,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAC5B,yDAAS,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC,EACjC,oDAAG,CAAC,CAAC,uBAAuB,EAAE,EAAE;;YAC9B,MAAM,aAAa,GAAG,uBAAuB,CAAC,aAAa,CAAC;YAC5D,MAAM,QAAQ,GAAG,6BAAuB,CAAC,aAAa,0CAAE,QAAQ,CAAC;YACjE,MAAM,YAAY,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YACtE,MAAM,QAAQ,GAAG,cAAa,aAAb,aAAa,uBAAb,aAAa,CAAE,OAAO,EAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,UAAU,CAAC;YAC5D,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,QAAQ,gBAAgB,YAAY,EAAE,EAAE,SAAS,CAAC,CAAC;QACjF,CAAC,CAAC,EACF,oDAAG,CAAC,CAAC,uBAAuB,EAAE,EAAE;;YAAC,QAAC;gBAChC,UAAU,EAAE,wBAAuB,aAAvB,uBAAuB,uBAAvB,uBAAuB,CAAE,aAAa,KAAI,IAAI;gBAC1D,KAAK,EAAE,6BAAuB,aAAvB,uBAAuB,uBAAvB,uBAAuB,CAAE,aAAa,0CAAE,OAAO;gBACtD,aAAa,EAAE,6BAAuB,aAAvB,uBAAuB,uBAAvB,uBAAuB,CAAE,aAAa,0CAAE,QAAQ;gBAC/D,KAAK,EAAE,6BAAuB,aAAvB,uBAAuB,uBAAvB,uBAAuB,CAAE,MAAM,0CAAE,KAAK;aAC9C,CAAC;SAAA,CAAC,EACH,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,sBAAsB;QAC5B,OAAO,IAAI,CAAC,aAAa,CAAC,IAAI,CAC5B,yDAAS,CAAC,GAAG,EAAE,CACb,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAC1B,oDAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;YACtB,aAAa;YACb,MAAM,EAAE,cAAa,aAAb,aAAa,uBAAb,aAAa,CAAE,OAAO,EAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,SAAS;SAClF,CAAC,CAAC,CACJ,CACF,CACF,CAAC;IACJ,CAAC;IAEO,yBAAyB;QAC/B,IAAI,CAAC,aAAa;aACf,IAAI,CACH,yDAAS,CAAC,GAAG,EAAE,CAAC,CAAC,0FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,2CAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC,EACrG,+DAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CACnC;aACA,SAAS,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,EAAE,EAAE;YACtB,IAAI,KAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,KAAK,KAAI,IAAI,CAAC,gBAAgB,CAAC,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,aAAa,EAAE,GAAG,CAAC,EAAE;gBAClE,2CAA2C;gBAC3C,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,+BAA+B,EAAE,SAAS,CAAC,CAAC;gBAC9D,IAAI,CAAC,YAAY,EAAE,CAAC;aACrB;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAED,gBAAgB,CAAC,aAAqB,EAAE,YAAoB;QAC1D,OAAO,aAAa,IAAI,aAAa,GAAG,6DAAY,EAAE,GAAG,YAAY,CAAC;IACxE,CAAC;IAEM,YAAY;QACjB,OAAO,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;IACzC,CAAC;IAEM,qBAAqB,CAAC,GAAW;QACtC,IAAI;YACF,IAAI,CAAC,WAAW,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC;SAC7C;QAAC,OAAO,GAAG,EAAE;YACZ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,sCAAsC,CAAC,CAAC;SAC3E;IACH,CAAC;IAEY,MAAM,CAAC,YAAY,GAAG,IAAI;;YACrC,MAAM,WAAW,GAAG,MAAM,qDAAc,CAAC,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;YAC5E,IAAI,YAAY,EAAE;gBAChB,MAAM,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC;gBAC5B,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,wBAAwB,GAAG,GAAG,EAAE,SAAS,CAAC,CAAC;gBAC7D,YAAY,CAAC,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;aAC3C;YACD,IAAI;gBACF,MAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;oBAC5B,UAAU,EAAE,IAAI,CAAC,wBAAwB,CAAC,WAAW,CAAC;oBACtD,MAAM,EAAE,OAAO,CAAC,qBAAqB;iBACtC,CAAC,CAAC;aACJ;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,kBAAkB,CAAC,CAAC;aACvD;QACH,CAAC;KAAA;IAEY,MAAM;;YACjB,MAAM,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;YAClD,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,CAAC;QACxC,CAAC;KAAA;IAEa,2BAA2B;;YACvC,IAAI;gBACF,MAAM,IAAI,GAAG,MAAM,oDAAa,CAAC,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,CAAC,CAAC;gBAC3E,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,EAAE;oBAChD,OAAO;iBACR;gBACD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,iBAAiB,EAAE,CAAC;gBAC5C,MAAM,oDAAa,CAAC,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;aAChF;YAAC,OAAO,GAAG,EAAE;gBACZ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,SAAS,EAAE,qBAAqB,CAAC,CAAC;aAC1D;QACH,CAAC;KAAA;IAEa,iBAAiB;;;YAC7B,MAAM,aAAa,GAAG,2BAA2B,CAAC;YAClD,MAAM,cAAc,GAAG,0BAA0B,CAAC;YAClD,MAAM,SAAS,GAAG,YAAY,CAAC;YAC/B,MAAM,YAAY,GAAG,MAAM,oDAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,aAAa,EAAE,cAAc,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;YAChH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,aAAa,CAAC;gBACnC,OAAO,EAAE,YAAY,CAAC,cAAc,CAAC;gBACrC,eAAe,EAAE,KAAK;gBACtB,MAAM,EAAE;oBACN;wBACE,IAAI,EAAE,MAAM;wBACZ,IAAI,EAAE,MAAM;wBACZ,GAAG,EAAE,EAAE;qBACR;iBACF;gBACD,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,YAAY,CAAC,SAAS,CAAC;wBAC7B,OAAO,EAAE,CAAC,IAAsB,EAAE,EAAE;4BAClC,OAAO,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,IAAI,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;wBACtD,CAAC;qBACF;iBACF;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;YAEhB,MAAM,MAAM,GAAG,CAAC,MAAM,KAAK,CAAC,YAAY,EAAE,CAEzC,CAAC;YACF,OAAO,kBAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,IAAI,0CAAE,MAAM,0CAAE,IAAI,CAAC;;KACnC;IAEM,wBAAwB;QAC7B,OAAO,qDAAc,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAC5C,CAAC;IAEa,mBAAmB;;YAC/B,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,eAAe,CAAC,IAAI,CAAC,EAAE;gBACtD,MAAM,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;gBACvD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,uDAAuD,SAAS,GAAG,EAAE,SAAS,CAAC,CAAC;gBAClG,IAAI,SAAS,EAAE;oBACb,YAAY,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC;oBACxC,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;oBACtF,MAAM,IAAI,CAAC,OAAO,CAAC,eAAe,CAAC,SAAS,CAAC,CAAC;iBAC/C;qBAAM;oBACL,MAAM,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE,CAAC,CAAC;iBACrC;aACF;QACH,CAAC;KAAA;IAEa,gBAAgB,CAAC,MAAc,EAAE,OAAe;;YAC5D,MAAM,IAAI,GAAG,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,CAAC,qBAAqB,CAAC,CAAC,CAAC,eAAe,CAAC;YACrG,MAAM,WAAW,GAAG,SAAS,IAAI,EAAE,CAAC;YACpC,MAAM,YAAY,GAAG,IAAI,KAAK,eAAe,CAAC,CAAC,CAAC,IAAI,OAAO,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;YACnE,MAAM,YAAY,GAAG,MAAM,oDAAa,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,sBAAsB,EAAE,UAAU,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC;YACvH,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,sBAAsB,CAAC;gBAC5C,OAAO,EAAE,GAAG,YAAY,CAAC,WAAW,CAAC,GAAG,YAAY,EAAE;gBACtD,OAAO,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;aACpC,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;KAAA;IAEO,wBAAwB,CAAC,OAAgB;QAC/C,IAAI,OAAO,KAAK,mEAAU,IAAI,OAAO,KAAK,mEAAU,EAAE;YACpD,OAAO,OAAO,CAAC;SAChB;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,QAAQ,CAAC,KAAa;QAC5B,MAAM,SAAS,GAAG,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACtC,MAAM,MAAM,GAAG,SAAS,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;QAC/D,MAAM,WAAW,GAAG,kBAAkB,CACpC,IAAI,CAAC,MAAM,CAAC;aACT,KAAK,CAAC,EAAE,CAAC;aACT,GAAG,CAAC,UAAU,CAAC;YACd,OAAO,GAAG,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/D,CAAC,CAAC;aACD,IAAI,CAAC,EAAE,CAAC,CACZ,CAAC;QACF,OAAO,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;IACjC,CAAC;;kFA3PU,iBAAiB;mHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;;;;AClBK;AAElB,MAAM,kBAAkB,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,qBAAqB;AAM9D,MAAM,iBAAkB,SAAQ,0DAAa;IAclD,YAAY,QAA+B;QACzC,KAAK,CAAC,QAAQ,CAAC,CAAC;QAChB,IAAI,QAAQ,CAAC,wBAAwB,EAAE;YACrC,IAAI,CAAC,qBAAqB,GAAG,QAAQ,CACnC,QAAQ,CAAC,wBAAwB,EACjC,EAAE,CACH,CAAC;SACH;IACH,CAAC;IAED,mBAAmB,CAAC,SAAiB,kBAAkB;QACrD,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,MAAM,GAAG,GAAG,6DAAY,EAAE,CAAC;YAC3B,OAAO,GAAG,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,GAAG,MAAM,CAAC;SACtD;aAAM;YACL,OAAO,IAAI,CAAC;SACb;IACH,CAAC;CACF;;;;;;;;;;;;;;;;ACzCM,MAAM,oBAAoB,GAAkB;IACjD,KAAK,EAAE,4BAA4B;IACnC,WAAW,EAAE,qBAAqB;IAClC,OAAO,EAAE,CAAC;IACV,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,EAAE,EAAE;YACF,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACd;QACD,YAAY,EAAE;YACZ,IAAI,EAAE,QAAQ;SACf;QACD,eAAe,EAAE;YACf,IAAI,EAAE,QAAQ;SACf;QACD,GAAG,EAAE;YACH,IAAI,EAAE,QAAQ;SACf;QACD,IAAI,EAAE;YACJ,IAAI,EAAE,QAAQ;SACf;QACD,KAAK,EAAE,EACN;QACD,QAAQ,EAAE;YACR,IAAI,EAAE,QAAQ;SACf;QACD,YAAY,EAAE;YACZ,IAAI,EAAE,QAAQ;SACf;QACD,kBAAkB,EAAE;YAClB,IAAI,EAAE,QAAQ;SACf;QACD,YAAY,EAAE;YACZ,IAAI,EAAE,QAAQ;SACf;QACD,SAAS,EAAE;YACT,IAAI,EAAE,QAAQ;SACf;QACD,MAAM,EAAE;YACN,IAAI,EAAE,QAAQ;SACf;QACD,OAAO,EAAE;YACP,IAAI,EAAE,QAAQ;SACf;QACD,kBAAkB,EAAE;YAClB,IAAI,EAAE,QAAQ;SACf;QACD,gBAAgB,EAAE,EACjB;KACF;IACD,QAAQ,EAAE,CAAC,IAAI,EAAE,cAAc,EAAE,iBAAiB,CAAC;CACpD,CAAC;;;;;;;;;;;;;;;;ACrDK,MAAM,aAAa,GAAkB;IAC1C,KAAK,EAAE,gBAAgB;IACvB,WAAW,EAAE,sCAAsC;IACnD,OAAO,EAAE,CAAC;IACV,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,EAAE,EAAE;YACF,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACd;QACD,WAAW,EAAE;YACX,IAAI,EAAE,QAAQ;SACf;QACD,IAAI,EAAE;YACJ,IAAI,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAE;SAC3B;KACF;CACF,CAAC;;;;;;;;;;;;;;;;AClBK,MAAM,8BAA8B,GAAkB;IAC3D,KAAK,EAAE,mCAAmC;IAC1C,WAAW,EAAE,4BAA4B;IACzC,OAAO,EAAE,CAAC;IACV,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,EAAE,EAAE;YACF,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACd;QACD,WAAW,EAAE;YACX,IAAI,EAAE,OAAO;YACb,WAAW,EAAE,IAAI;YACjB,KAAK,EAAE;gBACL,IAAI,EAAE,QAAQ;aACf;SACF;QACD,YAAY,EAAE;YACZ,IAAI,EAAE,QAAQ;SACf;QACD,gBAAgB,EAAE;YAChB,IAAI,EAAE,QAAQ;SACf;QACD,MAAM,EAAE;YACN,IAAI,EAAE,OAAO;YACb,KAAK,EAAE;gBACL,IAAI,EAAE,QAAQ;gBACd,UAAU,EAAE;oBACV,EAAE,EAAE;wBACF,IAAI,EAAE,QAAQ;qBACf;oBACD,KAAK,EAAE;wBACL,IAAI,EAAE,QAAQ;qBACf;iBACF;aACF;SACF;KACF;IACD,QAAQ,EAAE,CAAC,IAAI,CAAC;CACjB,CAAC;;;;;;;;;;;;;;;;AC1CK,MAAM,kBAAkB,GAAiB;IAC9C,KAAK,EAAE,qBAAqB;IAC5B,WAAW,EAAE,eAAe;IAC5B,OAAO,EAAE,CAAC;IACV,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,EAAE,EAAE;YACF,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACd;QACD,OAAO,EAAE;YACP,IAAI,EAAE,QAAQ;SACf;QACD,SAAS,EAAE;YACT,IAAI,EAAE,QAAQ;SACf;QACD,UAAU,EAAE;YACV,IAAI,EAAE,QAAQ;SACf;QACD,QAAQ,EAAE;YACR,IAAI,EAAE,QAAQ;SACf;QACD,SAAS,EAAE;YACT,IAAI,EAAE,QAAQ;SACf;QACD,cAAc,EAAE;YACd,IAAI,EAAE,QAAQ;SACf;QACD,OAAO,EAAE;YACP,IAAI,EAAE,QAAQ;YACd,UAAU,EAAE,EAAE;SACf;QACD,QAAQ,EAAE;YACR,IAAI,EAAE,QAAQ;YACd,UAAU,EAAE,EAAE;SACf;QACD,sBAAsB,EAAE;YACtB,IAAI,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC;SACzB;KACF;IACD,QAAQ,EAAE,CAAC,IAAI,EAAE,SAAS,EAAE,WAAW,EAAE,YAAY,CAAC;IACtD,WAAW,EAAE;QACX,SAAS,EAAE,KAAK;KACjB;CACF,CAAC;;;;;;;;;;;;;;;;AC3CK,MAAM,oBAAoB,GAAkB;IACjD,KAAK,EAAE,wBAAwB;IAC/B,WAAW,EAAE,iBAAiB;IAC9B,OAAO,EAAE,CAAC;IACV,cAAc,EAAE,KAAK;IACrB,IAAI,EAAE,QAAQ;IACd,UAAU,EAAE;QACV,EAAE,EAAE;YACF,IAAI,EAAE,QAAQ;YACd,OAAO,EAAE,IAAI;SACd;QACD,UAAU,EAAE;YACV,IAAI,EAAE,QAAQ;SACf;QACD,QAAQ,EAAE;YACR,IAAI,EAAE,QAAQ;SACf;KACF;IACD,QAAQ,EAAE,CAAC,IAAI,EAAE,YAAY,EAAE,UAAU,CAAC;CAC3C,CAAC;;;;;;;;;;;;;;;;ACtBK,SAAS,cAAc,CAAC,GAAW;IACxC,OAAO,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;QACrC,MAAM,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;QACjC,GAAG,CAAC,IAAI,CAAC,KAAK,EAAE,GAAG,EAAE,IAAI,CAAC,CAAC;QAC3B,GAAG,CAAC,YAAY,GAAG,MAAM,CAAC;QAC1B,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;QACrC,GAAG,CAAC,MAAM,GAAG,GAAG,EAAE;YAChB,IAAI,GAAG,CAAC,MAAM,IAAI,GAAG,EAAE;gBACrB,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;aACvB;iBAAI;gBACH,MAAM,CAAC,IAAI,KAAK,CAAC,WAAW,CAAC,CAAC,CAAC;aAChC;QACH,CAAC,CAAC;QACF,GAAG,CAAC,IAAI,EAAE,CAAC;IACb,CAAC,CAAC,CAAC;AACL,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfiE;AAEF;AAGZ;AAE7C,SAAS,iBAAiB,CAAC,GAAkB,EAAE,eAAiC;IACrF,IAAG,CAAC,GAAG,EAAE;QACP,OAAO,EAAE,CAAC;KACX;IACD,IAAG,GAAG,CAAC,UAAU,KAAK,mEAAiB,IAAI,GAAG,CAAC,QAAQ,EAAE;QACvD,OAAO,6BAA6B,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC;KAC5D;IACD,OAAO,4BAA4B,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC;AAC5D,CAAC;AAEM,SAAS,uCAAuC,CAAC,SAAwD,EAAE,eAAiC;IACjJ,IAAG,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE;QACvC,OAAO,EAAE,CAAC;KACX;IACD,OAAQ,SAAS,CAAC,WAAqC;SACpD,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;SACrF,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,iCAAM,CAAC,KAAE,IAAI,EAAE,YAAY,IAAI,CAAC,CAAC;AACjD,CAAC;AAEM,SAAS,uBAAuB,CAAC,SAAgC,EAAE,eAAiC;IACzG,IAAG,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE;QACrC,OAAO,EAAE,CAAC;KACX;IACD,OAAO,EAAE,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC;SAC3E,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AAC3F,CAAC;AAEM,SAAS,wBAAwB,CAAC,SAAgC,EAAE,eAAiC;IAC1G,IAAG,CAAC,SAAS,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,qBAAqB,EAAE;QACvF,OAAO,EAAE,CAAC;KACX;IACD,OAAO,EAAE,CAAC,MAAM,CAAC,GAAG,SAAS,CAAC,WAAW,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC;SACnG,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;AAC3F,CAAC;AAEM,SAAS,8BAA8B,CAAC,SAAgC,EAAE,eAAiC;IAChH,MAAM,WAAW,GAAG,uCAAuC,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;IACxF,MAAM,oBAAoB,GAAG,uBAAuB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;IACjF,MAAM,qBAAqB,GAAG,wBAAwB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;IACnF,OAAQ,EAAE,CAAC,MAAM,CAAC,GAAG,WAAW,EAAE,GAAG,oBAAoB,EAAE,GAAG,qBAAqB,CAAC,CAAC;AACvF,CAAC;AAEM,SAAS,4BAA4B,CAAC,GAAkB,EAAE,eAAiC;IAChG,OAAQ,8BAA8B,CAAC,GAAG,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;AACvE,CAAC;AAEM,SAAS,6BAA6B,CAAC,GAAkB,EAAE,eAAiC;IACjG,OAAQ,8BAA8B,CAAC,GAAG,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;AACxE,CAAC;AAEM,SAAS,4BAA4B,CAAC,GAAkB,EAAE,YAAoB;IACnF,IAAG,GAAG,IAAI,GAAG,CAAC,OAAO,EAAE;QACrB,IAAG,GAAG,CAAC,OAAO,CAAC,WAAW,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAChE,GAAG,CAAC,OAAO,CAAC,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,YAAY,KAAK,YAAY,CAAC,CAAC;SAClG;QACD,IAAG,GAAG,CAAC,OAAO,CAAC,WAAW,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,qBAAqB,EAAE;YAC3E,KAAI,MAAM,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,qBAAqB,EAAE;gBAC9D,GAAG,CAAC,WAAW,GAAG,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,YAAY,KAAK,YAAY,CAAC,CAAC;aAClF;SACF;KACF;AACH,CAAC;AAEM,SAAS,0BAA0B,CAAC,GAAkB,EAAE,YAAoB,EAAE,KAA0B;IAC7G,IAAG,GAAG,IAAI,GAAG,CAAC,OAAO,EAAE;QACrB,IAAG,GAAG,CAAC,OAAO,CAAC,WAAW,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YAChE,GAAG,CAAC,OAAO,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;gBAClE,IAAG,CAAC,CAAC,YAAY,KAAK,YAAY,EAAE;oBAClC,OAAO,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;iBAChC;gBACD,OAAO,CAAC,CAAC;YACX,CAAC,CAAC,CAAC;SACJ;QACD,IAAG,GAAG,CAAC,OAAO,CAAC,WAAW,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,qBAAqB,EAAE;YAC3E,KAAI,MAAM,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,qBAAqB,EAAE;gBAC9D,GAAG,CAAC,WAAW,GAAG,CAAC,GAAG,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;oBAClD,IAAG,CAAC,CAAC,YAAY,KAAK,YAAY,EAAE;wBAClC,OAAO,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC;qBAChC;oBACD,OAAO,CAAC,CAAC;gBACX,CAAC,CAAC,CAAC;aACJ;SACF;KACF;AACH,CAAC;AAEM,SAAS,eAAe,CAAC,eAAgC;IAC9D,OAAO,0EAAe,CAAC,eAAe,CAAC,CAAC;AAC1C,CAAC;AAEM,SAAS,8BAA8B,CAAC,QAAuD,EAAE,eAAgC;IACtI,IAAI,QAAQ,IAAI,eAAe,EAAE;QAC/B,OAAO,QAAQ,CAAC,eAAe,CAAC,eAAe,CAAC,CAAC,CAAC;KACnD;IACD,OAAO,IAAI,CAAC;AACd,CAAC;AAEM,SAAS,sBAAsB,CAAC,GAAkB,EAAE,eAAgC;IACzF,OAAO,8BAA8B,CAAC,GAAG,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;AACtE,CAAC;AAEM,SAAS,mBAAmB;IACjC,OAAO,MAAM,CAAC,IAAI,CAAC,0EAAe,CAAC;SAChC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,0EAAe,CAAC,GAAG,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,GAAoB,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC,CAAC;AACpG,CAAC;AAEM,SAAS,yCAAyC,CAAC,QAAuD,EAAE,eAAgC;IACjJ,IAAI,QAAQ,IAAI,eAAe,EAAE;QAC/B,OAAO,mEAAO,CAAC,8BAA8B,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC,CAAC;KAC3E;IACD,OAAO,IAAI,CAAC;AACd,CAAC;AAEM,SAAS,oCAAoC,CAAC,GAAkB,EAAE,eAAgC;IACvG,OAAO,yCAAyC,CAAC,GAAG,CAAC,OAAO,EAAE,eAAe,CAAC,CAAC;AACjF,CAAC;AAEM,SAAS,kBAAkB,CAAC,GAAkB;IACnD,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,IAAI,EAAE;QACrC,OAAO,KAAK,CAAC;KACd;IACD,MAAM,gBAAgB,GAAG,mBAAmB,EAAE,CAAC;IAC/C,OAAO,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,oCAAoC,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;AACrF,CAAC;AAEM,SAAS,WAAW,CAAC,GAAoB;IAC9C,OAAO;QACL,+FAAoC;QACpC,gGAAqC;QACrC,6FAAkC;QAClC,gGAAqC;QACrC,0FAA+B;QAC/B,oFAAyB;QACzB,kFAAuB;QACvB,oFAAyB;KAC1B,CAAC,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AACtB,CAAC;AAEM,SAAS,+BAA+B,CAAC,SAAoB;IAClE,MAAM,WAAW,GAAG,CAAC,6FAAkC,CAAC,CAAC;IACzD,MAAM,mBAAmB,GAAG,IAAI,GAAG,CAA+B;QAChE,CAAC,sEAAc,EAAE;gBACf,oFAAyB;gBACzB,uFAA4B;gBAC5B,gGAAqC;gBACrC,6FAAkC;gBAClC,iGAAsC;gBACtC,0FAA+B;gBAC/B,uFAA4B;gBAC5B,gGAAqC;gBACrC,+FAAoC;gBACpC,mFAAwB;aACzB,CAAC;QACF,CAAC,qEAAa,EAAE;gBACd,sFAA2B;gBAC3B,uFAA4B;gBAC5B,oFAAyB;gBACzB,mFAAwB;aACzB,CAAC;QACF,CAAC,uEAAe,EAAE;gBAChB,sFAA2B;gBAC3B,oFAAyB;aAC1B,CAAC;QACF,CAAC,sEAAc,EAAE;gBACf,oFAAyB;gBACzB,uFAA4B;aAC7B,CAAC;KACH,CAAC,CAAC;IACH,OAAO,mBAAmB,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;AAChE,CAAC;AAEM,SAAS,8BAA8B,CAAC,GAAkB,EAAE,GAAoB;IACrF,IAAI,oCAAoC,CAAC,GAAG,EAAE,GAAG,CAAC,EAAE;QAClD,OAAO,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;KACnC;IACD,OAAO,sBAAsB,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC1C,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AEvLD,IAAY,eA2BX;AA3BD,WAAY,eAAe;IACvB,kFAAuB;IACvB,8DAAa;IACb,4DAAY;IACZ,gEAAc;IACd,gEAAc;IACd,kFAAuB;IACvB,0FAA2B;IAC3B,sEAAiB;IACjB,kFAAuB;IACvB,4EAAoB;IACpB,sEAAiB;IACjB,sFAAyB;IACzB,oFAAwB;IACxB,sFAAyB;IACzB,sFAAyB;IACzB,wFAA0B;IAC1B,wFAA0B;IAC1B,oEAAgB;IAChB,0EAAmB;IACnB,sEAAiB;IACjB,sEAAiB;IACjB,sEAAiB;IACjB,oEAAgB;IAChB,kEAAe;IACf,oEAAgB;IAChB,sEAAiB;AACrB,CAAC,EA3BW,eAAe,KAAf,eAAe,QA2B1B;;;;;;;;;;;;;;;;AC3BD,IAAY,WAIX;AAJD,WAAY,WAAW;IACnB,6CAAQ;IACR,6CAAQ;IACR,2CAAO;AACX,CAAC,EAJW,WAAW,KAAX,WAAW,QAItB;;;;;;;;;;;;;;;;;ACHiD;AAE3C,MAAM,WAAW;IAuBpB,YAAY,MAAc,EAAE,KAAa;QAtBhC,SAAI,GAAG,gEAAgB,CAAC;QACxB,aAAQ,GAAG,MAAM,CAAC;QAsBzB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACtB,CAAC;IAnBD,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAED,IAAI,MAAM,CAAC,MAAc;QACvB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IACxB,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAED,IAAI,KAAK,CAAC,KAAa;QACrB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACtB,CAAC;CAOJ;;;;;;;;;;;;;;;;;AC9BiD;AAE3C,MAAM,UAAU;IAuBnB,YAAY,MAAc,EAAE,KAAa;QAtBhC,SAAI,GAAG,+DAAe,CAAC;QACvB,aAAQ,GAAG,KAAK,CAAC;QAsBxB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;QACtB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACtB,CAAC;IAnBD,IAAI,MAAM;QACR,OAAO,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAED,IAAI,MAAM,CAAC,MAAc;QACvB,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;IACxB,CAAC;IAED,IAAI,KAAK;QACP,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC1C,CAAC;IAED,IAAI,KAAK,CAAC,KAAa;QACrB,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;IACtB,CAAC;IAOO,cAAc,CAAC,GAAW;QAChC,MAAM,cAAc,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;QACzC,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,GAAG,CAAC,iBAAiB,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,EAAE;YACjG,MAAM,MAAM,GAAG,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YAClC,IAAI,MAAM,IAAI,CAAC,EAAE;gBACf,OAAO,UAAU,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC;aAC3C;YAED,OAAO,UAAU,GAAG,EAAE,CAAC;SACxB;QACD,OAAO,GAAG,CAAC;IACb,CAAC;CAEJ;;;;;;;;;;;;;;;;AC5CD;;GAEG;AACH,IAAY,UAeX;AAfD,WAAY,UAAU;IACpB;;OAEG;IACH,6BAAe;IAEf;;OAEG;IACH,2BAAa;IAEb;;OAEG;IACH,gCAAkB;AACpB,CAAC,EAfW,UAAU,KAAV,UAAU,QAerB;;;;;;;;;;;;;;;;;;AClB8C;AAGxC,MAAM,sBAAsB,GAAG,IAAI,yDAAc,CAA6B,gCAAgC,CAAC,CAAC;AAChH,MAAM,sBAAsB,GAAG,IAAI,yDAAc,CAAmB,qCAAqC,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;ACH5E;AACmB;;;AAMlD,MAAM,kBAAkB;IAC7B,YAAoB,UAAsB;QAAtB,eAAU,GAAV,UAAU,CAAY;IAAI,CAAC;IAEzC,SAAS,CAAC,KAAa,EAAE,MAAc,EAAE,iBAAiB,GAAG,KAAK;;YACtE,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,+BAA+B,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YAC5G,MAAM,UAAU,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,CAAC;YAC3D,MAAM,MAAM,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YAChG,OAAO,MAAM,CAAC,IAAI,EAAE,CAAC;QACvB,CAAC;KAAA;;oFARU,kBAAkB;oIAAlB,kBAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRe;AACG;;;;;;;;;;;;;;;;;;;;;;ACAM;AAEU;AAEA;AAKP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACVI;AACN;AACoD;AACE;AAC0B;AAC7C;AACF;AACiD;AACrE;AACN;AAC6B;AAC1D;AAC0E;AACvC;AAC2C;AACF;AAC7C;AACyB;;;AAEnF,SAAS,8BAA8B,CAAC,OAAoC;IACjF,MAAM,uBAAuB,GAAG,IAAI,oGAAuB,EAAE,CAAC;IAC9D,qFAAqF;IACrF,8CAA8C;IAC9C,IAAI,OAAO,EAAE;QACX,IAAI,OAAO,CAAC,OAAO,EAAE;YACnB,uBAAuB,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;SACnD;KACF;IACD,OAAO,uBAAuB,CAAC;AACjC,CAAC;AAEM,SAAS,yBAAyB;IACvC,MAAM,WAAW,GAAG,EAAE,kBAAkB,EAAE,GAAG,EAAE,CAAC,iDAAU,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE,CAAC;IACpF,OAAO,WAAW,CAAC;AACrB,CAAC;AAEM,SAAS,yBAAyB;IACvC,MAAM,WAAW,GAAG,EAAE,WAAW,EAAE,GAAG,EAAE,CAAC,iDAAU,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC,EAAE,CAAC;IAC7E,OAAO,WAAW,CAAC;AACrB,CAAC;AAEM,SAAS,qBAAqB,CAAC,IAAgB;IACpD,OAAO,IAAI,4EAAmB,CAAC,IAAI,EAAE,gBAAgB,EAAE,OAAO,CAAC,CAAC;AAClE,CAAC;AAEM,MAAM,sBAAsB,GAAG,yEAAuB,CAAC;IAC5D,MAAM,EAAE;QACN,OAAO,EAAE,iEAAe;QACxB,UAAU,EAAE,qBAAqB;QACjC,IAAI,EAAE,CAAC,6DAAU,CAAC;KACnB;CACF,CAAC,CAAC;AAOI,MAAM,kBAAkB;IAC7B,MAAM,CAAC,OAAO,CAAC,OAAoC;QACjD,OAAO;YACL,QAAQ,EAAE,kBAAkB;YAC5B,SAAS,EAAE;gBACT;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,OAAO;iBAClB;gBACD;oBACE,OAAO,EAAE,oGAAuB;oBAChC,UAAU,EAAE,8BAA8B;oBAC1C,IAAI,EAAE,CAAC,mEAAsB,CAAC;iBAC/B;gBACD;oBACE,OAAO,EAAE,gCAAgC;oBACzC,QAAQ,EAAE,uHAA4B;iBACvC;gBACD;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,mJAAiC;oBAC3C,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,qHAAsB;oBAChC,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,OAAO,EAAE,oEAAiB;oBAC1B,QAAQ,EAAE,0EAA2B;oBACrC,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,OAAO,EAAE,qGAAoB;oBAC7B,QAAQ,EAAE,MAAM,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,yFAAqB,CAAC,CAAC,CAAC,yHAA6B;iBACnG;gBACD,kEAAgB;aACjB;SACF,CAAC;IACJ,CAAC;IAED,MAAM,CAAC,QAAQ,CAAC,OAAoC;QAClD,OAAO,kBAAkB,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;IAC7C,CAAC;IAED,MAAM,CAAC,UAAU;QACf,OAAO;YACL,QAAQ,EAAE,kBAAkB;YAC5B,SAAS,EAAE;gBACT;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE;iBAChC;gBACD;oBACE,OAAO,EAAE,oGAAuB;oBAChC,QAAQ,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE;iBAChC;gBACD;oBACE,OAAO,EAAE,gCAAgC;oBACzC,QAAQ,EAAE,qHAA2B;iBACtC;gBACD;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,mJAAiC;oBAC3C,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,OAAO,EAAE,mEAAsB;oBAC/B,QAAQ,EAAE,qHAAsB;oBAChC,KAAK,EAAE,IAAI;iBACZ;gBACD;oBACE,OAAO,EAAE,qGAAoB;oBAC7B,QAAQ,EAAE,yHAA6B;iBACxC;gBACD,EAAE,OAAO,EAAE,iFAAkB,EAAE,UAAU,EAAE,yBAAyB,EAAE;gBACtE,EAAE,OAAO,EAAE,8EAAkB,EAAE,UAAU,EAAE,yBAAyB,EAAE;aACvE;SACF,CAAC;IACJ,CAAC;;oFAhFU,kBAAkB;gHAAlB,kBAAkB;oHAJpB,CAAC,mEAAU,EAAE,wFAAyB,EAAE,sBAAsB,CAAC,EAE9D,8EAA6B;oIAE5B,kBAAkB,cAJnB,mEAAU,EAAE,wFAAyB,EAAE,8EAEvC,8EAA6B;;;;;;;;;;;;;;;;;;;ACvDwB;;AAEjE,MAAM,KAAK,GAAG;IACZ,0EAAkB;CACnB,CAAC;AAOK,MAAM,6BAA6B;;0GAA7B,6BAA6B;0HAA7B,6BAA6B;8HAH/B,EAAE;mIAGA,6BAA6B,mBARxC,0EAAkB,aAAlB,0EAAkB;AAU6C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACdkB;AACP;AACuB;AACS;AACpD;AACiB;AACF;AACqB;AACoB;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRjD;AAC0B;AACA;AAI3C;;;;AAG9C,MAAM,SAAS,GAAG,uBAAuB,CAAC;AAC1C,MAAM,QAAQ,GAAG,aAAa,CAAC;AAE/B;;GAEG;AAEY,MAAM,qBAAqB;IAIxC,YAAoB,IAAU,EAAU,cAA8B;QAAlD,SAAI,GAAJ,IAAI,CAAM;QAAU,mBAAc,GAAd,cAAc,CAAgB;QAH9D,yBAAoB,GAAG,KAAK,CAAC;QAC7B,uBAAkB,GAAG,IAAI,iDAAe,CAAO,SAAS,CAAC,CAAC,CAAC,0DAA0D;QAG3H,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,yCAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,qBAAqB,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC;IACvG,CAAC;IAEK,aAAa,CACjB,cAAsB,EACtB,IAAU,EACV,QAAgB,EAChB,SAAoB,EACpB,eAAgC,EAChC,IAAqB,EACrB,GAAY;;YAEZ,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACzC,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;YACzD,MAAM,YAAY,GAAG,kEAAM,EAAE,CAAC;YAE9B,MAAM,kBAAkB,GAAG,GAAG,YAAY,IAAI,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,EAAE,CAAC;YAChF,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,OAAO,IAAI,cAAc,EAAE,EAAE,kBAAkB,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;YAEvG,MAAM,QAAQ,GAA8B;gBAC1C,YAAY,EAAE,SAAS;gBACvB,eAAe,EAAE,eAAe;gBAChC,kBAAkB,EAAE,QAAQ;gBAC5B,EAAE,EAAE,YAAY;gBAChB,IAAI;gBACJ,QAAQ,EAAE,IAAI,CAAC,IAAI;gBACnB,QAAQ,EAAE,kBAAkB;gBAC5B,GAAG;aACJ,CAAC;YACF,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,uBAAuB,OAAO,IAAI,cAAc,IAAI,kBAAkB,EAAE,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;YACzH,MAAM,oDAAc,CAAC,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAE,QAAQ,CAAC,CAAC,CAAC;QAC3E,CAAC;KAAA;IAED,mBAAmB,CAAC,cAAsB,EAAE,IAA+B;QACzE,OAAO,0CAAI,CACT,IAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,EAAE,CAClC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,OAAO,IAAI,cAAc,EAAE,EAAE,GAAG,IAAI,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAChH,CACF,CAAC,IAAI,CAAC,yCAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;IACpD,CAAC;IAED,cAAc,CAAC,cAAsB;QACnC,OAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,+CAAS,CAAC,GAAG,EAAE,CAAC,0CAAI,CAAC,IAAI,CAAC,sBAAsB,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1G,CAAC;IAED,OAAO,CAAC,cAAsB,EAAE,YAAoB;QAClD,OAAO,0CAAI,CAAC,IAAI,CAAC,eAAe,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC,CAAC;IAClE,CAAC;IAED,iBAAiB,CAAC,cAAsB,EAAE,YAAoB;QAC5D,OAAO,0CAAI,CAAC,IAAI,CAAC,wBAAwB,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC,CAAC;IAC3E,CAAC;IAED,gBAAgB,CAAC,cAAsB,EAAE,YAAoB;QAC3D,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC,SAAS,EAAE,CAAC;IACnE,CAAC;IAEK,iBAAiB,CAAC,cAAsB;;YAC5C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACtC,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,EAAE,cAAc,CAAC,CAAC;YACtD,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;QACjC,CAAC;KAAA;IAED,kBAAkB,CAAC,cAAsB;QACvC,OAAO,0CAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC,CAAC;IACtD,CAAC;IAED;;;OAGG;IACK,uBAAuB;QAC7B,IAAI,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACxC,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;YACxC,OAAO,OAAO,CAAC;SAChB;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAED;;;OAGG;IACW,WAAW;;YACvB,MAAM,UAAU,GAAG,IAAI,CAAC,uBAAuB,EAAE,CAAC;YAClD,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;gBAC9B,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACtD,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;aAClC;YACD,OAAO,GAAG,UAAU,GAAG,QAAQ,EAAE,CAAC;QACpC,CAAC;KAAA;IAEa,sBAAsB,CAAC,cAAsB;;YACzD,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACtC,IAAI,MAAM,IAAI,CAAC,8BAA8B,CAAC,cAAc,CAAC,EAAE;gBAC7D,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;gBAC9D,OAAO,MAAM,OAAO,CAAC,GAAG,CACtB,OAAO;qBACJ,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;qBAC/D,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,CACrE,CAAC;aACH;YACD,OAAO,EAAE,CAAC;QACZ,CAAC;KAAA;IAEa,gBAAgB,CAAC,cAAsB,EAAE,QAAgB;;YACrE,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACzC,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,8BAA8B,CAAC,cAAc,CAAC,CAAC,EAAE;gBAChE,MAAM,KAAK,CAAC,8BAA8B,OAAO,IAAI,cAAc,iBAAiB,CAAC,CAAC;aACvF;YACD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,OAAO,IAAI,cAAc,EAAE,EAAE,QAAQ,CAAC,CAAC;YACrF,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QAC7B,CAAC;KAAA;IAEa,eAAe,CAAC,cAAsB,EAAE,YAAoB;;YACxE,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACzC,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE,GAAG,YAAY,OAAO,CAAC,CAAC;YACrF,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,OAAO,IAAI,cAAc,EAAE,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACpG,OAAO,IAAI,IAAI,CAAC,CAAC,MAAM,CAAC,EAAE,EAAE,IAAI,EAAE,QAAQ,CAAC,kBAAkB,EAAE,CAAC,CAAC;QACnE,CAAC;KAAA;IAEa,wBAAwB,CAAC,cAAsB,EAAE,YAAoB;;YACjF,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YAC1C,MAAM,IAAI,GAAG,GAAG,QAAQ,IAAI,cAAc,GAAG,CAAC;YAC9C,MAAM,gBAAgB,GAAG,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC;YAChE,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,cAAc,EAAE,gBAAgB,CAAC,CAAC;YAC/E,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;YACpD,MAAM,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,gBAAgB,CAAC,CAAC;YAEnD,MAAM,gBAAgB,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;YAC3E,IAAI,gBAAgB,CAAC,MAAM,KAAK,CAAC,EAAE;gBACjC,MAAM,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;aACrD;YACD,IAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,CAAC;YAC/B,OAAO,IAAI,CAAC;QACd,CAAC;KAAA;IAEO,mBAAmB,CAAC,YAAoB;QAC9C,OAAO,GAAG,YAAY,OAAO,CAAC;IAChC,CAAC;IAEO,gBAAgB,CAAC,QAAgB;QACvC,QAAQ,QAAQ,EAAE;YAChB,KAAK,YAAY;gBACf,OAAO,KAAK,CAAC;YACf,KAAK,WAAW;gBACd,OAAO,KAAK,CAAC;SAChB;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAEa,8BAA8B,CAAC,cAAsB;;YACjE,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YACtC,IAAI;gBACF,MAAM,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,IAAI,GAAG,EAAE,cAAc,CAAC,CAAC;gBACrD,OAAO,IAAI,CAAC;aACb;YAAC,OAAO,GAAG,EAAE;gBACZ,OAAO,KAAK,CAAC;aACd;QACH,CAAC;KAAA;;0FApKkB,qBAAqB;sHAArB,qBAAqB,WAArB,qBAAqB;;;;;;;;;;;;;;;;ACZ1C;;GAEG;AACI,MAAe,oBAAoB;CAsBzC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5B2E;AAC2B;AAEtB;AAEI;;;;AAK9E,MAAM,6BAA6B;IACxC,YACU,gBAAkC,EAChC,cAA8B,EAC9B,aAA4B;QAF9B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,kBAAa,GAAb,aAAa,CAAe;IACrC,CAAC;IAEE,aAAa,CACjB,cAAsB,EACtB,IAAU,EACV,QAAgB,EAChB,SAAoB,EACpB,eAAgC,EAChC,IAAqB,EACrB,GAAY;;YAEZ,MAAM,YAAY,GAAG,kEAAM,EAAE,CAAC;YAC9B,IAAI,CAAC,kCAAkC,CAAC,cAAc,CAAC;iBACpD,IAAI,CACH,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAChB,IAAI,CAAC,mBAAmB,CAAC,cAAc,EAAE;gBACvC,EAAE,EAAE,YAAY;gBAChB,kBAAkB,EAAE,QAAQ;gBAC5B,YAAY,EAAE,SAAS;gBACvB,eAAe,EAAE,eAAe;gBAChC,IAAI;gBACJ,GAAG;gBACH,QAAQ,EAAE,IAAI,CAAC,IAAI;aACpB,CAAC,CAAC,IAAI,CACL,yDAAS,CAAC,GAAG,EAAE,CACb,0CAAI,CACF,GAAG,CAAC,aAAa,CAAC;gBAChB,EAAE,EAAE,YAAY;gBAChB,IAAI;gBACJ,IAAI,EAAE,QAAQ;aACf,CAAC,CACH,CACF,CACF,CACF,EACD,0DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;gBACjB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,0BAA0B,EAAE,GAAG,CAAC,CAAC;gBAChE,OAAO,uCAAK,CAAC;YACf,CAAC,CAAC,CACH;iBACA,SAAS,EAAE,CAAC;QACjB,CAAC;KAAA;IAED,cAAc,CAAC,cAAsB;QACnC,OAAO,mDAAa,CAAC,CAAC,IAAI,CAAC,kCAAkC,CAAC,cAAc,CAAC,EAAE,IAAI,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC,IAAI,CACnH,yDAAS,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,IAAI,GAAG,CAAC,cAAc,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,6BAA6B,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,wCAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAClH,CAAC;IACJ,CAAC;IAEO,wBAAwB;QAC9B,OAAO,IAAI,CAAC,uCAAuC,EAAE,CAAC,IAAI,CACxD,yDAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC,EACvC,0DAAS,CAAC,EAAE,CAAC,CACd,CAAC;IACJ,CAAC;IAED,aAAa,CAAC,cAAsB,EAAE,YAAoB;QACxD,OAAO,IAAI,CAAC,cAAc,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,YAAY,CAAC,CAAC,CAAC,CAAC;IAC9G,CAAC;IAED,OAAO,CAAC,cAAsB,EAAE,YAAoB;QAClD,OAAO,IAAI,CAAC,kCAAkC,CAAC,cAAc,CAAC,CAAC,IAAI,CACjE,uDAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EACtB,yDAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,wCAAE,CAAC,GAAG,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,CAAC,EACvD,uDAAM,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,EACpC,yDAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,0CAAI,CAAC,UAAU,CAAC,OAAO,EAAmB,CAAC,CAAC,CACvE,CAAC;IACJ,CAAC;IAED,gBAAgB,CAAC,cAAsB,EAAE,YAAoB;QAC3D,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC,SAAS,EAAE,CAAC;IACnE,CAAC;IAED,kBAAkB,CAAC,cAAsB;QACvC,OAAO,0CAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,CAAC,CAAC;IACtD,CAAC;IAED,iBAAiB,CAAC,cAAsB,EAAE,YAAoB;QAC5D,OAAO,IAAI,CAAC,iCAAiC,CAAC,cAAc,EAAE,YAAY,CAAC,CAAC,IAAI,CAC9E,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,0CAAI,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,EAClC,yDAAS,CAAC,GAAG,EAAE,CACb,IAAI,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC,IAAI,CAC/C,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,0CAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC,CAC/C,CACF,CACF,CAAC;IACJ,CAAC;IAEK,iBAAiB,CAAC,cAAsB;;YAC5C,MAAM,MAAM,GAAG,MAAM,IAAI,CAAC,kCAAkC,CAAC,cAAc,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YACvG,IAAI,CAAC,MAAM,EAAE;gBACX,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,iCAAiC,CAAC,CAAC;gBAC5D,OAAO;aACR;YACD,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,kDAAkD,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YACjH,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE;gBAC9B,IAAI;oBACF,MAAM,OAAO,CAAC,MAAM,EAAE,CAAC;iBACxB;gBAAC,OAAO,GAAG,EAAE;oBACZ,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,sEAAsE,EAAE,OAAO,EAAE,GAAG,CAAC,CAAC;iBAChH;aACF;YACD,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YAChG,MAAM,UAAU,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,sBAAsB;QACxE,CAAC;KAAA;IAEO,iCAAiC,CAAC,cAAsB,EAAE,YAAoB;QACpF,OAAO,IAAI,CAAC,kCAAkC,CAAC,cAAc,CAAC,CAAC,IAAI,CACjE,uDAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,EACtB,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,CAC9C,CAAC;IACJ,CAAC;IAEO,6BAA6B,CAAC,GAA2B;QAC/D,OAAO,IAAI,CAAC,kDAAkD,CAAC,GAAG,CAAC,CAAC,IAAI,CACtE,oDAAG,CAAC,CAAC,kBAA8C,EAAE,EAAE,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC,CAChI,CAAC;IACJ,CAAC;IAEO,kDAAkD,CAAC,GAA2B;QACpF,MAAM,WAAW,GAAG,GAAG,CAAC,cAAc,EAAE,CAAC;QACzC,IAAI,WAAW,CAAC,MAAM,IAAI,CAAC,EAAE;YAC3B,OAAO,wCAAE,CAAC,EAAE,CAAC,CAAC;SACf;QACD,OAAO,+CAAQ,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC,GAAG,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,IAAI,CAAC,yBAAyB,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACzH,CAAC;IAEO,yBAAyB,CAAC,EAAU;QAC1C,OAAO,IAAI,CAAC,uCAAuC,EAAE,CAAC,IAAI,CACxD,yDAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAC7F,CAAC;IACJ,CAAC;IAEM,mBAAmB,CAAC,cAAsB,EAAE,kBAA6C;QAC9F,OAAO,IAAI,CAAC,uCAAuC,EAAE,CAAC,IAAI,CACxD,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,0CAAI,CAAC,YAAY,CAAC,YAAY,CAAC,kBAAkB,CAAC,CAAC,CAAC,CACjF,CAAC;IACJ,CAAC;IAEO,uCAAuC;QAC7C,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC,6BAA6B,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IAC1G,CAAC;IAEO,6BAA6B,CAAC,OAAgB;QACpD,OAAO,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAA6B,OAAO,EAAE,uFAA2B,CAAC,CAAC;IACjH,CAAC;IAES,kCAAkC,CAAC,EAAU;QACrD,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,yDAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAC1D,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAChC,CAAC;IACJ,CAAC;IAEO,qCAAqC;QAC3C,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC,4BAA4B,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACzG,CAAC;IAEO,4BAA4B,CAAC,OAAgB;QACnD,OAAO,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAA2B,OAAO,EAAE,oFAAwB,CAAC,CAAC;IAC5G,CAAC;;0GAzKU,6BAA6B;+HAA7B,6BAA6B,WAA7B,6BAA6B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXyB;AACS;AACkC;AACpB;AAE9D;AACwC;;;;AAI7D,MAAM,6CAA6C,GAAG,IAAI,yDAAc,CAAmC,yCAAyC,CAAC,CAAC;AAQtJ,MAAe,yBAAyB;IAS7C,YACmE,OAAyC,EAChG,gBAAkC,EAClC,eAAgC,EAChC,cAA8B,EAC9B,MAAqB;QAJkC,YAAO,GAAP,OAAO,CAAkC;QAChG,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,WAAM,GAAN,MAAM,CAAe;QAXzB,sBAAiB,GAAG,IAAI,iDAAe,CAAU,KAAK,CAAC,CAAC;QAY9D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,2DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC;IAXD,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,CAAC;IAC/C,CAAC;IAeD,gCAAgC;IACzB,MAAM;QACX,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClC,mDAAa,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CAChF,yDAAS,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,oCAAoC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,EAC9F,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,EAAE;YACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;OAGG;IACO,OAAO,CAAC,QAAwC;QACxD,MAAM,KAAK,GAAG,QAAQ,IAAI,CAAC,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC,cAAc,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC;QAChF,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,mBAAmB,KAAK,CAAC,CAAC,CAAC,iCAAiC,CAAC,CAAC,CAAC,6BAA6B,EAAE,EAAE,QAAQ,CAAC,CAAC;QAC5H,OAAO,KAAK,CAAC;IACf,CAAC;IAED;;OAEG;IACO,cAAc;QACtB,OAAO,6CAAM,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,SAAS,CAAC,CAAC;IACjE,CAAC;IAED;;OAEG;IACK,iBAAiB;QACvB,OAAO,mDAAa,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,IAAI,CACvF,yDAAS,CAAC,CAAC,CAAC,OAAO,EAAE,OAAO,CAAC,EAAE,EAAE,CAC/B,IAAI,CAAC,uCAAuC,CAAC,OAAO,EAAE,OAAO,CAAC;aAC3D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,EAAE,yDAAS,CAAC,CAAC,WAAW,EAAE,EAAE,CACvC,WAAW,IAAI,IAAI,CAAC,CAAC,CAAC,wCAAE,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,4DAA4D,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC1I,CAAC;IAED;;;;OAIG;IACK,uCAAuC,CAAC,OAAgB,EAAE,OAAgB;QAChF,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,WAAW,EAAE,EAAE;YACpE,+CAA+C;YAC/C,IAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE;gBAC5B,OAAO,WAAW,CAAC,IAAI,CAAC;aACzB;YACD,OAAO,IAAI,CAAC;QACd,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED;;;;OAIG;IACK,4DAA4D,CAAC,OAAgB,EAAE,OAAgB;QACrG,OAAO,IAAI,CAAC,oCAAoC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CACrE,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,kEAAkE,EAAE,GAAG,CAAC,CAAC;YAC1F,OAAO,IAAI,CAAC,gCAAgC,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QACjE,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;IAED;;OAEG;IACK,oCAAoC,CAAC,OAAgB,EAAE,OAAgB;QAC7E,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CAC/C,yDAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YAC3F,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,wCAAwC,EAAE,GAAG,CAAC,CAAC;YACjE,OAAO,wCAAE,CAAC,IAAI,CAAC,CAAC;QAClB,CAAC,CAAC,EAAE,mDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;IAED;;;;;OAKG;IACK,mBAAmB,CAAC,OAAgB,EAAE,OAAgB,EAAE,IAAO;QACrE,MAAM,IAAI,GAAuB;YAC/B,EAAE,EAAE,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC;YACxC,WAAW,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YAC5B,IAAI;SACL,CAAC;QACF,OAAO,2CAAI,CAAC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;IAChE,CAAC;IAED;;;OAGG;IACK,eAAe,CAAC,OAAgB;QACtC,MAAM,UAAU,GAAG,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;QACxE,OAAO,UAA6B,CAAC;IACvC,CAAC;IAED;;;;OAIG;IACK,cAAc,CAAC,OAAgB,EAAE,OAAgB;QACvD,MAAM,UAAU,GAAI,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;QAClD,MAAM,GAAG,GAAG,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,CAAC;QACjD,OAAO,UAAU,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAA+C,CAAC;IAC3I,CAAC;IAED;;;OAGG;IACK,sBAAsB,CAAC,OAAgB;QAC7C,OAAQ,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,CAAC,GAAG,OAAO,EAAE,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC;IAC5F,CAAC;IAED;;;;OAIG;IACK,gCAAgC,CAAC,OAAgB,EAAE,OAAgB;QACzE,OAAO,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CAC/C,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YAChB,IAAG,CAAC,GAAG,EAAE;gBACP,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6DAA6D,CAAC,CAAC;gBAChF,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;aAC/C;YACD,OAAO,wCAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;QACtB,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;;kGA5JmB,yBAAyB,yDAUnC,6CAA6C;0HAVnC,yBAAyB,WAAzB,yBAAyB;;;;;;;;;;;;;;;;;;;;;;;;;ACjBuD;AAQjD;AACH;AACF;AACV;AAC8B;AAC+B;;;;;;AAEnG,MAAM,uBAAuB,GAAG,KAAK,CAAC,CAAC,WAAW;AAClD,MAAM,wBAAwB,GAAG,cAAc,CAAC;AAKzC,MAAM,eAAgB,SAAQ,2GAAwC;IAE3E,YAAsB,gBAAkC,EAC5C,eAAgC,EAChC,cAA8B,EAC9B,MAAqB,EACvB,kBAAsC,EACtC,UAAsB;QAC9B,KAAK,CAAC;YACJ,iBAAiB,EAAE,IAAI;YACvB,YAAY,EAAE,uBAAuB;SACtC,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,EAAE,MAAM,CAAC,CAAC;QAT1C,qBAAgB,GAAhB,gBAAgB,CAAkB;QAC5C,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,WAAM,GAAN,MAAM,CAAe;QACvB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,eAAU,GAAV,UAAU,CAAY;IAKhC,CAAC;IAEM,YAAY,CAAC,OAAgB;QAClC,OAAO,GAAG,OAAO,CAAC,iBAAiB,EAAE,YAAY,CAAC;IACpD,CAAC;IAEM,cAAc,CAAC,CAAU,EAAE,OAAgB;QAChD,OAAO,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;IACtD,CAAC;IAEM,eAAe,CAAC,CAAU,EAAE,OAAgB;QACjD,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CACzB,GAAG,wBAAwB,cAAc,4EAAgB,CAAC,OAAO,CAAC,OAAO,CAAC;aACxE,IAAI,CAAC,0DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACvB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,0BAA0B,4EAAgB,CAAC,OAAO,CAAC,yCAAyC,EAAE,GAAG,CAAC,CAAC;YACpH,OAAO,wCAAE,CAAC,EAAE,CAAC,CAAC;QAChB,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;IAEM,qBAAqB,CAAC,SAAoB,EAAE,eAAuB;QACxE,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,SAAwB,EAAE,EAAE,CACtD,SAAS,CAAC,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,YAAY,KAAK,SAAS,IAAI,IAAI,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,EACxG,mDAAG,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;IAC3D,CAAC;IAEM,qBAAqB,CAAC,SAAoB,EAAE,eAAuB;QACxE,OAAO,IAAI,CAAC,qBAAqB,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;IAC1F,CAAC;;8EAvCU,eAAe;gHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;;AClByB;AACR;;AAI9B,MAAM,2BAA2B;IACtC,UAAU,CAAC,IAAmB;QAC5B,IAAG,CAAC,IAAI,EAAE;YACR,OAAO,wCAAE,CAAC,KAAK,CAAC,CAAC;SAClB;QACD,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;IACxD,CAAC;IACD,QAAQ,CAAC,IAAmB;QAC1B,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IAC7E,CAAC;IAEO,iBAAiB;QACvB,OAAO,2CAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC;IACtD,CAAC;;sGAbU,2BAA2B;4HAA3B,2BAA2B,WAA3B,2BAA2B;;;;;;;;;;;;;;;;ACJjC,MAAe,uBAAuB;CAG5C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJ+C;AAG8G;AAC/E;AACM;AAEa;AACnC;AACqB;AAEjD;;;;;;;AAG5B,MAAM,4BAA4B;IACvC,YACU,4BAAiD,EACjD,eAAgC,EAChC,oBAA0C,EAC1C,oBAA0C,EAC1C,aAA4B,EAC5B,UAAsB,EACtB,eAAgC;QANhC,iCAA4B,GAA5B,4BAA4B,CAAqB;QACjD,oBAAe,GAAf,eAAe,CAAiB;QAChC,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,kBAAa,GAAb,aAAa,CAAe;QAC5B,eAAU,GAAV,UAAU,CAAY;QACtB,oBAAe,GAAf,eAAe,CAAiB;IACvC,CAAC;IAEJ,UAAU,CAAC,IAAmB;QAC5B,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,CAAC,EAAE;YACzD,OAAO,wCAAE,CAAC,KAAK,CAAC,CAAC;SAClB;QACD,OAAO,IAAI,CAAC,4BAA4B,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;IACzG,CAAC;IAED,QAAQ,CAAC,IAAmB,EAAE,kBAA2B;QACvD,OAAO,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CACxC,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,OAAO,EAAE,kBAAkB,CAAC,CAAC,CAC/E,CAAC;IACJ,CAAC;IAED,cAAc,CAAC,IAAmB,EAAE,OAAgB,EAAE,kBAA2B;QAC/E,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,wBAAwB,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;QAClE,OAAO,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC,IAAI,CACtC,yDAAS,CAAC,CAAC,sBAAsB,EAAE,EAAE;YACnC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,iCAAiC,EAAE,sBAAsB,CAAC,CAAC;YACpF,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;YACxD,MAAM,aAAa,GAAG,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC;YACnE,IAAI,oBAAoB,GAAW,SAAS,CAAC;YAC7C,IAAI,CAAC,aAAa,EAAE;gBAClB,oBAAoB,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAE,CAAC,CAAC,KAA2B,CAAC,MAAM,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;aACjJ;YACD,oGAAoG;YACpG,MAAM,UAAU,GAAG,iDAAS,CAAC,IAAI,CAAC,CAAC;YACnC,IAAI,CAAC,qBAAqB,CAAC,UAAU,EAAE,sBAAsB,CAAC,CAAC;YAC/D,OAAO,CACL,IAAI,CAAC,kBAAkB,CAAC,UAAU,EAAE,OAAO,EAAE,kBAAkB,CAAC;gBAC9D,6CAA6C;iBAC5C,IAAI,CACH,yDAAS,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EACvF,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;gBACf,OAAO,EAAE,aAAa;gBACtB,IAAI,kCAAO,iDAAS,CAAC,IAAI,CAAC,KAAE,QAAQ,EAAE,MAAM,GAAE;gBAC9C,UAAU,EAAE,oBAAoB;gBAChC,KAAK,EAAE,aAAa,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,8BAA8B;aAClE,CAAC,CAAC,EACH,0DAAU,CAAC,CAAC,GAAsB,EAAE,EAAE;gBACpC,MAAM,QAAQ,GAAG,IAAI,CAAC,mCAAmC,CAAC,GAAG,CAAC,CAAC;gBAC/D,OAAO,wCAAE,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,GAAG,CAAC,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,CAAC,CAAC;YACrF,CAAC,CAAC,CACH,CACJ,CAAC;QACJ,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,mCAAmC,CAAC,GAAsB;QAChE,IAAI,GAAG,IAAI,GAAG,CAAC,KAAK,EAAE;YACpB,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;SAClC;QACD,IAAI,GAAG,IAAI,GAAG,CAAC,OAAO,EAAE;YACtB,OAAO,GAAG,CAAC,OAAO,CAAC;SACpB;QACD,OAAO,eAAe,CAAC;IACzB,CAAC;IAED;;QAEI;IACI,qBAAqB,CAAC,GAAkB,EAAE,mBAAgD;QAChG,IAAI,mBAAmB,IAAI,mBAAmB,CAAC,MAAM,GAAG,CAAC,EAAE;YACzD,KAAK,MAAM,kBAAkB,IAAI,mBAAmB,EAAE;gBACpD,IAAI,kBAAkB,CAAC,kBAAkB,EAAE;oBACzC,6CAA6C;oBAC7C,IAAI,CAAC,8BAA8B,CAAC,kBAAkB,EAAE,GAAG,CAAC,CAAC;iBAC9D;aACF;SACF;IACH,CAAC;IAEO,kBAAkB,CAAC,IAAmB,EAAE,OAAgB,EAAE,kBAA4B;QAC5F,kFAAkF;QAClF,gDAAgD;QAChD,OAAO,IAAI,CAAC,QAAQ;YAClB,CAAC,CAAC,MAAM;gBACN,IAAI,CAAC,4BAA4B,CAAC,0BAA0B,CAAC;oBAC3D,YAAY,EAAE,IAAI,CAAC,OAAO;oBAC1B,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,KAAK;oBACvB,OAAO;oBACP,mBAAmB,EAAE,IAAI,CAAC,EAAE;oBAC5B,kBAAkB,EAAE,kBAAkB;iBACvC,CAAC;YACJ,CAAC,CAAC,OAAO;gBACP,IAAI,CAAC,4BAA4B,CAAC,kBAAkB,CAAC;oBACnD,YAAY,EAAE,IAAI,CAAC,OAAO;oBAC1B,OAAO;oBACP,mBAAmB,EAAE,IAAI,CAAC,EAAE;iBAC7B,CAAC,CAAC;IACT,CAAC;IAED,uBAAuB,CAAC,IAAmB;QACzC,OAAO,IAAI,CAAC,oBAAoB,CAAC,kBAAkB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;IACrF,CAAC;IAED,iBAAiB,CAAC,IAAmB;QACnC,OAAO,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,CAAC,IAAI,CAC3C,oDAAI,CAAC,CAAC,CAAC,EACP,yDAAS,CAAC,CAAC,mBAAmB,EAAE,EAAE;YAChC,IAAI,mBAAmB,CAAC,MAAM,GAAG,CAAC,EAAE;gBAClC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,yBAAyB,EAAE,mBAAmB,CAAC,CAAC;gBACzE,OAAO,8CAAQ,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI,CAAC,wCAAwC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;aACvH;YACD,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,0BAA0B,CAAC,CAAC;YACrD,OAAO,wCAAE,CAAC,EAAE,CAAC,CAAC;QAChB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAED,wCAAwC,CAAC,GAAkB,EAAE,gBAA2C;QACtG,gBAAgB,CAAC,KAAK,GAAG,SAAS,CAAC;QACnC,OAAO,IAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,EAAE,gBAAgB,CAAC,EAAE,CAAC,CAAC,IAAI,CACxE,yDAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CACjB,IAAI,CAAC,4BAA4B,CAAC,gBAAgB,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,IAAI,CAC/D,yDAAS,CAAC,CAAC,QAAQ,EAAE,EAAE;YACrB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,uCAAuC,EAAE,gBAAgB,EAAE,QAAQ,CAAC,CAAC;YAC9F,gEAAgE;YAChE,gBAAgB,CAAC,kBAAkB,GAAG,QAAQ,CAAC;YAC/C,OAAO,IAAI,CAAC,oBAAoB,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAAE,EAAE,gBAAgB,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,GAAG,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC;QACnH,CAAC,CAAC,CACH,CACF,EACD,0DAAU,CAAC,CAAC,GAAU,EAAE,EAAE;YACxB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,6CAA6C,EAAE,GAAG,CAAC,CAAC;YAC7E,gBAAgB,CAAC,KAAK,GAAG,GAAG,CAAC;YAC7B,OAAO,wCAAE,CAAC,gBAAgB,CAAC,CAAC;QAC9B,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,8BAA8B,CAAC,yBAAoD,EAAE,GAAkB;QAC7G,MAAM,UAAU,GAAG;YACjB,kBAAkB,EAAE,yBAAyB,CAAC,kBAAkB;YAChE,YAAY,EAAE,yBAAyB,CAAC,YAAY;YACpD,SAAS,EAAE,yBAAyB,CAAC,SAAS;YAC9C,MAAM,EAAE,yBAAyB,CAAC,MAAM;YACxC,YAAY,EAAE,yBAAyB,CAAC,YAAY;YACpD,eAAe,EAAE,yBAAyB,CAAC,eAAe;YAC1D,OAAO,EAAE,yBAAyB,CAAC,OAAO;YAC1C,kBAAkB,EAAE,yBAAyB,CAAC,kBAAkB;YAChE,gBAAgB,EAAE,yBAAyB,CAAC,gBAAgB;SAC7D,CAAC;QACF,IAAI,yBAAyB,CAAC,IAAI,KAAK,iCAAiC,EAAE;YACxE,IAAI,CAAC,uBAAuB,CAAC,UAAU,EAAE,GAAG,EAAE,yBAAyB,CAAC,GAAG,CAAC,CAAC;YAC7E,OAAO;SACR;QACD,IAAI,yBAAyB,CAAC,IAAI,KAAK,qBAAqB,EAAE;YAC5D,IAAI,CAAC,sBAAsB,CAAC,UAAU,EAAE,GAAG,EAAE,yBAAyB,CAAC,GAAG,CAAC,CAAC;YAC5E,OAAO;SACR;QACD,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,EAAE;YAC5B,GAAG,CAAC,OAAO,CAAC,WAAW,GAAG,EAAE,CAAC;SAC9B;QACD,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC3C,CAAC;IAEO,sBAAsB,CAAC,UAA+B,EAAE,GAAkB,EAAE,GAAW;QAC7F,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,qDAAqD,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;IACxG,CAAC;IAEO,uBAAuB,CAAC,UAA+B,EAAE,GAAkB,EAAE,GAAW;QAC9F,MAAM,SAAS,GAAG,CAAC,CAAmC,EAAE,EAAE,CAAC,CAAC,CAAC,GAAG,KAAK,GAAG,CAAC;QACzE,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,qBAAqB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAClF,IAAI,CAAC,WAAW,EAAE;YAChB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,oDAAoD,GAAG,EAAE,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;SAC3G;QACD,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE;YAC5B,WAAW,CAAC,WAAW,GAAG,EAAE,CAAC;SAC9B;QACD,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC3C,CAAC;IAED,sBAAsB,CAAC,IAAmB;QACxC,OAAO,IAAI,CAAC,oBAAoB,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAC3D,CAAC;IAED,4BAA4B,CAAC,EAAU,EAAE,IAAU;QACjD,MAAM,kBAAkB,GAAG,GAAG,IAAI,CAAC,oBAAoB,CAAC,OAAO,GAAG,kGAAuC,EAAE,CAAC;QAC5G,MAAM,QAAQ,GAAG,IAAI,QAAQ,EAAE,CAAC;QAChC,QAAQ,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;QAC9B,OAAO,IAAI,CAAC,UAAU;aACnB,IAAI,CAAC,kBAAkB,EAAE,QAAQ,EAAE;YAClC,YAAY,EAAE,MAAM;YACpB,cAAc,EAAE,IAAI;YACpB,OAAO,EAAE,QAAQ;YACjB,OAAO,EAAE,EAAE,aAAa,EAAE,EAAE,EAAE;SAC/B,CAAC;aACD,IAAI,CACH,oDAAG,CAAC,CAAC,KAAK,EAAE,EAAE;YACZ,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,yCAAyC,EAAE,KAAK,CAAC,CAAC;YAC3E,IAAI,KAAK,CAAC,IAAI,KAAK,+EAA4B,EAAE;gBAC/C,IAAI,CAAC,eAAe,CAAC,qBAAqB,CAAC,EAAE,EAAE,KAAK,CAAC,KAAK,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC;aAC3E;QACH,CAAC,CAAC,EACF,uDAAM,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,KAAK,yEAAsB,CAAC,EACxD,mDAAG,CAAC,CAAC,KAA2B,EAAE,EAAE;YAClC,IAAI,CAAC,KAAK,CAAC,EAAE,EAAE;gBACb,MAAM,KAAK,CAAC,wCAAwC,KAAK,CAAC,UAAU,EAAE,CAAC,CAAC;aACzE;YACD,OAAO,KAAK,CAAC,IAAI,CAAC;QACpB,CAAC,CAAC,EACF,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,2CAA2C,MAAM,GAAG,CAAC,CAAC,CAChG,CAAC;IACN,CAAC;;wGAxNU,4BAA4B;8HAA5B,4BAA4B,WAA5B,4BAA4B;;;;;;;;;;;;;;;;;;;;;;;;;ACfuF;AAC1F;AACU;AAC0D;AACtC;AAClB;AAGiD;;;;;;AAEnG,MAAM,iBAAiB,GAAG,cAAc,CAAC,CAAC,mCAAmC;AAKtE,MAAM,UAAW,SAAQ,2GAAiD;IAE/E,YAAsB,gBAAkC,EAC5C,eAAgC,EAChC,MAAqB,EACrB,cAA8B,EAChC,kBAAsC,EACtC,UAAsB;QAC9B,KAAK,CAAC,EAAE,iBAAiB,EAAE,IAAI,EAAE,YAAY,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,EAAE,gBAAgB,EAAE,eAAe,EAAE,cAAc,EAAE,MAAM,CAAC,CAAC;QANtG,qBAAgB,GAAhB,gBAAgB,CAAkB;QAC5C,oBAAe,GAAf,eAAe,CAAiB;QAChC,WAAM,GAAN,MAAM,CAAe;QACrB,mBAAc,GAAd,cAAc,CAAgB;QAChC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,eAAU,GAAV,UAAU,CAAY;IAEhC,CAAC;IAEM,+BAA+B,CAAC,GAAW;QAChD,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IACjE,CAAC;IAEM,gCAAgC,CAAC,GAAyB;QAC/D,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;IAClE,CAAC;IAEM,cAAc,CAAC,CAAU,EAAE,OAAgB;QAChD,OAAO,IAAI,CAAC,kBAAkB,CAAC,kBAAkB,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC;IAC1E,CAAC;IAEM,YAAY,CAAC,OAAgB;QAClC,OAAO,GAAG,OAAO,CAAC,iBAAiB,EAAE,cAAc,CAAC;IACtD,CAAC;IAEM,eAAe,CAAC,CAAU,EAAE,OAAgB;QACjD,OAAO,IAAI,CAAC,UAAU,CAAC,GAAG,CACzB,GAAG,iBAAiB,gBAAgB,4EAAgB,CAAC,OAAO,CAAC,OAAO,CAAC;aACnE,IAAI,CAAC,0DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACvB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,6BAA6B,4EAAgB,CAAC,OAAO,CAAC,yCAAyC,EAAE,GAAG,CAAC,CAAC;YACvH,OAAO,wCAAE,CAAC;gBACR,eAAe,EAAE,EAAE;gBACnB,gBAAgB,EAAE,EAAE;aACrB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC,CAAC;IACR,CAAC;;oEArCU,UAAU;2GAAV,UAAU,WAAV,UAAU,mBAFT,MAAM;;;;;;;;;;;;;;;;;;ACVb,MAAM,uBAAuB;IAHpC;QAIW,YAAO,GAAG,KAAK,CAAC;KAC1B;;8FAFY,uBAAuB;wHAAvB,uBAAuB,WAAvB,uBAAuB,mBAFtB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACFkC;AAC8B;AACb;AACG;AAK/C;AAEqC;AACxB;AACuC;AACqB;AACrB;AACd;AACO;AACA;;;;AAEjE,MAAM,WAAW,GAAI;IAC1B,YAAY,EAAE,cAAc;IAC5B,YAAY,EAAE,aAAa;IAC3B,UAAU,EAAE,WAAW;IACvB,eAAe,EAAE,gBAAgB;IACjC,0BAA0B,EAAE,cAAc;IAC1C,eAAe,EAAE,gBAAgB;CAClC,CAAC;AAEF,MAAM,WAAW,GAA6E;IAC5F;QACE,IAAI,EAAE,WAAW,CAAC,YAAY;QAC9B,MAAM,EAAE,+EAAkB;QAC1B,kBAAkB,EAAE,IAAI;KACzB;IACD;QACE,IAAI,EAAE,WAAW,CAAC,YAAY;QAC9B,MAAM,EAAE,qEAAa;QACrB,kBAAkB,EAAE,IAAI;KACzB;IACD;QACE,IAAI,EAAE,WAAW,CAAC,UAAU;QAC5B,MAAM,EAAE,qEAAa;QACrB,kBAAkB,EAAE,IAAI;KACzB;IACD;QACE,IAAI,EAAE,WAAW,CAAC,eAAe;QACjC,MAAM,EAAE,oFAAoB;QAC5B,kBAAkB,EAAE,IAAI;KACzB;IACD;QACE,IAAI,EAAE,WAAW,CAAC,0BAA0B;QAC5C,MAAM,EAAE,yGAA8B;QACtC,kBAAkB,EAAE,KAAK;KAC1B;IACD;QACE,IAAI,EAAE,WAAW,CAAC,eAAe;QACjC,MAAM,EAAE,oFAAoB;QAC5B,kBAAkB,EAAE,KAAK;KAC1B;CACF,CAAC;AAEF,SAAS,eAAe;IACtB,8DAAW,CAAC,kFAAwB,CAAC,CAAC;IACtC,8DAAW,CAAC,2EAAqB,CAAC,CAAC;IACnC,8DAAW,CAAC,kFAAwB,CAAC,CAAC;AACxC,CAAC;AAKM,MAAM,gBAAgB;IAK3B,YAAoB,cAA8B,EAAU,OAAgC,EAAU,MAAqB;QAAvG,mBAAc,GAAd,cAAc,CAAgB;QAAU,YAAO,GAAP,OAAO,CAAyB;QAAU,WAAM,GAAN,MAAM,CAAe;IAC3H,CAAC;IAEK,YAAY,CAAC,OAAe;;YAChC,IAAI,CAAC,UAAU,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC/C,CAAC;KAAA;IAED,IAAI,EAAE;QACJ,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB,CAAC;IAEM,iBAAiB;QACtB,OAAO,2CAAI,CAAC,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE,CAAC,CAAC;IACnD,CAAC;IAEM,eAAe,CAAsC,OAAgB,EAAE,SAAiB;QAC7F,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,EAAE,SAAS,CAAC,CAAM,CAAC;IACpE,CAAC;IAEM,mBAAmB,CAAC,OAAgB,EAAE,SAAiB;QAC5D,MAAM,CAAC,GAAG,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC;QACxD,IAAG,CAAC,CAAC,EAAE;YACL,MAAM,IAAI,KAAK,CAAC,SAAS,SAAS,2BAA2B,CAAC,CAAC;SAChE;QAED,IAAG,CAAC,CAAC,kBAAkB,EAAE;YACvB,OAAO,GAAG,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;SACnD;aAAI;YACH,OAAO,CAAC,CAAC,IAAI,CAAC;SACf;IACH,CAAC;IAEa,MAAM,CAAC,OAAe;;YAElC,eAAe,EAAE,CAAC;YAElB,MAAM,EAAE,GAAG,MAAM,mEAAgB,CAA8C;gBAC7E,IAAI,EAAE,6BAA6B;gBACnC,OAAO;gBACP,aAAa,EAAE;oBACb,UAAU,EAAE,EAAE,EAAE,oCAAoC;iBACrD;gBACD,eAAe,EAAE,IAAI;aACtB,CAAC,CAAC;YAEH,IAAI,yDAAS,EAAE,EAAE;gBACd,MAAkB,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,CAAC,gCAAgC;aACjE;YAED,MAAM,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;YAEhF,OAAO,EAAE,CAAC;QACZ,CAAC;KAAA;IAEO,cAAc;QACpB,MAAM,MAAM,GAAgD,EAAE,CAAC;QAC/D,KAAI,MAAM,CAAC,IAAI,WAAW,EAAE;YAC1B,IAAG,CAAC,CAAC,kBAAkB,EAAE;gBACvB,KAAI,MAAM,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,gEAAO,CAAC,EAAE;oBACzC,MAAM,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC;iBAC/E;aACF;iBAAI;gBACH,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;aAChB;SACF;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;;gFAvEU,gBAAgB;kHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AClEuC;AAC2B;AAEL;AAErD;AAEY;;;;AAExC,MAAM,gBAAgB,GAAG,cAAc,CAAC;AAKjC,MAAM,eAAe;IAG1B,YAAoB,aAA4B,EAAU,gBAAkC;QAAxE,kBAAa,GAAb,aAAa,CAAe;QAAU,qBAAgB,GAAhB,gBAAgB,CAAkB;QAC1F,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CACzF,4DAAY,CAAC,GAAG,CAAC,EACjB,mDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,EAC5B,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,CAAC,EAC7C,oEAAoB,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,sDAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAC/C,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEK,iBAAiB,CAAC,UAAyB,IAAI;;YACnD,MAAM,IAAI,CAAC,qCAAqC,EAAE,CAAC,YAAY,CAAC;gBAC9D,EAAE,EAAE,gBAAgB;gBACpB,WAAW,EAAE,OAAO,IAAI,EAAE;gBAC1B,gBAAgB,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;gBACjC,YAAY,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,MAAM;gBACpC,MAAM,EAAE,EAAE;aACX,CAAC,CAAC;QACL,CAAC;KAAA;IAEK,eAAe,CAAC,QAAgB,EAAE,KAAwB;;YAC9D,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,2BAA2B,EAAE,QAAQ,CAAC,CAAC;YAC9D,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,uBAAuB,EAAE,CAAC;YACjD,IAAG,GAAG,EAAE;gBACN,MAAM,OAAO,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;gBAC7B,MAAM,MAAM,GAAG,CAAC,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;gBACnC,IAAG,KAAK,EAAE;oBACR,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAC,CAAC,CAAC;iBACrC;gBACD,MAAM,IAAI,CAAC,qCAAqC,EAAE,CAAC,YAAY,CAAC;oBAC9D,EAAE,EAAE,gBAAgB;oBACpB,MAAM,EAAE,MAAM;oBACd,WAAW,EAAE,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,QAAQ,CAAC;iBAC/D,CAAC,CAAC;aACJ;QACH,CAAC;KAAA;IAED,qBAAqB,CAAC,OAAe;QACnC,OAAO,IAAI,CAAC,2BAA2B,EAAE,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAClE,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,EAAE,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IAC5F,CAAC;IAEK,qBAAqB,CAAC,OAAe,EAAE,UAAkB,EAAE,QAAgB;;YAC/E,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,sCAAsC,QAAQ,IAAI,UAAU,KAAK,OAAO,EAAE,CAAC,CAAC;YACnG,MAAM,IAAI,CAAC,2BAA2B,EAAE,CAAC,YAAY,CAAC;gBACpD,EAAE,EAAE,OAAO;gBACX,UAAU;gBACV,QAAQ;aACT,CAAC,CAAC;QACL,CAAC;KAAA;IAEa,uBAAuB;;YACnC,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,qCAAqC,EAAE,CAAC,SAAS,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACnG,OAAO,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,GAAG,CAAC,gBAAgB,CAAC,CAAC;QAC1C,CAAC;KAAA;IAEO,qCAAqC;QAC3C,OAAO,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,kGAAsC,CAAyC,CAAC;IAClH,CAAC;IAEO,2BAA2B;QACjC,OAAO,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,uFAA2B,CAA+B,CAAC;IAC7F,CAAC;IAEO,oBAAoB;QAC1B,OAAO;YACL,MAAM,EAAE,EAAE;YACV,mBAAmB,EAAE,SAAS;YAC9B,QAAQ,EAAE,KAAK;YACf,EAAE,EAAE,EAAE;YACN,UAAU,EAAE,KAAK;YACjB,UAAU,EAAE,IAAI;YAChB,SAAS,EAAE,CAAC;YACZ,kBAAkB,EAAE,SAAS;YAC7B,2BAA2B,EAAE,SAAS;YACtC,WAAW,EAAE,EAAE;YACf,gBAAgB,EAAE,SAAS;YAC3B,YAAY,EAAE,CAAC;SAChB,CAAC;IACJ,CAAC;IAEO,qBAAqB,CAAC,GAAwB;QACpD,IAAG,CAAC,GAAG,EAAE;YACP,OAAO,IAAI,CAAC,oBAAoB,EAAE,CAAC;SACpC;QAED,MAAM,kBAAkB,GAAG,IAAI,CAAC,2BAA2B,CAAC,GAAG,CAAC,CAAC;QACjE,uCACK,GAAG,KACN,mBAAmB,EAAE,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,EAClD,QAAQ,EAAE,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,EAC7C,UAAU,EAAE,GAAG,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,EACtC,UAAU,EAAE,GAAG,CAAC,WAAW,CAAC,MAAM,KAAK,CAAC,EACxC,SAAS,EAAE,GAAG,CAAC,WAAW,CAAC,MAAM,EACjC,kBAAkB,EAClB,2BAA2B,EAAE,kBAAkB,CAAC,cAAc,CAAC,SAAS,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,qBAAqB,EAAE,CAAC,EAAE,CAAC,IACzH;IACJ,CAAC;IAEO,mBAAmB,CAAC,GAAwB;QAClD,MAAM,aAAa,GAAG,kDAAW,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;QACxD,MAAM,EAAE,GAAG,6CAAM,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC;QACxD,MAAM,SAAS,GAAG,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC;QACzC,MAAM,SAAS,GAAG,GAAG,CAAC,YAAY,GAAG,SAAS,CAAC;QAC/C,IAAG,SAAS,GAAG,CAAC,EAAE;YAChB,MAAM,cAAc,GAAG,EAAE,GAAG,SAAS,CAAC;YACtC,OAAO,cAAc,GAAG,SAAS,CAAC;SACnC;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAEO,2BAA2B,CAAC,GAAwB;QAC1D,MAAM,SAAS,GAAG,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC;QACzC,IAAI,GAAG,CAAC,YAAY,GAAG,CAAC,IAAI,SAAS,GAAG,CAAC,EAAE;YACzC,OAAO,CAAC,GAAG,CAAC,YAAY,GAAG,SAAS,CAAC,GAAG,GAAG,CAAC,YAAY,CAAC;SAC1D;QACD,OAAO,CAAC,CAAC;IACX,CAAC;;8EAxHU,eAAe;gHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbqG;AAClB;AAc/E;AAEyD;AACtB;AAEgC;AAC/D;AAWQ;AAC2B;AACP;AACR;AACb;AAE8C;AAEG;AAC5C;AAGkD;;;;;;;;;;AAE1F,MAAM,qBAAqB,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,oFAAoF;AAC7H,MAAM,cAAc,GAAG,CAAC,GAAG,IAAI,CAAC,CAAC,mDAAmD;AAK7E,MAAM,mBAAmB;IAI9B,YACU,gBAAkC,EAClC,aAA4B,EAC5B,eAAgC,EAChC,UAAsB,EACtB,oBAA0C,EAC1C,cAA8B,EAC9B,oBAA0C,EACA,8BAAsE;IACxH,gFAAgF;IACxE,uBAAgD,EAChB,OAAmC;QAVnE,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,kBAAa,GAAb,aAAa,CAAe;QAC5B,oBAAe,GAAf,eAAe,CAAiB;QAChC,eAAU,GAAV,UAAU,CAAY;QACtB,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,mBAAc,GAAd,cAAc,CAAgB;QAC9B,yBAAoB,GAApB,oBAAoB,CAAsB;QACA,mCAA8B,GAA9B,8BAA8B,CAAwC;QAEhH,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChB,YAAO,GAAP,OAAO,CAA4B;QAE3E,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,yBAAyB,EAAE,CAAC,IAAI,CAC/D,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;YACV,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,uBAAuB,EAAE,GAAG,CAAC,CAAC;QACzD,CAAC,CAAC,EACF,4DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QACF,IAAI,CAAC,YAAY,EAAE,CAAC;IACtB,CAAC;IAEM,WAAW,CAChB,GAAkB,EAClB,yBAA0C,SAAS,EACnD,kBAAkB,GAAG,KAAK;QAE1B,GAAG,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;QACpD,GAAG,CAAC,UAAU,GAAG,qEAAe,CAAC;QACjC,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;IACxD,CAAC;IAEM,gBAAgB,CAAC,GAAkB,EAAE,kBAAkB,GAAG,KAAK,EAAE,sBAAsB,GAAG,IAAI;QACnG,IAAI,sBAAsB,EAAE;YAC1B,GAAG,CAAC,OAAO,GAAG,6CAAM,EAAE,CAAC,IAAI,EAAE,CAAC;SAC/B;QACD,IAAI,GAAG,CAAC,UAAU,KAAK,qEAAe,EAAE;YACtC,OAAO,IAAI,CAAC,6BAA6B,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;SACpE;aAAM;YACL,OAAO,IAAI,CAAC,gCAAgC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;SACzE;IACH,CAAC;IAEO,6BAA6B,CAAC,GAAkB,EAAE,kBAA2B;QACnF,uCAAuC;QACvC,IAAI,IAAI,CAAC,6BAA6B,EAAE;YACtC,IAAI,CAAC,6BAA6B,CAAC,WAAW,EAAE,CAAC;SAClD;QACD,OAAO,IAAI,CAAC,gCAAgC,CAAC,GAAG,CAAC,CAAC,IAAI,CACpD,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,sBAAsB,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC,EACrE,oDAAG,CAAC,GAAG,EAAE;YACP,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,6CAA6C,CAAC,CAAC;YACxE,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,gCAAgC,CAAC,GAAkB;QACzD,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,qDAAI,CAAC,CAAC,CAAC,EACP,0DAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,2CAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAC9D,CAAC;IACJ,CAAC;IAEM,kBAAkB,CAAC,EAAU;QAClC,OAAO,IAAI,CAAC,kCAAkC,CAAC,EAAE,CAAC,CAAC,IAAI,CACrD,qDAAI,CAAC,CAAC,CAAC,EACP,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,8BAA8B,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,SAAS,CAAC,CAAC,CAAC,EAC7H,0DAAS,CAAC,CAAC,GAA2B,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,2CAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CACnF,CAAC;IACJ,CAAC;IAEM,oCAAoC,CAAC,EAAU;QACpD,OAAO,IAAI,CAAC,kCAAkC,CAAC,EAAE,CAAC,CAAC,IAAI,CACrD,qDAAI,CAAC,CAAC,CAAC,EACP,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,2CAAI,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAC3D,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,0BAA0B,CAAC,EAAU;QAC1C,OAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CACnC,oDAAG,CAAC,CAAC,aAAa,EAAE,EAAE,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,EAC9D,uDAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,IAAI,IAAI,CAAC,CAC7B,CAAC;IACJ,CAAC;IAEY,mBAAmB,CAAC,EAAU;;;YACzC,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;YAChG,MAAM,SAAS,GAAG,MAAM,UAAU,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACnD,OAAO,eAAS,CAAC,GAAG,CAAC,EAAE,CAAC,0CAAE,MAAM,EAAE,CAAC;;KACpC;IAEY,UAAU;;YACrB,MAAM,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,CAAC;YAC/C,IAAI,IAAI,CAAC,6BAA6B,EAAE;gBACtC,IAAI,CAAC,6BAA6B,CAAC,WAAW,EAAE,CAAC;aAClD;YACD,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;KAAA;IAEM,YAAY;QACjB,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;YACzB,IAAI,CAAC,6BAA6B,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC,SAAS,EAAE,CAAC;SAC/E;IACH,CAAC;IAEM,yBAAyB,CAAC,SAAoB,EAAE,UAAU,GAAG,IAAI;QACtE,OAAO,IAAI,CAAC,+BAA+B,CAAC,SAAS,EAAE,UAAU,CAAC;aAC/D,IAAI,CACH,oDAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,GAAG,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAC5D,qDAAI,CAAC,CAAC,CAAC,CACR;aACA,SAAS,EAAE,CAAC;IACjB,CAAC;IAEM,+BAA+B,CAAC,SAAoB,EAAE,UAAU,GAAG,IAAI;QAC5E,OAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CACnC,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CACd,OAAO,CAAC,MAAM,CACZ,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,YAAY,KAAK,SAAS,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,KAAK,sEAAgB,CAAC,CAAC,CAAC,IAAI,CAAC;QAC5G,mGAAmG;SACpG,CACF,CACF,CAAC;IACJ,CAAC;IAEM,oBAAoB,CAAC,SAAqB;QAC/C,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,0DAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,EAC9C,oDAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE,CAAC,CAAC,EAC1C,oDAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAClF,CAAC;IACJ,CAAC;IAEM,yCAAyC,CAAC,SAAqB;QACpE,OAAO,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC,IAAI,CAC9C,0DAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,+CAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,oCAAoC,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CACjI,CAAC;IACJ,CAAC;IAEM,wCAAwC,CAAC,SAAqB;QACnE,IAAI,CAAC,yCAAyC,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;IACtF,CAAC;IAEM,UAAU,CAAC,KAAa,EAAE,eAAgC,EAAE,KAAa;QAC9E,OAAO,IAAI,CAAC,0BAA0B,CAAC,KAAK,CAAC,CAAC,IAAI,CAChD,qDAAI,CAAC,CAAC,CAAC,EACP,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;YACV,MAAM,SAAS,GAAG,iDAAS,CAAC,GAAG,CAAC,CAAC;YACjC,IAAI,CAAC,gCAAgC,CAAC,SAAS,CAAC,CAAC;YACjD,IAAI,kEAAW,CAAC,eAAe,CAAC,IAAI,SAAS,CAAC,OAAO,CAAC,sEAAe,CAAC,eAAe,CAAC,CAAC,CAAC,MAAM,GAAG,KAAK,EAAE;gBACrG,SAAS,CAAC,OAAO,CAAC,sEAAe,CAAC,eAAe,CAAC,CAAoB,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;gBACzF,2CAA2C;gBAC3C,IAAK,SAAS,CAAC,OAAO,CAAC,sEAAe,CAAC,eAAe,CAAC,CAAoB,CAAC,MAAM,KAAK,CAAC,EAAE;oBACxF,IAAI,CAAC,4CAA4C,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;iBAC/E;aACF;iBAAM,IAAI,CAAC,kEAAW,CAAC,eAAe,CAAC,EAAE;gBACxC,OAAO,SAAS,CAAC,OAAO,CAAC,sEAAe,CAAC,eAAe,CAAC,CAAC,CAAC;gBAC3D,IAAI,CAAC,4CAA4C,CAAC,SAAS,EAAE,eAAe,CAAC,CAAC;aAC/E;YACD,OAAO,SAAS,CAAC;QACnB,CAAC,CAAC,EACF,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,CAC3D,CAAC;IACJ,CAAC;IAEO,4CAA4C,CAAC,GAAkB,EAAE,eAAgC;QACvG,IAAI,GAAG,IAAI,GAAG,CAAC,OAAO,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,EAAE;YACjD,GAAG,CAAC,OAAO,CAAC,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC;SACxG;QACD,OAAO,GAAG,CAAC;IACb,CAAC;IAEM,mBAAmB,CAAC,SAAoB;QAC7C,MAAM,EAAE,GAAG,mEAAM,EAAE,CAAC;QACpB,MAAM,KAAK,GAAkB;YAC3B,EAAE;YACF,SAAS;YACT,OAAO,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YACxB,UAAU,EAAE,sEAAgB;YAC5B,OAAO,EAAE;gBACP,YAAY,EAAE,SAAS;gBACvB,SAAS,EAAE,SAAS;gBACpB,WAAW,EAAE,EAAE;gBACf,WAAW,EAAE,EAAE;aAChB;SACF,CAAC;QACF,OAAO,KAAK,CAAC;IACf,CAAC;IAEY,+BAA+B,CAAC,qBAA4C;;YACvF,MAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC;YACzE,GAAG,CAAC,EAAE,GAAG,qBAAqB,CAAC,mBAAmB,IAAI,GAAG,CAAC,EAAE,CAAC,CAAC,mCAAmC;YACjG,GAAG,CAAC,OAAO,GAAG,iDAAS,CAAC,qBAAqB,CAAC,CAAC;YAC/C,GAAG,CAAC,QAAQ,GAAG,iDAAS,CAAC,qBAAqB,CAAC,CAAC;YAChD,GAAG,CAAC,UAAU,GAAG,uEAAiB,CAAC;YACnC,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC;YACjD,OAAO,GAAG,CAAC;QACb,CAAC;KAAA;IAEM,gCAAgC,CAAC,GAAkB;QACxD,IAAI,GAAG,IAAI,GAAG,CAAC,UAAU,KAAK,uEAAiB,EAAE;YAC/C,GAAG,CAAC,OAAO,GAAG,iDAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;SACvC;IACH,CAAC;IAEM,iBAAiB;QACtB,OAAO,IAAI,CAAC,gCAAgC,EAAE,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,yBAAyB,EAAE,CAAC,CAAC;IACjG,CAAC;IAEM,sBAAsB,CAAC,GAAkB,EAAE,kBAA2B;QAC3E,IAAI,CAAC,GAAG,EAAE;YACR,OAAO,yCAAE,CAAC,KAAK,CAAC,CAAC;SAClB;QACD,OAAO,yCAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CACnB,IAAI,CAAC,yBAAyB,CAAC,kBAAkB,CAAC,EAClD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAC3D,CAAC;IACJ,CAAC;IAEO,qBAAqB;QAC3B,OAAO,IAAI,CAAC,wBAAwB,EAAE,CAAC,IAAI,CACzC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,gCAAgC,MAAM,EAAE,CAAC,CAAC,EACnF,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,EAAE,CAAC,EAC1D,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,kEAAkE,CAAC,CAAC,EACvG,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,gCAAgC,EAAE,CAAC,EACxD,IAAI,CAAC,mCAAmC,EAAE,EAC1C,IAAI,CAAC,yBAAyB,EAAE,CACjC,CAAC;IACJ,CAAC;IAEO,wBAAwB;QAC9B,MAAM,sBAAsB,GAAG,4CAAK,CAClC,IAAI,CAAC,0BAA0B,EAAE,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,+BAA+B,CAAC,CAAC,EAClF,4CAAK,CAAC,qBAAqB,EAAE,qBAAqB,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,eAAe,CAAC,CAAC,CACrF,CAAC;QACF,OAAO,IAAI,CAAC,gCAAgC,CAAC,KAAK,CAAC,CAAC,IAAI,CACtD,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,EACpC,uDAAM,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,UAAU,CAAC,EAClC,0DAAS,CAAC,GAAG,EAAE,CAAC,sBAAsB,CAAC,CACxC,CAAC;IACJ,CAAC;IAEO,yBAAyB,CAAC,kBAAkB,GAAG,KAAK;QAC1D,OAAO,CAAC,GAAgC,EAAE,EAAE,CAC1C,GAAG,CAAC,IAAI;QACN,oBAAoB;QACpB,0DAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,2CAAI,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;QAEvH,kCAAkC;QAClC,IAAI,CAAC,0BAA0B,CAAC,kBAAkB,CAAC,EAEnD,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,eAAe,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,EAAE,GAAG,CAAC,KAAK,CAAC,CAAC,EAC1E,IAAI,CAAC,sBAAsB,EAAE,EAC7B,wDAAO,EAAE,EACT,2DAAU,CAAC,CAAC,KAAK,EAAE,EAAE;YACnB,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;YAC/D,OAAO,yCAAE,CAAC,EAAE,CAAC,CAAC;QAChB,CAAC,CAAC,EACF,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,iBAAiB,EAAE,CAAC,CACpD,CAAC;IACN,CAAC;IAED;;OAEG;IACI,mCAAmC,CAAC,GAAkB,EAAE,eAAgC;QAC7F,MAAM,KAAK,GAAG,IAAI,CAAC,8BAA8B,CAAC,GAAG,CAAC,CAAC;QACvD,OAAO,yCAAE,CAAC,gGAAyC,CAAC,KAAK,EAAE,eAAe,CAAC,CAAC,CAAC,IAAI,CAC/E,0DAAS,CAAC,CAAC,OAAO,EAAE,EAAE;YACpB,IAAI,CAAC,OAAO,EAAE;gBACZ,OAAO,yCAAE,CAAC,IAAI,CAAC,CAAC;aACjB;YACD,OAAO,IAAI,CAAC,oCAAoC,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QACvF,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,8BAA8B,CAAC,GAAkB;QACvD,IAAI,GAAG,CAAC,UAAU,KAAK,uEAAiB,IAAI,GAAG,CAAC,QAAQ,EAAE;YACxD,OAAO,GAAG,CAAC,QAAQ,CAAC;SACrB;QACD,OAAO,GAAG,CAAC,OAAO,CAAC;IACrB,CAAC;IAED,oCAAoC,CAAC,GAAkB,EAAE,eAAgC;QACvF,OAAO,IAAI,CAAC,oCAAoC,CAAC,GAAG,CAAC,EAAE,EAAE,eAAe,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;IAC/H,CAAC;IAED,mCAAmC,CAAC,GAAkB,EAAE,eAAgC;QACtF,OAAO,IAAI,CAAC,oCAAoC,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;IACnG,CAAC;IAED,+BAA+B,CAAC,GAAkB;QAChD,OAAO,IAAI,CAAC,gCAAgC,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,IAAI,CAC9D,0DAAS,CAAC,CAAC,QAAQ,EAAE,EAAE,CACrB,QAAQ,CAAC,MAAM,GAAG,CAAC;YACjB,CAAC,CAAC,+CAAQ,CACN,QAAQ,CAAC,GAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CACvB,IAAI,CAAC,mCAAmC,CAAC,GAAG,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,EAAE,OAAO,EAAE,OAAO,EAAE,CAAC,CAAC,CAAC,CACtH,CACF;YACH,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CACX,EACD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CACvE,CAAC;IACJ,CAAC;IAEM,iCAAiC,CAAC,EAAU,EAAE,eAAgC;QACnF,OAAO,IAAI,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,4BAA4B,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC;IAC/H,CAAC;IAED;;;;OAIG;IACI,eAAe,CAAC,GAAkB,EAAE,eAAgC,EAAE,UAAU,GAAG,IAAI;QAC5F,IAAI,CAAC,2FAAoC,CAAC,GAAG,EAAE,eAAe,CAAC,EAAE;YAC/D,6FAA6F;YAC7F,kBAAkB;YAClB,0CAA0C;YAC1C,IAAI;YACJ,qGAAqG;YACrG,OAAO,IAAI,CAAC,uBAAuB;iBAChC,eAAe,CAAC,GAAG,EAAE,eAAe,CAAC;iBACrC,IAAI,CAAC,oDAAG,CAAC,CAAC,cAAc,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,0BAA0B,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC;SACxG;QACD,OAAO,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC;IAChG,CAAC;IAEM,4BAA4B,CAAC,GAAkB,EAAE,eAAgC,EAAE,UAAU,GAAG,IAAI;QACzG,IAAI,GAAG,CAAC,sBAAsB,KAAK,eAAe,IAAI,GAAG,CAAC,UAAU,KAAK,uEAAiB,EAAE;YAC1F,OAAO,IAAI,CAAC,eAAe,CAAC,GAAG,EAAE,eAAe,EAAE,UAAU,CAAC,CAAC;SAC/D;QACD,OAAO,IAAI,CAAC,oCAAoC,CAAC,GAAG,EAAE,eAAe,EAAE,UAAU,CAAC,CAAC;IACrF,CAAC;IAEM,mBAAmB,CAAC,eAAgC;QACzD,OAAO,IAAI,CAAC,UAAU,CAAC,+BAA+B,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAC5E,oDAAG,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,EAAE,KAAK,eAAe,CAAC,CAAC,EAC3E,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CACpC,CAAC;IACJ,CAAC;IAEO,oCAAoC,CAC1C,GAAkB,EAClB,eAAgC,EAChC,UAAU,GAAG,IAAI;QAEjB,IAAI,GAAG,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,SAAS,IAAI,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACtF,MAAM,OAAO,GAAG,GAAG,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC;YAC5F,IAAI,OAAO,EAAE;gBACX,OAAO,yCAAE,CAAC,OAAO,CAAC,CAAC;aACpB;SACF;QACD,OAAO,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC;IAChG,CAAC;IAEO,oBAAoB,CAAC,eAAgC;QAC3D,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,CAAC,IAAI,CACnD,oDAAG,CAAC,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC;YACzB,eAAe,EAAE,eAAe;YAChC,gBAAgB,EAAE,gBAAgB;YAClC,SAAS,EAAE,EAAE;SACd,CAAC,CAAC,CACJ,CAAC;IACJ,CAAC;IAEM,gCAAgC,CAAC,SAAoB;QAC1D,MAAM,4BAA4B,GAAG,sFAA+B,CAAC,SAAS,CAAC,CAAC;QAEhF,MAAM,mBAAmB,GAAG,IAAI,CAAC,UAAU,CAAC,gCAAgC,CAAC,oBAAoB,CAAC,CAAC,IAAI,CACrG,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,GAAG,SAAS,EAAE,CAAC,CAAC,CAAC,EAC/D,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,wBAAwB,CAAC,MAAM,CAAC,CAAC,EACtD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,4BAA4B,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC,CAAC,CACxG,CAAC;QAEF,OAAO,yCAAE,CAAC,4BAA4B,CAAC,CAAC,IAAI,CAC1C,0DAAS,CAAC,CAAC,gBAAgB,EAAE,EAAE,CAC7B,mBAAmB,CAAC,IAAI,CACtB,oDAAG,CACD,CAAC,EAAE,EAAE,EAAE,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,eAAe,EAAE,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,EACxG,uDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAC7B,CACF,CACF,CACF,CAAC;IACJ,CAAC;IAEO,wBAAwB,CAAC,KAA0B;QACzD,MAAM,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACvF,OAAO,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAC/C,CAAC;IAEO,uBAAuB,CAAC,GAAc;QAC5C,IAAI,CAAC,GAAG,EAAE;YACR,OAAO,EAAE,CAAC;SACX;QACD,OAAO,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE;YACnB,MAAM,MAAM,GAAsB;gBAChC,eAAe,EAAE,CAAC,CAAC,IAAI,CAAC;gBACxB,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC;gBACf,SAAS,EAAE,CAAC,CAAC,WAAW,CAAC;gBACzB,QAAQ,EAAE,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC;aACtD,CAAC;YACF,OAAO,MAAM,CAAC;QAChB,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,kBAAkB,CAAC,EAAU;QAClC,OAAO,oDAAa,CAAC,CAAC,IAAI,CAAC,qCAAqC,EAAE,EAAE,IAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CACrG,qDAAI,CAAC,CAAC,CAAC,EACP,oDAAG,CAAC,CAAC,CAAC,UAAU,EAAE,GAAG,CAAC,EAAE,EAAE;YACxB,IAAI,CAAC,UAAU,EAAE;gBACf,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;aACtF;YACD,IAAI,CAAC,GAAG,EAAE;gBACR,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,sDAAsD,EAAE,EAAE,CAAC,CAAC;aACrF;QACH,CAAC,CAAC,EACF,0DAAS,CAAC,CAAC,CAAC,UAAU,EAAE,GAAG,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,IAAI,UAAU,CAAC,CAAC,CAAC,2CAAI,CAAC,UAAU,CAAC,WAAW,CAAC,cAAc,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAC3H,CAAC;IACJ,CAAC;IAEM,iBAAiB,CAAC,EAAU;QACjC,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC,SAAS,CACnC,GAAG,EAAE,CAAC,IAAI,EACV,CAAC,GAAG,EAAE,EAAE;YACN,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,+BAA+B,EAAE,GAAG,CAAC,CAAC;QAChE,CAAC,CACF,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,gBAAgB,CAAC,EAAU;QAChC,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,oDAAG,CAAC,CAAC,UAAU,EAAE,EAAE;YACjB,IAAI,CAAC,UAAU,EAAE;gBACf,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,2DAA2D,CAAC,CAAC;aACtF;QACH,CAAC,CAAC,EACF,0DAAS,CAAC,CAAC,UAAU,EAAE,EAAE,CACvB,UAAU,CAAC,CAAC,CAAC,2CAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,cAAc,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,yCAAE,CAAC,SAAS,CAAC,CAClI,EACD,0DAAS,CAAC,CAAC,GAAkB,EAAE,EAAE,CAC/B,GAAG;YACD,CAAC,CAAC,IAAI,CAAC,gCAAgC,CAAC,GAAG,CAAC,CAAC,IAAI,CAC7C,0DAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,oBAAoB,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC,EACjE,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAChB;YACH,CAAC,CAAC,yCAAE,CAAC,KAAK,CAAC,CACd,CACF,CAAC;IACJ,CAAC;IAED;;OAEG;IACI,eAAe,CAAC,EAAU;QAC/B,IAAI,CAAC,gBAAgB,CAAC,EAAE,CAAC,CAAC,SAAS,EAAE,CAAC;IACxC,CAAC;IAEM,6BAA6B,CAAC,EAAU;QAC7C,OAAO,IAAI,CAAC,iCAAiC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;IAC7F,CAAC;IAEM,iCAAiC,CAAC,EAAU;QACjD,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,wEAAiB,CAAC,GAAG,CAAC,CAAC,CAAC;YAC9E,IAAI,CAAC,oBAAoB,CAAC,cAAc,CAAC,EAAE,CAAC;SAC7C,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,CAAC,mBAAmB,EAAE,cAAc,CAAC,EAAE,EAAE,CAAC;YAC7C,GAAG,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,UAAoC,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;YAClG,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,KAA0B,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;SACpF,CAAC,CACH,CAAC;IACJ,CAAC;IAEM,yCAAyC,CAAC,EAAU,EAAE,eAAgC;QAC3F,OAAO,IAAI,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,wEAAiB,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC;IACzG,CAAC;IAEM,oCAAoC,CAAC,EAAU,EAAE,eAAgC;QACtF,OAAO,IAAI,CAAC,oBAAoB;aAC7B,cAAc,CAAC,EAAE,CAAC;aAClB,IAAI,CAAC,oDAAG,CAAC,CAAC,WAAwC,EAAE,EAAE,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,CAAC,CAAC;IAC/H,CAAC;IAEM,oCAAoC,CAAC,EAAU,EAAE,eAAgC;QACtF,OAAO,oDAAa,CAAC;YACnB,IAAI,CAAC,yCAAyC,CAAC,EAAE,EAAE,eAAe,CAAC;YACnE,IAAI,CAAC,oCAAoC,CAAC,EAAE,EAAE,eAAe,CAAC;SAC/D,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,CAAC,mBAAmB,EAAE,cAAc,CAAC,EAAE,EAAE,CAAC;YAC7C,GAAG,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,UAAoC,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;YAClG,GAAG,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,KAA0B,EAAE,UAAU,EAAE,CAAC,EAAE,CAAC,CAAC;SACpF,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,kCAAkC,CAAC,EAAU;QACnD,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,0DAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAC1D,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,CAChC,CAAC;IACJ,CAAC;IAEO,yBAAyB;QAC/B,OAAO,IAAI,CAAC,qCAAqC,EAAE,CAAC,IAAI,CACtD,0DAAS,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,YAAY,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC,EACvG,qEAAoB,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC,uDAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAChD,CAAC;IACJ,CAAC;IAEO,4BAA4B,CAAC,OAAgB;QACnD,OAAO,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAA2B,OAAO,EAAE,oFAAwB,CAAC,CAAC;IAC5G,CAAC;IAEO,qCAAqC;QAC3C,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,CAAC,4BAA4B,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;IACzG,CAAC;IAEO,0BAA0B;QAChC,OAAO,IAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,IAAI,CAC7C,qEAAoB,EAAE,EACtB,uDAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,EAC1B,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,oBAAoB,CAAC,CAAC,CAC1D,CAAC;IACJ,CAAC;IAEO,mCAAmC;QACzC,OAAO,CAAC,GAAgC,EAAE,EAAE,CAC1C,GAAG,CAAC,IAAI,CACN,+DAAc,CAAC,IAAI,CAAC,eAAe,CAAC,yBAAyB,CAAC,EAC9D,uDAAM,CAAC,CAAC,CAAC,EAAE,YAAY,CAAC,EAAE,EAAE,CAAC,CAAC,YAAY,CAAC,UAAU,CAAC,EACtD,oDAAG,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,CAC5B,CAAC;IACN,CAAC;IAEO,gCAAgC,CAAC,eAAe,GAAG,KAAK;QAC9D,OAAO,IAAI,CAAC,oBAAoB,CAAC,IAAI,CACnC,0DAAS,CAAC,CAAC,OAAO,EAAE,EAAE,CACpB,OAAO,CAAC,MAAM,GAAG,CAAC;YAChB,CAAC,CAAC,2CAAI,CAAC,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC,IAAI,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;YAC5H,CAAC,CAAC,yHAAyH;gBACzH,yCAAE,CAAC,EAAE,CAAC,CACX,EACD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAC1F,CAAC;IACJ,CAAC;IAEY,OAAO,CAAC,GAAkB;;YACrC,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;YAC9C,OAAO,CAAC,UAAU,CAAC;QACrB,CAAC;KAAA;IAEO,UAAU,CAAC,GAAkB;QACnC,MAAM,QAAQ,GAAG,yEAAkB,CAAC,GAAG,CAAC,CAAC;QACzC,IAAI,QAAQ,EAAE;YACZ,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;SAC9B;QACD,OAAO,IAAI,CAAC,6BAA6B,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;IAC9E,CAAC;IAEa,UAAU,CAAC,GAAkB,EAAE,eAAe,GAAG,KAAK;;YAClE,IAAI,GAAG,CAAC,UAAU,KAAK,qEAAe,EAAE;gBACtC,IAAI,eAAe,IAAI,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;oBAC/C,OAAO,KAAK,CAAC;iBACd;gBACD,IAAI,GAAG,CAAC,QAAQ,IAAI,GAAG,CAAC,QAAQ,CAAC,KAAK,GAAG,CAAC,EAAE;oBAC1C,OAAO,IAAI,CAAC,CAAC,6EAA6E;iBAC3F;gBACD,OAAO,MAAM,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;aACnC;YACD,OAAO,KAAK,CAAC;QACf,CAAC;KAAA;IAEO,cAAc,CAAC,GAAkB;QACvC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE;YACjB,OAAO,KAAK,CAAC;SACd;QACD,IAAI,GAAG,CAAC,OAAO,GAAG,GAAG,CAAC,QAAQ,EAAE;YAC9B,OAAO,KAAK,CAAC;SACd;QACD,MAAM,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;QAC3E,IAAI,YAAY,GAAG,CAAC,EAAE;YACpB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,oBAAoB,YAAY,GAAG,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC;YACzE,OAAO,IAAI,CAAC;SACb;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAEO,kBAAkB,CAAC,yBAAiC,EAAE,OAAe;QAC3E,MAAM,eAAe,GAAG,CAAC,6CAAM,EAAE,CAAC,IAAI,EAAE,GAAG,yBAAyB,CAAC,GAAG,IAAI,CAAC;QAC7E,OAAO,OAAO,GAAG,eAAe,CAAC;IACnC,CAAC;IAEO,0BAA0B,CAAC,kBAA2B;QAC5D,OAAO,CAAC,GAAgC,EAAE,EAAE,CAC1C,GAAG,CAAC,IAAI,CACN,yDAAQ,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,6CAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC,CAAC,CAAC,EACvF,yDAAQ,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CACnB,CAAC;IACN,CAAC;IAEO,UAAU,CAAC,IAAmB,EAAE,kBAA2B;QACjE,OAAO,IAAI,CAAC,8BAA8B,CAAC,QAAQ,CAAC,IAAI,EAAE,kBAAkB,CAAC,CAAC,IAAI,CAChF,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,yCAAE,CAAC,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,CAAC,CAAC,EAC7D,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,sBAAsB,EAAE,MAAM,CAAC,CAAC,CACxE,CAAC;IACJ,CAAC;IAEO,uCAAuC;QAC7C,OAAO,CAAC,GAAsD,EAAE,EAAE,CAChE,GAAG,CAAC,IAAI,CACN,oDAAG,CAAC,CAAC,CAAwC,EAAE,EAAE,CAAC,iCAC7C,CAAC,CAAC,IAAI,KACT,QAAQ,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE,EACzB,UAAU,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,uEAAiB,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,KAAK,CAAC,CAAC,CAAC,CAAC,qEAAe,CAAC,CAAC,CAAC,sEAAgB,EACnG,OAAO,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,iDAAS,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,iDAAS,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,EAC3E,cAAc,EAAE,CAAC,CAAC,UAAU,EAC5B,SAAS,EAAE,CAAC,CAAC,KAAK,IAClB,CAAC,CACJ,CAAC;IACN,CAAC;IAEO,sBAAsB;QAC5B,OAAO,CAAC,GAAsD,EAAE,EAAE,CAChE,GAAG,CAAC,IAAI,CACN,IAAI,CAAC,uCAAuC,EAAE,EAC9C,0DAAS,CAAC,CAAC,IAAmB,EAAE,EAAE,CAChC,IAAI,CAAC,gCAAgC,CAAC,IAAI,CAAC,CAAC,IAAI,CAC9C,2DAAU,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,4CAA4C,EAAE,GAAG,CAAC,CAAC;YAC5E,OAAO,yCAAE,CAAC,EAAE,CAAC,CAAC;QAChB,CAAC,CAAC,EACF,oDAAG,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAChB,CACF,CACF,CAAC;IACN,CAAC;;sFA1oBU,mBAAmB,88BAYpB,gCAAgC,+MAGhC,oEAAsB;qHAfrB,mBAAmB,WAAnB,mBAAmB,mBAFlB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;AChD0C;AACZ;AACI;AACe;AAEL;AAEP;AACkB;AACtB;AAE9C,MAAe,mBAAmB;IAIvC,YAAmB,gBAAkC,EAAS,UAAsB;QAAjE,qBAAgB,GAAhB,gBAAgB,CAAkB;QAAS,eAAU,GAAV,UAAU,CAAY;IACpF,CAAC;IAED,eAAe,CAAC,GAAkB,EAAE,kBAAmC,IAAI,CAAC,eAAe;QACzF,OAAO,IAAI,CAAC,mBAAmB,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,yDAAS,CAAC,CAAC,gBAAgB,EAAE,EAAE,CAAC,mDAAa,CAAC,IAAI,CAAC,sBAAsB,CAAC,GAAG,EAAE,eAAe,EAAE,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7K,CAAC;IAEO,sBAAsB,CAAC,GAAkB,EAAE,eAAgC,EAAE,gBAAwB;QAC3G,MAAM,gBAAgB,GAAG,oFAAsB,CAAC,GAAG,EAAE,eAAe,CAAiC,CAAC;QACtG,IAAI,kEAAW,CAAC,eAAe,CAAC,EAAE;YAChC,OAAO,CAAE,gBAAqC,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,EAAE,CAC7E,IAAI,CAAC,6BAA6B,CAAC,GAAG,EAAE,eAAe,EAAE,gBAAgB,EAAE,gBAAgB,EAAE,IAAI,CAAC,aAAa,CAAC,eAAe,EAAE,gBAAgB,CAAC,CAAC,CAAC,CAAC;SACxJ;QACD,OAAO,CAAC,IAAI,CAAC,6BAA6B,CAAC,GAAG,EAAE,eAAe,EAAE,gBAAgB,EAAE,gBAA6B,EAAE,IAAI,CAAC,aAAa,CAAC,eAAe,EAAE,gBAAgB,CAAC,CAAC,CAAC,CAAC;IAC5K,CAAC;IAEO,aAAa,CAAC,eAAgC,EAAE,gBAAwB;QAC9E,OAAO;YACL,eAAe,EAAE,eAAe;YAChC,gBAAgB,EAAE,gBAAgB;YAClC,SAAS,EAAE,EAAE;SACd,CAAC;IACJ,CAAC;IAEM,mBAAmB,CAAC,eAAgC;QACzD,OAAO,IAAI,CAAC,UAAU,CAAC,+BAA+B,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,EAAE,mDAAG,CAAC,CAAC,gBAAgB,EAAE,EAAE;YAC/G,MAAM,gBAAgB,GAAG,CAAC,gBAAgB,IAAI,EAAE,CAAC;iBAC9C,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,eAAe,CAAC,CAAC;YACzC,OAAO,gBAAgB,CAAC,CAAC,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;QACvD,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAED,aAAa,CAAC,IAAyB;QACrC,MAAM,cAAc,GAAG,sCAAsC,CAAC;QAC9D,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;YAC7E,IAAI,EAAE,+EAAgB;YACtB,QAAQ,EAAE,MAAM;YAChB,MAAM,EAAE,YAAY,CAAC,cAAc,CAAC;YACpC,KAAK,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,mEAAU,CAAC,GAAG,CAAC,cAAc,IAAI,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;SACzF,CAAC,CAAC,CAAC,CAAC;IACP,CAAC;IAED,cAAc,CAAC,oBAA4B,EAAE,KAAa;QACxD,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,CAAC,CAAC,IAAI,CAC3D,mDAAG,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,IAAI,qEAAW,CACnC,YAAY,CAAC,oBAAoB,CAAC,EAAE,KAAK,CAC1C,CAAC,CAAC,CAAC;IACR,CAAC;IAED,MAAM,CAAC,GAAW;QAChB,OAAO,CAAC,mEAAO,CAAC,GAAG,CAAC,IAAI,GAAG,GAAG,CAAC,CAAC;IAClC,CAAC;IAED,aAAa,CAAC,oBAA4B,EAAE,MAAc,EAAE,GAAW;QACrE,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC,IAAI,CACzD,yDAAS,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,+BAA+B,CAAC,MAAM,CAAC;aAC/E,IAAI,CACH,oDAAI,CAAC,CAAC,CAAC,EACP,mDAAG,CAAC,CAAC,WAAyB,EAAE,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,UAAsB,EAAE,EAAE,CAAC,UAAU,CAAC,EAAE,KAAK,GAAG,CAAC,CAAC,EACvG,mDAAG,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,IAAI,qEAAW,CACjC,WAAW,EAAE,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAC/C,CAAC,CACH,CAAC,CAAC,CAAC;IACV,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;AChF6D;AAEP;AACP;AAEA;;;;AAKzC,MAAM,uBAAwB,SAAQ,uEAA4B;IAGvE,YAAmB,gBAAkC,EAAS,UAAsB;QAClF,KAAK,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QADnB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAAS,eAAU,GAAV,UAAU,CAAY;QAFpF,oBAAe,GAAG,SAAS,CAAC;IAI5B,CAAC;IAED,6BAA6B,CAAC,IAAmB,EAC/C,gBAAiC,EACjC,iBAAyB,EACzB,KAAc,EACd,OAAgB;QAChB,OAAO,IAAI,CAAC,wBAAwB,EAAE,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,iCAAM,OAAO,KAAE,SAAS,EAAE,MAAM,IAAG,CAAC,CAAC,CAAC;IACpG,CAAC;IAED,wBAAwB;QACtB,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,uCAAuC,CAAC;aACtE,IAAI,CAAC,yDAAS,CAAC,CAAC,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,wCAAwC,EAAE,WAAW,CAAC;aACxG,IAAI,CAAC,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACzC,CAAC;;8FAnBU,uBAAuB;wHAAvB,uBAAuB,WAAvB,uBAAuB,mBAFtB,MAAM;;;;;;;;;;;;;;;;;;;;;;;ACV0D;AAEf;AACd;AACM;AACJ;AAEd;;;;AAK9B,MAAM,iCAAkC,SAAQ,uEAAgD;IAGrG,YAAmB,gBAAkC,EAAS,UAAsB;QAClF,KAAK,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QADnB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAAS,eAAU,GAAV,UAAU,CAAY;QAF3E,oBAAe,GAAG,oFAAkC,CAAC;IAI9D,CAAC;IAED,6BAA6B,CAAC,IAAmB,EAC/C,gBAAiC,EACjC,iBAAyB,EACzB,KAAkC,EAClC,OAAgB;QAChB,OAAO,IAAI,CAAC,mCAAmC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,iCAAM,OAAO,KAAE,SAAS,EAAE,MAAM,IAAG,CAAC,CAAC,CAAC;IACpH,CAAC;IAED,mCAAmC,CAAC,KAAkC;QACpE,MAAM,SAAS,GAAqC,EAAE,CAAC;QACvD,IAAG,KAAK,EAAE;YACR,IAAI,KAAK,CAAC,UAAU,EAAE;gBACpB,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,yCAAyC,EAAE,KAAK,CAAC,UAAU,CAAC,CAAC,CAAC;aAClG;YACD,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,yCAAyC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;aAC/F;YACD,IAAI,KAAK,CAAC,SAAS,EAAE;gBACnB,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,2CAA2C,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC,CAAC;aACnG;YACD,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;gBACvC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;aAChD;SACF;QACD,OAAO,mDAAa,CAAC,SAAS,CAAC,CAAC;IAClC,CAAC;;kHAhCU,iCAAiC;kIAAjC,iCAAiC,WAAjC,iCAAiC,mBAFhC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;ACT6D;AAC1B;AACW;AAClB;AAEM;AACN;AACK;;;;AAK9C,MAAM,sBAAuB,SAAQ,uEAAqC;IAI/E,YAAmB,gBAAkC,EAAS,UAAsB;QAClF,KAAK,CAAC,gBAAgB,EAAE,UAAU,CAAC,CAAC;QADnB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAAS,eAAU,GAAV,UAAU,CAAY;QAF3E,oBAAe,GAAG,oFAAkC,CAAC;IAI9D,CAAC;IAED,6BAA6B,CAC3B,IAAmB,EACnB,gBAAiC,EACjC,iBAAyB,EACzB,KAAuB,EACvB,OAAgB;QAChB,OAAO,IAAI,CAAC,mCAAmC,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,iCAAM,OAAO,KAAE,SAAS,EAAE,MAAM,IAAG,CAAC,CAAC,CAAC;IACpH,CAAC;IAED,mCAAmC,CAAC,KAAuB;QACzD,MAAM,SAAS,GAAqC,EAAE,CAAC;QACvD,IAAI,KAAK,EAAE;YACT,IAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAAE;gBACtC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,kDAAkD,EAAE,uBAAuB,EAAE,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;aACzI;YAED,IAAI,CAAC,mEAAO,CAAC,KAAK,CAAC,cAAc,CAAC,EAAE;gBAClC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,gDAAgD,EAAE,GAAG,KAAK,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;aAChI;YAED,IAAG,CAAC,mEAAO,CAAC,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,mEAAO,CAAC,KAAK,CAAC,SAAS,CAAC,EAAC;gBAC5D,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC,IAAI,CACnD,yDAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,cAAc,CAAC,sCAAsC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;aAC1F;YAED,IAAI,KAAK,CAAC,OAAO,EAAE;gBACjB,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,yCAAyC,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;aAC/F;YAED,IAAG,CAAC,mEAAO,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE;gBAC7B,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,4CAA4C,EAAE,GAAG,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC,CAAC;aAC3G;SACF;QACD,OAAO,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,8CAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,wCAAE,CAAC,EAAE,CAAC,CAAC;IAC7D,CAAC;IAEO,qBAAqB,CAAC,KAAuB;QACnD,MAAM,SAAS,GAAG,CAAC,mEAAO,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,IAAI,CAAC,8BAA8B,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,wCAAE,CAAC,IAAI,CAAC,CAAC;QACjJ,OAAO,SAAS,CAAC,IAAI,CAAC,mDAAG,CAAC,CAAC,QAAQ,EAAE,EAAE;YACrC,MAAM,GAAG,GAAG,EAAE,CAAC;YACf,IAAG,CAAC,mEAAO,CAAC,KAAK,CAAC,SAAS,CAAC,EAAE;gBAC5B,GAAG,CAAC,IAAI,CAAC,GAAG,KAAK,CAAC,SAAS,MAAM,CAAC,CAAC;aACpC;YACD,IAAG,QAAQ,KAAK,IAAI,IAAI,QAAQ,KAAK,SAAS,EAAE;gBAC9C,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;aACpB;YACD,OAAO,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACzB,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAEO,8BAA8B,CAAC,aAAqB;QAC1D,IAAI,aAAa,IAAI,CAAC,IAAI,aAAa,GAAG,EAAE,IAAI,aAAa,IAAI,GAAG,EACpE;YACE,OAAO,2CAA2C,CAAC;SACpD;aACI,IAAI,aAAa,IAAI,EAAE,IAAI,aAAa,GAAG,EAAE,EAClD;YACE,OAAO,+CAA+C,CAAC;SACxD;aACI,IAAI,aAAa,IAAI,EAAE,IAAI,aAAa,GAAG,GAAG,EACnD;YACE,OAAO,0CAA0C,CAAC;SACnD;aACI,IAAI,aAAa,IAAI,GAAG,IAAI,aAAa,GAAG,GAAG,EACpD;YACE,OAAO,+CAA+C,CAAC;SACxD;aACI,IAAI,aAAa,IAAI,GAAG,IAAI,aAAa,GAAG,GAAG,EACpD;YACE,OAAO,2CAA2C,CAAC;SACpD;aACI,IAAI,aAAa,IAAI,GAAG,IAAI,aAAa,GAAG,GAAG,EACpD;YACE,OAAO,+CAA+C,CAAC;SACxD;aACI,IAAI,aAAa,IAAI,GAAG,IAAI,aAAa,GAAG,GAAG,EACpD;YACE,OAAO,0CAA0C,CAAC;SACnD;aACI,IAAI,aAAa,IAAI,GAAG,IAAI,aAAa,GAAG,GAAG,EACpD;YACE,OAAO,+CAA+C,CAAC;SACxD;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;;4FA5FU,sBAAsB;uHAAtB,sBAAsB,WAAtB,sBAAsB,mBAFrB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;ACV0B;AAGH;AACf;AACU;AAC6D;;AAEnG;;;GAGG;AAII,MAAM,eAAe;IAC1B,gBAAe,CAAC;IAEV,YAAY,CAAC,EAAU,EAAE,UAAmB;;YAChD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC7C,YAAY,CAAC,WAAW,GAAG,6CAAM,EAAE,CAAC,WAAW,EAAE,CAAC;YAClD,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC;YAC9B,YAAY,CAAC,aAAa,GAAG,IAAI,CAAC;YAClC,YAAY,CAAC,QAAQ,GAAG,CAAC,CAAC;YAC1B,YAAY,CAAC,aAAa,GAAG,CAAC,CAAC;YAC/B,YAAY,CAAC,UAAU,GAAG,UAAU,CAAC;YACrC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC;YAC1B,YAAY,CAAC,YAAY,GAAG,IAAI,CAAC;YACjC,YAAY,CAAC,MAAM,GAAG,EAAE,CAAC;YACzB,OAAO,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEK,cAAc,CAClB,EAAU,EACV,aAAqB,EACrB,UAAkB,EAClB,MAAe;;YAEf,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC7C,YAAY,CAAC,aAAa,GAAG,aAAa,CAAC;YAC3C,YAAY,CAAC,UAAU,GAAG,UAAU,CAAC;YACrC,YAAY,CAAC,MAAM,GAAG,MAAM,CAAC;YAC7B,YAAY,CAAC,QAAQ,GAAG,aAAa,GAAG,UAAU,CAAC;YACnD,OAAO,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEK,gBAAgB,CACpB,EAAU,EACV,UAAmB,EACnB,aAAoB,EACpB,WAAkB;;YAElB,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC7C,YAAY,CAAC,SAAS,GAAG,KAAK,CAAC;YAC/B,YAAY,CAAC,aAAa,GAAG,6CAAM,EAAE,CAAC,WAAW,EAAE,CAAC;YACpD,YAAY,CAAC,WAAW,GAAG,6CAAM,EAAE,CAAC,WAAW,EAAE,CAAC;YAClD,YAAY,CAAC,QAAQ,GAAG,GAAG,CAAC;YAC5B,YAAY,CAAC,UAAU,GAAG,UAAU,CAAC;YACrC,YAAY,CAAC,aAAa,GAAG,UAAU,CAAC;YACxC,YAAY,CAAC,aAAa,GAAG,6CAAM,CAAC,aAAa,CAAC,CAAC,WAAW,EAAE,CAAC;YACjE,YAAY,CAAC,WAAW,GAAG,6CAAM,CAAC,WAAW,CAAC,CAAC,WAAW,EAAE,CAAC;YAC7D,OAAO,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEK,YAAY,CAAC,EAAU,EAAE,YAAoB;;YACjD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC7C,YAAY,CAAC,SAAS,GAAG,KAAK,CAAC;YAC/B,YAAY,CAAC,aAAa,GAAG,6CAAM,EAAE,CAAC,WAAW,EAAE,CAAC;YACpD,YAAY,CAAC,QAAQ,GAAG,GAAG,CAAC;YAC5B,YAAY,CAAC,MAAM,GAAG,OAAO,CAAC;YAC9B,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC;YAC1B,YAAY,CAAC,YAAY,GAAG,YAAY,CAAC;YACzC,OAAO,IAAI,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;QAC7C,CAAC;KAAA;IAEa,gBAAgB,CAAC,IAAe;;YAC5C,OAAO,oDAAI,CAAC,mEAA6B,CAAC,CAAC,KAAK,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,IAAI,EAAE,CAAC;QAC1E,CAAC;KAAA;IAED,QAAQ,CAAC,EAAU;QACjB,OAAO,IAAI,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;IACjE,CAAC;IAED,oBAAoB,CAAC,EAAU;QAC7B,OAAO,IAAI,qGAAwB,CACjC,oDAAI,CAAC,mEAA6B,CAAC;aAChC,KAAK,CAAC,QAAQ,CAAC;aACf,KAAK,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC;aACzB,MAAM,EAAE,CACZ,CAAC,IAAI,CACJ,mDAAG,CAAC,CAAC,GAAgB,EAAE,EAAE,CACvB,GAAG,CAAC,MAAM,GAAG,CAAC;YACZ,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACR,CAAC,CAAC;gBACA,EAAE;gBACF,SAAS,EAAE,IAAI;gBACf,WAAW,EAAE,IAAI;gBACjB,SAAS,EAAE,KAAK;gBAChB,OAAO,EAAE,IAAI;aACd,CACJ,CACF,CAAC;IACJ,CAAC;;8EAvFU,eAAe;gHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACd4D;AACjC;AASvB;AACyE;AACA;AAC1B;AAC3B;AAChB;AAE0E;;;;;;;;;ICRhG,uEAA+C;IAAA,uDAAqB;IAAA,4DAAO;;;IAA5B,0DAAqB;IAArB,8FAAqB;;;IAElE,uEAAuC;IAAA,uDAIvC;;;;;IAAA,4DAAO;;;IAJgC,0DAIvC;IAJuC,uhBAIvC;;;IALF,uEAA+C;IAC7C,mIAIO;IACT,4DAAO;;;;;IALE,0DAAe;IAAf,6EAAe;;;IAMxB,uEAA8C;IAC5C,uDACF;IAAA,4DAAO;;;;IADL,0DACF;IADE,2HACF;;;IACA,uEAAuC;IAAA,oEAAS;IAAA,4DAAO;;;IAbzD,sEAAyC;IACvC,uDACA;IAAA,2HAA2E;IAC3E,2HAMO;IACP,2HAEO;IACP,2HAAuD;IACzD,4DAAM;;;;IAbJ,0DACA;IADA,yHACA;IAAO,0DAAsC;IAAtC,qGAAsC;IACtC,0DAAsC;IAAtC,qGAAsC;IAOtC,0DAAqC;IAArC,oGAAqC;IAGrC,0DAA8B;IAA9B,6FAA8B;;;;;;IApB3C,sEAA8B;IAC5B,6EAAuF;IACrF,oFAAoC;IAApB,6TAAmB;IACjC,yEAA+E;IACjF,4DAAiB;IACnB,4DAAU;IACV,oFAAoG;IAClG,mHAcM;IACR,4DAAc;IAChB,4DAAM;;;IAtBqD,0DAA6B;IAA7B,yJAA6B;IAExE,0DAAyD;IAAzD,yHAAyD;IAGzB,0DAAqD;IAArD,4KAAqD;IAC3E,0DAAiB;IAAjB,0FAAiB;;;IAkBzC,mEACF;;ADFO,MAAM,iBAAiB;IAS5B,YACU,kBAAsC,EACtC,kBAAsC,EACtC,MAAc;QAFd,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,WAAM,GAAN,MAAM,CAAQ;QAPhB,eAAU,GAAG,IAAI,yCAAO,EAAQ,CAAC;IAQtC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CACvD,mDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,oBAAoB,CAAC,EACpC,oEAAoB,EAAE,EACtB,0EAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CACvB,CAAC;QACF,IAAI,CAAC,QAAQ;aACV,IAAI,CACH,yDAAS,CAAC,CAAC,IAAI,EAAE,EAAE,CACjB,IAAI;YACF,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,IAAI,CACjC,qDAAI,CAAC,CAAC,GAAqB,EAAE,GAAG,EAAE,EAAE;gBAClC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACd,OAAO,GAAG,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;YACxB,CAAC,EAAE,EAAE,CAAC,EACN,6DAAY,CAAC,GAAG,CAAC,CAClB;YACD,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CACX,EACD,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC3B;aACA,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,cAAc,GAAG,GAAG,CAAC;YAC5B,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,cAAc,EAAE,CAAC;YACxB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,kBAAkB,CAAC,IAAI;aACzB,IAAI,CACH,uDAAM,CACJ,CAAC,GAAG,EAAE,EAAE,CACN,GAAG,CAAC,MAAM,KAAK,kBAAkB;YACjC,GAAG,CAAC,MAAM,KAAK,iBAAiB,CACnC,EACD,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,kBAAkB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAChE,oEAAoB,EAAE,EACtB,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC3B;aACA,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,UAAU,CAAC,GAAG,EAAE;gBACd,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;YACxB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,WAAW;QACT,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;IAC7B,CAAC;IAED,cAAc;QACZ,IAAI,IAAI,CAAC,KAAK,EAAE;YACd,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,CAAC;SAC7B;IACH,CAAC;IAED,iBAAiB,CAAC,SAAiB;QACjC,OAAO,kDAAW,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC;IACrE,CAAC;IAED,qBAAqB,CAAC,GAAkB;QACtC,IAAI,CAAC,GAAG,EAAE;YACR,OAAO,aAAa,CAAC;SACtB;QACD,QAAQ,GAAG,CAAC,IAAI,EAAE;YAClB,KAAK,sHAAqC;gBACxC,OAAO,mBAAmB,CAAC;YAC7B,KAAK,yHAAwC;gBAC3C,OAAO,sBAAsB,CAAC;YAChC,KAAK,6GAA4B;gBAC/B,OAAO,SAAS,CAAC;YACnB;gBACE,OAAO,GAAG,CAAC,OAAO,CAAC;SACpB;IACH,CAAC;;kFAjGU,iBAAiB;+GAAjB,iBAAiB;;;;;;QCxB9B,6GAuBM;;QACN,yMAEc;;QA1BR,+IAAsB;;;;;;;;;;;;;;;;;;;;ACCmD;AACxB;;AAOhD,MAAM,cAAc;;4EAAd,cAAc;2GAAd,cAAc;+GAJhB,CAAC,+DAAY,CAAC;mIAIZ,cAAc,mBAHV,wFAAiB,aADtB,+DAAY,aAEZ,wFAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACEN;AACM;AAC0B;AACI;AAEd;AAE2B;AACY;;;AAGpF,MAAM,UAAU,GAAG,gCAAgC,CAAC;AACpD,MAAM,QAAQ,GAAG,+BAA+B,CAAC;AACjD,MAAM,WAAW,GAAG,sCAAsC,CAAC;AAQpD,MAAM,iBAAiB;IAQ5B,YAAoB,GAAsB;QAAtB,QAAG,GAAH,GAAG,CAAmB;QAE1C,YAAO,GAAiB;YACtB,IAAI,EAAE,kFAA2C;YACjD,OAAO,EAAE,iEAA0B;YACnC,OAAO,EAAE,CAAC;YACV,kBAAkB,EAAE,KAAK;YACzB,kBAAkB,EAAE,KAAK;YACzB,WAAW,EAAE,KAAK;YAClB,eAAe,EAAE,QAAQ;YACzB,SAAS,EAAE,QAAQ;YACnB,WAAW,EAAE,KAAK;YAClB,MAAM,EAAE,2CAAQ,CAAC,oEAA8C,CAAC;SACjE,CAAC;IAb2C,CAAC;IAetC,gBAAgB,CAAC,KAAK,GAAG,KAAK;QACpC,OAAO,yCAAM,CAAC;YACZ,OAAO,EAAE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ;YACtC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YAClB,UAAU,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC;YACtB,SAAS,EAAE,2BAA2B;YACtC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;SACrB,CAAC,CAAC;IACL,CAAC;IAEO,aAAa;QACnB,OAAO,yCAAM,CAAC;YACZ,OAAO,EAAE,WAAW;YACpB,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YAClB,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YACpB,SAAS,EAAE,2BAA2B;YACtC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;SACrB,CAAC,CAAC;IACL,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,gBAAgB,GAAG,IAAI,iDAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3D,IAAI,CAAC,UAAU,GAAG,IAAI,yCAAO,EAAE,CAAC;IAClC,CAAC;IAED,WAAW,CAAC,OAA2C;QACrD,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,GAAG,IAAI,iDAAe,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC5D;QACD,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC;IAC5D,CAAC;IAED,WAAW;QACT,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;IACD,iBAAiB,CAAC,GAAU;QAC1B,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACvE,IAAI,IAAI,CAAC,GAAG,EAAE;gBACZ,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC;aAC/C;YACD,IAAI,CAAC,aAAa,EAAE,CAAC;YACrB,IAAI,GAAG,IAAI,GAAG,CAAC,MAAM,EAAE;gBACrB,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAChD,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,SAAS,CAAC,CAAC;aAC3C;YACD,IAAI,GAAG,IAAI,GAAG,CAAC,iBAAiB,EAAE;gBAChC,IAAI,CAAC,oBAAoB,CACvB,GAAG,CAAC,iBAAiB,CAAC,KAAK,EAC3B,GAAG,CAAC,iBAAiB,CAAC,IAAI,CAC3B,CAAC;aACH;YACD,IAAI,GAAG,IAAI,GAAG,CAAC,eAAe,IAAI,GAAG,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;gBAChE,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;aAC9C;QACH,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE;YACnB,IAAI,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;gBAChB,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;aACxB;YACD,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;YAC5B,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC;YAC7B,IAAI,CAAC,GAAG,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;SAC5B;QACD,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAED,SAAS;QACP,IAAI,OAAO,GAAG,CAAC,CAAC;QAChB,2CAAK,CAAC,GAAG,EAAE,EAAE,CAAC;aACX,IAAI,CACH,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,EAC1B,yDAAS,CAAC,GAAG,EAAE,CAAC,OAAO,GAAG,CAAC,CAAC,EAC5B,oDAAG,CAAC,GAAG,EAAE,CAAC,OAAO,EAAE,CAAC,CACrB;aACA,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,IAAI,CAAC,GAAG,EAAE;gBACZ,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC;aAC3B;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,UAAU;QAChB,IAAI,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;YACzC,OAAO,CACL,wFAAuB,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;gBAC7C,0FAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAChD,CAAC;SACH;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAEO,aAAa;QACnB,MAAM,GAAG,GAAG,IAAI,CAAC,UAAU,EAAE;YAC3B,CAAC,CAAC,+EAAwC;YAC1C,CAAC,CAAC,gFAAyC,CAAC;QAC9C,8CAAW,CAAC,GAAG,EAAE;YACf,cAAc,EAAE,IAAI;YACpB,UAAU,EAAE,CAAC;SACd,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;IAEO,SAAS,CAAC,MAAgB,EAAE,SAAoB;QACtD,2CAAQ,CAAC,MAAM,EAAE;YACf,IAAI,EAAE,IAAI,4FAAqB,CAAC,SAAS,CAAC;YAC1C,WAAW,EAAE,KAAK;SACnB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;IAEO,oBAAoB,CAAC,KAAe,EAAE,IAAc;QAC1D,IAAI,KAAK,EAAE;YACT,2CAAQ,CAAC,KAAK,EAAE;gBACd,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC;gBACjC,WAAW,EAAE,KAAK;aACnB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACpB;QACD,IAAI,IAAI,EAAE;YACR,2CAAQ,CAAC,IAAI,EAAE;gBACb,IAAI,EAAE,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC;gBAClC,WAAW,EAAE,KAAK;aACnB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACpB;QACD,IAAI,KAAK,IAAI,IAAI,EAAE;YACjB,6CAAU,CAAC,CAAC,KAAK,EAAE,IAAI,CAAC,EAAE;gBACxB,KAAK,EAAE,KAAK;gBACZ,MAAM,EAAE,CAAC;gBACT,OAAO,EAAE,GAAG;aACb,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;SACpB;IACH,CAAC;IAEO,kBAAkB,CAAC,SAAqB;QAC9C,IAAI,SAAS,IAAI,SAAS,CAAC,MAAM,GAAG,CAAC,EAAE;YACrC,KAAK,MAAM,QAAQ,IAAI,SAAS,EAAE;gBAChC,2CAAQ,CAAC,QAAQ,EAAE;oBACjB,IAAI,EAAE,IAAI,CAAC,aAAa,EAAE;oBAC1B,WAAW,EAAE,KAAK;iBACnB,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aACpB;SACF;IACH,CAAC;;kFAvKU,iBAAiB;gHAAjB,iBAAiB;QC9B9B,0EAAsF;QAA9C,iKAAmB,6BAAyB,IAAC;QACrF,6DAAM;;QADO,wFAA0B;;;;;;;;;;;;;;;;;;;;;;;;ACAmB;AAEX;AACF;AACA;AACS;AACE;;AAajD,MAAM,cAAc;;4EAAd,cAAc;2GAAd,cAAc;+GAVhB;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,gEAAe;YACf,kEAAa;SACd;mIAIU,cAAc,mBAHV,mEAAiB,aAN9B,yDAAY;QACZ,uDAAW;QACX,uDAAW;QACX,gEAAe;QACf,kEAAa,aAGL,mEAAiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjBgF;AAClD;AACH;AACD;AACE;AACO;AACgB;AACpB;AACiC;AAChB;AACN;;;;;;;;;;;;;ICS/D,uEAC+C;IAAA,uDAA0B;IAAA,4DAAO;;;IAAjC,0DAA0B;IAA1B,qGAA0B;;;IAF3E,6EAAqD;IACnD,6IACgF;IAAA,uDAClF;IAAA,4DAAU;;;IADL,0DAA0C;IAA1C,oHAA0C;IAAmC,0DAClF;IADkF,oGAClF;;;IAIE,wEAAwC;IACtC,uDACF;;IAAA,qEAAe;;;IADb,0DACF;IADE,qMACF;;;IAEE,uEAAiC;IAAA,kEAAO;IAAA,4DAAO;;;;IADjD,wEAAwC;IACtC,4JAA+C;IAC/C,0EAAiC;IAC/B,sEACO;IACT,4DAAO;IACP,uDACF;IAAA,qEAAe;;;IANN,0DAAwB;IAAxB,4FAAwB;IAEC,0DAAwD;IAAxD,kLAAwD;IAGxF,0DACF;IADE,mGACF;;;IAXF,6EAAmF;IACjF,6JAEe;IACf,6JAOe;IACjB,4DAAU;;;IAXO,0DAAuB;IAAvB,0FAAuB;IAGvB,0DAAuB;IAAvB,0FAAuB;;;IAb1C,wEAAoD;IAGlD,yIAGU;IAGV,yIAYU;IAEZ,qEAAe;;;IApBwB,0DAAc;IAAd,iFAAc;IAMd,0DAA4C;IAA5C,sHAA4C;;;IAiBnF,6EAAsD;IACpD,uDAEF;;;;;IAAA,4DAAU;;;IAFR,0DAEF;IAFE,8dAEF;;;IAMM,0EAAiG;;;IACjG,0EAAmG;;;IAFrG,wEAA2D;IACzD,sJAAiG;IACjG,sJAAmG;IACnG,uDACF;;;IAAA,qEAAe;;;IAHF,0DAA0B;IAA1B,8FAA0B;IAC1B,0DAA0B;IAA1B,8FAA0B;IACrC,0DACF;IADE,iPACF;;;IANJ,6EAA6E;IACzE,uDACA;;IAAA,8IAIe;IACnB,4DAAU;;;IANN,0DACA;IADA,kOACA;IAAe,0DAA0C;IAA1C,oHAA0C;;;IAW/D,6EAAoF;;AD3CtF,MAAM,6BAA6B,GAAG,KAAM,CAAC;AAC7C,IAAI,cAAc,GAAG,CAAC,CAAC;AAQhB,MAAM,sBAAuB,SAAQ,iFAAa;IAgCvD,YACE,UAAsB,EACd,gBAAkC,EAClC,SAAoB,EACpB,eAAgC,EAChC,gBAAkC,EAClC,QAAkB,EAC1B,kBAAsC,EAC9B,aAA4B,EAC5B,GAAsB;QAE9B,KAAK,EAAE,CAAC;QATA,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,cAAS,GAAT,SAAS,CAAW;QACpB,oBAAe,GAAf,eAAe,CAAiB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,aAAQ,GAAR,QAAQ,CAAU;QAElB,kBAAa,GAAb,aAAa,CAAe;QAC5B,QAAG,GAAH,GAAG,CAAmB;QA1BhC,YAAO,GAAG,KAAK,CAAC;QA8Bd,0DAA0D;QAC1D,4EAA4E;QAC5E,mDAAa,CAAC;YACZ,kBAAkB,CAAC,gBAAgB;YACnC,UAAU,CAAC,WAAW;SACvB,CAAC;aACC,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,CAAC,MAAM,EAAE,UAAU,CAAC,EAAE,EAAE;YAClC,IAAI,CAAC,OAAO,GAAG,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC;YAC1C,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;QAEL,UAAU,CAAC,iCAAiC;aACzC,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,UAAU,EAAE,EAAE;YACxB,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC;YACnC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;YACrB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,oBAAoB,CAAC,UAAU,CAAC,CAAC;YACtC,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IA7DD,IAAI,aAAa;;QACf,OAAO,UAAI,CAAC,cAAc,0CAAE,aAAa,CAAC;IAC5C,CAAC;IASD,IAAI,QAAQ;;QACV,IAAI,WAAI,CAAC,OAAO,0CAAE,MAAM,KAAI,IAAI,CAAC,SAAS,IAAI,IAAI,EAAE;YAClD,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;gBAC/B,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ;gBACjC,GAAG,EAAE,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS;aACnC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,IAAI,gBAAgB;;QAClB,IAAI,iBAAI,CAAC,OAAO,0CAAE,MAAM,0CAAE,QAAQ,KAAI,IAAI,IAAI,IAAI,CAAC,SAAS,EAAE;YAC5D,OAAO,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC;SACtD;IACH,CAAC;IAuCD,2BAA2B,CAAC,KAAa;QACvC,OAAO,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IACnD,CAAC;IAEO,oBAAoB,CAAC,OAAiB;QAC5C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;QAEpB,MAAM,mBAAmB,GAAG,IAAI,CAAC,gBAAgB;aAC9C,WAAW,CAAC,OAAO,CAAC;aACpB,IAAI,CACH,wDAAO,CAAC,6BAA6B,CAAC,EACtC,2DAAU,CAAC,GAAG,EAAE,CAAC,yCAAE,CAAC,EAAc,CAAC,CAAC,CACrC,CAAC;QAEJ,mDAAmD;QACnD,uCAAuC;QACvC,cAAc,EAAE,CAAC;QACjB,MAAM,YAAY,GAAG,cAAc,CAAC;QAEpC,qDAAc,CAAC,mBAAmB,CAAC;aAChC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACf,IAAI,YAAY,GAAG,cAAc;gBAAE,OAAO;YAE1C,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC,QAAQ,CAAC;YAClC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC;YACpC,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,SAAS,CAAC;YACpC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,wBAAwB;QAC9B,OAAO,CACL,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC;YAC1B,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CACzD,CAAC;IACJ,CAAC;IAEK,eAAe;;YACnB,MAAM,UAAU,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,KAAK,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;YAClE,IAAI,IAAI,CAAC,wBAAwB,EAAE,EAAE;gBACnC,MAAM,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACvC;iBAAM;gBACL,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;aACrC;YACD,MAAM,SAAS,GAAG,MAAM,qDAAc,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC,CAAC;YACzG,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,OAAO,EAAE,SAAS;gBAClB,IAAI,EAAE,IAAI;gBACV,QAAQ,EAAE,IAAI;aACf,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAEO,kBAAkB,CAAC,GAAW;QACpC,MAAM,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;QAClD,MAAM,CAAC,KAAK,CAAC,QAAQ,GAAG,OAAO,CAAC;QAChC,MAAM,CAAC,KAAK,CAAC,IAAI,GAAG,GAAG,CAAC;QACxB,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,GAAG,CAAC;QACvB,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,GAAG,CAAC;QAC3B,MAAM,CAAC,KAAK,GAAG,GAAG,CAAC;QACnB,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAClC,MAAM,CAAC,KAAK,EAAE,CAAC;QACf,MAAM,CAAC,MAAM,EAAE,CAAC;QAChB,QAAQ,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;QAC7B,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,CAAC;IACpC,CAAC;;4FAvIU,sBAAsB;oHAAtB,sBAAsB;;;;;;QCrBnC,oEAA+D;QAG/D,4EAIC;QADC,2IAAS,qBAAiB,IAAC;QAE3B,8EAAiC;QAE/B,oIAuBe;QAGf,2HAGU;QAGV,0HAOU;QAEZ,4DAAW;QACb,4DAAM;QAEN,8MAEc;;;QA9CK,0DAAgB;QAAhB,8EAAgB;QA0BM,0DAAe;QAAf,+EAAe;QAMf,0DAAsC;QAAtC,0GAAsC;;;;;;;;;;;;;;;;;;;;;;AC9CgB;;;;;;AAQxF,MAAM,yBAAyB;IAGpC,YAAoB,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACtD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC;IAC5D,CAAC;IAED,gBAAgB;QACd,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,EAAE,CAAC;IAC5C,CAAC;IAED,MAAM,CAAC,YAAqB;QAC1B,OAAO,gBAAgB,YAAY,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ,MAAM,CAAC;IACpE,CAAC;;kGAbU,yBAAyB;uHAAzB,yBAAyB;QCTtC,0EAAS;QACP,oFAA8F;QAA7B,yJAAS,sBAAkB,IAAC;QAC3F,yEAA2D;;QAC7D,4DAAiB;QACnB,4DAAU;;QAFI,0DAAqC;QAArC,+JAAqC;;;;;;;;;;;;;;;;;;;;;ACK5B;AACwC;;;;;;AASxD,MAAM,kBAAkB;IAK7B,YACU,UAAsB,EACtB,KAAwB;QADxB,eAAU,GAAV,UAAU,CAAY;QACtB,UAAK,GAAL,KAAK,CAAmB;IAC/B,CAAC;IAEJ,kBAAkB;QAChB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YAChE,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;YACtB,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;QAC7B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,CAAC;IAC7B,CAAC;IAED,QAAQ,KAAI,CAAC;IAEb,WAAW;QACT,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;SACjC;IACH,CAAC;IAED,eAAe;QACb,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,CAAC;IACpC,CAAC;;oFA5BU,kBAAkB;gHAAlB,kBAAkB;QCjB/B,0EAAS;QACP,oFAC8B;QAA5B,kJAAS,qBAAiB,IAAC;QAC3B,yEAAmC;QACrC,4DAAiB;QACnB,4DAAU;;QAJyD,0DAAkC;QAAlC,0JAAkC;;;;;;;;;;;;;;;;;;;;;;;ACAT;;;;;;;;ICA1F,4EAAuD;;;IACvD,mFAA4E;;;IAC5E,4EAAuD;;;ADMlD,MAAM,oBAAoB;IAM/B,YAAoB,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;QAL/C,kBAAa,GAAG,IAAI,CAAC;QACrB,yBAAoB,GAAG,IAAI,CAAC;QAC5B,kBAAa,GAAG,IAAI,CAAC;QAI5B,IAAI,CAAC,WAAW,GAAG,iBAAiB,CAAC,aAAa,CAAC;IACrD,CAAC;IAED,QAAQ,KAAI,CAAC;;wFAVF,oBAAoB;kHAApB,oBAAoB;QCTjC,yEAA6E;;QAC3E,sIAAuD;QACvD,oJAA4E;QAC5E,sIAAuD;QACzD,4DAAM;;QAJoB,4NAAkD;QACzD,0DAAmB;QAAnB,mFAAmB;QACZ,0DAA0B;QAA1B,0FAA0B;QACjC,0DAAmB;QAAnB,mFAAmB;;;;;;;;;;;;;;;;;;;;;;;ACFW;AACiC;AACF;;;AAOzE,MAAM,kBAAkB;IAC7B,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAExD,QAAQ,KAAI,CAAC;IAEP,YAAY;;YAChB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,kFAAe;gBAC1B,aAAa,EAAE,IAAI;gBACnB,cAAc,EAAE,+FAAgC;gBAChD,cAAc,EAAE,8FAA+B;aAChD,CAAC,CAAC;YACH,OAAO,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;QAC/B,CAAC;KAAA;;oFAbU,kBAAkB;gHAAlB,kBAAkB;QCV/B,0EAAS;QACP,oFAA0F;QAAzB,kJAAS,kBAAc,IAAC;QACvF,yEAAmC;QACrC,4DAAiB;QACnB,4DAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACMa;AACM;AACoE;AACrB;AAEzB;AAEmC;AAC1B;AAQpC;AACoE;AACV;AACF;AAChB;AAKlB;AACoC;AACY;AACG;AAEnD;AAC8B;AAClC;;;;;;;;;;;;;;;IC1C1C,0EAAqG;IAA9C,wVAA6C;IACpG,6DAAM;;;IADsB,2FAA0B;;AD8CtD,MAAM,SAAS,GAAG,cAAc,CAAC;AAIjC,MAAM,WAAW,GAAG,CAAC,KAAa,EAAE,EAAE,CAAY,MAAM,CAAC,MAAM,CAAC,+DAAO,CAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;AAC1F,MAAM,wBAAwB,GAAG,CAAC,UAAwB,EAAE,EAAE;IAC5D,UAAU,CAAC,SAAS,CAAC,CAAC,KAAK,EAAE,EAAE;QAC7B,IAAI,KAAK,YAAY,8CAAW,EAAE;YAChC,KAAK,CAAC,MAAM,EAAE,CAAC;SAChB;IACH,CAAC,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,2EAA2E;AAC3E,MAAM,oBAAoB,GAAG,CAAC,GAAyB,EAAE,YAAqB,EAAsB,EAAE;IACpG,IAAI,YAAY,EAAE;QAChB,OAAO;YACL,aAAa,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;YAC9C,aAAa,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC;SACzC,CAAC;KACH;SAAM;QACL,OAAO;YACL,aAAa,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;YAC7B,aAAa,EAAE,GAAG,CAAC,IAAI;SACxB,CAAC;KACH;AACH,CAAC,CAAC;AAEF,IAAK,cAOJ;AAPD,WAAK,cAAc;IACjB,+FAA8B;IAC9B,wFAA2B;IAC3B,sFAA0B;IAC1B,kFAAwB;IACxB,gFAAuB;IACvB,kDAAQ;AACV,CAAC,EAPI,cAAc,KAAd,cAAc,QAOlB;AAOM,MAAM,YAAY;IA4BvB,YACU,kBAAsC,EACtC,UAAsB,EACtB,gBAAkC,EAClC,IAAY,EACZ,iBAAoC,EACpC,cAA8B,EAC9B,kBAAsC,EACtC,IAAU,EACV,QAAkB,EAC1B,QAAkB;QATV,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,eAAU,GAAV,UAAU,CAAY;QACtB,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,SAAI,GAAJ,IAAI,CAAQ;QACZ,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,SAAI,GAAJ,IAAI,CAAM;QACV,aAAQ,GAAR,QAAQ,CAAU;QApCnB,kBAAa,GAAG,IAAI,CAAC;QACrB,yBAAoB,GAAG,IAAI,CAAC;QAC5B,kBAAa,GAAG,IAAI,CAAC;QACrB,qBAAgB,GAAG,IAAI,CAAC;QACxB,cAAS,GAAG,IAAI,CAAC;QACjB,oBAAe,GAAG,IAAI,CAAC;QAGtB,aAAQ,GAAwB,IAAI,wDAAY,EAAE,CAAC;QACpD,iBAAY,GAAG,IAAI,CAAC;QACpB,WAAM,GAAG,SAAS,CAAC;QACnB,uBAAkB,GAAG,KAAK,CAAC;QAEpC,WAAM,GAAG,KAAK,CAAC;QAEP,eAAU,GAAG,+CAAY,EAAE,CAAC;QAC5B,0BAAqB,GAAG,+CAAY,EAAE,CAAC;QACvC,gCAA2B,GAAG,+CAAY,EAAE,CAAC;QAE7C,wBAAmB,GAAG,IAAI,CAAC;QAC3B,eAAU,GAAG,IAAI,0CAAO,EAAQ,CAAC;QACjC,eAAU,GAAG,IAAI,CAAC;QAClB,sBAAiB,GAAG,KAAK,CAAC;QAC1B,2BAAsB,GAAG,IAAI,CAAC;QAgBpC,IAAI,2FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,iBAAiB,GAAG,QAAQ,CAAC,GAAG,CAAC,8FAAiB,CAAC,CAAC;SAC1D;QAED,uDAAuD;QACvD,gDAAa,CAAC;YACZ,cAAc,EAAE;gBACd,IAAI,IAAI,CAAC,QAAQ,KAAK,SAAS,EAAE;oBAC/B,OAAO,IAAI,0CAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;iBAC1B;gBACD,OAAO,wDAAqB,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,IAAI,0CAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YACnE,CAAC;YACD,SAAS,EAAE,UAAU,MAAM;gBACzB,IAAI,IAAI,CAAC,QAAQ,EAAE;oBACjB,wDAAqB,CACnB,IAAI,CAAC,QAAQ,EACb,IAAI,CAAC,cAAc,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,CACvC,CAAC;iBACH;YACH,CAAC;SACF,CAAC,CAAC;IACL,CAAC;IAIK,QAAQ;;YACZ,IAAI,CAAC,OAAO,GAAG;gBACb,IAAI,EACF,IAAI,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,qEAA8B;gBACtE,OAAO,EAAE,iEAA0B;gBACnC,OAAO,EAAE,iEAA0B;gBACnC,MAAM,EACJ,IAAI,CAAC,MAAM,IAAI,2CAAQ,CAAC,oEAA8C,CAAC;gBACzE,kBAAkB,EAAE,KAAK;gBACzB,kBAAkB,EAAE,KAAK;gBACzB,WAAW,EAAE,KAAK;gBAClB,SAAS,EAAE,IAAI,iDAAc,CAC3B,IAAI,2CAAQ,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,EAC1B,IAAI,2CAAQ,CAAC,CAAC,EAAE,EAAE,KAAK,CAAC,CACzB;gBACD,kBAAkB,EAAE,GAAG;aACxB,CAAC;YACF,IAAI,CAAC,QAAQ,GAAG,IAAI,kDAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACvD,IAAI;gBACF,IAAI,IAAI,CAAC,MAAM,KAAK,SAAS,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;oBACxD,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,QAAQ;yBAC/C,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;yBACb,SAAS,EAAE,CAAC;oBACf,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,EAAE;wBACrC,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;wBACjC,IAAI,IAAI,CAAC,MAAM,KAAK,SAAS,EAAE;4BAC7B,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,WAAW,CAAC,MAAM,CAAC;yBAC1C;wBACD,IAAI,IAAI,CAAC,IAAI,KAAK,SAAS,EAAE;4BAC3B,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC;yBACtC;qBACF;iBACF;aACF;oBAAS;gBACR,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;aACpB;QACH,CAAC;KAAA;IAED,WAAW;QACT,IAAI,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;QACzD,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;IAED,iBAAiB,CAAC,QAAiB;QACjC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/B,CAAC;IAED,iBAAiB,CAAC,GAAU;QAC1B,qEAAqE;QACrE,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,IAAI,CAAC,SAAS,EAAE;YAClB,kDAAe,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SACjD;QAED,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC3C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,2BAA2B,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAEjD,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAC3B,mCAAmC;YACnC,yFAAyF;YACzF,sGAAsG;YACtG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,eAAe,EAAE,GAAG,EAAE;gBAChC,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAc,EAAE,EAAE;oBAC3C,IAAI,CAAC,YAAY,8CAAW,EAAE;wBAC5B,CAAC,CAAC,YAAY,EAAE,CAAC,KAAK,CAAC,MAAM,GAAG,iBAAiB,CAAC;qBACnD;gBACH,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;SACJ;QAED,IAAI,CAAC,kBAAkB,CAAC,YAAY;aACjC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,WAAW,EAAE,EAAE;YACzB,IAAI,CAAC,mBAAmB,CAAC,WAAW,CAAC,CAAC;YACtC,IAAI,WAAW,CAAC,aAAa,EAAE;gBAC7B,IAAI,CAAC,aAAa,EAAE,CAAC;aACtB;QACH,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,UAAU,CAAC,WAAW;aACxB,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;YACtB,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,2BAA2B,IAAI,CAAC,UAAU,EAAE,EAC5C,SAAS,CACV,CAAC;QACJ,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,UAAU,CAAC,gBAAgB;aAC7B,IAAI,CACH,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,EAC1B,0DAAS,CAAC,GAAG,EAAE,CACb,2CAAI,CAAC,IAAI,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CACtE,CACF;aACA,SAAS,EAAE,CAAC;QAEf,IAAI,CAAC,gBAAgB,CAAC,eAAe;aAClC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,IAAI,EAAE,EAAE;YAClB,IAAI,CAAC,iBAAiB,EAAE,CAAC;YACzB,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;gBAC/B,MAAM,MAAM,GAAG,IAAI,YAAY,2CAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC;gBAC7D,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,wEAAiC,CAAC,CAAC;YACxD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,UAAU,CAAC,gBAAgB;aAC7B,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;gBAC/B,IAAI,IAAI,CAAC,UAAU,EAAE;oBACnB,MAAM,eAAe,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;oBACtD,MAAM,MAAM,GAAG,2CAAQ,CACrB,eAAe,CAAC,MAAM,CAAC,QAAQ,EAC/B,eAAe,CAAC,MAAM,CAAC,SAAS,CACjC,CAAC;oBACF,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,sBAAsB,EAAE;wBAClD,uDAAuD;wBACvD,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;qBAC3B;yBAAM;wBACL,oBAAoB;wBACpB,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,IAAI,CAAC,CAAC;qBAC9C;oBACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;iBACrC;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEL,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;YAC/B,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;YACjD,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;YAC/B,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,SAAS,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,iBAAiB,CAAC,aAAa;aACjC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,GAAG,EAAE;YACd,IAAI,CAAC,SAAS,EAAE,CAAC;QACnB,CAAC,CAAC,CAAC;QAEL,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,IAAI,CAAC,kBAAkB,CAAC,gBAAgB;iBACrC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;iBAChC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,CAAC;YAElD,IAAI,CAAC,kBAAkB,CAAC,eAAe;iBACpC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;iBAChC,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;gBACrB,IAAI,IAAI,CAAC,UAAU,EAAE;oBACnB,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;iBACrC;YACH,CAAC,CAAC,CAAC;YAEL,IAAI,CAAC,wBAAwB,EAAE,CAAC;SACjC;QAED,IAAI,CAAC,2BAA2B,EAAE,CAAC;QAEnC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,QAAQ,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,CAAC;QAElD,IAAI,2FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,eAAe,EAAE,CAAC;SACxB;QAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IAC/B,CAAC;IAEa,eAAe;;YAC3B,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,uBAAuB,EAAE,SAAS,CAAC,CAAC;YAE9D,oDAAa,CAAC;gBACZ,IAAI,CAAC,iBAAiB,CAAC,SAAS;gBAChC,IAAI,CAAC,kBAAkB,CAAC,YAAY;aACrC,CAAC;iBACC,IAAI,CAAC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;iBAChC,SAAS,CAAC,CAAC,CAAC,QAAQ,EAAE,YAAY,CAAC,EAAE,EAAE;gBACtC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;oBAC/B,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE,YAAY,CAAC,CAAC;oBAEjD,kDAAkD;oBAClD,4CAA4C;oBAC5C,sDAAsD;oBACtD,sBAAsB;oBACtB,wBAAwB,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;oBACrD,wBAAwB,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;gBAC7D,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACP,CAAC;KAAA;IAEO,kBAAkB,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAuC;QACzE,MAAM,QAAQ,GAAG,IAAI,0CAAO,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;QACvC,MAAM,MAAM,GAAG,IAAI,0CAAO,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QAEjC,MAAM,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACzC,MAAM,OAAO,GAAG,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACtC,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;QAC1C,MAAM,EAAE,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC;QAC1C,OAAO,IAAI,iDAAc,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;IACpC,CAAC;IAEO,mBAAmB,CAAC,QAA6B,EAAE,YAAyB;QAClF,IAAI,CAAC,qBAAqB,CAAC,WAAW,EAAE,CAAC;QACzC,IAAI,CAAC,2BAA2B,CAAC,WAAW,EAAE,CAAC;QAE/C,wCAAwC;QACxC,MAAM,kBAAkB,GAAG,IAAI,CAAC,kBAAkB;aAC/C,sBAAsB,CAAC,YAAY,CAAC;aACpC,MAAM,CAAC,UAAU,CAAC,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC;aACxC,MAAM,CAAC,CAAC,GAAG,EAAE,UAAU,EAAE,EAAE;YAC1B,GAAG,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC;YACrC,OAAO,GAAG,CAAC;QACb,CAAC,EAAE,IAAI,GAAG,EAAE,CAAC,CAAC;QAEhB,iCAAiC;QACjC,KAAK,MAAM,cAAc,IAAI,QAAQ,EAAE;YACrC,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE;gBACpD,IAAI,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;oBAC1B,IAAI,CAAC,yBAAyB,CAAC,GAAG,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;iBAChE;qBAAM,IAAI,kBAAkB,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;oBAC5C,MAAM,EAAE,OAAO,EAAE,GAAG,kBAAkB,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;oBACtD,IAAI,CAAC,4BAA4B,CAAC,GAAG,EAAE,OAAO,EAAE,YAAY,CAAC,YAAY,CAAC,CAAC;iBAC5E;qBAAM;oBACL,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,KAAK,4EAA4E,GAAG,CAAC,GAAG,EAAE,EAAE,SAAS,CAAC,CAAC;iBAC1I;aACF;SACF;IACH,CAAC;IAEO,yBAAyB,CAAC,GAAyB,EAAE,YAAqB;QAChF,MAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACrD,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,kBAAkB,CAAC;QACzC,MAAM,iBAAiB,GAAG,oBAAoB,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC;QAElE,MAAM,KAAK,GAAG,IAAI,8CAAW,CAAC,GAAG,kCAC5B,iBAAiB,KACpB,MAAM;YACN,uDAAuD;YACvD,2DAA2D;YAC3D,+BAA+B;YAC/B,MAAM,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC,cAAc,CAAC,sBAAsB,EAC5F,YAAY,IACZ,CAAC;QACH,IAAI,CAAC,qBAAqB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IAC7C,CAAC;IAEO,4BAA4B,CAAC,GAAyB,EAAE,OAAe,EAAE,YAAqB;QACpG,MAAM,MAAM,GAAG,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QACrD,MAAM,GAAG,GAAG,GAAG,GAAG,CAAC,GAAG,kBAAkB,CAAC;QACzC,MAAM,iBAAiB,GAAG,oBAAoB,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC;QAClE,MAAM,KAAK,GAAG,IAAI,8CAAW,CAAC,GAAG,kCAC5B,iBAAiB,KACpB,MAAM;YACN,OAAO;YACP,uDAAuD;YACvD,2DAA2D;YAC3D,+BAA+B;YAC/B,MAAM,EAAE,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,cAAc,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC,cAAc,CAAC,mBAAmB,EAC7F,YAAY,IACZ,CAAC;QACH,IAAI,CAAC,2BAA2B,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC;IACnD,CAAC;IAGO,wBAAwB;QAC9B,IAAI,CAAC,QAAQ;aACV,IAAI,CAAC,qEAAoB,EAAE,EAAE,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aACxD,SAAS,CAAC,CAAC,MAAM,EAAE,EAAE;YACpB,IAAI,MAAM,EAAE;gBACV,IAAI,CAAC,kBAAkB,CAAC,sBAAsB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;gBAC5D,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB;iBAAM;gBACL,IAAI,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;aAC5D;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,SAAS;QACf,IAAI,CAAC,iBAAiB,EAAE,CAAC;QACzB,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,CAAC;IACrC,CAAC;IAEO,YAAY;QAClB,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAEO,iBAAiB;QACvB,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;YAC3B,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,sBAAsB,EAAE,SAAS,CAAC,CAAC;YAC7D,IAAI,CAAC,UAAU,CAAC,UAAU,GAAG,KAAK,CAAC;SACpC;aAAM;YACL,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,wDAAwD,EACxD,SAAS,CACV,CAAC;SACH;IACH,CAAC;IAEO,aAAa;QACnB,IAAI,IAAI,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC;gBAC5B,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE;gBAC5B,MAAM,EAAE,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE;gBAC5B,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;aACzB,CAAC,CAAC;SACJ;IACH,CAAC;IAEO,0BAA0B,CAChC,YAAY,GAAG,KAAK;QAEpB,OAAO;YACL,OAAO,EAAE,iEAA0B;YACnC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC;YACtC,aAAa,EAAE,iEAA0B;YACzC,YAAY,EAAE,YAAY;YAC1B,cAAc,EAAE,wEAAiC;YACjD,eAAe,EAAE,yEAAkC;SACpD,CAAC;IACJ,CAAC;IAEO,mBAAmB,CAAC,WAAwB;QAClD,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;YAC/B,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;YAC9B,IAAI,CAAC,GAAG,CAAC,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC,CAAC;YAE/D,MAAM,sBAAsB,GAAG,IAAI,CAAC,mBAAmB,CACrD,WAAW,CAAC,OAAO,CACpB,CAAC;YAEF,KAAK,MAAM,eAAe,IAAI,sBAAsB,EAAE;gBACpD,MAAM,OAAO,mCACR,IAAI,CAAC,0BAA0B,CAAC,WAAW,CAAC,YAAY,CAAC,KAC5D,MAAM,EAAE,cAAc,CAAC,qBAAqB,GAC7C,CAAC;gBACF,MAAM,KAAK,GAAG,eAAe,CAAC,OAAO,CAAC,CAAC;gBACvC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9B;YAED,KAAK,MAAM,WAAW,IAAI,IAAI,CAAC,kBAAkB,CAAC,sBAAsB,CACtE,WAAW,CACZ,EAAE;gBACD,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;oBACxB,SAAS;iBACV;gBAED,MAAM,OAAO,mCACR,IAAI,CAAC,0BAA0B,CAAC,WAAW,CAAC,YAAY,CAAC,KAC5D,MAAM,EAAE,cAAc,CAAC,kBAAkB,EACzC,cAAc,EAAE,GAAG,EACnB,UAAU,EAAE,CAAC,EACb,cAAc,EAAE,IAAI,EACpB,OAAO,EAAE,4EAAqC,EAC9C,MAAM,EAAO,4EAAqC,GACnD,CAAC;gBAEF,MAAM,KAAK,GAAG,IAAI,CAAC,yBAAyB,CAAC,WAAW,CAAC,IAAI,EAAE,WAAW,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;gBACzF,KAAK,CAAC,UAAU,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;gBACtC,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9B;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,yBAAyB,CAAC,IAAY,EAAE,GAAW,EAAE,OAA2B;QACtF,IAAI,2FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,OAAO,IAAI,wFAA2B,CACpC,IAAI,EACJ,GAAG,EACH,OAAO,EACP,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,EAC3C,IAAI,CAAC,cAAc,CACpB,CAAC;SACH;aAAM;YACL,OAAO,IAAI,4EAAe,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;SAC1C;IACH,CAAC;IAEO,UAAU,CAAC,YAAqB;QACtC,OAAO,YAAY,IAAI,mDAAgB;YACrC,CAAC,CAAC,iEAA0B,GAAG,CAAC;YAChC,CAAC,CAAC,iEAA0B,CAAC;IACjC,CAAC;IAEO,mBAAmB,CAAC,OAAgB;QAC1C,IAAI,uBAAwC,CAAC;QAC7C,IAAI,qBAAsC,CAAC;QAE3C,IAAI,2FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,uBAAuB,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,wFAA2B,CACpE,+EAAuB,EACvB,+EAAwC,kCAEnC,OAAO,KACV,MAAM,EAAE,4EAA8D,KAExE,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,EAC3C,IAAI,CAAC,cAAc,CACpB,CAAC;YAEF,qBAAqB,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,wFAA2B,CAClE,+EAAuB,EACvB,+EAAwC,EACxC,OAAO,EACP,IAAI,CAAC,iBAAiB,CAAC,oBAAoB,EAC3C,IAAI,CAAC,cAAc,CACpB,CAAC;SACH;aAAM;YACL,uBAAuB,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,4EAAe,CACxD,+EAAwC,kCAEnC,OAAO,KACV,MAAM,EAAE,4EAA8D,IAEzE,CAAC;YAEF,qBAAqB,GAAG,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,4EAAe,CACtD,+EAAwC,EACxC,OAAO,CACR,CAAC;SACH;QAGD,MAAM,iBAAiB,GAAoB,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,8CAAW,CAAC,wEAAiC,EAAE,OAAO,CAAC,CAAC;QACpH,MAAM,qBAAqB,GAAoB,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,8CAAW,CAAC,gFAAyC,EAAE,OAAO,CAAC,CAAC;QAChI,MAAM,wBAAwB,GAAoB,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,8CAAW,CAAC,+EAAwC,EAAE,OAAO,CAAC,CAAC;QAClI,MAAM,uBAAuB,GAAsB;YACjD,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,4EAAe,CAC9B,gFAAyC,kCAEpC,OAAO,KACV,MAAM,EAAE,cAAc,CAAC,0BAA0B,EACjD,aAAa,EAAE,kFAAgB,IAElC;YACD,uBAAuB;SACxB,CAAC;QAEF,QAAQ,OAAO,EAAE;YACjB,KAAK,+EAAuB;gBAC1B,OAAO,CAAC,qBAAqB,CAAC,CAAC;YACjC,KAAK,wEAAgB;gBACnB,OAAO,CAAC,iBAAiB,CAAC,CAAC;YAC7B,KAAK,4EAAoB;gBACvB,OAAO,CAAC,qBAAqB,CAAC,CAAC;YACjC,KAAK,+EAAuB;gBAC1B,OAAO,CAAC,wBAAwB,CAAC,CAAC;YACpC,KAAK,2EAAmB;gBACtB,OAAO;oBACL,CAAC,OAAO,EAAE,EAAE,CAAC,IAAI,4EAAe,CAAC,wEAAiC,kCAC7D,OAAO,KACV,MAAM,EAAE,cAAc,CAAC,0BAA0B,EACjD,aAAa,EAAE,kFAAgB,IAC/B;oBACF,uBAAuB;iBACxB,CAAC;YACJ,KAAK,+EAAuB,CAAC;YAC7B;gBACE,OAAO,uBAAuB,CAAC;SAChC;IACH,CAAC;IAED,qEAAqE;IAC7D,2BAA2B;QACjC,4CAAK,CAAC,IAAI,EAAE,IAAI,CAAC;aACd,IAAI,CACH,+DAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAC7B,uDAAM,CAAC,CAAC,CAAC,KAAK,EAAE,MAAM,CAAC,EAAE,EAAE,CAAC,MAAM,CAAC,EACnC,0DAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAC3B;aACA,SAAS,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,CAAC;IACvC,CAAC;IAED,SAAS;QACP,IAAI,IAAI,CAAC,GAAG,EAAE;YACZ,IAAI,CAAC,GAAG,CAAC,cAAc,EAAE,CAAC;SAC3B;QACD,MAAM,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;IAC5C,CAAC;IAED,eAAe;QACb,IAAI,CAAC,SAAS,EAAE,CAAC;IACnB,CAAC;IAEO,gBAAgB,CAAC,IAAc;QACrC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;YAC/B,IAAI,IAAI,CAAC,GAAG,EAAE;gBACZ,MAAM,MAAM,GAAG,2CAAQ,CAAC;oBACtB,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,QAAQ;oBACzB,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,SAAS;iBAC3B,CAAC,CAAC;gBACH,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;oBACpB,IAAI,CAAC,UAAU,GAAG,IAAI,qFAAU,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;iBAClD;qBAAM;oBACL,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;iBACtC;gBACD,IAAI,IAAI,CAAC,UAAU,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE;oBAC9C,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;oBACrD,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;iBAClC;aACF;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,YAAY,CAAC,MAAgB,EAAE,MAAM,GAAG,KAAK;QACnD,IAAI,CAAC,KAAK,CACR,MAAM,EACN,IAAI,CAAC,GAAG,CAAC,kEAA2B,EAAE,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,EACzD,MAAM,CACP,CAAC;IACJ,CAAC;IAEO,KAAK,CAAC,MAAgB,EAAE,IAAY,EAAE,MAAM,GAAG,KAAK;QAC1D,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAC9B,gBAAgB;QAChB,4BAA4B;QAC5B,WAAW;QACX,kCAAkC;QAClC,IAAI;QACJ,oFAAoF;QACpF,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC,CAAC;QACnD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;IACjC,CAAC;;wEAhlBU,YAAY;2GAAZ,YAAY;QCxFzB,yGACM;QACN,kFAIoB;;QANd,6EAAY;QAGhB,2DAA+B;QAA/B,6FAA+B;;;;;;;;;;;;;;;;;;;;ACHJ;AAC0B;AAEhD,MAAM,qBAAsB,SAAQ,4CAAS;IAIlD,YAAY,SAAoB,EAAE,UAAU,GAAG,KAAK;QAClD,KAAK,CAAC;YACJ,IAAI,EAAE,qBAAqB,CAAC,UAAU,CAAC,SAAS,EAAE,UAAU,CAAC;YAC7D,SAAS,EAAE,YAAY;YACvB,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;YAClB,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;SACrB,CAAC,CAAC;QACH,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC;QAC5B,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;IAC9B,CAAC;IAED,MAAM,CAAC,UAAU,CAAC,SAAoB,EAAE,UAAmB;QACzD,QAAQ,SAAS,EAAE;YACnB,KAAK,sEAAc;gBACjB,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YACrC,KAAK,uEAAe;gBAClB,OAAO,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,CAAC;YACtC,KAAK,sEAAc;gBACjB,OAAO,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YACrC,KAAK,qEAAa;gBAChB,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;YACpC;gBACE,OAAO,EAAE,CAAC;SACX;IACH,CAAC;IAED,MAAM,CAAC,UAAU,CAAC,UAAmB;QACnC,OAAO;;;;;;;;;;;wCAW6B,UAAU,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;;;SAuBnE,CAAC;IACR,CAAC;IAED,MAAM,CAAC,SAAS,CAAC,UAAmB;QAClC,OAAO;;;;;;;;;;;wCAW6B,UAAU,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;;;;;;;;;;;;;SAanE,CAAC;IACR,CAAC;IAED,MAAM,CAAC,WAAW,CAAC,UAAmB;QACpC,OAAO;;;;;;;;;;;kEAYT,UAAU,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EACpC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAkCS,CAAC;IACR,CAAC;IAED,MAAM,CAAC,UAAU,CAAC,UAAmB;QACnC,OAAO;;;;;;;;;;;wCAW6B,UAAU,CAAC,CAAC,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;SAkDnE,CAAC;IACR,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,OAAO,CAAC,IAAI,GAAG,qBAAqB,CAAC,UAAU,CAClD,IAAI,CAAC,UAAU,EACf,IAAI,CAAC,SAAS,CACf,CAAC;IACJ,CAAC;IAED,YAAY,CAAC,SAAoB;QAC/B,IAAI,CAAC,UAAU,GAAG,SAAS,CAAC;QAC5B,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAED,WAAW,CAAC,QAAiB;QAC3B,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;QAC1B,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;CACF;;;;;;;;;;;;;;;;;;;;ACvO4B;AACiD;AAK9E,MAAM,SAAS,GAAG,6BAA6B,CAAC;AAOzC,MAAM,eAAgB,SAAQ,8CAAW;IAE9C,YACE,GAAW,EACX,OAAgC;QAEhC,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;IACtB,CAAC;IAED,YAAY,CAAC,MAAgB;QAC3B,MAAM,KAAK,GAAS,0EAAwC,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QAC3E,IAAI,CAAC,KAAK,EAAE;YACV,OAAO,KAAK,CAAC;SACd;QACD,IAA8B,IAAI,CAAC,OAAQ,CAAC,aAAa,EAAE;YACzD,MAAM,UAAU,GAAS,iFAA+C,CACtE,IAAI,EACJ,MAAM,CACP,CAAC;YACF,OAAO,CAAC,sFAAqB,CAC3B,UAAU,EACgB,IAAI,CAAC,OAAQ,CAAC,aAAa,CACtD,CAAC;SACH;QACD,OAAO,IAAI,CAAC;IACd,CAAC;CACF;AAEM,MAAM,2BAA4B,SAAQ,eAAe;IAC9D,YACU,OAAe,EACvB,GAAW,EACX,OAAgC,EACxB,oBAA0C,EAC1C,cAA8B;QAEtC,KAAK,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;QANZ,YAAO,GAAP,OAAO,CAAQ;QAGf,yBAAoB,GAApB,oBAAoB,CAAsB;QAC1C,mBAAc,GAAd,cAAc,CAAgB;IAGxC,CAAC;IAED,kBAAkB,CAAC,MAAgB;QACjC,MAAM,YAAY,GAAG,IAAI,CAAC,oBAAoB,CAAC,qBAAqB,CAAC,IAAI,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC,CAAC,CAAC;QACjH,IAAI,YAAY,IAAI,IAAI,EAAE;YACxB,IAAI,YAAY,CAAC,IAAI,IAAI,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,IAAI,YAAY,CAAC,IAAI,EAAE;gBAClE,OAAO,IAAI,CAAC;aACb;SACF;QACD,OAAO,KAAK,CAAC;IACf,CAAC;IAED,YAAY,CAAC,MAAgB;QAC3B,MAAM,KAAK,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;QACzC,IAAI,KAAK,IAAI,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,EAAE;YAC5C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,2BAA2B,IAAI,CAAC,OAAO,MAAM,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,IAAI,MAAM,CAAC,CAAC,EAAE,EAAE,SAAS,CAAC,CAAC;YACtH,OAAO,KAAK,CAAC;SACd;QACD,OAAO,KAAK,CAAC;IACf,CAAC;CACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACrE6D;AACN;AACgC;AACO;AACqB;AACrB;AACC;AACf;AAChB;AAClB;AACmB;AACrB;AACW;AACF;AACP;AAC0C;AACG;AAC7B;AACR;;AAuChD,MAAM,SAAS;;kEAAT,SAAS;uGAAT,SAAS;2GApCX;YACP,0DAAY;YACZ,wDAAW;YACX,gEAAmB;YACnB,wDAAW;YACX,mEAAoB;YACpB,iEAAe;YACf,0DAAY;YACZ,kEAAa;YACb,2EAAuB;YACvB,0FAAqB;YACrB,kGAAuB;YACvB,sGAAwB;YACxB,wEAAc;YACd,gEAAY;SACb,EAgBC,0FAAqB;QACrB,kGAAuB;QACvB,sGAAwB;oIAGf,SAAS,mBAnBlB,uEAAY;QACZ,iGAAoB;QACpB,wGAAkB;QAClB,6HAAyB;QACzB,wGAAkB;QAClB,yGAAsB,aArBtB,0DAAY;QACZ,wDAAW;QACX,gEAAmB;QACnB,wDAAW;QACX,mEAAoB;QACpB,iEAAe;QACf,0DAAY;QACZ,kEAAa;QACb,2EAAuB;QACvB,0FAAqB;QACrB,kGAAuB;QACvB,sGAAwB;QACxB,wEAAc;QACd,gEAAY,aAWZ,uEAAY;QACZ,iGAAoB;QACpB,wGAAkB;QAClB,6HAAyB;QACzB,wGAAkB;QAClB,yGAAsB;QACtB,0FAAqB;QACrB,kGAAuB;QACvB,sGAAwB;;;;;;;;;;;;;;;;;;;;;;;;ACtDmB;AACF;AACA;AACc;AACL;AACE;AACa;;AAc9D,MAAM,uBAAuB;;8FAAvB,uBAAuB;oHAAvB,uBAAuB;wHAXzB;YACP,yDAAY;YACZ,uDAAW;YACX,uDAAW;YACX,gEAAe;YACf,kEAAa;YACb,uEAAc;SACf;mIAIU,uBAAuB,mBAHnB,oEAAiB,aAP9B,yDAAY;QACZ,uDAAW;QACX,uDAAW;QACX,gEAAe;QACf,kEAAa;QACb,uEAAc;;;;;;;;;;;;;;;;;;;ACd+B;;;;AAO1C,MAAM,iBAAiB;IAG5B,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAExD,QAAQ,KAAI,CAAC;IAEb,KAAK;QACH,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;;kFATU,iBAAiB;+GAAjB,iBAAiB;QCT9B,iFAA+B;QAAlB,8IAAS,WAAO,IAAC;QAC5B,8EAAwE;QAC1E,4DAAc;;QADG,0DAAqB;QAArB,kFAAqB;;;;;;;;;;;;;;;;;;;;;;;;ACAgB;AACY;AACnB;AACO;AACT;AACoC;;AAa1E,MAAM,qBAAqB;;0FAArB,qBAAqB;kHAArB,qBAAqB;sHAVvB;YACP,yDAAY;YACZ,uDAAW;YACX,+DAAmB;YACnB,uDAAW;YACX,gEAAe;SAChB;mIAIU,qBAAqB,mBAHjB,+DAAe,EAAE,sFAAuB,aANrD,yDAAY;QACZ,uDAAW;QACX,+DAAmB;QACnB,uDAAW;QACX,gEAAe;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACd6D;AACN;AACM;AAGnC;AAMrB;AACK;AACyC;AACF;;;;;;;;;;ICEhE,+EAA+E;IAAlC,iZAAiC;IAC5E,4EAAW;IACT,0EAAyG;;IACzG,+EAAoD;IAAA,uDAAoB;IAAA,4DAAW;IACrF,4DAAY;IACd,4DAAW;;;;IAH8B,0DAAwD;IAAxD,qOAAwD;IACzC,0DAAoB;IAApB,oFAAoB;;;IAJ9E,8EAA4F;IAC1F,iIAKW;IACb,4DAAW;;;IANkB,0DAAgB;IAAhB,qFAAgB;;;;IAYzC,+EAA+E;IAAlC,qaAAiC;IAC5E,0EAAwD;IACxD,4EAAW;IACT,+EAAqC;IAAA,uDAAa;IAAA,4DAAW;IAC7D,+EAAoD;IAAA,uDAAoB;IAAA,4DAAW;IACrF,4DAAY;IACd,4DAAW;;;IAH8B,0DAAa;IAAb,8EAAa;IACE,0DAAoB;IAApB,qFAAoB;;;IAR9E,8EAAyG;IACvG,sFAA4C;IAC1C,4EAAW;IAAA,uDAAkD;;IAAA,4DAAY;IAC3E,4DAAkB;IAClB,gJAMW;IACb,4DAAW;;;IATI,0DAAkD;IAAlD,oKAAkD;IAEpC,0DAAgB;IAAhB,qFAAgB;;;IAL/C,wEAA8D;IAC5D,qIAWW;IACb,qEAAe;;;;IAZF,0DAAyD;IAAzD,sIAAyD;;ADRxE,MAAM,aAAa,GAAG,GAAG,CAAC,CAAC,gDAAgD;AAOpE,MAAM,eAAe;IAc1B,YACU,eAAgC,EAChC,gBAAkC,EAClC,MAAc,EACd,QAAmB,EACnB,OAAsB;QAJtB,oBAAe,GAAf,eAAe,CAAiB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,WAAM,GAAN,MAAM,CAAQ;QACd,aAAQ,GAAR,QAAQ,CAAW;QACnB,YAAO,GAAP,OAAO,CAAe;QATxB,gBAAW,GAAG,CAAC,CAAC;QAChB,oBAAe,GAAG,CAAC,CAAC;IASzB,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,WAAW,GAAG,IAAI,uDAAW,EAAE,CAAC;QACrC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,gBAAgB,CAAC,4BAA4B,EAAE,CAAC;QAC3E,MAAM,oBAAoB,GAAG,IAAI,CAAC,WAAW,CAAC,YAAY,CAAC,IAAI,CAC7D,4DAAY,CAAC,GAAG,CAAC,EACjB,oEAAoB,EAAE,CACvB,CAAC;QAEF,IAAI,CAAC,aAAa,GAAG,oBAAoB,CAAC,IAAI,CAC5C,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE;YACV,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;gBACpB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;gBACxB,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC;YACxB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,EACF,0DAAS,CAAC,CAAC,WAAmB,EAAE,EAAE,CAChC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,WAAW,CAAC,CAC7C,EACD,mDAAG,CAAC,CAAC,MAAM,EAAE,EAAE;YACb,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;gBACpC,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;YACvB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CACH,CAAC;QAEF,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,QAAQ;QACN,MAAM,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;QACxD,IAAI,WAAW,EAAE;YACf,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,GAAG,WAAW,CAAC;YAC1D,IAAI,CAAC,UAAU,EAAE,CAAC;SACnB;IACH,CAAC;IAEa,aAAa;;YACzB,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,EAAE,CAAC;YACpD,IAAI,CAAC,OAAO,GAAG,0DAAa,CAAC;gBAC3B,EAAE,EAAE,IAAI,CAAC,QAAQ;gBACjB,WAAW,EAAE,gBAAgB;gBAC7B,SAAS,EAAE,GAAG;gBACd,aAAa,EAAE,IAAI;gBACnB,MAAM,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,EAAE,CAAC;gBACtC,KAAK,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE;aAC/B,CAAC,CAAC;YAEH,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;QACxB,CAAC;KAAA;IAED,WAAW;QACT,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;IACzB,CAAC;IAED,aAAa,CAAC,WAAmB;QAC/B,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,GAAG,CAAC,EAAE;YACzC,MAAM,UAAU,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YAC9B,KAAK,MAAM,GAAG,IAAI,UAAU,EAAE;gBAC5B,MAAM,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;gBACtE,IAAI,aAAa,EAAE;oBACjB,OAAO,aAAa,CAAC;iBACtB;aACF;SACF;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAED,kBAAkB,CAAC,WAAqB;QACtC,IAAI,WAAW,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;YAC3C,MAAM,gBAAgB,GAAG,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;YACnE,MAAM,gBAAgB,GAAG,IAAI,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;YACnE,IACE,gBAAgB;gBAChB,gBAAgB,CAAC,MAAM,GAAG,CAAC;gBAC3B,gBAAgB;gBAChB,gBAAgB,CAAC,MAAM,GAAG,CAAC;gBAC3B,+EAAsB,CAAC,gBAAgB,CAAC;gBACxC,+EAAsB,CAAC,gBAAgB,CAAC,EACxC;gBACA,MAAM,GAAG,GAAG,UAAU,CAAC,gBAAgB,CAAC,CAAC;gBACzC,MAAM,GAAG,GAAG,UAAU,CAAC,gBAAgB,CAAC,CAAC;gBACzC,IAAI,GAAG,GAAG,CAAC,EAAE,IAAI,GAAG,GAAG,EAAE,IAAI,GAAG,GAAG,CAAC,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE;oBACpD,OAAO,2CAAQ,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;iBAC3B;aACF;SACF;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEO,oBAAoB,CAAC,KAAa;QACxC,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,IAAI,EAAE;YACzC,OAAO,KAAK,CAAC;SACd;QACD,OAAO,KAAK,CAAC,IAAI,EAAE,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IACzC,CAAC;IAED,UAAU,CAAC,KAAY;QACrB,MAAM,KAAK,GAAkB,KAAK,CAAC,MAAM,CAAC;QAC1C,UAAU,CAAC,GAAG,EAAE;YACR,KAAM,CAAC,QAAQ,EAAE,CAAC;QAC1B,CAAC,EAAE,IAAI,CAAC,CAAC;IACX,CAAC;IAED,UAAU;QACR,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;IAED,iBAAiB,CAAC,IAAuB;QACvC,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,GAAG,IAAI,CAAC;QACnD,IAAI,CAAC,UAAU,EAAE,CAAC;IACpB,CAAC;IAED,aAAa,CAAC,EAAiB;QAC7B,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC;QACxC,IAAI,KAAK,GAAG,CAAC,EAAE;YACb,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YAChD,IAAI,IAAI,CAAC,eAAe,GAAG,aAAa,EAAE;gBACxC,IAAI,CAAC,sBAAsB,EAAE,CAAC;aAC/B;iBAAM;gBACL,IAAI,CAAC,UAAU,EAAE,CAAC;aACnB;SACF;IACH,CAAC;IAED,sBAAsB;QACpB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,EAAE;gBACtB,MAAM,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC;gBAC3C,IAAI,CAAC,QAAQ,CAAC,YAAY,CACxB,IAAI,CAAC,QAAQ,EACb,eAAe,EACf,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,CAC5B,CAAC;gBACF,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,EAAE,cAAc,EAAE,GAAG,OAAO,EAAE,CAAC,CAAC;gBACxE,IAAI,CAAC,QAAQ,CAAC,QAAQ,CACpB,IAAI,CAAC,QAAQ,EACb,WAAW,EACX,cAAc,IAAI,CAAC,WAAW,KAAK,CACpC,CAAC;gBACF,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,CAAC,CAAC;YACjE,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,QAAQ;QACN,IAAI,IAAI,CAAC,eAAe,GAAG,aAAa,EAAE;YACxC,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;YACrB,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;YACzB,IAAI,CAAC,sBAAsB,EAAE,CAAC;SAC/B;IACH,CAAC;;8EA/KU,eAAe;6GAAf,eAAe;QCvB5B,6EAAY;QACV,iFAAwB;QACtB,0EAA8B;QAAxB,2IAAY,cAAU,IAAC;QAC3B,8EAA4D;QAC1D,2EAAU;QACR,yEAAgD;QAChD,+EACgE;QAA9D,oKAAmB,sBAAkB,IAAC,sFAAY,cAAU,IAAtB;;QAAwB,4DAAY;QAC5E,8EAAyD;QAAvB,yIAAS,gBAAY,IAAC;QAAC,4DAAW;QACtE,4DAAW;QACb,4DAAW;QACb,4DAAO;QACT,4DAAc;QAChB,4DAAa;QACb,8EAAa;QACX,uHAOW;;QACX,+HAae;;QACjB,4DAAc;;QA/BO,0DAAoD;QAApD,6KAAoD;QAAC,wFAA2B;QASxF,0DAA4B;QAA5B,qJAA4B;QAQxB,0DAA6B;QAA7B,sJAA6B;;;;;;;;;;;;;;;;;;;;ACtBe;AACA;;AAQtD,MAAM,wBAAwB;;gGAAxB,wBAAwB;qHAAxB,wBAAwB;yHAL1B,CAAC,+DAAY,CAAC;mIAKZ,wBAAwB,mBAJpB,sEAAkB,aADvB,+DAAY,aAGZ,sEAAkB;;;;;;;;;;;;;;;;;;;;ACPmB;;;;;AAO1C,MAAM,kBAAkB;IAC7B,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAExD,QAAQ,KAAI,CAAC;IAEb,KAAK;QACH,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;;oFAPU,kBAAkB;gHAAlB,kBAAkB;QCR/B,6EAAY;QACV,iFAAuC;QACrC,iFAAwB;QACtB,gFAA8B;QAAlB,8IAAS,WAAO,IAAC;QAAC,uDAA8B;;QAAA,4DAAa;QAC3E,4DAAc;QACd,4EAAW;QACT,uDACF;;QAAA,4DAAY;QACd,4DAAc;QAChB,4DAAa;QACb,4EAEc;;;QATsB,0DAA8B;QAA9B,8IAA8B;QAG5D,0DACF;QADE,gKACF;QAG6B,0DAAiD;QAAjD,8NAAiD;;;;;;;;;;;;;;;;;;;ACTf;;;AAK5D,MAAM,uBAAuB;IAClC,YAAoB,SAAuB;QAAvB,cAAS,GAAT,SAAS,CAAc;IAAG,CAAC;IAE/C,SAAS,CAAC,KAAa,EAAE,IAAa;QACpC,MAAM,MAAM,GAAG,IAAI;YACjB,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,GAAG,GAAG,IAAI,GAAG,GAAG,EAAE,IAAI,CAAC,EAAE,qBAAqB,CAAC;YAC1E,CAAC,CAAC,KAAK,CAAC;QACV,OAAO,IAAI,CAAC,SAAS,CAAC,uBAAuB,CAAC,MAAM,CAAC,CAAC;IACxD,CAAC;;8FARU,uBAAuB;8IAAvB,uBAAuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLc;AACC;AAEtB;AACqC;AACT;AAEwC;AACjC;AACE;AACjB;AAErB;AAIU;AACgE;;;;;AAK/F,MAAM,gBAAgB;IAY3B,YACU,UAAsB,EACtB,kBAAsC,EACtC,cAA8B;QAF9B,eAAU,GAAV,UAAU,CAAY;QACtB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,0BAA0B,GAAG,IAAI,yCAAO,EAE1C,CAAC;QACJ,IAAI,CAAC,6BAA6B,GAAG,IAAI,CAAC,0BAA0B,CAAC,YAAY,EAAE,CAAC;QACpF,IAAI,CAAC,6BAA6B,CAAC,SAAS,CAAC,CAAC,IAAI,EAAE,EAAE;YACpD,IAAI,CAAC,CAAC,IAAI,YAAY,2CAAQ,CAAC,EAAE;gBAC/B,IAAI,CAAC,qBAAqB,CAAC,IAAyB,CAAC,CAAC;aACvD;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAtBD,IAAI,eAAe;QACjB,OAAO,IAAI,CAAC,6BAA6B,CAAC;IAC5C,CAAC;IAED,IAAI,qBAAqB,CAAC,IAAkC;QAC1D,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC7C,CAAC;IAkBD,SAAS,CAAC,IAAY;QACpB,OAAO,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,IAAI,CAC3C,yDAAS,CAAC,CAAC,QAAQ,EAAE,EAAE,CACrB,8CAAQ,CAAC;YACP,IAAI,CAAC,qBAAqB,CAAC,IAAI,EAAE,QAAQ,CAAC;YAC1C,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,QAAQ,CAAC;SACjC,CAAC,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,GAAG,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAC3C,CACF,CAAC;IACJ,CAAC;IAED,qBAAqB,CACnB,IAAY,EACZ,IAAa;QAEb,OAAO,IAAI,CAAC,UAAU;aACnB,GAAG,CACF,GAAG,iEAA0B,QAAQ,IAAI,CAAC,IAAI,EAAE,kBAAkB,wEAAiC,EAAE;cACnG,eAAe,8EAAuC,YAAY,0EAAmC,EAAE,CAC1G;aACA,IAAI,CACH,oDAAG,CAAC,CAAC,SAA0B,EAAE,EAAE;YACjC,MAAM,IAAI,GAAG,SAAS,CAAC,QAAQ,CAAC,iBAAiB,CAAC;YAClD,MAAM,UAAU,GACd,IAAI,KAAK,CAAC;gBACR,CAAC,CAAC,EAAE;gBACJ,CAAC,CAAC,IAAI,KAAK,CAAC;oBACV,CAAC,CAAC,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAS,CAAC;oBAC7B,CAAC,CAAE,SAAS,CAAC,IAAoB,CAAC;YAExC,OAAO,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;gBACpD,MAAM,IAAI,GAAsB;oBAC9B,IAAI,EAAE,IAAI,CAAC,UAAU;oBACrB,WAAW,EAAE,IAAI,CAAC,yBAAyB,CAAC,IAAI,EAAE,IAAI,CAAC;oBACvD,IAAI,EAAE,IAAI,CAAC,eAAe;oBAC1B,MAAM,EAAE,2CAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,EAAE,IAAI,CAAC,oBAAoB,CAAC,GAAG,CAAC;iBAChF,CAAC;gBACF,OAAO,IAAI,CAAC;YACd,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,EACF,2DAAU,CAAC,GAAG,EAAE,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC,CACzB,CAAC;IACN,CAAC;IAED,yBAAyB,CAAC,IAAU,EAAE,IAAa;;QACjD,MAAM,QAAQ,GAAG,IAAI,CAAC,eAAe,CAAC;QACtC,MAAM,SAAS,GAAG,IAAI,KAAK,mEAAU,IAAI,IAAI,KAAK,mEAAU,CAAC;QAC7D,MAAM,MAAM,GAAG,UAAI,CAAC,MAAM,CAAC,CAAC,CAAC,0CAAE,UAAU,CAAC;QAC1C,IAAI,IAAI,CAAC,QAAQ,CAAC,MAAM,KAAK,CAAC,IAAI,QAAQ,KAAK,SAAS,EAAE;YACxD,IAAI,SAAS,EAAE;gBACb,OAAO,GAAG,QAAQ,KAAK,MAAM,EAAE,CAAC;aACjC;YACD,OAAO,MAAM,CAAC;SACf;QACD,IAAI,IAAI,CAAC,MAAM,CAAC,MAAM,KAAK,CAAC,IAAI,QAAQ,KAAK,OAAO,EAAE;YACpD,IAAI,SAAS,EAAE;gBACb,OAAO,GAAG,QAAQ,EAAE,CAAC;aACtB;YACD,OAAO,EAAE,CAAC;SACX;QACD,MAAM,YAAY,GAAG,UAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,0CAAE,WAAW,CAAC;QACnD,IAAI,SAAS,EAAE;YACb,OAAO,GAAG,QAAQ,KAAK,YAAY,KAAK,MAAM,GAAG,CAAC;SACnD;QACD,OAAO,GAAG,YAAY,KAAK,MAAM,GAAG,CAAC;IACvC,CAAC;IAEO,gBAAgB,CAAC,IAAY;QACnC,OAAO,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,EAAE,YAAY,EAAE,EAAE;YAC/C,IACE,GAAG,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,KAAK,YAAY,CAAC,WAAW,CAAC;iBAChE,MAAM,KAAK,CAAC,EACf;gBACA,GAAG,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;aACxB;YACD,OAAO,GAAG,CAAC;QACb,CAAC,EAAE,EAAE,CAAC,CAAC;IACT,CAAC;IAED,WAAW,CAAC,IAAY,EAAE,IAAa;QACrC,OAAO,IAAI,CAAC,UAAU;aACnB,GAAG,CACF,GAAG,uEAAgC,cAAc;YAC/C,mBAAmB,IAAI,YAAY,8EAAuC,EAAE;YAC5E,SAAS,gEAAO,CAAC,IAAI,CAAC,EAAE;YACxB,aAAa,4EAAqC,EAAE,CACvD;aACA,IAAI,CACH,oDAAG,CAAC,CAAC,IAA4B,EAAE,EAAE;YACnC,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,IAAI,EAAE,CAAC;YACpC,OAAO,OAAO;iBACX,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC;iBAC3C,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE;gBACZ,MAAM,IAAI,GAAsB;oBAC9B,IAAI,EAAE,IAAI,CAAC,IAAI;oBACf,WAAW,EACT,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC;wBAC7C,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,CAAC;wBACvB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC;oBACzD,IAAI,EAAE,EAAE;oBACR,MAAM,EAAE,2CAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBAC7D,CAAC;gBACF,OAAO,IAAI,CAAC;YACd,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,EACF,2DAAU,CAAC,GAAG,EAAE,CAAC,yCAAE,CAAC,EAAE,CAAC,CAAC,CACzB,CAAC;IACN,CAAC;IAED,WAAW,CACT,OAAiB,EACjB,SAAS,GAAG,uEAAc;QAE1B,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC;QAC9B,OAAO,IAAI,CAAC,cAAc;aACvB,mBAAmB,CAAC;YACnB,QAAQ,EAAE,MAAM,CAAC,GAAG;YACpB,SAAS,EAAE,MAAM,CAAC,GAAG;YACrB,WAAW,EAAE,SAAS;SACvB,CAAC;aACD,IAAI,CACH,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;YACf,QAAQ,EAAE;gBACR,IAAI,EAAE,MAAM,CAAC,IAAI;gBACjB,SAAS,EAAE,MAAM,CAAC,iBAAiB,IAAI,MAAM,CAAC,aAAa;aAC5D;YACD,SAAS,EAAE,MAAM,CAAC,IAAI;YACtB,SAAS,EAAE,MAAM,CAAC,SAAS;YAC3B,MAAM,EAAE,MAAM;SACf,CAAC,CAAC,EACH,2DAAU,CAAC,GAAG,EAAE,CAAC,yCAAE,CAAC,IAAI,CAAC,CAAC,CAC3B,CAAC;IACN,CAAC;IAEa,qBAAqB,CAAC,YAA+B;;YACjE,MAAM,eAAe,GAAG,CACtB,MAAM,IAAI,CAAC,4BAA4B,EAAE,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CACpE,CAAC,MAAM,CACN,CAAC,IAAI,EAAE,EAAE,CACP,CAAC,CACC,IAAI,CAAC,MAAM,CAAC,GAAG,KAAK,YAAY,CAAC,MAAM,CAAC,GAAG;gBAC3C,IAAI,CAAC,MAAM,CAAC,GAAG,KAAK,YAAY,CAAC,MAAM,CAAC,GAAG,CAC5C,CACJ,CAAC;YACF,eAAe,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,kBACzB,SAAS,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE,IACvB,YAAY,EACf,CAAC,CAAC,oCAAoC;YACxC,MAAM,KAAK,GAAG,eAAe,CAAC,KAAK,CACjC,CAAC,EACD,4EAAqC,CACtC,CAAC,CAAC,yBAAyB;YAC5B,MAAM,oDAAI,CAAC,4EAAsC,CAAC;iBAC/C,KAAK,CAAC,QAAQ,EAAE,EAAE,EAAE,EAAE,eAAe,EAAE,KAAK,EAAE,CAAC;iBAC/C,IAAI,EAAE,CAAC;QACZ,CAAC;KAAA;IAED,4BAA4B;QAC1B,OAAO,IAAI,qGAAwB,CAGjC,oDAAI,CAAC,4EAAsC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,MAAM,EAAE,CACtE,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC;;gFA/LU,gBAAgB;kHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnBmE;AAc/D;AAEyE;AACf;AAChC;;;;AAMlD,MAAM,SAAS,GAAG,YAAY,CAAC;AAKxB,MAAM,UAAU;IAqDrB,YACU,kBAAsC,EACtC,cAA8B;QAD9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,mBAAc,GAAd,cAAc,CAAgB;QAEtC,IAAI,CAAC,kBAAkB,GAAG,IAAI,iDAAe,CAAU,IAAI,CAAC,CAAC;QAC7D,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,kBAAkB;aACjD,YAAY,EAAE;aACd,IAAI,CAAC,oEAAoB,EAAE,EAAE,2DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QAChD,IAAI,CAAC,uBAAuB,GAAG,IAAI,yCAAO,EAAQ,CAAC;QACnD,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,uBAAuB;aAC3D,YAAY,EAAE;aACd,IAAI,CAAC,2DAAW,CAAC,CAAC,CAAC,CAAC,CAAC;QACxB,IAAI,CAAC,eAAe,GAAG,IAAI,iDAAe,CAAW,IAAI,CAAC,CAAC;QAC3D,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,CAAC,IAAI,CACvD,4DAAY,CAAC,GAAG,CAAC,EACjB,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CACV,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,iBAAiB,EAAE,SAAS,EAAE,GAAG,CAAC,CAC7D,EACD,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;QACF,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,+BAA+B,EAAE,CAAC;QAClE,IAAI,CAAC,oBAAoB,GAAG,IAAI,iDAAe,CAAO,IAAI,CAAC,CAAC;QAC5D,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,oBAAoB,CAAC,YAAY,EAAE,CAAC;QAC/D,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,wBAAwB,EAAE,CAAC;IACnE,CAAC;IAjED,IAAI,QAAQ;QACV,OAAO,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;IAED,IAAI,yBAAyB;QAC3B,OAAO,IAAI,CAAC,yBAAyB,CAAC;IACxC,CAAC;IAED,IAAI,kBAAkB;QACpB,OAAO,IAAI,CAAC,mBAAmB,CAAC;IAClC,CAAC;IAED,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAED;;OAEG;IACH,IAAI,iCAAiC;QACnC,OAAO,4CAAM,CACX,IAAI,CAAC,SAAS,CAAC,IAAI,CACjB,sDAAM,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,KAAK,IAAI,CAAC,EACrC,qDAAI,CAAC,CAAC,CAAC,CACR,EACD,IAAI,CAAC,mBAAmB,CACzB,CAAC;IACJ,CAAC;IAED,IAAI,WAAW;QACb,OAAO,IAAI,CAAC,qBAAqB,CAAC;IACpC,CAAC;IAED,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,0BAA0B,CAAC;IACzC,CAAC;IAED,IAAI,UAAU,CAAC,GAAY;QACzB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACpC,CAAC;IA4BD,eAAe;QACb,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,uBAAuB,CAAC,IAAI,EAAE,CAAC;IACtC,CAAC;IAED,aAAa,CAAC,OAAiB;QAC7B,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACpC;IACH,CAAC;IAED,gBAAgB;QACd,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvC,CAAC;IAEO,mBAAmB;QACzB,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CACvB,4DAAY,CAAC,GAAG,CAAC,EACjB,yDAAQ,EAAE,EACV,oDAAG,CAAC,CAAC,CAAC,IAAI,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,IAAI,CAAC,IAAI,EAAE;gBACT,OAAO,IAAI,CAAC;aACb;YACD,OAAO,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAC7C,CAAC,CAAC,EACF,qDAAI,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,GAAG,GAAG,GAAG,EAAE,CAAC,CAAC,CACjC,CAAC;IACJ,CAAC;IAEO,wBAAwB,CAAC,YAAY,GAAG,EAAE;QAChD,OAAO,IAAI,CAAC,mBAAmB,EAAE,CAAC,IAAI,CACpC,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YAChB,OAAO,GAAG,GAAG,YAAY,CAAC;QAC5B,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAEO,+BAA+B,CAAC,YAAY,GAAG,EAAE;QACvD,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CACvB,2DAAU,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,wBAAwB,CAAC,YAAY,CAAC,CAAC,EAC7D,0DAAS,CAAC,CAAC,MAAM,EAAE,EAAE,CACnB,MAAM,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC;YAC9C,CAAC,CAAC,yCAAE,CAAC,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAC/B,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAChC,EACD,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CACV,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,8BAA8B,EAC9B,SAAS,EACT,GAAG,CACJ,CACF,EACD,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;IAEO,wBAAwB;QAC9B,MAAM,4BAA4B,GAAG,oDAAa,CAAC;YACjD,IAAI,CAAC,kBAAkB;YACvB,IAAI,CAAC,kBAAkB,CAAC,iBAAiB;SAC1C,CAAC,CAAC,IAAI,CACL,oDAAG,CAAC,CAAC,CAAC,OAAO,EAAE,UAAU,CAAC,EAAE,EAAE,CAAC,CAAC;YAC9B,OAAO;YACP,MAAM,EAAE;gBACN,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,GAAG;gBACjC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,GAAG;gBACjC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,GAAG;gBACjC,OAAO,CAAC,MAAM,CAAC,YAAY,EAAE,CAAC,GAAG,CAAC,OAAO;aAC1C;YACD,MAAM,EAAE,EAAE,GAAG,EAAE,OAAO,CAAC,MAAM,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,CAAC,MAAM,CAAC,GAAG,EAAE;YAC5D,UAAU;SACX,CAAC,CAAC,CACJ,CAAC;QAEF,OAAO,4BAA4B,CAAC,IAAI,CACtC,0DAAS,CAAC,CAAC,GAAG,EAAE,EAAE,CAChB,iEAAU,CACR,GAAG,EAAE,CACH,IAAI,MAAM,CAAC,2BAAI,GAAG,CAAC,oJAA0D,CAAC,GAAE;YAC9E,IAAI,EAAE,SAAQ;SACf,CAAC,EACJ,4BAA4B,CAC7B,CAAC,IAAI,CACJ,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,iCACX,GAAG,CAAC,OAAO,GACX,MAAM,EACT,CAAC,CACJ,CACF,EACD,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CACV,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,qBAAqB,EAAE,SAAS,EAAE,GAAG,CAAC,CACjE,EACD,2DAAW,CAAC,CAAC,CAAC,CACf,CAAC;IACJ,CAAC;;oEA7KU,UAAU;4GAAV,UAAU,WAAV,UAAU,mBAFT,MAAM;;;;;;;;;;;;;;;;;;;;ACxBb,MAAM,uBAAuB;IAC5B,aAAa,CAAC,SAAmB;;YACrC,OAAO,SAAS,CAAC,QAAQ,EAAE,CAAC;QAC9B,CAAC;KAAA;;8FAHU,uBAAuB;wHAAvB,uBAAuB,WAAvB,uBAAuB;;;;;;;;;;;;;;;;;;;;;;;;ACDX;AAGwB;AACjD,0EAA0E;AACoB;AAEvC;AAE8B;AACwC;;;;;;AAGtH,MAAM,qBAAqB;IAEhC,YACU,eAAgC,EAChC,mBAA8C,EAC9C,kBAAsC,EACtC,gBAAkC;QAHlC,oBAAe,GAAf,eAAe,CAAiB;QAChC,wBAAmB,GAAnB,mBAAmB,CAA2B;QAC9C,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,qBAAgB,GAAhB,gBAAgB,CAAkB;IACzC,CAAC;IAEE,aAAa,CACjB,SAAuB,EACvB,CAAyB,EACzB,EAAuB,EACvB,SAA+B;;YAE/B,IACE,SAAS;gBACT,CAAC,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC;gBAClC,SAAS,CAAC,YAAY,EACtB;gBACA,MAAM,GAAG,GAAG,MAAM,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAC5D,SAAS,CAAC,YAAY,CAAC,EAAE,CAC1B,CAAC;gBACF,IAAI,GAAG,IAAI,GAAG,CAAC,UAAU,KAAK,qGAAgB,EAAE;oBAC9C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;oBACtC,IAAI,CAAC,IAAI,EAAE;wBACT,MAAM,IAAI,CAAC,mBAAmB,CAAC,oCAAoC,CACjE,SAAS,CAAC,YAAY,CAAC,EAAE,CAC1B,CAAC;qBACH;iBACF;aACF;YACD,OAAO,IAAI,CAAC;QACd,CAAC;KAAA;IAED,aAAa,CAAC,GAAW;QACvB,MAAM,SAAS,GAAG,CAAC,eAAe,EAAE,iBAAiB,CAAC,CAAC;QACvD,OAAO,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;IACpD,CAAC;IAEK,WAAW;;YACf,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC;gBACH,gCAAgC;gBAChC,iCAAiC;gBACjC,4BAA4B;gBAC5B,6BAA6B;aAC9B,CAAC;iBACD,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,MAAM,EAAE,YAAY,CAAC,gCAAgC,CAAC;gBACtD,OAAO,EAAE,YAAY,CAAC,iCAAiC,CAAC;gBACxD,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,YAAY,CAAC,4BAA4B,CAAC;wBAChD,IAAI,EAAE,QAAQ;qBACf;oBACD;wBACE,IAAI,EAAE,YAAY,CAAC,6BAA6B,CAAC;qBAClD;iBACF;aACF,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,MAAM,MAAM,GAAG,MAAM,KAAK,CAAC,YAAY,EAAE,CAAC;YAC1C,OAAO,MAAM,CAAC,IAAI,KAAK,QAAQ,CAAC;QAClC,CAAC;KAAA;;0FAjEU,qBAAqB;sHAArB,qBAAqB,WAArB,qBAAqB;;;;;;;;;;;;;;;;;;AChBqB;;;AAEvD,MAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,uBAAuB;QAC7B,YAAY,EAAE,GAAG,EAAE,CACjB,mTAA0C,CAAC,IAAI,CAC7C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,kBAAkB,CAC5B;KACJ;IACD;QACE,IAAI,EAAE,2BAA2B;QACjC,YAAY,EAAE,GAAG,EAAE,CACjB,0MAA0C,CAAC,IAAI,CAC7C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAC3B;KACJ;IACD;QACE,IAAI,EAAE,6BAA6B;QACnC,YAAY,EAAE,GAAG,EAAE,CACjB,mUAAkD,CAAC,IAAI,CACrD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,qBAAqB,CAC/B;KACJ;IACD;QACE,IAAI,EAAE,+BAA+B;QACrC,YAAY,EAAE,GAAG,EAAE,CACjB,mUAAkD,CAAC,IAAI,CACrD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,qBAAqB,CAC/B;KACJ;IACD;QACE,IAAI,EAAE,wBAAwB;QAC9B,YAAY,EAAE,GAAG,EAAE,CACjB,uSAAoC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,eAAe,CAAC;KACtE;IACD;QACE,IAAI,EAAE,kCAAkC;QACxC,YAAY,EAAE,GAAG,EAAE,CACjB,8cAAwD,CAAC,IAAI,CAC3D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,wBAAwB,CAClC;KACJ;IACD;QACE,IAAI,EAAE,oCAAoC;QAC1C,YAAY,EAAE,GAAG,EAAE,CACjB,2UAAsD,CAAC,IAAI,CACzD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,oBAAoB,CAC9B;KACJ;IACD;QACE,IAAI,EAAE,+BAA+B;QACrC,YAAY,EAAE,GAAG,EAAE,CACjB,uTAA4C,CAAC,IAAI,CAC/C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,gBAAgB,CAC1B;KACJ;IACD;QACE,IAAI,EAAE,gCAAgC;QACtC,YAAY,EAAE,GAAG,EAAE,CACjB,+TAAgD,CAAC,IAAI,CACnD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,kBAAkB,CAC5B;KACJ;IACD;QACE,IAAI,EAAE,oCAAoC;QAC1C,YAAY,EAAE,GAAG,EAAE,CACjB,+UAAwD,CAAC,IAAI,CAC3D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAChC;KACJ;IACD;QACE,IAAI,EAAE,qCAAqC;QAC3C,YAAY,EAAE,GAAG,EAAE,CACjB,6kBAAyD,CAAC,IAAI,CAC5D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAChC;KACJ;IACD;QACE,IAAI,EAAE,6BAA6B;QACnC,YAAY,EAAE,GAAG,EAAE,CACjB,2TAA8C,CAAC,IAAI,CACjD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,mBAAmB,CAC7B;KACJ;IACD;QACE,IAAI,EAAE,2BAA2B;QACjC,YAAY,EAAE,GAAG,EAAE,CACjB,kbAA0C,CAAC,IAAI,CAC7C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,kBAAkB,CAC5B;KACJ;IACD;QACE,IAAI,EAAE,qCAAqC;QAC3C,YAAY,EAAE,GAAG,EAAE,CACjB,6kBAAyD,CAAC,IAAI,CAC5D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,sBAAsB,CAChC;KACJ;IACD;QACE,IAAI,EAAE,0CAA0C;QAChD,YAAY,EAAE,GAAG,EAAE,CACjB,qWAAmE,CAAC,IAAI,CACtE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,2BAA2B,CACrC;KACJ;IACD;QACE,IAAI,EAAE,+BAA+B;QACrC,YAAY,EAAE,GAAG,EAAE,CACjB,yTAA6C,CAAC,IAAI,CAChD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,iBAAiB,CAC3B;KACJ;IACD;QACE,IAAI,EAAE,oCAAoC;QAC1C,YAAY,EAAE,GAAG,EAAE,CACjB,6UAAuD,CAAC,IAAI,CAC1D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,qBAAqB,CAC/B;KACJ;IACD;QACE,IAAI,EAAE,oCAAoC;QAC1C,YAAY,EAAE,GAAG,EAAE,CACjB,6eAAuD,CAAC,IAAI,CAC1D,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,qBAAqB,CAC/B;KACJ;IACD;QACE,IAAI,EAAE,wCAAwC;QAC9C,YAAY,EAAE,GAAG,EAAE,CACjB,4dAA+D,CAAC,IAAI,CAClE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,yBAAyB,CACnC;KACJ;IACD;QACE,IAAI,EAAE,yCAAyC;QAC/C,YAAY,EAAE,GAAG,EAAE,CACjB,kYAAiE,CAAC,IAAI,CACpE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,0BAA0B,CACpC;KACJ;IACD;QACE,IAAI,EAAE,4CAA4C;QAClD,YAAY,EAAE,GAAG,EAAE,CACjB,6WAEC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,6BAA6B,CAAC;KACjD;CACF,CAAC;AAMK,MAAM,yBAAyB;;kGAAzB,yBAAyB;sHAAzB,yBAAyB;0HAH3B,CAAC,kEAAqB,CAAC,MAAM,CAAC,CAAC,EAC9B,yDAAY;mIAEX,yBAAyB,oFAF1B,yDAAY;;;;;;;;;;;;;;;;;;;;;;ACxJkD;AACnB;AACsB;AACT;AACD;;AAQ5D,MAAM,kBAAkB;;oFAAlB,kBAAkB;+GAAlB,kBAAkB;oHAFlB,CAAC,sFAAuB,EAAE,6EAAqB,CAAC,YAHlD,CAAC,mFAAyB,EAAE,6EAAe,EAAE,+DAAY,CAAC;mIAKxD,kBAAkB,cALnB,mFAAyB,EAAE,6EAAe,EAAE,+DAAY;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPxC;AACqE;AACjB;AAC/B;AACgC;AACR;AACtB;AAC6B;AACE;AAC5C;;;;;;AAEtC,MAAM,SAAS,GAAG,iBAAiB,CAAC;AAK7B,MAAM,eAAe;IAC1B,YACU,kBAAmC,EACnC,kBAAsC,EACtC,eAAgC,EAChC,cAA8B;QAH9B,uBAAkB,GAAlB,kBAAkB,CAAiB;QACnC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;IACrC,CAAC;IAEE,eAAe,CAAC,MAAsB;;YAC1C,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC3D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,MAAM,IAAI,CAAC,qCAAqC,CAC9C,WAAW,CAAC,OAAO,EACnB,WAAW,CAAC,QAAQ,EACpB,MAAM,CACP,CAAC;QACJ,CAAC;KAAA;IAEO,aAAa,CAAC,OAAgB,EAAE,QAAiB;QACvD,OAAO,GAAG,oEAA8B,IAAI,OAAO,IAAI,QAAQ,EAAE,CAAC;IACpE,CAAC;IAEa,qCAAqC,CACjD,OAAgB,EAChB,QAAiB,EACjB,MAAsB;;YAEtB,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,QAAQ,CAClD,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,QAAQ,CAAC,CACtC,CAAC;YACF,MAAM,gBAAgB,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACxC,0EAAmC,EACnC,cAAc,CACf,CAAC;YACF,IACE,QAAQ,CAAC,SAAS;gBAClB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,EACtD;gBACA,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,yCAAyC,EACzC,SAAS,CACV,CAAC;aACH;iBAAM;gBACL,MAAM,eAAe,GAAG,6CAAM,EAAE,CAAC,QAAQ,CACvC,0EAAmC,EACnC,KAAK,CACN,CAAC;gBACF,IACE,CAAC,QAAQ,CAAC,WAAW;oBACrB,6CAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,CAAC,QAAQ,CAAC,eAAe,CAAC,EACtD;oBACA,MAAM,IAAI,CAAC,0BAA0B,CAAC,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;iBAClE;aACF;QACH,CAAC;KAAA;IAEK,0BAA0B,CAC9B,OAAgB,EAChB,QAAiB,EACjB,MAAsB;;YAEtB,MAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;YACzD,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;YACpD,IAAI;gBACF,MAAM,SAAS,GAAG,MAAM,oFAAmB,CACzC,IAAI,CAAC,kBAAkB,CAAC,WAAW,CAAC,QAAQ,CAAC,EAC7C,MAAM,EACN,KAAK,CACN,CAAC;gBACF,MAAM,yDAAmB,CAAC,oEAA8B,EAAE,OAAO,CAAC;qBAC/D,KAAK,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,CAAC;qBAC5D,IAAI,EAAE,CAAC;gBACV,MAAM,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;aACzD;YAAC,OAAO,GAAG,EAAE;gBACZ,MAAM,IAAI,CAAC,eAAe,CAAC,YAAY,CAAC,UAAU,EAAE,GAAG,CAAC,OAAO,CAAC,CAAC;aAClE;QACH,CAAC;KAAA;IAEK,gBAAgB,CACpB,OAAgB,EAChB,OAAgB,EAChB,SAAoB,EACpB,eAAuB;;YAEvB,MAAM,SAAS,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YAC5D,OAAO,SAAS,CAAC,IAAI,CACnB,CAAC,CAAC,EAAE,EAAE,CACJ,CAAC,CAAC,CAAC;gBACH,CAAC,CAAC,YAAY,KAAK,SAAS;gBAC5B,CAAC,CAAC,eAAe,KAAK,eAAe,CACxC,CAAC;QACJ,CAAC;KAAA;IAEK,YAAY,CAAC,OAAgB,EAAE,OAAgB;;YACnD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YACrE,IAAI,YAAY,EAAE;gBAChB,OAAO,YAAY,CAAC;aACrB;iBAAM;gBACL,MAAM,WAAW,GAAG,+DAAO,CAAC,OAAO,CAAC,CAAC;gBACrC,MAAM,gBAAgB,GAAkB,2BAAQ,aAAsC,EAAE,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC5G,OAAO,gBAAgB,CAAC;aACzB;QACH,CAAC;KAAA;IAEa,kBAAkB,CAC9B,OAAgB,EAChB,OAAgB;;YAEhB,MAAM,MAAM,GAAG,MAAM,yDAAmB,CACtC,oEAA8B,EAC9B,OAAO,CACR;iBACE,KAAK,CAAC,QAAQ,CAAC;iBACf,KAAK,CAAC,CAAC,SAAS,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;iBAChC,IAAI,EAAE,CAAC;YACV,IAAI,MAAM,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,OAAO,MAAM,CAAC,CAAC,CAAC,CAAC,SAA0B,CAAC;aAC7C;iBAAM;gBACL,OAAO,IAAI,CAAC;aACb;QACH,CAAC;KAAA;;8EAzHU,eAAe;iHAAf,eAAe,WAAf,eAAe,mBAFd,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACbuB;AACmD;AAClE;AACiD;AAC3B;AAC4B;AAC/B;AAC6C;AACtC;AACR;AACiC;AACH;AACwB;AACyB;;;;;;;;;;;AAG7H,MAAM,SAAS,GAAG,qBAAqB,CAAC;AAKjC,MAAM,mBAAmB;IAI9B,YACU,iBAAoC,EACpC,kBAAsC;IAC9C,iEAAiE;IACzD,aAA4B,EAC5B,eAAgC,EAChC,cAA8B,EAC9B,kBAAsC;IAC9C,wEAAwE;IAChE,yBAAoD,EACpD,UAAsB,EACtB,IAAU;QAVV,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAEtC,kBAAa,GAAb,aAAa,CAAe;QAC5B,oBAAe,GAAf,eAAe,CAAiB;QAChC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QAEtC,8BAAyB,GAAzB,yBAAyB,CAA2B;QACpD,eAAU,GAAV,UAAU,CAAY;QACtB,SAAI,GAAJ,IAAI,CAAM;QAElB,2EAA2E;QAC3E,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,yBAAyB,CAAC,oBAAoB,CAAC;QAC1E,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,oDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,UAAU,KAAK,qGAAgB,CAAC,CAAC,CAAC,CAAC;IACpH,CAAC;IAED,oEAAoE;IACpE,6EAA6E;IAC7E,yBAAyB;IACzB,cAAc;IACd,MAAM;IACN,4CAA4C;IAC5C,gFAAgF;IAChF,mEAAmE;IACnE,IAAI;IAEE,qBAAqB,CAAC,YAA2B,EAAE,KAAK,GAAG,KAAK;;YACpE,yDAAyD;YACzD,mBAAmB;YACnB,kBAAkB;YAClB,eAAe;YACf,kDAAkD;YAClD,IAAI;YACJ,gDAAgD;YAChD,MAAM,IAAI,CAAC,yBAAyB,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;QAChG,CAAC;KAAA;IAED,qBAAqB,CAAC,SAAoB;QACxC,MAAM,KAAK,GAAG,8DAAU,EAAE,CAAC;QAC3B,MAAM,GAAG,GAAkB;YACzB,EAAE,EAAE,KAAK;YACT,SAAS;YACT,OAAO,EAAE,6CAAM,EAAE,CAAC,IAAI,EAAE;YACxB,UAAU,EAAE,qGAAgB;YAC5B,OAAO,EAAE;gBACP,SAAS,EAAE,IAAI;gBACf,YAAY,EAAE,SAAS;aACxB;SACF,CAAC;QACF,OAAO,GAAG,CAAC;IACb,CAAC;IAED,qDAAqD;IACrD,wCAAwC;IACxC,0CAA0C;IAC1C,kEAAkE;IAClE,IAAI;IAEJ,0DAA0D;IAC1D,8BAA8B;IAC9B,2DAA2D;IAC3D,wDAAwD;IACxD,sDAAsD;IACtD,sEAAsE;IACtE,wCAAwC;IACxC,UAAU;IACV,aAAa;IACb,4CAA4C;IAC5C,0DAA0D;IAC1D,YAAY;IACZ,mDAAmD;IACnD,UAAU;IACV,QAAQ;IACR,oCAAoC;IACpC,4DAA4D;IAC5D,QAAQ;IACR,6CAA6C;IAC7C,MAAM;IACN,gBAAgB;IAChB,IAAI;IAEJ,8DAA8D;IAC9D,SAAS;IACT,aAAa;IACb,qBAAqB;IACrB,iCAAiC;IACjC,oDAAoD;IACpD,QAAQ;IACR,iFAAiF;IACjF,aAAa;IACb,iDAAiD;IACjD,yCAAyC;IACzC,YAAY;IACZ,0DAA0D;IAC1D,sEAAsE;IACtE,UAAU;IACV,QAAQ;IACR,qCAAqC;IACrC,WAAW;IACX,6EAA6E;IAC7E,UAAU;IACV,mEAAmE;IACnE,QAAQ;IACR,MAAM;IACN,IAAI;IAEJ,+BAA+B;IAC/B,mCAAmC;IACnC,MAAM;IACN,UAAU;IACV,sBAAsB;IACtB,gBAAgB;IAChB,QAAQ;IACR,mEAAmE;IACnE,4EAA4E;IAC5E,iCAAiC;IACjC,WAAW;IACX,QAAQ;IACR,+DAA+D;IAC/D,+CAA+C;IAC/C,kDAAkD;IAClD,oBAAoB;IACpB,gEAAgE;IAChE,qCAAqC;IACrC,cAAc;IACd,cAAc;IACd,WAAW;IACX,QAAQ;IACR,WAAW;IACX,+BAA+B;IAC/B,qDAAqD;IACrD,6DAA6D;IAC7D,UAAU;IACV,uEAAuE;IACvE,0EAA0E;IAC1E,oBAAoB;IACpB,gEAAgE;IAChE,qCAAqC;IACrC,cAAc;IACd,cAAc;IACd,WAAW;IACX,QAAQ;IACR,oBAAoB;IACpB,6EAA6E;IAC7E,MAAM;IACN,IAAI;IAEJ,kEAAkE;IAClE,kCAAkC;IAClC,yDAAyD;IACzD,0DAA0D;IAC1D,SAAS;IACT,8DAA8D;IAC9D,+CAA+C;IAC/C,qBAAqB;IACrB,eAAe;IACf,sBAAsB;IACtB,QAAQ;IACR,MAAM;IACN,iBAAiB;IACjB,IAAI;IAEJ,4CAA4C;IAC5C,yDAAyD;IACzD,8EAA8E;IAC9E,0BAA0B;IAC1B,IAAI;IAEJ,oEAAoE;IACpE,4DAA4D;IAC5D,IAAI;IAEJ,oEAAoE;IACpE,gBAAgB;IAChB,iBAAiB;IACjB,MAAM;IACN,oDAAoD;IACpD,mDAAmD;IACnD,OAAO;IACP,IAAI;IAEJ,iFAAiF;IACjF,iDAAiD;IACjD,iEAAiE;IACjE,MAAM;IACN,iBAAiB;IACjB,IAAI;IAEJ,sDAAsD;IACtD,6CAA6C;IAC7C,IAAI;IAEJ,kEAAkE;IAClE,qBAAqB;IACrB,iCAAiC;IACjC,4CAA4C;IAC5C,6CAA6C;IAC7C,0CAA0C;IAC1C,6CAA6C;IAC7C,uCAAuC;IACvC,+BAA+B;IAC/B,gCAAgC;IAChC,OAAO;IACP,sEAAsE;IACtE,IAAI;IAEE,gBAAgB,CAAC,OAAgB,EAAE,GAAkB;;YACzD,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,wBAAwB,EAAE,CAAC;YAC7E,IAAI,CAAC,YAAY,CAAC,UAAU,EAAE;gBAC5B,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;gBAChC,OAAO;aACR;YACD,GAAG,CAAC,UAAU,GAAG,oGAAe,CAAC;YACjC,IAAI,CAAC,yBAAyB,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC,SAAS,EAAE,CAAC;YACxE,oDAAoD;YACpD,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,iBAAiB,CAAC,CAAC;QACrD,CAAC;KAAA;IAED,4CAA4C;IAC5C,sCAAsC;IACtC,IAAI;IAEJ,uBAAuB;IACvB,sDAAsD;IACtD,iCAAiC;IACjC,mDAAmD;IACnD,kDAAkD;IAClD,UAAU;IACV,QAAQ;IACR,OAAO;IACP,IAAI;IAEE,iBAAiB,CAAC,MAAqB;;YAC3C,OAAO,oFAAmB,CAAC,IAAI,CAAC,yBAAyB,CAAC,iBAAiB,EAAE,EAAE,MAAM,CAAC,CAAC;QACzF,CAAC;KAAA;IAED,mDAAmD;IACnD,2BAA2B;IAC3B,kBAAkB;IAClB,0BAA0B;IAC1B,0BAA0B;IAC1B,UAAU;IACV,MAAM;IACN,oEAAoE;IACpE,qBAAqB;IACrB,oBAAoB;IACpB,iEAAiE;IACjE,sEAAsE;IACtE,+DAA+D;IAC/D,SAAS;IACT,4BAA4B;IAC5B,6DAA6D;IAC7D,QAAQ;IACR,qCAAqC;IACrC,cAAc;IACd,MAAM;IAEN,oEAAoE;IACpE,qBAAqB;IACrB,oBAAoB;IACpB,0CAA0C;IAC1C,YAAY;IACZ,iDAAiD;IACjD,sBAAsB;IACtB,qCAAqC;IACrC,WAAW;IACX,+BAA+B;IAC/B,0DAA0D;IAC1D,4BAA4B;IAC5B,6EAA6E;IAC7E,6BAA6B;IAC7B,uDAAuD;IACvD,0BAA0B;IAC1B,6BAA6B;IAC7B,yCAAyC;IACzC,eAAe;IACf,mBAAmB;IACnB,gDAAgD;IAChD,YAAY;IACZ,UAAU;IACV,iEAAiE;IACjE,sBAAsB;IACtB,0EAA0E;IAC1E,QAAQ;IACR,MAAM;IACN,IAAI;IAEJ,kCAAkC;IAClC,iCAAiC;IACjC,8BAA8B;IAC9B,2BAA2B;IAC3B,MAAM;IACN,UAAU;IACV,kCAAkC;IAClC,sDAAsD;IACtD,+DAA+D;IAC/D,sEAAsE;IACtE,+BAA+B;IAC/B,wBAAwB;IACxB,iBAAiB;IACjB,WAAW;IACX,6DAA6D;IAC7D,0CAA0C;IAC1C,+BAA+B;IAC/B,gCAAgC;IAChC,uCAAuC;IACvC,WAAW;IACX,QAAQ;IACR,+EAA+E;IAC/E,mBAAmB;IACnB,6CAA6C;IAC7C,iDAAiD;IACjD,mCAAmC;IACnC,yCAAyC;IACzC,qBAAqB;IACrB,wBAAwB;IACxB,aAAa;IACb,WAAW;IACX,wCAAwC;IACxC,+BAA+B;IAC/B,6CAA6C;IAC7C,iCAAiC;IACjC,4BAA4B;IAC5B,aAAa;IACb,2FAA2F;IAC3F,+DAA+D;IAC/D,+CAA+C;IAC/C,6FAA6F;IAC7F,qCAAqC;IACrC,gBAAgB;IAChB,4DAA4D;IAC5D,uBAAuB;IACvB,yBAAyB;IACzB,aAAa;IACb,iCAAiC;IACjC,sCAAsC;IACtC,6DAA6D;IAC7D,aAAa;IACb,oEAAoE;IACpE,iBAAiB;IACjB,qCAAqC;IACrC,gBAAgB;IAChB,iEAAiE;IACjE,uBAAuB;IACvB,yBAAyB;IACzB,aAAa;IACb,iCAAiC;IACjC,sCAAsC;IACtC,0CAA0C;IAC1C,aAAa;IACb,oEAAoE;IACpE,UAAU;IACV,eAAe;IACf,iCAAiC;IACjC,mCAAmC;IACnC,cAAc;IACd,6CAA6C;IAC7C,qBAAqB;IACrB,uBAAuB;IACvB,WAAW;IACX,yEAAyE;IACzE,kEAAkE;IAClE,QAAQ;IACR,MAAM;IACN,IAAI;IAEJ,kEAAkE;IAClE,sCAAsC;IACtC,sEAAsE;IACtE,iEAAiE;IACjE,oEAAoE;IACpE,6BAA6B;IAC7B,UAAU;IACV,gBAAgB;IAChB,mBAAmB;IACnB,yBAAyB;IACzB,uCAAuC;IACvC,QAAQ;IACR,qDAAqD;IACrD,MAAM;IACN,8BAA8B;IAC9B,IAAI;IAEJ,yDAAyD;IACzD,sEAAsE;IACtE,eAAe;IACf,SAAS;IACT,OAAO;IACP,IAAI;IAEJ,sBAAsB;QACpB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI;QAC7B,oBAAoB;QACpB,oDAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,UAAU,KAAK,qGAAgB,CAAC,CAAC,CACvE,CAAC;IACJ,CAAC;IAED,wBAAwB,CAAC,EAAU;QACjC,OAAO,IAAI,CAAC,yBAAyB,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;IAChE,CAAC;;sFArZU,mBAAmB;qHAAnB,mBAAmB,WAAnB,mBAAmB,mBAFlB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpBmC;AACI;AAC/B;AACuD;AACW;AACG;AACjB;AAEhB;AAC0B;AACrC;AAC6B;AACV;;;;;;;;;;;;;;;;ICLlE,+EAAqG;IAA3F,4ZAAuC;IAC/C,8EAA4F;IAC5F,4EAAW;IAAA,uDAAmF;;;IAAA,4DAAY;IAC5G,4DAAW;;;;IAFkB,0DAAsB;IAAtB,+EAAsB;IACtC,0DAAmF;IAAnF,kQAAmF;;;;IAIhG,+EAAqF;IAArC,yZAAoC;IAClF,0EAAgD;IAChD,4EAAW;IACT,uDACA;;;IAAA,oEAAG;IAAA,uDAAgB;IAAA,4DAAI;IACzB,4DAAY;IACd,4DAAW;;;;IAHP,0DACA;IADA,2QACA;IAAG,0DAAgB;IAAhB,+EAAgB;;;;IAMrB,+EAAsF;IAAhC,yVAAyB,IAAI,KAAE;IACnF,0EAA6D;IAC7D,4EAAW;IAAA,uDAAiC;;IAAA,4DAAY;IAC1D,4DAAW;;IADE,0DAAiC;IAAjC,kJAAiC;;;IAHhD,wEAA6C;IAC3C,gJAGW;;IACb,qEAAe;;;;IAJF,0DAA2B;IAA3B,sJAA2B;;;IAxB9C,gFAAqH;IACnH,iFAAgB;IACd,yEAAgC;IAClC,4DAAiB;IACjB,kFAAyB;IACvB,8EAA4D;IAG1D,gIAGW;IAGX,gIAMW;;IAGX,wIAKe;IAEjB,4DAAW;IACX,qEAAgD;IAClD,4DAAe;IACjB,4DAAU;;;;IAzBoE,0DAA2B;IAA3B,gGAA2B;IAMvE,0DAAkB;IAAlB,oJAAkB;IAS/B,0DAA4B;IAA5B,2FAA4B;;;;IAa/C,+EAA2C;IAAjC,kUAAyB,KAAK,KAAE;IACxC,0EAA6D;IAC7D,4EAAW;IAAA,uDAAkC;;IAAA,4DAAY;IAC3D,4DAAW;;IADE,0DAAkC;IAAlC,mJAAkC;;ADvBjD,MAAM,SAAS,GAAG,kBAAkB,CAAC;AAO9B,MAAM,gBAAgB;IAW3B,YACU,mBAAwC,EACxC,aAA4B,EAC5B,iBAAoC,EACpC,iBAAoC,EACpC,kBAAsC,EACtC,gBAAkC,EAClC,cAA8B;QAN9B,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,kBAAa,GAAb,aAAa,CAAe;QAC5B,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,mBAAc,GAAd,cAAc,CAAgB;IACrC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,IAAI,CAC7D,oDAAG,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC;YACX,UAAU,EAAE,EAAE,CAAC,gBAAgB;YAC/B,QAAQ,EAAE,EAAE,CAAC,gBAAgB,CAAC,OAAO,CAAC,uEAAc,CAAC,IAAI,CAAC;SAC3D,CAAC,CAAC,EACH,qFAAoB,EAAE,CACvB,CAAC;QACF,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,IAAI,CAClD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CACb,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,uBAAuB,EAAE,SAAS,EAAE,MAAM,CAAC,CACtE,EACD,0DAAS,CAAC,CAAC,MAAM,EAAE,EAAE,CACnB,MAAM,CAAC,MAAM,GAAG,CAAC;YACf,CAAC,CAAC,oDAAa,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,kBAAkB,CAAC,KAAK,CAAC,CAAC,CAAC;YACtE,CAAC,CAAC,yCAAE,CAAC,EAAE,CAAC,CACX,EACD,oDAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CACb,IAAI,CAAC,cAAc,CAAC,KAAK,CACvB,iCAAiC,EACjC,SAAS,EACT,MAAM,CACP,CACF,EACD,qFAAoB,EAAE,CACvB,CAAC;QACF,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC;IAC5D,CAAC;IAEO,kBAAkB,CACxB,KAAoB;QAEpB,OAAO,2CAAI,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAC3C,oDAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,EAAE,EAAE,EAAE,KAAK,CAAC,EAAE,EAAE,SAAS,EAAE,KAAK,CAAC,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC,CACpE,CAAC;IACJ,CAAC;IAED,OAAO,CAAC,SAAoB;QAC1B,OAAO,kEAAS,CAAC,SAAS,CAAC,CAAC;IAC9B,CAAC;IAED,OAAO,CAAC,SAAiB;QACvB,OAAO,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,kDAAW,CAAC,SAAS,CAAC,CAAC,CAAC;IACnE,CAAC;IAED,gBAAgB,CAAC,GAAW;QAC1B,UAAU,CAAC,GAAG,EAAE;YACd,IAAI,IAAI,CAAC,OAAO,EAAE;gBAChB,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;aACtB;QACH,CAAC,EAAE,CAAC,CAAC,CAAC;QACN,IAAI,CAAC,aAAa,CAAC,eAAe,CAAC,GAAG,CAAC,CAAC;IAC1C,CAAC;IAED,kBAAkB,CAAC,SAAoB;QACrC,IAAI,CAAC,gBAAgB,CAAC,oBAAoB,SAAS,EAAE,CAAC,CAAC;IACzD,CAAC;IAED,gBAAgB,CAAC,EAAU;QACzB,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,EAAE,EAAE,CAAC,CAAC;IACnD,CAAC;IAED,SAAS;QACP,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;IACvB,CAAC;IAED,eAAe,CAAC,WAAoB;QAClC,OAAO,WAAW;YAChB,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE;YACzC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;IAC3C,CAAC;;gFA3FU,gBAAgB;8GAAhB,gBAAgB;;;;;;QCtB7B,qHAiCU;;QAEV,wMAKc;;QAxCqD,qJAA+B;;;;;;;;;;;;;;;;;;;ACCE;;;;AAO7F,MAAM,qBAAqB;IAGhC,YAAoB,mBAAwC;QAAxC,wBAAmB,GAAnB,mBAAmB,CAAqB;IAAG,CAAC;IAEhE,QAAQ,KAAI,CAAC;IAEb,QAAQ,CAAC,KAAY;QACnB,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,IAAI,CAAC,mBAAmB,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACtD,CAAC;;0FAVU,qBAAqB;mHAArB,qBAAqB;;QCRlC,uEAAuC;QAA3B,8IAAS,oBAAgB,IAAC;QACpC,6DAAyB;QAC3B,4DAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACMmB;AASM;AAC+D;AACjD;AACY;AAC0C;AAK3C;AACX;;;;;;;;;ICrBvC,4EAAwD;IACtD,6EAA6D;IAC/D,4DAAY;;;IAF4B,sFAAe;IACvC,0DAA+B;IAA/B,2FAA+B;;;IAU3C,4EAA8B;IAC5B,6EAAuD;IACzD,4DAAY;;;IADI,0DAAyB;IAAzB,qFAAyB;;;;IAN3C,+EAC4C;IAA1C,0bAAyC;IACzC,oFAAoE;IAClE,6EAAuD;IACzD,4DAAiB;IACjB,sKAEY;IACd,4DAAW;;;;IAN2C,0DAAe;IAAf,+EAAe;IACnD,0DAAyB;IAAzB,qFAAyB;IAE7B,0DAAgB;IAAhB,mFAAgB;;;IANhC,8EAAmF;IACjF,yJAQW;IACb,4DAAW;;;IAVD,wGAA4C;IACD,0DAAuB;IAAvB,4FAAuB;;;IAF9E,wEAA8E;IAC5E,8IAUW;IACb,qEAAe;;;IAX2C,0DAAY;IAAZ,+EAAY;;;;;IAXxE,6EAC4G;;IAC1G,8EAA6B;IAAnB,yTAAkB;IAC1B,oFAAoE;IAClE,6EAA6D;IAC/D,4DAAiB;IACjB,iIAEY;IACd,4DAAW;IACX,uIAYe;;IACjB,4DAAU;;;;IAtBK,gOAAiD;IAER,0DAAe;IAAf,+EAAe;IACnD,0DAA+B;IAA/B,2FAA+B;IAEnC,0DAA0B;IAA1B,oGAA0B;IAIzB,0DAAsC;IAAtC,+JAAsC;;;;IAcvD,0EAAuD;IAAnB,gTAAkB;IAAC,4DAAM;;ADK7D,MAAM,eAAe,GAAG;IACtB,CAAC,sEAAc,CAAC;IAChB,CAAC,qEAAa,CAAC;IACf,CAAC,uEAAe,EAAE,sEAAc,CAAC;CAClC,CAAC;AA4CK,MAAM,eAAe;IAgB1B,+BAA+B;IAC/B,qIAAqI;IACrI,IAAI;IAEJ,YACU,iBAAoC,EACpC,kBAAsC,EACtC,MAAc;QAFd,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,WAAM,GAAN,MAAM,CAAQ;QAlBf,UAAK,GAAG,OAAO,CAAC;QAChB,WAAM,GAAG,KAAK,CAAC;QACf,eAAU,GAAG,IAAI,CAAC;QACjB,iBAAY,GAAG,IAAI,uDAAY,EAAE,CAAC;QACnC,mBAAc,GAAG,KAAK,CAAC;QAExB,eAAU,GAAG,IAAI,yCAAO,EAAQ,CAAC;QAGzC,wBAAmB,GAAG,GAAG,CAAC;IAUvB,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,kBAAkB,CAAC,iBAAiB,CAAC;QACnE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CACtD,mDAAG,CAAC,CAAC,gBAAgB,EAAE,EAAE,CACvB,eAAe,CAAC,MAAM,CACpB,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAC7D,CACF,CACF,CAAC;QACF,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC;QACxD,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,eAAe,GAAG,UAAU,CAAC,GAAG,EAAE;gBACrC,IAAI,CAAC,mBAAmB,GAAG,eAAe,CAAC;YAC7C,CAAC,EAAE,GAAG,CAAC,CAAC;SACT;aAAM;YACL,IAAI,CAAC,mBAAmB,GAAG,SAAS,CAAC;SACtC;IACH,CAAC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,YAAY,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;SACpC;QACD,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IACtC,CAAC;IAED,IAAI;QACF,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;IAC9B,CAAC;IAED,KAAK;QACH,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;IAC/B,CAAC;IAED,gBAAgB,CAAC,IAAa;QAC5B,MAAM,OAAO,GAAG,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC;QACrC,IAAI,OAAO,EAAE;YACX,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACrC;IACH,CAAC;IAEK,mBAAmB,CAAC,UAAuB;;YAC/C,IAAI,CAAC,KAAK,EAAE,CAAC;YACb,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC/D,IAAI,CAAC,qDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,iCACnC,eAAe,KAClB,gBAAgB,EAAE,UAAU,IAC5B,CAAC;QACL,CAAC;KAAA;;8EAlFU,eAAe;6GAAf,eAAe;QC7E5B,oHAuBU;;QACV,2GAA6D;;QAxBxC,wJAAkC;QAwBjD,0DAAY;QAAZ,4EAAY;s1KDcJ;YACV,6DAAO,CAAC,mBAAmB,EAAE;gBAC3B,2DAAK,CAAC,GAAG,EAAE,2DAAK,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;gBAC9D,2DAAK,CAAC,SAAS,EAAE,2DAAK,CAAC,EAAE,SAAS,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC,EAAE,CAAC,CAAC;gBACpE,gEAAU,CACR,oBAAoB,EACpB,sGAAuC,CAAC,GAAG,EAAE,GAAG,EAAE,+EAAgB,CAAC,CACpE;aACF,CAAC;YACF,6DAAO,CACL,gBAAgB,EAChB,0GAA2C,CAAC,CAAC,EAAE,GAAG,EAAE,0EAAW,CAAC,CACjE;YACD,6DAAO,CAAC,aAAa,EAAE;gBACrB,gEAAU,CAAC,QAAQ,EAAE;oBACnB,2DAAK,CACH,QAAQ,EACR;wBACE,2DAAK,CAAC;4BACJ,SAAS,EAAE,2CAA2C;4BACtD,OAAO,EAAE,CAAC;yBACX,CAAC;wBACF,6DAAO,CACL,GAAG,EACH,6DAAO,CACL,aAAa,0EAAW,EAAE,EAC1B,2DAAK,CAAC;4BACJ,SAAS,EAAE,qCAAqC;4BAChD,OAAO,EAAE,CAAC;yBACX,CAAC,CACH,CACF;qBACF,EACD,EAAE,QAAQ,EAAE,IAAI,EAAE,CACnB;iBACF,CAAC;aACH,CAAC;SACH;;;;;;;;;;;;;;;;;;;;AE1EoD;;;;;AAOhD,MAAM,gBAAgB;IAC3B;QAGS,iBAAY,GAAG,IAAI,CAAC;IAHd,CAAC;IAKhB,IAAI,QAAQ;QACV,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;YACjD,OAAO,IAAI,CAAC,UAAU;iBACnB,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,SAAS,KAAK,sEAAc,CAAC,CAAC,CAAU,iEAAS,CAAC,SAAS,CAAE,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC;iBACxG,IAAI,CAAC,GAAG,CAAC,CAAC;SACd;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,IAAI,OAAO;QACT,OAAO,gBAAgB,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,GAAG,EAAE,GAAG,CAAC,MAAM,CAAC;IAC/D,CAAC;IAED,QAAQ,KAAI,CAAC;;gFAnBF,gBAAgB;8GAAhB,gBAAgB;QCR7B,yEAA6F;;QAAnF,4EAAe;;;;;;;;;;;;;;;;;;;;ACGuD;;;;AAOzE,MAAM,gBAAgB;IAK3B,YAAoB,gBAAkC;QAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;IAAG,CAAC;IAE1D,QAAQ;QACN,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC9D,CAAC;;gFATU,gBAAgB;8GAAhB,gBAAgB;QCV7B,uDAAmB;;;QAAnB,2IAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;ACC8E;AAE1C;AAEjB;;;;;;;;;ICJpC,oFAAuF;IAAnB,iVAAkB;IACpF,6EAA0E;IAC5E,4DAAiB;;;IADD,0DAA4C;IAA5C,wGAA4C;;;;IActD,+EACwC;IAAtC,kdAAqC;IACrC,qFAA2C;IACzC,6EAAuD;IACzD,4DAAiB;IACjB,4EAAW;IACT,6EAAuD;IACzD,4DAAY;IACd,4DAAW;;;IALO,0DAAyB;IAAzB,qFAAyB;IAGzB,0DAAyB;IAAzB,qFAAyB;;;IAP7C,wEAAwD;IACtD,wJAQW;IACb,qEAAe;;;;IATF,0DAAwE;IAAxE,wIAAwE;;;;IAZzF,yEAA+C;IAC7C,yEAAqD;IAAnB,8TAAkB;IAAC,4DAAM;IAC3D,8EAA6C;IAC3C,+EAA6B;IAAnB,mUAAkB;IAC1B,qFAA2C;IACzC,6EAA0E;IAC5E,4DAAiB;IACjB,4EAAW;IACT,6EAA0E;IAC5E,4DAAY;IACd,4DAAW;IACX,iJAUe;IACjB,4DAAW;IACb,4DAAM;;;;IAlBgB,0DAA4C;IAA5C,wGAA4C;IAG5C,0DAA4C;IAA5C,wGAA4C;IAGzB,0DAAiB;IAAjB,0FAAiB;;;IAf5D,gFAAwH;IACtH,8IAEiB;IACjB,wHAuBM;IACR,4DAAU;;;IA3B+B,0DAAa;IAAb,gFAAa;IAGnB,0DAAY;IAAZ,+EAAY;;ADQxC,MAAM,kBAAkB;IAK7B,YAAoB,kBAAsC;QAAtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAH1D,WAAM,GAAG,KAAK,CAAC;IAG8C,CAAC;IAE9D,QAAQ;QACN,IAAI,CAAC,cAAc,GAAG;YACpB,CAAC,sEAAc,CAAC;YAChB,CAAC,qEAAa,CAAC;YACf,CAAC,uEAAe,EAAE,sEAAc,CAAC;SAClC,CAAC;QACF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC;IAC5D,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC;IAC7B,CAAC;IAEK,eAAe,CAAC,UAAuB;;YAC3C,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACpB,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC/D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,iCACnC,eAAe,KAClB,gBAAgB,EAAE,UAAU,IAC5B,CAAC;QACL,CAAC;KAAA;;oFA7BU,kBAAkB;gHAAlB,kBAAkB;QCZ/B,sHA4BU;;;QA5BA,oJAA8B;;;;;;;;;;;;;;;;;;;;;;;;;ACAoC;AAEgB;AACE;AACG;AAC5C;;;;;;;;;ICHjD,iFAAkD;IAChD,gFAAuE;IACzE,4DAAc;;;IADa,0DAA2B;IAA3B,2FAA2B;;;IAEtD,iFAA+C;IAC7C,gFAA4D;IAC9D,4DAAc;;;IACd,4EAAgC;IAC9B,uDACF;;IAAA,4DAAY;;;IADV,0DACF;IADE,yJACF;;;;IACA,4EAA+B;IAC7B,iFAA+E;IAApB,yUAAmB;IAC5E,uDACF;;IAAA,4DAAa;IACf,4DAAY;;IAFR,0DACF;IADE,6JACF;;;IAdN,gFAA8E;IAC5E,iFAAyE;IACvE,wIAEc;IACd,wIAEc;IACd,oIAEY;IACZ,oIAIY;IACd,4DAAc;IAChB,4DAAa;;;IAhB2B,0DAAuB;IAAvB,uFAAuB;IAChC,0DAAqB;IAArB,wFAAqB;IAGvB,0DAAoB;IAApB,uFAAoB;IAGjC,0DAAkB;IAAlB,qFAAkB;IAGlB,0DAAiB;IAAjB,oFAAiB;;ADC1B,MAAM,eAAe;IAwB1B,YACU,iBAAoC,EACpC,iBAAoC,EACpC,kBAAsC,EACtC,MAAc;QAHd,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,WAAM,GAAN,MAAM,CAAQ;QA3Bf,mBAAc,GAAG,IAAI,CAAC;QACtB,sBAAiB,GAAG,KAAK,CAAC;QAE1B,gBAAW,GAAG,GAAG,CAAC;QAE3B,gBAAW,GAAG,KAAK,CAAC;QACZ,YAAO,GAAG,oEAAY,CAAC;QAGvB,kBAAa,GAAmB,EAAE,CAAC;IAmBxC,CAAC;IAjBJ,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,iBAAiB,CAAC,yBAAyB,EAAE,CAAC;IAC5D,CAAC;IAED,IAAI,WAAW;QACb,IAAI,IAAI,CAAC,WAAW,EAAE;YACpB,OAAO,cAAc,CAAC;SACvB;aAAM;YACL,OAAO,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;SACnC;IACH,CAAC;IASD,QAAQ;QACN,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC;QAC1D,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,iBAAiB,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACtD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;YACzB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CACH,CAAC;QACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,OAAO,EAAE,EAAE;YACrD,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;YACzB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CACH,CAAC;IACJ,CAAC;IAED,WAAW;QACT,KAAK,MAAM,YAAY,IAAI,IAAI,CAAC,aAAa,EAAE;YAC7C,YAAY,CAAC,WAAW,EAAE,CAAC;SAC5B;IACH,CAAC;IAED,OAAO;QACL,IAAI,CAAC,iBAAiB,CAAC,cAAc,EAAE,CAAC;IAC1C,CAAC;;8EAzDU,eAAe;6GAAf,eAAe;QCZ5B,yHAiBa;;;QAjBW,+KAAoD;;;;;;;;;;;;;;;;;;;;;;;ACAG;AACxB;AAGA;;;;;;ICDvD,yEAA6E;;;IAA9B,kFAAkB;;ADGjE,MAAM,sBAAsB,GAAG,gBAAgB,CAAC;AAChD,MAAM,qBAAqB,GAAG,eAAe,CAAC;AAOvC,MAAM,eAAe;IAyB1B,YACU,qBAA4C,EAC5C,gBAAkC;QADlC,0BAAqB,GAArB,qBAAqB,CAAuB;QAC5C,qBAAgB,GAAhB,gBAAgB,CAAkB;QAvBlC,wBAAmB,GAAG,IAAI,uDAAY,EAAE,CAAC;QAC1C,YAAO,GAAwB,EAAE,CAAC;QAClC,cAAS,GAAG,IAAI,CAAC;QACjB,aAAQ,GAAG,KAAK,CAAC;IAqBvB,CAAC;IAnBJ,IAAI,SAAS;QACX,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,aAAa,CAAC,CAAC;QAC3E,IAAI,IAAI,EAAE;YACR,OAAO,IAAI,CAAC,IAAI,CAAC;SAClB;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,IAAI,SAAS;QACX,MAAM,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,IAAI,CAAC,aAAa,CAAC,CAAC;QAC3E,IAAI,IAAI,EAAE;YACR,OAAO,IAAI,CAAC,IAAI,CAAC;SAClB;QACD,OAAO,SAAS,CAAC;IACnB,CAAC;IAOD,QAAQ,KAAI,CAAC;IAEC,qBAAqB;;YACjC,MAAM,OAAO,GAAwB,EAAE,CAAC;YACxC,KAAK,MAAM,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE;gBACpE,MAAM,cAAc,GAAG,MAAM,IAAI,CAAC,gBAAgB;qBAC/C,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC;qBAChB,SAAS,EAAE,CAAC;gBACf,OAAO,CAAC,IAAI,CAAC;oBACX,IAAI,EAAE,cAAc;oBACpB,IAAI,EAAE,MAAM,CAAC,IAAI;oBACjB,IAAI,EAAE,MAAM,CAAC,EAAE,KAAK,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,SAAS;oBAC/D,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;iBAChD,CAAC,CAAC;aACJ;YACD,IAAI,IAAI,CAAC,aAAa,KAAK,SAAS,IAAI,IAAI,CAAC,SAAS,EAAE;gBACtD,MAAM,mBAAmB,GAAG,MAAM,IAAI,CAAC,gBAAgB;qBACpD,GAAG,CAAC,qBAAqB,CAAC;qBAC1B,SAAS,EAAE,CAAC;gBACf,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE;oBACnB,IAAI,EAAE,mBAAmB;oBACzB,OAAO,EAAE,GAAG,EAAE,CAAC,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC;oBAC/C,IAAI,EAAE,aAAa;iBACpB,CAAC,CAAC;aACJ;YACD,MAAM,oBAAoB,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBACrD,GAAG,CAAC,sBAAsB,CAAC;iBAC3B,SAAS,EAAE,CAAC;YACf,OAAO,CAAC,IAAI,CAAC;gBACX,IAAI,EAAE,oBAAoB;gBAC1B,IAAI,EAAE,QAAQ;aACf,CAAC,CAAC;YACH,OAAO,OAAO,CAAC;QACjB,CAAC;KAAA;IAEK,oBAAoB;;YACxB,IAAI,mBAA2B,CAAC;YAChC,IAAI,IAAI,CAAC,KAAK,EAAE;gBACd,mBAAmB,GAAG,MAAM,IAAI,CAAC,gBAAgB;qBAC9C,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;qBACf,SAAS,EAAE,CAAC;aAChB;YACD,IAAI,sBAA8B,CAAC;YACnC,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,sBAAsB,GAAG,MAAM,IAAI,CAAC,gBAAgB;qBACjD,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC;qBAClB,SAAS,EAAE,CAAC;aAChB;YACD,OAAO;gBACL,mBAAmB;gBACnB,sBAAsB;aACvB,CAAC;QACJ,CAAC;KAAA;IAEK,UAAU;;YACd,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;gBAClB,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBACvD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,qBAAqB,EAAE,CAAC;gBACnD,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,qBAAqB,CAAC,MAAM,CAAC;oBAC1D,MAAM,EAAE,YAAY,CAAC,mBAAmB;oBACxC,SAAS,EAAE,YAAY,CAAC,sBAAsB;oBAC9C,OAAO;iBACR,CAAC,CAAC;gBACH,MAAM,WAAW,CAAC,OAAO,EAAE,CAAC;aAC7B;QACH,CAAC;KAAA;IAEO,gBAAgB,CAAC,EAAmB;QAC1C,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IACpC,CAAC;;8EApGU,eAAe;6GAAf,eAAe;QCd5B,gFACyB;QAAvB,2IAAS,gBAAY,IAAC;QACxB,4DAAa;QACb,qHAA6E;QAC7E,2EAAU;QACR,uDACF;;QAAA,4DAAW;QACX,yEAA4E;;QAJ9C,0DAAe;QAAf,+EAAe;QAE3C,0DACF;QADE,2JACF;;;;;;;;;;;;;;;;;;;;;;;;ACAO,MAAM,qBAAqB;IALlC;QAQE,WAAM,GAAG,KAAK,CAAC;QACf,aAAQ,GAAG,KAAK,CAAC;QAET,qBAAgB,GAAG,KAAK,CAAC;KA8BlC;IA5BC,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC;IAC/B,CAAC;IAED,QAAQ;QACN,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;IACrB,CAAC;IAED,OAAO;QACL,IAAI,IAAI,CAAC,gBAAgB,EAAE;YACzB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACtB;aAAM;YACL,IAAI,CAAC,gBAAgB,EAAE,CAAC;SACzB;IACH,CAAC;IAEO,gBAAgB;QACtB,IAAI,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,GAAG,CAAC,OAAO,CAAC,sBAAsB,CAAC,GAAG,CAAC,EAAE;YAC5D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,GAAG;iBACzB,OAAO,CAAC,QAAQ,EAAE,KAAK,CAAC;iBACxB,OAAO,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC;SAC9B;aAAM;YACL,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACtB;QACD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC;IAC/B,CAAC;;0FAnCU,qBAAqB;mHAArB,qBAAqB;QCNlC,yEAAmC;QACjC,6EACsD;QAApD,8JAAiB,cAAU,IAAC,4FAAa,aAAS,IAAtB;QAAwB,4DAAU;QAChE,yEAAqF;QACnF,yEAAsC;QACxC,4DAAM;QACR,4DAAM;;QALwB,0DAAmD;QAAnD,oKAAmD;QAE9C,0DAAmD;QAAnD,oKAAmD;;;;;;;;;;;;;;;;;;;;;;;;;ACHV;AAC7C;AACO;AACkB;;;;;;;ICAtD,2EAA6B;IAC3B,0EAAS;IACP,6EAAiC;IAC/B,gFAAyD;IAAnB,oUAAkB;IAAC,uDAAkC;;IAAA,4DAAa;IAC1G,4DAAU;IACZ,4DAAU;IACZ,4DAAW;;IAHoD,0DAAkC;IAAlC,kJAAkC;;ADI5F,MAAM,0BAA0B;IAWrC,YAAoB,MAAc,EAAU,QAAkB;QAA1C,WAAM,GAAN,MAAM,CAAQ;QAAU,aAAQ,GAAR,QAAQ,CAAU;QAV9D,eAAU,GAAG,KAAK,CAAC;QAMV,aAAQ,GAAG,KAAK,CAAC;IAIuC,CAAC;IAElE,QAAQ;QACN,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,OAAO,CAAC;QAClE,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE;YACvB,IAAI,CAAC,aAAa,GAAG,IAAI,yCAAO,EAAW,CAAC;SAC7C;IACH,CAAC;IAED,MAAM;QACJ,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAChC,CAAC;IAEO,gBAAgB;QACtB,OAAO,IAAI,CAAC,aAAa,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,CAAC;IACrE,CAAC;IAEK,SAAS;;YACb,IAAI,IAAI,CAAC,WAAW,EAAE;gBACpB,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;gBAC9C,aAAa,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;gBAC1C,wGAAwG;gBACxG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;oBACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACzB,CAAC,CAAC,CAAC;gBACH,IAAI;oBACF,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;iBACvC;wBAAS;oBACR,IAAI,CAAC,QAAQ,EAAE,CAAC;iBACjB;aACF;QACH,CAAC;KAAA;IAEO,QAAQ;QACd,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;YACnB,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;YACnB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QAC1B,CAAC,CAAC,CAAC;IACL,CAAC;;oGAnDU,0BAA0B;wHAA1B,0BAA0B;kEAI1B,wDAAY;;;;;QCdzB,mFAA6E;QAAjD,mKAAc,eAAW,IAAC;QACpD,sFACwB;QACxB,gIAMW;QACb,4DAAgB;;QAVuC,kFAAqB;QACnB,0DAA6B;QAA7B,0FAA6B;QAEzE,0DAAgB;QAAhB,gFAAgB;;;;;;;;;;;;;;;;;;;ACGN;AAG0E;;;AAK1F,MAAM,oBAAoB;IAW/B,YACU,kBAAsC,EACtC,MAAc;QADd,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,WAAM,GAAN,MAAM,CAAQ;IACrB,CAAC;IAVJ,IACI,YAAY;QACd,OAAO,6BACL,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAC9C,EAAE,CAAC;IACL,CAAC;IAOD,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,SAAS,CAC5D,CAAC,OAAO,EAAE,EAAE;YACV,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;YACzB,CAAC,CAAC,CAAC;QACL,CAAC,CACF,CAAC;IACJ,CAAC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,YAAY,EAAE;YACrB,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;SACjC;IACH,CAAC;;wFA9BU,oBAAoB;kHAApB,oBAAoB;;;;;;;;;;;;;;;;;;;ACduC;;AAIjE,MAAM,kBAAkB;IAe7B,YAAoB,EAAc;QAAd,OAAE,GAAF,EAAE,CAAY;IAAG,CAAC;IAZtC,WAAW;QACT,MAAM,MAAM,GACV,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,UAAU;YAChC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC,CAAC;QACvD,IAAI,MAAM,EAAE;YACV,IAAI,SAAS,GAAG,EAAE,CAAC;YACnB,SAAS,IAAI,SAAS,CAAC;YACvB,SAAS,IAAI,IAAI,CAAC,eAAe,CAAC;YAClC,SAAS,IAAI,UAAU,CAAC;YACxB,MAAM,CAAC,SAAS,IAAI,SAAS,CAAC;SAC/B;IACH,CAAC;;oFAdU,kBAAkB;gHAAlB,kBAAkB;;;;;;;;;;;;;;;;;;ACCxB,MAAM,OAAO;IAClB,SAAS,CAAC,KAAc;QACtB,IAAI;YACF,OAAO,IAAI,CAAC,GAAG,CAAC,KAAe,CAAC,CAAC;SAClC;QAAC,OAAO,KAAK,EAAE;YACd,OAAO,IAAI,CAAC;SACb;IACH,CAAC;;8DAPU,OAAO;8GAAP,OAAO;;;;;;;;;;;;;;;;;;ACH+D;;;AAK5E,MAAM,cAAc;IACzB,YAAoB,iBAAoC;QAApC,sBAAiB,GAAjB,iBAAiB,CAAmB;IAAG,CAAC;IAE5D,SAAS,CACP,KAAoB,EACpB,cAAc,GAAG,IAAI,EACrB,QAAQ,GAAG,IAAI,EACf,QAAQ,GAAG,IAAI;QAEf,OAAO,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,CAC5C,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,EAAE,EACpE,cAAc,EACd,QAAQ,EACR,QAAQ,CACT,CAAC;IACJ,CAAC;;4EAfU,cAAc;4HAAd,cAAc;;;;;;;;;;;;;;;;;;;;;;ACN4B;AAC3B;;;AAKrB,MAAM,iBAAiB;IAC5B,YAAoB,gBAAkC;QAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;IAAG,CAAC;IAE1D,gBAAgB,CACd,UAAkB,EAClB,cAAc,GAAG,IAAI,EACrB,QAAQ,GAAG,IAAI,EACf,QAAQ,GAAG,IAAI,EACf,kBAA0B,IAAI;QAE9B,OAAO,IAAI,CAAC,UAAU,CACpB,uDAAgB,CAAC,UAAU,CAAC,EAC5B,cAAc,EACd,QAAQ,EACR,QAAQ,EACR,eAAe,CAChB,CAAC;IACJ,CAAC;IAEK,UAAU,CACd,IAAmB,EACnB,cAAc,GAAG,IAAI,EACrB,QAAQ,GAAG,IAAI,EACf,QAAQ,GAAG,IAAI,EACf,kBAA0B,IAAI;;YAE9B,MAAM,QAAQ,GAAG,eAAe,IAAI,6CAAM,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;YACzD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE;gBACnB,OAAO,EAAE,CAAC;aACX;YACD,MAAM,KAAK,GAAG,EAAE,CAAC;YACjB,IAAI,YAAY,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YACxC,IAAI,cAAc,EAAE;gBAClB,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,gBAAgB;qBAC3C,GAAG,CAAC,mBAAmB,CAAC;qBACxB,SAAS,EAAE,CAAC;gBACf,MAAM,SAAS,GAAG,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;gBAC7D,YAAY,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE,CAAC;aACpD;YACD,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YACzB,IAAI,QAAQ,EAAE;gBACZ,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC;aACjC;YACD,IAAI,QAAQ,EAAE;gBACZ,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC;gBACjC,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,QAAQ,EAAE;oBACjC,KAAK,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;iBACrC;aACF;YACD,OAAO,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACzB,CAAC;KAAA;;kFAlDU,iBAAiB;kHAAjB,iBAAiB,WAAjB,iBAAiB,mBAFhB,MAAM;;;;;;;;;;;;;;;;;;;;ACJmC;AACA;AAElB;;;AAK9B,MAAM,gBAAgB;IAC3B,YAAoB,gBAAkC;QAAlC,qBAAgB,GAAhB,gBAAgB,CAAkB;IAAG,CAAC;IAE1D,iBAAiB,CAAC,SAAoB;QACpC,MAAM,YAAY,GAAG,SAAS,KAAK,sEAAc,CAAC,CAAC,CAAC,iEAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC;QAClF,OAAO,eAAe,YAAY,EAAE,CAAC,WAAW,EAAE,CAAC;IACrD,CAAC;IAED,kBAAkB,CAAC,UAAuB;QACxC,IAAI,UAAU,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;YACvC,OAAO,UAAU,CAAC,GAAG,CAAC,CAAC,SAAS,EAAE,EAAE,CAAC,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC,CAAC;SACzE;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;IAED,OAAO,CAAC,UAAuB;QAC7B,MAAM,IAAI,GAAG,IAAI,CAAC,kBAAkB,CAAC,UAAU,CAAC,CAAC;QACjD,OAAO,IAAI,CAAC,gBAAgB;aACzB,GAAG,CAAC,IAAI,CAAC;aACT,IAAI,CAAC,mDAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;IAC7D,CAAC;IAED,gBAAgB;QACd,OAAO,MAAM,CAAC,IAAI,CAAC,iEAAS,CAAC;aAC1B,MAAM,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,OAAO,iEAAS,CAAC,GAAG,CAAC,KAAK,QAAQ,CAAC;aACnD,GAAG,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,iEAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IAClC,CAAC;;gFA1BU,gBAAgB;iHAAhB,gBAAgB,WAAhB,gBAAgB,mBAFf,MAAM;;;;;;;;;;;;;;;;;;ACDyB;;AAQtC,MAAM,qBAAqB;IAEhC,gBAAe,CAAC;IAEhB,MAAM,KAAU,CAAC;IAEjB,OAAO,KAAU,CAAC;IAElB,gBAAgB,CAAC,OAAgB,IAAS,CAAC;IAE3C,OAAO,CAAC,IAAkB,IAAS,CAAC;IAEpC,KAAK,CACH,KAAY,EACZ,GAAY,EACZ,OAAgB,EAChB,GAAG,cAAqB;QAExB,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,4DAAc,EAAE,GAAG,EAAE,GAAG,cAAc,CAAC,CAAC;IACnE,CAAC;IAED,KAAK,CAAC,OAAe,EAAE,GAAY,EAAE,GAAG,cAAqB;QAC3D,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,4DAAc,EAAE,GAAG,EAAE,GAAG,cAAc,CAAC,CAAC;IAClE,CAAC;IAED,GAAG,CACD,OAAgB,EAChB,KAAa,EACb,KAAgB,EAChB,GAAY,EACZ,GAAG,cAAqB;QAExB,MAAM,GAAG,GAAG,IAAI,KAAK,CAAC,WAAW,EAAE,IACjC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,EAC1B,IAAI,OAAO,EAAE,CAAC;QACd,cAAc,CAAC,MAAM,GAAG,CAAC;YACvB,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAE,cAAc,CAAC;YAClC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;QACrB,IAAI,KAAK,EAAE;YACT,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;SACtB;IACH,CAAC;;0FAzCU,qBAAqB;sHAArB,qBAAqB,WAArB,qBAAqB,mBAFpB,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZpB;;;;;;;;;;;;;;;;;;;;;;;;;;;GA2BG;AAEwC;AACQ;AAEX;AACZ;AAE2D;AAC/C;AACK;;;;;AAKtC,MAAM,kBAAkB;IAa3B,YAAoB,IAAU,EACV,QAAkB,EAClB,aAA4B;QAF5B,SAAI,GAAJ,IAAI,CAAM;QACV,aAAQ,GAAR,QAAQ,CAAU;QAClB,kBAAa,GAAb,aAAa,CAAe;QAbxC,oBAAe,GAAG,KAAK,CAAC;QACxB,eAAU,GAAG,KAAK,CAAC;QAGnB,UAAK,GAAa,EAAE,CAAC;QACrB,eAAU,GAAG,KAAK,CAAC;QAUzB,IAAI,CAAC,aAAa,GAAG,IAAI,iBAAiB,CAAC;YACzC,iBAAiB,EAAE,KAAK;YACxB,YAAY,EAAE,KAAK;YACnB,aAAa,EAAE,yBAAyB;YACxC,cAAc,EAAE,qBAAqB;YACrC,YAAY,EAAE,IAAI;YAClB,WAAW,EAAE,OAAO;YACpB,YAAY,EAAE,OAAO;YACrB,OAAO,EAAE,IAAI,CAAC,cAAc;YAC5B,MAAM,EAAE,MAAM;YACd,SAAS,EAAE,QAAQ;YACnB,OAAO,EAAE,KAAK;SACf,CAAC,CAAC;QACH,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC;IACnC,CAAC;IAED;;OAEG;IACH,IAAI,CAAC,aAAiC;QACpC,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE;aACzB,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,CAAC,MAAM,GAAG,IAAI,iBAAiB,CAAC,aAAa,CAAC,CAAC;YACnD,yDAAyD;YACzD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YACtC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;gBACxB,IAAI,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,EAAE;oBAC9B,mDAAmD;oBACnD,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;iBAC/C;qBAAM;oBACL,IAAI,CAAC,aAAa,CAAC,0CAA0C,CAAC,CAAC;iBAChE;aACF;YACD,IAAI,CAAC,aAAa,CAAC,8CAA8C,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;YACjG,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC;YAC7B,IAAI,CAAC,aAAa,CAAC,0BAA0B,CAAC,CAAC;YAC/C,IAAI,CAAC,GAAG,CAAC,0BAA0B,CAAC,CAAC;YACrC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,EAC/B;gBACE,IAAI,CAAC,aAAa,CAAC,0EAA0E,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,CAAC;gBACrH,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;aAC1B;YACD,IAAI,CAAC,aAAa,CAAC,kBAAkB,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAC7D,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;iBAC/D,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,aAAa,CAAC,yBAAyB,CAAC,CAAC;gBAC9C,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC;YAC5B,CAAC,CAAC;iBACD,KAAK,CAAC,GAAG,CAAC,EAAE;gBACX,IAAI,CAAC,aAAa,CAAC,oCAAoC,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC/E,OAAO,IAAI,CAAC,YAAY,EAAE,CAAC;YAC7B,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAED,OAAO;QACL,OAAO,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;OAEG;IACK,YAAY;QAClB,IAAI,CAAC,aAAa,CAAC,wCAAwC,CAAC,CAAC;QAC7D,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,KAAK,CAAC;aACvE,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,CAAC,aAAa,CAAC,wCAAwC,CAAC,CAAC;YAC7D,OAAO,IAAI,CAAC,WAAW,EAAE,CAAC;QAC5B,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;YACvB,IAAI,CAAC,aAAa,CAAC,sCAAsC,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;QACnF,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;OAGG;IACK,WAAW;QACjB,IAAI,CAAC,aAAa,CAAC,mCAAmC,CAAC,CAAC;QACxD,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;aAC9D,IAAI,CAAC,CAAC,OAAgB,EAAE,EAAE;YACzB,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjC,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,GAAG,4BAA4B,CAAC,CAAC;gBAClE,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;aACnC;iBAAM;gBACL,IAAI,CAAC,aAAa,CAAC,8BAA8B,CAAC,CAAC;gBACnD,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC,CAAC;aAC7C;QACH,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,2BAA2B,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACvG,MAAM,GAAG,CAAC;QACZ,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;OAGG;IACW,YAAY,CAAC,OAAgB;;YACzC,IAAI,CAAC,aAAa,CAAC,sBAAsB,GAAG,OAAO,CAAC,MAAM,GAAG,YAAY,CAAC,CAAC;YAC3E,OAAO,GAAG,0CAAQ,CAAC,OAAO,EAAE,CAAC,KAAY,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,IAAI,KAAK,CAAC,IAAI,IAAI,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC;YAC1H,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,EAAE;gBACxB,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,CAAC,EAAE,IAAI,CAAC;qBACxC,KAAK,CAAC,GAAG,CAAC,EAAE;oBACX,oCAAoC;oBACpC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,MAAM,GAAG,CAAC;gBACZ,CAAC,CAAC,CAAC;aACN;YACD,OAAO,GAAG,2CAAS,CAAC,OAAO,EAAE,CAAC,MAAM,CAAC,EAAC,CAAC,KAAK,CAAC,CAAC,CAAC;YAC/C,MAAM,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC;YAC7B,IAAI,UAAU,GAAG,CAAC,CAAC;YACnB,IAAI,SAAS,GAAG,CAAC,CAAC;YAClB,IAAI;gBACF,oBAAoB;gBACpB,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE;oBAC3B,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;oBAC3C,oCAAoC;oBACpC,UAAU,EAAE,CAAC;oBACb,SAAS,IAAI,IAAI,CAAC;oBAClB,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG,UAAU,GAAG,wBAAwB,GAAG,SAAS,CAAC,CAAC;oBACjF,IAAI,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE;wBACxC,IAAI,CAAC,aAAa,CAAC,qCAAqC,GAAG,SAAS,CAAC,CAAC;wBACtE,OAAO,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,IAAI,CAAC;6BACvC,KAAK,CAAC,GAAG,CAAC,EAAE;4BACX,oCAAoC;4BACpC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;4BACvB,MAAM,GAAG,CAAC;wBACZ,CAAC,CAAC,CAAC;qBACN;yBAAM,IAAI,UAAU,KAAK,KAAK,EAAE;wBAC/B,IAAI,CAAC,aAAa,CAAC,6BAA6B,GAAG,SAAS,CAAC,CAAC;wBAC9D,uCAAuC;wBACvC,MAAM,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;wBAC1E,OAAO,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,EAAE,IAAI,CAAC;6BAChD,KAAK,CAAC,GAAG,CAAC,EAAE;4BACX,oCAAoC;4BACpC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;4BACvB,MAAM,GAAG,CAAC;wBACZ,CAAC,CAAC,CAAC;qBACN;iBACF;aACF;YAAC,OAAM,OAAO,EAAE;gBACf,MAAM,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;gBAC1E,4CAA4C;gBAC5C,OAAO,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,EAAE,OAAO,CAAC;qBAChD,KAAK,CAAC,GAAG,CAAC,EAAE;oBACX,4BAA4B;oBAC5B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,MAAM,GAAG,CAAC;gBACZ,CAAC,CAAC,CAAC;aACN;QACH,CAAC;KAAA;IAED;;;;KAIC;IACa,WAAW,CAAC,KAAY;;YACpC,OAAO,IAAI,OAAO,CAAC,CAAC,OAA2B,EAAE,MAAM,EAAE,EAAE;gBACzD,KAAK,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE;oBAC3B,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;gBACzB,CAAC,EAAE,OAAO,CAAC,EAAE;oBACX,MAAM,CAAC,6CAA6C,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC;gBAClF,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACL,CAAC;KAAA;IAED;;;;;;OAMG;IACK,eAAe,CAAC,OAAgB,EAAE,aAAqB;QAC7D,OAAO,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;aAC/B,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,CAAC,aAAa,CAAC,4BAA4B,CAAC,CAAC;YACjD,sBAAsB;YACtB,OAAO,CAAC,KAAK,EAAE,CAAC;YAChB,cAAc;YACd,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;QACpC,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE;YACX,MAAM,SAAS,GAAG,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;YAC1E,4CAA4C;YAC5C,OAAO,IAAI,CAAC,gBAAgB,CAAC,SAAS,EAAE,aAAa,EAAE,8CAA8C,GAAG,GAAG,CAAC,CAAC;QAC/G,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;;;;OAKG;IACK,gBAAgB,CAAC,SAAgB,EAAE,aAAqB,EAAE,KAAa;QAC7E,IAAI,CAAC,aAAa,CAAC,uBAAuB,CAAC,CAAC;QAC5C,IAAI,SAAS,IAAI,aAAa,GAAG,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE;YACxD,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC;YAC7B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;YAC5B,IAAI,KAAK,EAAE;gBACT,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;aACjB;YACD,IAAI,CAAC,aAAa,CAAC,4CAA4C,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;YAC7F,IAAI,CAAC,GAAG,CAAC,4CAA4C,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;YAC/E,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;aAAM;YACL,IAAI,CAAC,aAAa,CAAC,2DAA2D,CAAC,CAAC;YAChF,OAAO,IAAI,CAAC,cAAc,EAAE;iBACzB,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;gBAC5B,IAAI,KAAK,EAAE;oBACT,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;iBACjB;gBACD,IAAI,CAAC,aAAa,CAAC,uCAAuC,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;gBACxF,IAAI,CAAC,GAAG,CAAC,uCAAuC,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;gBAC1E,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;YAC3B,CAAC,CAAC,CAAC;SACN;IACH,CAAC;IAED;;;OAGG;IACK,UAAU,CAAC,KAAY;QAC7B,IAAI,CAAC,aAAa,CAAC,iBAAiB,GAAG,KAAK,CAAC,QAAQ,CAAC,CAAC;QACvD,MAAM,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;QAChC,MAAM,IAAI,GAAG,QAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAC9C,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC;IACtE,CAAC;IAED;;;;OAIG;IACK,WAAW,CAAC,OAAe,EAAE,GAAa;QAChD,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QACxB,MAAM,UAAU,GAAG,2DAAU,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;QACxE,MAAM,UAAU,GAAG,GAAG,GAAG,UAAU,GAAG,IAAI,GAAG,OAAO,GAAG,MAAM,CAAC;QAC9D,IAAI,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE;YAC5B,IAAI,GAAG,EAAE;gBACP,OAAO,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC;aAC3B;iBAAM;gBACL,OAAO,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;aACzB;SACF;QACD,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,aAAa,CAAC,gDAAgD,CAAC,CAAC;YACrE,OAAO;SACR;aAAM;YACL,+BAA+B;YAC/B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC5B,IAAI,IAAI,CAAC,eAAe,EAAE;gBACxB,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;oBAC7C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;oBACvB,IAAI,CAAC,SAAS,EAAE,CAAC;iBAClB;aACF;iBAAM;gBACL,IAAI,CAAC,aAAa,CAAC,iDAAiD,CAAC,CAAC;aACvE;SACF;IACH,CAAC;IAED,GAAG,CACD,OAAgB,EAChB,KAAa,EACb,KAAgB,EAChB,GAAY,EACZ,GAAG,cAAqB;QAExB,IAAI,GAAG,GAAG,IAAI,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,WAAW,EAAE,IAChC,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,EAC1B,IAAI,OAAO,EAAE,CAAC;QACd,IAAI,cAAc,EAAE;YAClB,GAAG,IAAI,aAAa,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,CAAC;SACtD;QACD,IAAI,KAAK,IAAI,CAAC,KAAK,IAAI,KAAK,IAAI,4DAAc,CAAC,EAAE;YAC/C,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;SACtB;aAAM;YACL,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;SAC9B;IACH,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,OAAe;QACpB,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;YACvB,IAAI,CAAC,GAAG,CAAC,UAAU,GAAG,OAAO,CAAC,CAAC;SAChC;IACH,CAAC;IAED;;;;KAIC;IACD,GAAG,CAAC,OAAe,EAAE,KAAW;QAC9B,IAAI,UAAU,GAAG,SAAS,GAAG,OAAO,CAAC;QACrC,IAAI,KAAK,EAAE;YACT,UAAU,IAAI,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;SAC5C;QACD,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;IACrC,CAAC;IAEO,SAAS,CAAC,OAAc;QAC9B,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;YACjC,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;SAChC;QACD,OAAO,EAAE,CAAC;IACZ,CAAC;IAED;;OAEG;IACK,SAAS;QACf,IAAI,CAAC,aAAa,CAAC,2BAA2B,CAAC,CAAC;QAChD,IAAI,CAAC,YAAY,EAAE;aAChB,IAAI,CAAC,GAAG,EAAE;YACT,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACzB,IAAI,CAAC,SAAS,EAAE,CAAC;aAClB;iBAAM;gBACL,IAAI,CAAC,eAAe,EAAE;qBACnB,IAAI,CAAC,GAAG,EAAE;oBACT,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;gBAC1B,CAAC,CAAC;qBACD,KAAK,CAAC,GAAG,CAAC,EAAE;oBACX,IAAI,CAAC,aAAa,CAAC,8BAA8B,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;oBACzE,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;gBAC1B,CAAC,CAAC,CAAC;aACN;QACH,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,0BAA0B,GAAG,GAAG,CAAC,CAAC;YACrD,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QAC1B,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACK,YAAY;QAClB,IAAI,CAAC,aAAa,CAAC,6BAA6B,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QACtE,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC;YACnC,OAAO,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI,EAAE,OAAO,EAAE;gBACzG,MAAM,EAAE,IAAI;gBACZ,OAAO,EAAE,KAAK;aACf,CAAC;iBACC,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,CAAC,KAAK,EAAE,CAAC;gBACb,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC;YAChC,CAAC,CAAC;iBACD,KAAK,CAAC,GAAG,CAAC,EAAE;gBACX,IAAI,CAAC,aAAa,CAAC,yBAAyB,GAAG,GAAG,CAAC,CAAC;YACtD,CAAC,CAAC,CAAC;SACN;aAAM;YACL,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;IACH,CAAC;IAED;;OAEG;IACK,eAAe;QACrB,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,CAAC,YAAY,EAAE;YAC1C,IAAI,CAAC,aAAa,CAAC,yDAAyD,CAAC,CAAC;YAC9E,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC;SAC9B;aAAM;YACL,OAAO,OAAO,CAAC,OAAO,EAAE,CAAC;SAC1B;IACH,CAAC;IAED;;OAEG;IACK,iBAAiB;QACvB,MAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC;QACxB,MAAM,UAAU,GAAG,2DAAU,CAAC,IAAI,EAAE,IAAI,CAAC,MAAM,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;QACzE,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,GAAG,GAAG,GAAG,UAAU,GAAG,MAAM,CAAC;IAC3D,CAAC;IAED;;OAEG;IACK,cAAc;QACpB,MAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,EAAE,CAAC;QAC1C,IAAI,CAAC,aAAa,CAAC,gCAAgC,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,GAAG,QAAQ,CAAC,CAAC;QACjH,OAAO,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,GAAG,GAAG,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,QAAQ,EAAE,KAAK,CAAC;aACzF,IAAI,CAAC,OAAO,CAAC,EAAE;YACd,IAAI,CAAC,KAAK,GAAG,CAAC,CAAC;YACf,IAAI,CAAC,WAAW,GAAG,OAAO,CAAC;YAC3B,IAAI,CAAC,aAAa,CAAC,oBAAoB,GAAG,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC;QACvE,CAAC,CAAC;aACD,KAAK,CAAC,GAAG,CAAC,EAAE;YACX,IAAI,CAAC,aAAa,CAAC,6BAA6B,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,CAAC;QAC1E,CAAC,CAAC,CAAC;IACP,CAAC;IAED;;OAEG;IACH,WAAW;QACT,IAAI,CAAC,aAAa,CAAC,kCAAkC,CAAC,CAAC;QACvD,IAAI,IAAI,CAAC,UAAU,EAAE;YACnB,IAAI,CAAC,aAAa,CAAC,gDAAgD,CAAC,CAAC;YACrE,OAAO,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;SAC5B;aAAM;YACL,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;SACnE;IACH,CAAC;IAEO,aAAa,CAAC,OAAe;QACnC,IAAI,IAAI,CAAC,MAAM,CAAC,iBAAiB,EAAE;YACjC,OAAO,CAAC,GAAG,CAAC,mBAAmB,GAAG,OAAO,CAAC,CAAC;SAC5C;IACH,CAAC;IAEK,eAAe;;YACnB,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,WAAW,EAAE,CAAC;YAC7C,MAAM,SAAS,GAAa,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,EAAE,CAAC,CAAC;YACpE,MAAM,WAAW,GAAG,SAAS,CAAC;YAC9B,MAAM,KAAK,GAAyB;gBAClC,EAAE,EAAE,oEAA0B;gBAC9B,WAAW;gBACX,OAAO,EAAE,mBAAmB;gBAC5B,IAAI,EAAE,EAAE;gBACR,MAAM,EAAE,IAAI;aACb,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC;KAAA;;oFAxcQ,kBAAkB;mHAAlB,kBAAkB,WAAlB,kBAAkB,mBAFhB,MAAM;AA6crB,MAAM,iBAAiB;IAmCnB,YAAY,MAAW;QACrB,qDAAqD;QACrD,KAAK,MAAM,CAAC,IAAI,MAAM,EAAE;YACtB,aAAa;YACb,IAAI,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;SACrB;IACH,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,MAAW;QACf,KAAK,MAAM,CAAC,IAAI,MAAM,EAAE;YACtB,IAAI,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,EAAE;gBAChB,IAAI,CAAC,CAAC,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;aACrB;SACF;IACH,CAAC;CACJ;;;;;;;;;;;;;;;;AC3iBD,IAAY,QAMX;AAND,WAAY,QAAQ;IAClB,2BAAe;IACf,+BAAmB;IACnB,uBAAW;IACX,yBAAa;IACb,2BAAe;AACjB,CAAC,EANW,QAAQ,KAAR,QAAQ,QAMnB;;;;;;;;;;;;;;;;ACFM,MAAe,cAAc;CAmBnC;;;;;;;;;;;;;;;;;;;;;;;;;;ACtBoD;AACX;AACoD;AAC3C;AACmB;AAGzB;AACe;;;;AAMrD,MAAM,aAAa;IAIxB,YACE,iBAAoC,EAC5B,kBAAsC;QAAtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAE9C,IAAI,CAAC,WAAW,GAAG,iBAAiB,CAAC,aAAa,EAAE,CAAC;QACrD,IAAI,CAAC,GAAG,CACN,aAAa,IAAI,CAAC,WAAW,CAAC,OAAO,aAAa,IAAI,CAAC,WAAW,CAAC,WAAW,EAAE,EAChF,IAAI,EACJ,2DAAa,CACd,CAAC;IACJ,CAAC;IAED,KAAK,CACH,KAAY,EACZ,GAAY,EACZ,OAAgB,EAChB,GAAG,cAAqB;QAExB,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,4DAAc,EAAE,GAAG,EAAE,GAAG,cAAc,CAAC,CAAC;IACnE,CAAC;IAED,KAAK,CAAC,OAAe,EAAE,GAAY,EAAE,GAAG,cAAqB;QAC3D,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,4DAAc,EAAE,GAAG,EAAE,GAAG,cAAc,CAAC,CAAC;IAClE,CAAC;IAED,gBAAgB,CAAC,OAAgB;QAC/B,iDAAW,CAAC;YACV,GAAG,EAAE,6EAAsB,CAAC,CAAC,CAAC,yDAAkB,CAAC,CAAC,CAAC,IAAI;YACvD,SAAS,EAAE,2DAAgC;YAC3C,WAAW,EACT,OAAO,KAAK,oEAAY;gBACtB,CAAC,CAAC,QAAQ;gBACV,CAAC,CAAC,OAAO,KAAK,oEAAY;oBACxB,CAAC,CAAC,aAAa;oBACf,CAAC,CAAC,aAAa;YACrB,OAAO,EAAE,6EAAsB;YAC/B,OAAO,EAAE,IAAI,CAAC,WAAW,CAAC,OAAO;YACjC,IAAI,EAAE,IAAI,CAAC,WAAW,CAAC,QAAQ;SAChC,CAAC,CAAC;IACL,CAAC;IAED,MAAM;QACJ,iDAAW,CAAC;YACV,GAAG,EAAE,6EAAsB,CAAC,CAAC,CAAC,yDAAkB,CAAC,CAAC,CAAC,IAAI;YACvD,OAAO,EAAE,6EAAsB;SAChC,CAAC,CAAC;IACL,CAAC;IAED,OAAO;QACL,iDAAW,CAAC;YACV,GAAG,EAAE,IAAI;YACT,OAAO,EAAE,KAAK;SACf,CAAC,CAAC;IACL,CAAC;IAED,OAAO,CAAC,IAAkB;QACxB,IAAI,IAAI,IAAI,IAAI,CAAC,KAAK,EAAE;YACtB,2DAAqB,CAAC,CAAC,KAAK,EAAE,EAAE;gBAC9B,KAAK,CAAC,OAAO,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;YACvC,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,GAAG,CACD,OAAgB,EAChB,KAAa,EACb,KAAgB,EAChB,GAAY,EACZ,GAAG,cAAqB;QAExB,IAAI,CAAC,kBAAkB,CAAC,GAAG,CAAC,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;QAC/E,IACE,OAAO;YACP,CAAC,KAAK,KAAK,8DAAgB;gBACzB,KAAK,KAAK,2DAAa;gBACvB,KAAK,KAAK,4DAAc,CAAC,EAC3B;YACA,0DAAoB,CAAC;gBACnB,QAAQ,EAAE,GAAG;gBACb,IAAI,EAAE,cAAc;gBACpB,OAAO;gBACP,KAAK,EAAG,KAAoC;aAC7C,CAAC,CAAC;SACJ;QACD,IAAI,KAAK,IAAI,KAAK,KAAK,4DAAc,EAAE;YACrC,IAAI,KAAK,EAAE;gBACT,6DAAuB,CAAC,KAAK,CAAC,CAAC;aAChC;SACF;IACH,CAAC;;0EA7FU,aAAa;8GAAb,aAAa,WAAb,aAAa,mBAFZ,MAAM;;;;;;;;;;;;;;;;;ACb6D;AAEjF;;;;GAIG;AACI,SAAS,uBAAuB,CAAC,IAAY;IAClD,IAAI,MAAM,GAAG,IAAI,CAAC;IAClB,IAAI,OAAM,aAAN,MAAM,uBAAN,MAAM,CAAE,OAAO,CAAC,2FAAkB,CAAC,KAAI,CAAC,EAAE;QAC5C,MAAM,GAAG,0BAA0B,CAAC,MAAM,EAAE,MAAM,EAAE,eAAe,CAAC,CAAC;KACtE;IACD,OAAO,MAAM,CAAC;AAChB,CAAC;AAGD;;;;;;;GAOG;AACH,SAAS,0BAA0B,CAAC,GAAW,EAAE,QAAgB,EAAE,UAAkB;IACnF,MAAM,EAAE,GAAG,IAAI,MAAM,CAAC,WAAW,GAAG,QAAQ,GAAG,mBAAmB,EAAE,GAAG,CAAC,CAAC;IACzE,IAAI,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,EAAE;QACjB,OAAO,GAAG,CAAC,OAAO,CAAC,EAAE,EAAE,QAAQ,GAAG,GAAG,GAAG,UAAU,CAAC,CAAC;KACrD;IACD,OAAO,GAAG,CAAC;AACb,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9BqD;AACP;AAEmB;AACrB;AACW;AAC0E;AAC5C;AACvC;AAC2C;AACsC;AACnD;AACJ;AACG;AACM;AACZ;AACkB;AACN;AACN;AACA;AACe;AACiB;AACrC;AACoB;AACJ;AACxB;AACZ;AACU;AAClB;;AAkEpC,MAAM,YAAY;;wEAAZ,YAAY;0GAAZ,YAAY;8GAhEd;YACP,0DAAY;YACZ,wDAAW;YACX,gEAAmB;YACnB,wDAAW;YACX,mEAAoB;YACpB,iEAAe;YACf,0DAAY;YACZ,wEAAc;YACd,0DAAU;YACV,wEAAqB;SACtB,EAuBC,0DAAY;QACZ,wDAAW;QACX,gEAAmB;QACnB,wDAAW;QACX,iEAAe;QACf,0DAAY;QAEZ,mEAAoB;QACpB,wEAAc;QAiBd,0DAAU;QACV,wEAAqB;oIAIZ,YAAY,mBAnDrB,4FAAkB;QAClB,sFAAgB;QAChB,qGAAqB;QACrB,qGAAqB;QACrB,sFAAgB;QAChB,2FAAkB;QAClB,+EAAc;QACd,uIAA4B;QAC5B,qIAA4B;QAC5B,2FAAkB;QAClB,iFAAe;QACf,sHAA0B;QAC1B,+FAAgB;QAChB,iGAAoB;QACpB,sFAAe;QACf,kFAAe;QACf,qFAAgB;QAChB,6FAAmB;QACnB,qDAAO,aA9BP,0DAAY;QACZ,wDAAW;QACX,gEAAmB;QACnB,wDAAW;QACX,mEAAoB;QACpB,iEAAe;QACf,0DAAY;QACZ,wEAAc;QACd,0DAAU;QACV,wEAAqB,aAwBrB,0DAAY;QACZ,wDAAW;QACX,gEAAmB;QACnB,wDAAW;QACX,iEAAe;QACf,0DAAY;QACZ,4FAAkB;QAClB,mEAAoB;QACpB,wEAAc;QACd,sFAAgB;QAChB,qGAAqB;QACrB,qGAAqB;QACrB,sFAAgB;QAChB,2FAAkB;QAClB,+EAAc;QACd,uIAA4B;QAC5B,qIAA4B;QAC5B,2FAAkB;QAClB,iFAAe;QACf,sHAA0B;QAC1B,+FAAgB;QAChB,iGAAoB;QACpB,sFAAe;QACf,kFAAe;QACf,6FAAmB;QACnB,0DAAU;QACV,wEAAqB;QACrB,qDAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3F0D;AAClB;AACb;AAC2D;AACf;AAC3B;AACJ;;;;;;;;;ICD7C,wEAAgC;IAAC,uDAA2B;;IAAA,qEAAe;;;IAA1C,0DAA2B;IAA3B,wJAA2B;;;IAC5D,wEAAkD;IAAA,uDAClD;;;IAAA,qEAAe;;;IADmC,0DAClD;IADkD,+OAClD;;;IACA,wEAAmD;IAAA,uDACtC;;;IAAA,qEAAe;;;IADuB,0DACtC;IADsC,mPACtC;;;IALf,uFAA2E;IACzE,+JAA2E;IAC3E,+JACe;IACf,+JAC4B;IAC9B,4DAAoB;;;IANoC,8EAAkB;IACzD,0DAAe;IAAf,8EAAe;IACf,0DAAiC;IAAjC,mGAAiC;IAEjC,0DAAkC;IAAlC,oGAAkC;;ADKhD,MAAM,6BAA6B;IAKxC,YACU,kBAAsC,EACtC,IAAY,EACZ,cAA8B;QAF9B,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,SAAI,GAAJ,IAAI,CAAQ;QACZ,mBAAc,GAAd,cAAc,CAAgB;IACrC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,YAAY,GAAG,mDAAa,CAAC;YAChC,IAAI,CAAC,kBAAkB,CAAC,SAAS;YACjC,IAAI,CAAC,kBAAkB,CAAC,iBAAiB;SAC1C,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,EAAE,gBAAgB,CAAC,EAAE,EAAE;YAC5C,MAAM,SAAS,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC;YACtC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;gBACjB,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC;gBACxD,MAAM,2BAA2B,GAAG,QAAQ,CAAC,IAAI,CAC/C,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,KAAK,SAAS,CACjC,CAAC;gBACF,IAAI,2BAA2B,EAAE;oBAC/B,IAAI,CAAC,gBAAgB,GAAG,2BAA2B,CAAC,QAAQ,CAAC;iBAC9D;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,WAAW;QACT,IAAI,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;IAClC,CAAC;IAED,gBAAgB,CAAC,SAAoB;QACnC,OAAO,qEAA8B,CAAC,iEAAS,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,CAC7D,CAAC,GAAW,EAAE,EAAE,CAAC,CAAC;YAChB,GAAG,EAAE,GAAG;YACR,IAAI,EAAE,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC,SAAS;SACzD,CAAC,CACH,CAAC;IACJ,CAAC;IAEK,IAAI;;YACR,MAAM,WAAW,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC3D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,OAAO,GAAG,KAAK,CAAC;YACpB,KAAK,MAAM,SAAS,IAAI,WAAW,CAAC,gBAAgB,EAAE;gBACpD,MAAM,aAAa,GAAG,WAAW,CAAC,mBAAmB,CAAC,IAAI,CACxD,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,SAAS,KAAK,SAAS,CACjC,CAAC;gBACF,IAAI,aAAa,CAAC,QAAQ,KAAK,IAAI,CAAC,gBAAgB,EAAE;oBACpD,aAAa,CAAC,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC;oBAC/C,OAAO,GAAG,IAAI,CAAC;iBAChB;aACF;YACD,IAAI,OAAO,EAAE;gBACX,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;aACvD;QACH,CAAC;KAAA;;0GA3DU,6BAA6B;2HAA7B,6BAA6B;QCb1C,8EAA4B;QAC1B,+EAA2C;QAAA,uDAAiC;;QAAA,4DAAY;QACxF,gFACiC;QADkD,iKAAa,UAAM,IAAC;;QAErG,qJAMoB;QACtB,4DAAa;QACf,4DAAW;;QAXkC,0DAAiC;QAAjC,mJAAiC;QAChE,0DAA6C;QAA7C,oKAA6C;QACvD,yFAA8B;QACM,0DAAkB;QAAlB,wFAAkB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJW;AACuB;AACE;AAE9C;AAE0B;AACgC;AAC7C;AAInB;AACa;AACoC;AACtC;AACuB;AACoB;;;;;;;;;;;;;;;;;;;ICAnD,wEAAmD;IAAC,uEAAU;IAAA,6DAAO;;;IAI1G,yFAAkF;IAChF,wDACF;IAAA,6DAAoB;;;IAFD,mFAAsB;IACvC,2DACF;IADE,yFACF;;;IAuBN,2EAAoE;IAClE,yFAAyD;IACzD,sFAAmD;IACrD,6DAAM;;;;IAjDR,+EAAkE;IAChE,sFAA2D;IACzD,gFAAqC;IACnC,wDACF;;IAAA,6DAAY;IACd,6DAAkB;IAClB,sFAAmC;IACjC,6EAAiC;IACjC,+EAA8E;IAC5E,0EAAsE;IACtE,gFAA8B;IAC5B,yDACF;;IAAA,6DAAY;IACd,6DAAW;IACX,6EAAU;IACR,2EAAyE;IACzE,iFAAwE;IACtE,yDAAqC;;IAAA,8HAAqE;IAC5G,6DAAY;IACZ,mFAC8D;IADJ,2WAAmC;;IAE3F,wJAEoB;IACtB,6DAAa;IACf,6DAAW;IACb,6DAAkB;IAClB,uFAA2D;IACzD,iFAAqC;IACnC,yDACF;;IAAA,6DAAY;IACd,6DAAkB;IAClB,6EAAU;IACR,4EAAyE;IACzE,iFAA8B;IAC5B,yDACF;;IAAA,6DAAY;IACZ,mFAAsF;IAA1E,gXAAwC;IAAkC,6DAAa;IACrG,6DAAW;IACX,6EAAU;IACR,4EAAiE;IACjE,iFAA8B;IAC5B,yDACF;;IAAA,6DAAY;IACZ,mFAAyF;IAA7E,qXAA2C;IAAkC,6DAAa;IACxG,6DAAW;IACX,4HAGM;IACN,6EAAU;IACR,kFAAiE;IAAA,yDAA4B;;IAAA,6DAAY;IACzG,mFACgE;IADN,4WAAkC;;IAE1F,0FAA6C;IAAA,yDACL;;;IAAA,6DAAoB;IAC5D,0FAAiD;IAAA,yDACT;;;IAAA,6DAAoB;IAC5D,0FAAqD;IAAA,yDACrD;;IAAA,6DAAoB;IACtB,6DAAa;IACf,6DAAW;IACX,uFAAmC;IACjC,iFAA4E;IAC1E,4EAA8E;IAC9E,iFAA8B;IAC5B,yDACF;;IAAA,6DAAY;IACd,6DAAW;IACb,6DAAkB;IAClB,sFAAiD;IACjD,uFAA2D;IACzD,iFAAqC;IACnC,yDACF;;IAAA,6DAAY;IACd,6DAAkB;IAClB,uFAAmC;IACjC,iFAAmD;IAAzC,uUAA0B;IAClC,4EAAwF;IACxF,iFAA8B;IAAA,yDAAmC;;IAAA,6DAAY;IAC/E,6DAAW;IACX,iFAAoD;IAA1C,wUAA2B;IACnC,4EAAsE;IACtE,iFAA8B;IAAA,yDAAmC;;IAAA,6DAAY;IAC/E,6DAAW;IACX,iFAAiD;IAAvC,qUAAwB;IAChC,4EAA+D;IAC/D,iFAA8B;IAAA,yDAA2C;;IAAA,6DAAY;IACvF,6DAAW;IACX,iFAA8C;IAApC,kUAAqB;IAC7B,4EAAkE;IAClE,iFAA8B;IAAA,yDAAqC;;IAAA,6DAAY;IACjF,6DAAW;IACb,6DAAkB;IAClB,qFAAkB;IAChB,kFAAiC;IAC/B,yDAAwC;;IAAA,0FAAoD;IAAA,wEAC5F;IAAA,6DAAoB;IAAA,+DACpB;IAAA,0FAA+C;IAAA,iEAAI;IAAA,6DAAoB;IAAA,+DAAE;IAAA,0FACzC;IAAA,oEAAO;IAAA,6DAAoB;IAC3D,yDACA;;IAAA,2FAAkD;IAAA,yEAAW;IAAA,6DAAoB;IAAA,0DACtC;;IAAA,2FAA6C;IAAA,iEAAG;IAAA,6DAAoB;IACjH,6DAAY;IACd,6DAAmB;IACrB,6DAAW;;;IAtGL,2DACF;IADE,oKACF;IAOI,2DACF;IADE,iKACF;IAKE,2DAAqC;IAArC,mKAAqC;IAAO,2DAA0C;IAA1C,qHAA0C;IAE5E,2DAA6C;IAA7C,wKAA6C;IAAC,kGAAmC;IAEhC,2DAAqB;IAArB,+FAAqB;IAQlF,2DACF;IADE,oKACF;IAKE,2DACF;IADE,uKACF;IACY,2DAAwC;IAAxC,uGAAwC;IAKlD,2DACF;IADE,yKACF;IACY,2DAA2C;IAA3C,0GAA2C;IAE1B,2DAAmC;IAAnC,uGAAmC;IAKC,2DAA4B;IAA5B,gJAA4B;IACjF,2DAA6C;IAA7C,wKAA6C;IAAC,iGAAkC;IAEvE,2DAAyB;IAAzB,0FAAyB;IAAC,2DACL;IADK,uQACL;IACrB,2DAA6B;IAA7B,8FAA6B;IAAC,2DACT;IADS,yQACT;IACrB,2DAAiC;IAAjC,kGAAiC;IAAC,2DACrD;IADqD,6KACrD;IAOE,2DACF;IADE,qLACF;IAMA,2DACF;IADE,6JACF;IAKgC,2DAAmC;IAAnC,yJAAmC;IAInC,2DAAmC;IAAnC,yJAAmC;IAInC,2DAA2C;IAA3C,iKAA2C;IAI3C,2DAAqC;IAArC,2JAAqC;IAKnE,2DAAwC;IAAxC,wKAAwC;IAIxC,4DACA;IADA,4JACA;IAAiF,2DACtC;IADsC,6KACtC;;AD9E1C,MAAM,iBAAiB;IAoB5B,YACU,kBAAsC,EACtC,kBAAsC,EACtC,eAAgC,EAChC,aAA4B,EAC5B,gBAAkC,EAClC,iBAAoC,EACpC,QAAkB,EAClB,aAA4B,EAC5B,MAAc,EACd,mBAAwC;QATxC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,oBAAe,GAAf,eAAe,CAAiB;QAChC,kBAAa,GAAb,aAAa,CAAe;QAC5B,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,aAAQ,GAAR,QAAQ,CAAU;QAClB,kBAAa,GAAb,aAAa,CAAe;QAC5B,WAAM,GAAN,MAAM,CAAQ;QACd,wBAAmB,GAAnB,mBAAmB,CAAqB;QA3BlD,aAAQ,GAAG,+CAAQ,CAAC;QACpB,YAAO,GAAG,+DAAO,CAAC;QAClB,YAAO,GAAG,gEAAO,CAAC;QAClB,yBAAoB,GAAG,KAAK,CAAC;QAE7B,uBAAkB,GAIZ,+EAAwC,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,iCACpD,IAAI,KACP,OAAO,EAAE,gEAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAC3B,CAAC,CAAC;IAgBD,CAAC;IAEE,QAAQ;;YACZ,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,kBAAkB;iBAClD,6CAA6C,EAAE;iBAC/C,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;gBACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;oBACnB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;gBACzB,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;YACL,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,SAAS,CAC3E,CAAC,GAAG,EAAE,EAAE;gBACN,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;oBACnB,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;gBAC1B,CAAC,CAAC,CAAC;YACL,CAAC,CACF,CAAC;YACF,IAAI,CAAC,oBAAoB,GAAG,0FAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC5D,CAAC;KAAA;IAED,gBAAgB;QACd,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IAC9D,CAAC;IAED,WAAW;QACT,IAAI,IAAI,CAAC,sBAAsB,EAAE;YAC/B,IAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,CAAC;SAC3C;QACD,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAChC,IAAI,CAAC,uBAAuB,CAAC,WAAW,EAAE,CAAC;SAC5C;IACH,CAAC;IAED,kBAAkB;QAChB,IAAI,CAAC,kBAAkB,CAAC,0CAA0C,EAAE,CAAC;IACvE,CAAC;IAEK,cAAc;;YAClB,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,4GAAmB;aAC/B,CAAC,CAAC;YACH,KAAK,CAAC,OAAO,EAAE,CAAC;QAClB,CAAC;KAAA;IAED,eAAe;QACb,IAAI,CAAC,YAAY,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAC3C,IAAI,CAAC,gBAAgB,EAAE,CAAC;QACxB,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,cAAc,CAAC,CAAC;IAClD,CAAC;IAEK,SAAS;;YACb,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC,sBAAsB,CAAC;iBAC3B,SAAS,EAAE,CAAC;YACf,MAAM,KAAK,GAAyB;gBAClC,EAAE,EAAE,iEAA0B;gBAC9B,OAAO,EAAE,YAAY;gBACrB,MAAM,EAAE,IAAI;aACb,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC;KAAA;IAEK,YAAY;;YAChB,MAAM,YAAY,GAAG,MAAM,IAAI,CAAC,gBAAgB;iBAC7C,GAAG,CAAC,CAAC,+BAA+B,EAAE,2BAA2B,CAAC,CAAC;iBACnE,SAAS,EAAE,CAAC;YACf,MAAM,UAAU,GAAG,MAAM,IAAI,CAAC,iBAAiB,CAAC,aAAa,EAAE,CAAC;YAChE,MAAM,KAAK,GAAyB;gBAClC,EAAE,EAAE,iEAA0B;gBAC9B,OAAO,EACL,GAAG,YAAY,CAAC,2BAA2B,CAAC,KAC1C,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,EACpC,EAAE;oBACF,GAAG,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE;oBACjD,IAAI,UAAU,CAAC,OAAO,IAAI,UAAU,CAAC,WAAW,IAAI,UAAU,CAAC,QAAQ,EAAE;gBAC3E,IAAI,EAAE,YAAY,CAAC,+BAA+B,CAAC;gBACnD,MAAM,EAAE,IAAI;aACb,CAAC;YACF,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACjC,CAAC;KAAA;IAED,cAAc;QACZ,uBAAuB;QACvB,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QAE5D,4CAA4C;QAC5C,IAAI,CAAC,kBAAkB,CAAC,0CAA0C,CAChE,IAAI,CAAC,mBAAmB,CAAC,yBAAyB,CACnD,CAAC;IACJ,CAAC;;kFAxHU,iBAAiB;gHAAjB,iBAAiB;QCxB9B,2HAyGW;;QAzGmC,mFAAkB;;;;;;;;;;;;;;;;;;;;;;;ACQzD,MAAM,wBAAwB;;gGAAxB,wBAAwB;sHAAxB,wBAAwB;QCRrC,kEAAkE;;QAClE,gEAAM;QACN,2EAAU;QACR,0EAAS;QACP,6EAA2C;QACzC,oEAC6d;QAC/d,4DAAU;QACV,6EAA4C;QAC1C,uDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACiV;QACnV,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACiR;QACnR,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;QACX,qEAAG;QAAA,wDAA6C;;QAAA,4DAAI;QACpD,4EAAU;QACR,2EAAS;QACP,8EAA2C;QACzC,qEAC6T;QAC/T,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACyU;QAC3U,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqU;QACvU,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;QACX,qEAAG;QAAA,wDAAyC;;QAAA,4DAAI;QAChD,4EAAU;QACR,2EAAS;QACP,8EAA2C;QACzC,sEACyO;QAC3O,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEAC6R;QAC/R,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;QACX,qEAAG;QAAA,wDAA4C;;QAAA,4DAAI;QACnD,4EAAU;QACR,2EAAS;QACP,8EAA2C;QACzC,sEACiM;QACnM,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEACiS;QACnS,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEAC6Q;QAC/Q,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;;QAxHR,uOAA0D;QASvD,0DACF;QADE,8KACF;QAQE,0DACF;QADE,+KACF;QAQE,0DACF;QADE,+KACF;QAQE,0DACF;QADE,+KACF;QAGD,0DAA6C;QAA7C,4KAA6C;QAQ1C,0DACF;QADE,iKACF;QAQE,0DACF;QADE,mKACF;QAQE,0DACF;QADE,gKACF;QAGD,0DAAyC;QAAzC,wKAAyC;QAQtC,0DACF;QADE,+KACF;QAQE,0DACF;QADE,+KACF;QAGD,0DAA4C;QAA5C,2KAA4C;QAQzC,0DACF;QADE,+KACF;QAQE,0DACF;QADE,+KACF;QAQE,0DACF;QADE,+KACF;;;;;;;;;;;;;;;;;;;;;;;AC9GG,MAAM,yBAAyB;;kGAAzB,yBAAyB;uHAAzB,yBAAyB;QCRtC,kEAAmE;;QACnE,gEAAM;QACN,2EAAU;QACR,0EAAS;QACP,6EAA2C;QACzC,oEACiQ;QACnQ,4DAAU;QACV,6EAA4C;QAC1C,uDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACiQ;QACnQ,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACiQ;QACnQ,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqR;QACvR,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqP;QACvP,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;QACX,qEAAG;QACD,wDACF;;QAAA,4DAAI;QACJ,4EAAU;QACR,2EAAS;QACP,8EAA2C;QACzC,qEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEACyN;QAC3N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEACyN;QAC3N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEACyN;QAC3N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,sEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;;QA7HR,wOAA2D;QASxD,0DACF;QADE,+KACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAIF,0DACF;QADE,qLACF;QAQM,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,gLACF;QAQE,0DACF;QADE,iLACF;QAQE,0DACF;QADE,iLACF;QAQE,0DACF;QADE,iLACF;QAQE,0DACF;QADE,iLACF;;;;;;;;;;;;;;;;;;;;;AC3HqF;AACG;AACH;AACM;AAExF,MAAM,aAAa,GAAG;IAC3B,SAAS,EAAE,kGAAwB;IACnC,WAAW,EAAE,qGAAyB;IACtC,SAAS,EAAE,kGAAwB;IACnC,WAAW,EAAE,wGAA0B;CACxC,CAAC;;;;;;;;;;;;;;;;;;;;;;ACT+C;AACoD;;;;AAQ9F,MAAM,8BAA8B;IACzC,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAElD,kBAAkB;;YACtB,MAAM,aAAa,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBACtD,SAAS,EAAE,iGAAkB;aAC9B,CAAC,CAAC;YACH,aAAa,CAAC,OAAO,EAAE,CAAC;QAC1B,CAAC;KAAA;;4GARU,8BAA8B;4HAA9B,8BAA8B;QCV3C,oEAAG;QAAA,uDAAgD;;QAAA,4DAAI;QACvD,2EAAU;QACR,0EAAS;QACP,6EAA2C;QACzC,oEACyO;QAC3O,4DAAU;QACV,6EAA4C;QAC1C,kEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,0EAAS;QACP,8EAA2C;QACzC,qEACqO;QACvO,4DAAU;QACV,8EAA4C;QAC1C,mEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACyO;QAC3O,4DAAU;QACV,8EAA4C;QAC1C,mEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACyO;QAC3O,4DAAU;QACV,8EAA4C;QAC1C,mEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqO;QACvO,4DAAU;QACV,8EAA4C;QAC1C,mEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqO;QACvO,4DAAU;QACV,8EAA4C;QAC1C,kEACF;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAAgC;QAC9B,iFAAwD;QAA/B,2JAAS,wBAAoB,IAAC;QAAC,wDAAuC;;QAAA,4DAAa;QAC9G,4DAAU;QACZ,4DAAU;QACZ,4DAAW;;QA7DR,0DAAgD;QAAhD,oKAAgD;QA0DW,2DAAuC;QAAvC,0JAAuC;;;;;;;;;;;;;;;;;;;;;;;ACvDR;AAGnC;;;;;;;ICJxD,wEAAoD;IAClD,kEAA6E;;IAC7E,yEAA6B;IAC3B,oEACyO;IACzO,uDACF;;IAAA,4DAAM;IACN,yEAA6B;IAC3B,oEACyO;IACzO,uDACF;;IAAA,4DAAM;IACN,0EAA6B;IAC3B,qEACyO;IACzO,wDACF;;IAAA,4DAAM;IAAA,iEAAI;IACZ,qEAAe;;IAhBV,0DAAqE;IAArE,iPAAqE;IAItE,0DACF;IADE,yLACF;IAIE,0DACF;IADE,0LACF;IAIE,0DACF;IADE,2LACF;;;IAEF,wEAAqD;IACnD,kEAA2E;;IAAA,gEAAI;IACjF,qEAAe;;IADV,0DAAmE;IAAnE,+OAAmE;;;IApB1E,wEAAwE;IACtE,uJAiBe;IACf,qJAEe;IACjB,qEAAe;;;;IArBE,0DAAmC;IAAnC,yGAAmC;IAkBnC,0DAAoC;IAApC,0GAAoC;;ADN9C,MAAM,wBAAwB;IAGnC,YACU,kBAAsC;QAAtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAE9C,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,kBAAkB,CAAC,yBAAyB,CAAC,IAAI,CACrF,qFAAoB,EAAE,CACvB,CAAC;IACJ,CAAC;IAED,eAAe,CAAC,YAA2B;QACzC,MAAM,SAAS,GAAG,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,WAAW,CAAC,CAAC;QAClE,IAAI,SAAS,IAAI,SAAS,CAAC,OAAO,IAAI,SAAS,CAAC,OAAO,CAAC,IAAI,IAAI,kBAAkB,EAAE;YAClF,OAAO,SAAS,CAAC,OAAO,CAAC,OAAO,CAAC;SAClC;QACD,OAAO,KAAK,CAAC;IACf,CAAC;;gGAjBU,wBAAwB;sHAAxB,wBAAwB;QCdrC,kEAAuE;;QAAA,gEAAI;QAC3E,sIAsBe;;QACf,yFAA2D;;QAxBxD,2OAA+D;QACnD,0DAAwC;QAAxC,gKAAwC;;;;;;;;;;;;;;;;;;;ACOhC;AAC2B;;;;AAQ3C,MAAM,gCAAgC;IAK3C,YAAoB,wBAAkD;QAAlD,6BAAwB,GAAxB,wBAAwB,CAA0B;IAAG,CAAC;IAE1E,QAAQ;QACN,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,aAAa;QACX,IAAI,IAAI,CAAC,IAAI,IAAI,0DAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;YACzC,MAAM,gBAAgB,GAAG,IAAI,CAAC,wBAAwB,CAAC,uBAAuB,CAC5E,0DAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CACzB,CAAC;YACF,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;SACzD;IACH,CAAC;;gHAlBU,gCAAgC;8HAAhC,gCAAgC;0EAEA,2DAAgB;;;;;QCnB7D,wNAAmC;;;;;;;;;;;;;;;;;;;;;;;ACQ5B,MAAM,0BAA0B;;oGAA1B,0BAA0B;wHAA1B,0BAA0B;QCRvC,oEAAG;QAAA,uDAA+C;;QAAA,4DAAI;QACtD,gEAAM;QACN,2EAAU;QACR,0EAAS;QACP,6EAA2C;QACzC,oEACyO;QAC3O,4DAAU;QACV,6EAA4C;QAC1C,uDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEAC6N;QAC/N,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACyS;QAC3S,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACiO;QACnO,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEAC6O;QAC/O,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACyO;QAC3O,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACV,2EAAS;QACP,8EAA2C;QACzC,qEACqP;QACvP,4DAAU;QACV,8EAA4C;QAC1C,wDACF;;QAAA,4DAAU;QACZ,4DAAU;QACZ,4DAAW;;QAlER,0DAA+C;QAA/C,mKAA+C;QAS5C,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;QAQE,0DACF;QADE,8KACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9D6F;AAI7C;AAEuC;AAC1C;;;;;;;;;;;;ICE3C,2EAAsC;IACpC,+EAA4C;IAC1C,uDACF;;IAAA,4DAAY;IACZ,gFAAkG;IAAtF,waAAyC;IAA6C,4DAAa;IACjH,4DAAW;;;IAHP,0DACF;IADE,gMACF;IACY,0DAAyC;IAAzC,mGAAyC;;;IAMnD,wFAA+E;IAAA,uDAC/E;;IAAA,4DAAoB;;;IADoC,mFAAsB;IAAC,0DAC/E;IAD+E,2JAC/E;;;;IAZN,yEAAgE;IAC9D,mKAKW;IACX,2EAAU;IACR,+EAAiE;IAAA,uDAA8B;;IAAA,4DAAY;IAC3G,gFAC6E;IAA3E,qZAAiC;;IACjC,qLACoB;IACtB,4DAAa;IACf,4DAAW;IACX,2EAAU;IACR,iFAAiC;IAC/B,iGAA2F;IAC7F,4DAAY;IACd,4DAAW;IACb,4DAAM;;;;IAnBO,0DAAyB;IAAzB,wFAAyB;IAO+B,0DAA8B;IAA9B,gJAA8B;IAC1D,0DAA6C;IAA7C,oKAA6C;IAChF,2FAAiC;IACK,0DAAgB;IAAhB,yFAAgB;IAMtB,0DAAyB;IAAzB,qFAAyB;;;;IA1BjE,wEAA+E;IAC7E,2EAAU;IACR,yEAA6D;IAC7D,+EAA4C;IAC1C,uDACF;;IAAA,4DAAY;IACZ,gFAAuF;IAA3E,iXAAiC;IAC7C,4DAAa;IACf,4DAAW;IACX,qJAoBM;IACR,qEAAe;;;;IA1BT,0DACF;IADE,wLACF;IACY,0DAAiC;IAAjC,2FAAiC;IAGhB,0DAA+B;IAA/B,qGAA+B;;;IAVlE,wEAAwE;IACtE,sJA8Be;IACjB,qEAAe;;;;IA/ByB,0DAAiB;IAAjB,oFAAiB;;ADsBlD,MAAM,yBAA0B,SAAQ,0EAAa;IAc1D,YACU,kBAAsC,EACtC,gBAAkC;QAE1C,KAAK,EAAE,CAAC;QAHA,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAdpC,4BAAuB,GAA2C,EAAE,CAAC;QAG7E,kBAAa,GAAG;YACd,EAAE,IAAI,EAAE,wBAAwB,EAAE,KAAK,EAAE,GAAG,EAAE;YAC9C,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE;YAC5B,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE;YAC3B,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE;SAC7B,CAAC;QASA,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,kBAAkB,CAAC,yBAAyB,CAAC,IAAI,CACrF,qFAAoB,EAAE,CACvB,CAAC;QAEF,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,yBAAyB,CAAC,SAAS,CAAC,CAAC,YAAY,EAAE,EAAE;YACpF,YAAY,CAAC,OAAO,CAClB,CAAC,WAAW,EAAE,EAAE,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CACjD,CAAC;YACF,IAAI,CAAC,oBAAoB,CAAC,WAAW,EAAE,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,eAAe,GAAG;YACrB,YAAY,EAAE,SAAS;YACvB,OAAO,EAAE,gBAAgB,CAAC,wBAAwB;YAClD,SAAS,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,IAAI;SACvB,CAAC;IACJ,CAAC;IAED,WAAW;QACT,KAAK,MAAM,QAAQ,IAAI,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE;YACjG,IAAI,QAAQ,CAAC,YAAY,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAM,EAAE;gBAC1D,QAAQ,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;aACrC;SACF;IACH,CAAC;IAED,aAAa,CAAC,KAAa,EAAE,EAAe;QAC1C,OAAO,EAAE,CAAC,IAAI,CAAC;IACjB,CAAC;IAEK,aAAa,CAAC,WAAwB;;YAC1C,IAAI,WAAW,CAAC,OAAO,EAAE;gBACvB,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;aACpC;iBAAM;gBACL,IAAI,WAAW,CAAC,OAAO,EAAE;oBACvB,WAAW,CAAC,OAAO,CAAC,OAAO,GAAG,KAAK,CAAC;iBACrC;gBACD,WAAW,CAAC,OAAO,GAAG,KAAK,CAAC;gBAC5B,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;aAChC;QACH,CAAC;KAAA;IAEK,gBAAgB,CAAC,WAAwB;;;YAC7C,IAAI,kBAAW,CAAC,OAAO,0CAAE,OAAO,MAAI,iBAAW,CAAC,OAAO,0CAAE,OAAO,GAAE;gBAChE,WAAW,CAAC,OAAO,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC,OAAO,CAAC;gBAC1D,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;aAC7C;YACD,IAAI,WAAW,CAAC,OAAO,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE;gBAC1D,WAAW,CAAC,OAAO,GAAG,CAAC,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;gBACvD,IAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,CAAC;aACrC;YACD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,CAAC;;KAChC;IAEK,YAAY,CAAC,WAAwB;;YACzC,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,kBAAkB,CAAC,YAAY;iBAC/D,IAAI,CAAC,oDAAI,CAAC,CAAC,CAAC,CAAC;iBACb,SAAS,EAAE,CAAC;YACf,IAAI,CAAC,kBAAkB,CAAC,gBAAgB,iCACnC,eAAe,KAClB,YAAY,EAAE,IAAI,CAAC,8BAA8B,CAC/C,WAAW,EACX,eAAe,CAAC,YAAY,CAC7B,IACD,CAAC;QACL,CAAC;KAAA;IAED,aAAa,CAAC,WAAwB;;QACpC,OAAO,CAAC,CAAC,kBAAW,CAAC,OAAO,0CAAE,OAAO,EAAC;IACxC,CAAC;IAED,YAAY,CAAC,WAAwB;QACnC,OAAO,WAAW,CAAC,OAAO,IAAI,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;IAChE,CAAC;IAED,iBAAiB,CAAC,OAAgB,IAAI;QACpC,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,uBAAuB,CAAC,EAAE;YAChD,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG;gBACxC,YAAY,EAAE,SAAS;gBACvB,OAAO,EAAE,IAAI,CAAC,gBAAgB,CAAC,+BAA+B;gBAC9D,SAAS,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,CAAC,gBAAgB;aAC5C,CAAC;SACH;QACD,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE;YACnF,IAAI,QAAQ,CAAC,YAAY,IAAI,CAAC,QAAQ,CAAC,YAAY,CAAC,MAAM,EAAE;gBAC1D,QAAQ,CAAC,YAAY,CAAC,WAAW,EAAE,CAAC;aACrC;YACD,IAAI,IAAI,CAAC,OAAO,IAAI,QAAQ,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;gBAC5C,QAAQ,CAAC,YAAY,GAAG,QAAQ;qBAC7B,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC;qBAC9C,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;qBAChC,SAAS,EAAE,CAAC;aAChB;QACH,CAAC,CAAC,CAAC;IACL,CAAC;IAED,8BAA8B,CAC5B,WAAwB,EACxB,0BAIG;QAEH,MAAM,SAAS,GAAG;YAChB,OAAO,EAAE,WAAW,CAAC,OAAO;YAC5B,IAAI,EAAE,WAAW,CAAC,IAAI;YACtB,OAAO,EAAE,WAAW,CAAC,OAAO;YAC5B,OAAO,EAAE,WAAW,CAAC,OAAO;SAC7B,CAAC;QACF,IAAI,WAAW,CAAC,OAAO,EAAE;YACvB,SAAS,CAAC,SAAS,CAAC,GAAG;gBACrB,IAAI,EAAE,WAAW,CAAC,OAAO,CAAC,IAAI;gBAC9B,OAAO,EAAE,WAAW,CAAC,OAAO,CAAC,OAAO;gBACpC,OAAO,EAAE,WAAW,CAAC,OAAO,CAAC,OAAO;aACrC,CAAC;SACH;QACD,OAAO;YACL,GAAG,0BAA0B,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,IAAI,CAAkB;YACzF,SAAS;SACV,CAAC;IACJ,CAAC;;kGA5IU,yBAAyB;uHAAzB,yBAAyB;QCvBtC,uIAgCe;;;QAhCA,gKAAwC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAc;AAEM;AACxB;AAC4C;AACK;AACpB;;;;;;;;;;ICF1E,wEAAkC;IAChC,uDACF;;IAAA,qEAAe;;;IADb,0DACF;IADE,gNACF;;;IAJJ,wEAAwD;IACtD,8EAAuC;IACrC,wJAEe;IACjB,4DAAW;IACX,gFAAiD;IAC/C,yEAAoD;IACtD,4DAAa;IACf,qEAAe;;;IAPI,0DAAiB;IAAjB,oFAAiB;;;IAUpC,8EAAuC;IACrC,4EAAuC;IACzC,4DAAW;IACX,gFAAiD;IAC/C,uDACF;;IAAA,4DAAa;;IADX,0DACF;IADE,6JACF;;ADNK,MAAM,2BAA2B;IAMtC,YACU,kBAAsC,EACtC,mBAAwC,EACxC,MAAc,EACd,eAAgC;QAHhC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,WAAM,GAAN,MAAM,CAAQ;QACd,oBAAe,GAAf,eAAe,CAAiB;QAR1C,aAAQ,GAAG,+CAAQ,CAAC;QAEpB,kBAAa,GAAmB,EAAE,CAAC;IAOhC,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB;aACpB,6CAA6C,EAAE;aAC/C,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;YACzB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CACL,CAAC;QACF,IAAI,CAAC,aAAa,CAAC,IAAI,CACrB,IAAI,CAAC,kBAAkB,CAAC,SAAS;aAC9B,IAAI,CACH,yDAAS,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC,eAAe,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,EAChE,mDAAG,CAAC,CAAC,KAAK,EAAE,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC,EAC/B,oEAAoB,EAAE,CACvB;aACA,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,SAAS,GAAG,GAAG,CAAC;YACvB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CACL,CAAC;IACJ,CAAC;IACD,WAAW;QACT,KAAK,MAAM,YAAY,IAAI,IAAI,CAAC,aAAa,EAAE;YAC7C,YAAY,CAAC,WAAW,EAAE,CAAC;SAC5B;IACH,CAAC;IAEK,0BAA0B;;YAC9B,IAAI,IAAI,CAAC,SAAS,EAAE;gBAClB,IAAI,CAAC,mBAAmB,CAAC,wBAAwB,EAAE,CAAC;aACrD;iBAAM;gBACL,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;gBACtB,MAAM,IAAI,CAAC,kBAAkB,CAAC,0CAA0C,CACtE,IAAI,CAAC,mBAAmB,CAAC,yBAAyB,CACnD,CAAC;gBACF,UAAU,CAAC,GAAG,EAAE;oBACd,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;gBACzB,CAAC,EAAE,GAAG,CAAC,CAAC;aACT;QACH,CAAC;KAAA;;sGAvDU,2BAA2B;yHAA3B,2BAA2B;QCbxC,8EAAiD;QAAvC,qJAAS,gCAA4B,IAAC;QAC9C,+EAA2C;QAAA,uDAA0C;;QAAA,4DAAY;QACjG,yIASe;QACjB,4DAAW;QACX,mNAOc;;;QAnB+B,0DAA0C;QAA1C,4JAA0C;QACtE,0DAAiB;QAAjB,gFAAiB;;;;;;;;;;;;;;;;;;;;;;;;;ACFmC;AACtC;AACY;AACoC;;;;;;;;;ICF7E,8EAA2E;IAAhC,yUAAiB;IAC1D,yEAA2E;IAC3E,+EAA8B;IAC5B,uDACF;;IAAA,4DAAY;IACd,4DAAW;;IAFP,0DACF;IADE,0JACF;;;IAEF,wEAA8C;IAC5C,8EAAsE;IACpE,yEAA2E;IAC3E,+EAA8B;IAC5B,uDACF;IAAA,4DAAY;IACd,4DAAW;IACX,8EAAgF;IAC9E,yEAAiE;IACjE,+EAA8B;IAC5B,uDACF;;IAAA,4DAAY;IACd,4DAAW;IACb,qEAAe;;;IATT,0DACF;IADE,qGACF;IAKE,0DACF;IADE,oKACF;;;IAlBN,wEAAgD;IAC9C,uIAKW;IACX,gJAae;IACjB,qEAAe;;;IApBF,0DAA8B;IAA9B,iGAA8B;IAM1B,0DAA6B;IAA7B,gGAA6B;;;IAgB5C,2EAAU;IACR,2EAAU;IACR,6EAAuC;IACzC,4DAAW;IACb,4DAAW;;ADhBN,MAAM,kBAAkB;IAK7B,YACU,iBAAoC,EACpC,MAAc;QADd,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,WAAM,GAAN,MAAM,CAAQ;QANxB,iBAAY,GAAiB,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC;QAC3C,eAAU,GAAG,IAAI,yCAAO,EAAQ,CAAC;QACzC,gBAAW,GAAG,KAAK,CAAC;IAKjB,CAAC;IAEJ,QAAQ;QACN,IAAI,CAAC,iBAAiB,CAAC,aAAa;aACjC,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,YAAY,GAAG,GAAG,CAAC;YAC1B,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACL,IAAI,CAAC,iBAAiB,CAAC,YAAY;aAChC,IAAI,CAAC,yDAAS,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAChC,SAAS,CAAC,CAAC,GAAG,EAAE,EAAE;YACjB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,GAAG,EAAE;gBACnB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC;YACzB,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACP,CAAC;IAED,KAAK;QACH,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;IAClC,CAAC;IAED,WAAW;QACT,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;QACvB,IAAI,CAAC,UAAU,CAAC,QAAQ,EAAE,CAAC;IAC7B,CAAC;;oFAlCU,kBAAkB;gHAAlB,kBAAkB;QCX/B,gIAqBe;QACf,0MAMc;;;QA5BC,kFAAmB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACCmC;AACoC;AACvB;AACmC;AACR;AACtD;AACoG;AAC5B;AACG;AACH;AACM;AACc;;AAyB5I,MAAM,cAAc;;4EAAd,cAAc;4GAAd,cAAc;gHAtBhB,CAAC,+DAAY,CAAC;oIAsBZ,cAAc,mBApBvB,8EAAiB;QACjB,kHAAyB;QACzB,2FAAkB;QAClB,8HAA6B;QAC7B,sHAA2B;QAC3B,oKAAgC;QAChC,wIAAwB;QACxB,2IAAyB;QACzB,wIAAwB;QACxB,+IAA0B;QAC1B,6JAA8B,aAZtB,+DAAY,aAoBZ,8EAAiB;;;;;;;;;;;;;;;;;;;;AClC8B;AACc;AACI;;;;AAOtE,MAAM,wBAAwB;IAKnC,YACU,eAAgC,EAChC,iBAAoC,EACpC,QAAkB;QAFlB,oBAAe,GAAf,eAAe,CAAiB;QAChC,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,aAAQ,GAAR,QAAQ,CAAU;IACzB,CAAC;IAEJ,QAAQ;QACN,IAAI,mFAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;SACjC;IACH,CAAC;IAED,WAAW;QACT,IAAI,mFAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;YACjC,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;SAC3E;IACH,CAAC;IAED,UAAU;QACR,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;;gGAzBU,wBAAwB;sHAAxB,wBAAwB;QCVrC,iFAAoC;QAAvB,qJAAS,gBAAY,IAAC;QACjC,6EAAY;QACV,4EAAW;QACT,yEAAmC;QACjC,oEAA0D;QAC5D,4DAAM;QACR,4DAAY;QACd,4DAAa;QACf,4DAAc;;QAJD,0DAAc;QAAd,wIAAc;;;;;;;;;;;;;;;;;;;;;ACHoC;AACM;AACuB;;AAQrF,MAAM,yBAAyB;;kGAAzB,yBAAyB;sHAAzB,yBAAyB;0HAL3B,CAAC,uEAAY,CAAC;mIAKZ,yBAAyB,mBAJrB,wEAAmB,EAAE,8FAAmB,aAD7C,uEAAY,aAGZ,wEAAmB;;;;;;;;;;;;;;;;;;;;;ACRkB;;;;;;AAO1C,MAAM,mBAAmB;IAC9B,YAAoB,eAAgC;QAAhC,oBAAe,GAAf,eAAe,CAAiB;IAAG,CAAC;IAExD,QAAQ,KAAI,CAAC;IAEb,KAAK;QACH,IAAI,CAAC,eAAe,CAAC,OAAO,EAAE,CAAC;IACjC,CAAC;;sFAPU,mBAAmB;iHAAnB,mBAAmB;QCRhC,6EAAY;QACV,iFAAuC;QACrC,iFAAwB;QACtB,gFAA8B;QAAlB,+IAAS,WAAO,IAAC;QAAC,uDAA8B;;QAAA,4DAAa;QAC3E,4DAAc;QACd,4EAAW;QACT,uDACF;;QAAA,4DAAY;QACd,4DAAc;QAChB,4DAAa;QACb,8EAAa;QACX,4EAAU;QACR,2EAAS;QACP,8EAAiC;QAC/B,8EAAmC;QACrC,4DAAU;QACZ,4DAAU;QACZ,4DAAW;QACb,4DAAc;;QAfsB,0DAA8B;QAA9B,8IAA8B;QAG5D,0DACF;QADE,iKACF;;;;;;;;;;;;;;;;;ACPJ,mFAAmF;AACnF,8FAA8F;AAC9F,yEAAyE;AACzE,gFAAgF;AACzE,MAAM,WAAW,GAAG;IACzB,UAAU,EAAE,KAAK;CAClB,CAAC;AAEF;;;;;GAKG;AACH,sEAAsE;;;;;;;;;;;;;;;;;;;;;;ACdtE,+BAA+B;AACgB;AAGF;AACY;AACrB;AACT;AAE3B,IAAI,6EAAsB,EAAE;IAC1B,6DAAc,EAAE,CAAC;CAClB;AAED,SAAS,QAAQ;IACf,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;IAC5B,wEAAwB;SACrB,eAAe,CAAC,sDAAS,CAAC;SAC1B,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC;AACtC,CAAC;AAED,QAAQ,CAAC,gBAAgB,CACvB,OAAO,OAAO,KAAK,WAAW,CAAC,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC,kBAAkB,EACnE,GAAS,EAAE,CAAC;IACV,OAAO,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;IACrC,IAAI;QACF,MAAM,kDAAY,EAAE,CAAC;QACrB,QAAQ,EAAE,CAAC;KACZ;IAAC,OAAO,GAAG,EAAE;QACZ,OAAO,CAAC,KAAK,CAAC,6BAA6B,EAAE,GAAG,CAAC,CAAC;QAClD,QAAQ,EAAE,CAAC,CAAC,0BAA0B;KACvC;AACH,CAAC,EACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;AChCoC;AACe;AACf;AACqB;AAUpD,MAAM,OAAO;IAwLlB,MAAM,CAAC,SAAS;QACd,MAAM,MAAM,GAKN,EAAE,CAAC;QACT,iCAAiC;QACjC,KAAK,MAAM,QAAQ,IAAI,OAAO,CAAC,MAAM,EAAE;YACrC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;SACvC;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,MAAM,CAAC,eAAe,CAAC,IAAY,EAAE,OAAgB;QACnD,OAAO,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC;IAC9B,CAAC;IAED,MAAM,CAAC,cAAc;QACnB,MAAM,MAAM,GAA0B,EAAE,CAAC;QACzC,KAAK,MAAM,KAAK,IAAI,OAAO,CAAC,SAAS,EAAE,EAAE;YACvC,IAAI,KAAK,CAAC,kBAAkB,EAAE;gBAC5B,MAAM,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,oEAAY,CAAC;oBACvD,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,OAAO,EAAE,KAAK,CAAC,OAAO;iBACvB,CAAC,CAAC;gBACH,MAAM,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,oEAAY,CAAC;oBACvD,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,OAAO,EAAE,KAAK,CAAC,OAAO;iBACvB,CAAC,CAAC;gBACH,MAAM,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,OAAO,CAAC,eAAe,CAAC,KAAK,CAAC,IAAI,EAAE,oEAAY,CAAC;oBACvD,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,OAAO,EAAE,KAAK,CAAC,OAAO;iBACvB,CAAC,CAAC;aACJ;iBAAM;gBACL,MAAM,CAAC,IAAI,CAAC;oBACV,IAAI,EAAE,KAAK,CAAC,IAAI;oBAChB,KAAK,EAAE,KAAK,CAAC,KAAK;oBAClB,OAAO,EAAE,KAAK,CAAC,OAAO;iBACvB,CAAC,CAAC;aACJ;SACF;QACD,OAAO,MAAM,CAAC;IAChB,CAAC;IAED,MAAM,CAAO,IAAI,CACf,SAAiB,iEAA0B,EAC3C,MAAe;;YAEf,MAAM,oDAAI,EAAE,CAAC,cAAc,CAAC;gBAC1B,EAAE,EAAE,MAAM;gBACV,IAAI,EAAE,MAAM,IAAI,yEAAO,EAAE;gBACzB,OAAO,EAAE,GAAG;gBACZ,MAAM,EAAE,IAAI,CAAC,cAAc,EAAE;gBAC7B,gBAAgB;gBAChB,iBAAiB;gBACjB,oBAAoB;gBACpB,IAAI;gBACJ,OAAO,EAAE;oBACP;wBACE,IAAI,EAAE,mBAAmB;wBACzB,OAAO,EAAE,GAAG;wBACZ,YAAY,EAAE,EAAE;wBAChB,OAAO,EAAE;4BACP;gCACE,IAAI,EAAE,mBAAmB;gCACzB,QAAQ,EAAE,IAAI;gCACd,IAAI,EAAE,CACJ,SAAuD,EACvD,QAAQ,EACR,EAAE;oCACF,SAAS,CAAC,GAAG,CAAC,EAAE,GAAG,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC;oCACtC,QAAQ,CAAC,SAAS,CAAC,CAAC;gCACtB,CAAC;6BACF;yBACF;qBACF;iBACF;aACF,CAAC,CAAC;YACH,wEAAwE;YACxE,yDAAyD;QAC3D,CAAC;KAAA;IAED,MAAM,CAAC,WAAW,CAAC,IAAY,EAAE,OAAgB;QAC/C,OAAO,oDAAI,CAAC,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC,CAAC;IACpC,CAAC;IAED,MAAM,CAAO,OAAO,CAClB,OAAgD;;YAEhD,QAAQ;YACR,6DAA6D;YAC7D,yBAAyB;YACzB,kBAAkB;YAClB,wBAAwB;YACxB,IAAI;YACJ,OAAO,OAAO,CAAC,GAAG,CAChB,OAAO,CAAC,cAAc,EAAE,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,EAAE,CAC3C,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,OAAO,CAAC,CACtC,CACF,CAAC;QACJ,CAAC;KAAA;IAED,MAAM,CAAO,UAAU,CACrB,WAAgC,EAChC,OAAgD;;YAEhD,IAAI,WAAW,CAAC,IAAI,KAAK,iBAAiB,EAAE;gBAC1C,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;aACvD;iBAAM;gBACL,MAAM,IAAI,CAAC,oBAAoB,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;aACvD;QACH,CAAC;KAAA;IAEO,MAAM,CAAO,oBAAoB,CACvC,WAAgC,EAChC,OAAgD;;YAEhD,IAAI;gBACF,MAAM,oDAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC,IAAI,EAAE,CAAC;aACrD;YAAC,OAAO,EAAE,EAAE;gBACX,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;iBAC/B;aACF;QACH,CAAC;KAAA;IAEO,MAAM,CAAO,oBAAoB,CACvC,WAAgC,EAChC,OAAgD;;YAEhD,IAAI;gBACF,MAAM,oDAAI,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,EAAE,CAAC;aACnD;YAAC,OAAO,EAAE,EAAE;gBACX,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;iBAC/B;aACF;YACD,IAAI;gBACF,MAAM,oDAAI,EAAE,CAAC,KAAK,CAAC,cAAc,EAAE,WAAW,CAAC,CAAC,IAAI,EAAE,CAAC;aACxD;YAAC,OAAO,EAAE,EAAE;gBACX,IAAI,OAAO,EAAE;oBACX,OAAO,CAAC,WAAW,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;iBAC/B;aACF;QACH,CAAC;KAAA;;AA3UsB,cAAM,GAAG;IAC9B,WAAW,EAAE;QACX,IAAI,EAAE,eAAe;QACrB,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,kBAAkB,EAAE,EAAE;YACtB,aAAa,EAAE,EAAE;YACjB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;QACX,aAAa;QACb,8BAA8B;QAC9B,yBAAyB;QACzB,KAAK;KACN;IACD,QAAQ,EAAE;QACR,IAAI,EAAE,SAAS;QACf,KAAK,EAAE;YACL,SAAS,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACvB,iBAAiB,EAAE,EAAE;YACrB,kBAAkB,EAAE,EAAE;YACtB,kBAAkB,EAAE,EAAE;YACtB,iBAAiB,EAAE,EAAE;YACrB,cAAc,EAAE,EAAE;YAClB,iBAAiB,EAAE,EAAE;YACrB,gBAAgB,EAAE,EAAE;SACrB;QACD,OAAO,EAAE,EAAE;KACZ;IACD,iBAAiB,EAAE;QACjB,IAAI,EAAE,iBAAiB;QACvB,KAAK,EAAE;YACL,SAAS,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACvB,cAAc,EAAE,EAAE;YAClB,kBAAkB,EAAE,EAAE;SACvB;QACD,OAAO,EAAE,EAAE;KACZ;IACD,eAAe,EAAE;QACf,IAAI,EAAE,YAAY;QAClB,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,OAAO,EAAE;QACP,IAAI,EAAE,SAAS;QACf,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,iBAAiB,EAAE;QACjB,IAAI,EAAE,mBAAmB;QACzB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,WAAW,EAAE;QACX,IAAI,EAAE,YAAY;QAClB,KAAK,EAAE;YACL,aAAa,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YAC3B,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,iBAAiB,EAAE;QACjB,IAAI,EAAE,iBAAiB;QACvB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,gBAAgB,EAAE,EAAE;YACpB,mBAAmB,EAAE,EAAE;YACvB,aAAa,EAAE,EAAE;YACjB,gBAAgB,EAAE,EAAE;YACpB,iBAAiB,EAAE,EAAE;SACtB;QACD,OAAO,EAAE;YACP,gBAAgB,EAAE,EAAE;YACpB,mBAAmB,EAAE,EAAE;YACvB,aAAa,EAAE,EAAE;SAClB;KACF;IACD,sBAAsB,EAAE;QACtB,IAAI,EAAE,sBAAsB;QAC5B,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,cAAc,EAAE,EAAE;YAClB,aAAa,EAAE,EAAE;SAClB;KACF;IACD,aAAa,EAAE;QACb,IAAI,EAAE,cAAc;QACpB,KAAK,EAAE;YACL,YAAY,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YAC1B,aAAa,EAAE,EAAE;YACjB,mBAAmB,EAAE,EAAE;YACvB,aAAa,EAAE,EAAE;YACjB,gBAAgB,EAAE,EAAE;SACrB;QACD,OAAO,EAAE;YACP,mBAAmB,EAAE,EAAE;SACxB;KACF;IACD,kBAAkB,EAAE;QAClB,IAAI,EAAE,kBAAkB;QACxB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,aAAa,EAAE;QACb,IAAI,EAAE,cAAc;QACpB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,IAAI,EAAE;QACJ,IAAI,EAAE,MAAM;QACZ,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,SAAS,EAAE;QACT,IAAI,EAAE,UAAU;QAChB,KAAK,EAAE;YACL,WAAW,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACzB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,YAAY,EAAE;QACZ,IAAI,EAAE,cAAc;QACpB,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,SAAS,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YACvB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,YAAY,EAAE;QACZ,IAAI,EAAE,aAAa;QACnB,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,aAAa,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YAC3B,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;IACD,eAAe,EAAE;QACf,IAAI,EAAE,QAAQ;QACd,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,YAAY,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YAC1B,eAAe,EAAE,EAAE;YACnB,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE;YACP,eAAe,EAAE,EAAE;SACpB;KACF;IACD,UAAU,EAAE;QACV,IAAI,EAAE,WAAW;QACjB,kBAAkB,EAAE,IAAI;QACxB,KAAK,EAAE;YACL,aAAa,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE;YAC3B,OAAO,EAAE,EAAE;SACZ;QACD,OAAO,EAAE,EAAE;KACZ;CACF,CAAC;;;;;;;;;;;;;;;;ACnMJ,4BAA4B;AACrB,MAAM,QAAQ,GAAG;IACtB,UAAU,EAAE;QACV,IAAI,EAAE;YACJ,SAAS,EAAE,sCAAsC;YACjD,WAAW,EAAE,gGAAgG;YAC7G,YAAY,EAAE,mBAAmB;YACjC,wBAAwB,EAAE,SAAS;YACnC,MAAM,EAAE,uBAAuB;YAC/B,IAAI,EAAE,IAAI;YACV,cAAc,EAAE,mDAAmD;YACnE,SAAS,EAAE,gCAAgC;YAC3C,iBAAiB,EAAE,sDAAsD;SAC1E;QACD,IAAI,EAAE;YACJ,SAAS,EAAE,sCAAsC;YACjD,WAAW,EAAE,sGAAsG;YACnH,YAAY,EAAE,mBAAmB;YACjC,wBAAwB,EAAE,SAAS;YACnC,MAAM,EAAE,uBAAuB;YAC/B,IAAI,EAAE,IAAI;YACV,cAAc,EAAE,mDAAmD;YACnE,SAAS,EAAE,gCAAgC;YAC3C,iBAAiB,EAAE,sDAAsD;SAC1E;QACD,IAAI,EAAE;YACJ,SAAS,EAAE,sCAAsC;YACjD,WAAW,EAAE,gGAAgG;YAC7G,YAAY,EAAE,mBAAmB;YACjC,wBAAwB,EAAE,SAAS;YACnC,MAAM,EAAE,uBAAuB;YAC/B,IAAI,EAAE,IAAI;YACV,cAAc,EAAE,8CAA8C;YAC9D,SAAS,EAAE,2BAA2B;YACtC,iBAAiB,EAAE,iDAAiD;SACrE;KACF;IACD,YAAY,EAAE;QACZ,sBAAsB,EAAE,IAAI;QAC5B,QAAQ,EAAE;YACR,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;YAC5B,GAAG,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;YAChC,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;SAC7B;QACD,QAAQ,EAAE,aAAa;KACxB;IACD,QAAQ,EAAE;QACR,MAAM,EAAE;YACN,MAAM,EAAE;gBACN,IAAI,EAAE,0BAA0B;gBAChC,IAAI,EAAE,+BAA+B;gBACrC,IAAI,EAAE,+BAA+B;gBACrC,mCAAmC;aACpC;YACD,UAAU,EAAE;gBACV,IAAI,EAAE,4CAA4C;gBAClD,IAAI,EAAE,0CAA0C;gBAChD,IAAI,EAAE,+CAA+C;aACtD;YACD,MAAM,EAAE;gBACN,IAAI,EAAE,uBAAuB;gBAC7B,IAAI,EAAE,wBAAwB;gBAC9B,IAAI,EAAE,wBAAwB;aAC/B;YACD,aAAa,EAAE,0BAA0B;YACzC,mBAAmB,EAAE,kCAAkC;YACvD,iBAAiB,EAAE,8CAA8C;YACjE,cAAc,EAAE,iBAAiB;YACjC,cAAc,EAAE,OAAO;SACxB;QACD,OAAO,EAAE;YACP,uBAAuB,EAAE,CAAC;YAC1B,YAAY,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;YACjC,QAAQ,EAAE,aAAa;YACvB,UAAU,EAAE,YAAY;YACxB,IAAI,EAAE;gBACJ,MAAM,EAAE,8DAA8D;gBACtE,MAAM,EAAE;oBACN,EAAE,EAAE,yHAAyH;oBAC7H,EAAE,EAAE,iIAAiI;iBACtI;gBACD,WAAW,EAAE,UAAU;aACxB;YACD,IAAI,EAAE;gBACJ,MAAM,EAAE,8DAA8D;gBACtE,MAAM,EAAE;oBACN,EAAE,EAAE,wIAAwI;oBAC5I,EAAE,EAAE,uJAAuJ;iBAC5J;gBACD,WAAW,EAAE,cAAc;aAC5B;YACD,KAAK,EAAE;gBACL,MAAM,EAAE,0DAA0D;gBAClE,MAAM,EAAE;oBACN,EAAE,EAAE,oIAAoI;oBACxI,EAAE,EAAE,mJAAmJ;iBACxJ;gBACD,WAAW,EAAE,cAAc;aAC5B;YACD,GAAG,EAAE;gBACH,MAAM,EAAE,sDAAsD;gBAC9D,WAAW,EAAE,cAAc;aAC5B;SACF;KACF;IACD,EAAE,EAAE;QACF,aAAa,EAAE;YACb,MAAM,EAAE,qBAAqB;YAC7B,QAAQ,EAAE,SAAS;SACpB;QACD,OAAO,EAAE;YACP,MAAM,EAAE,QAAQ;SACjB;KACF;IACD,GAAG,EAAE;QACH,KAAK,EAAE;YACL,WAAW,EAAE,YAAY;YACzB,SAAS,EAAE,CAAC;YACZ,6BAA6B,EAAE,EAAE;YACjC,2BAA2B,EAAE,IAAI;YACjC,eAAe,EAAE,WAAW;YAC5B,WAAW,EAAE,kCAAkC;YAC/C,WAAW,EAAE,CAAC;YACd,uBAAuB,EAAE,CAAC;YAC1B,wBAAwB,EAAE,CAAC;YAC3B,OAAO,EAAE,CAAC;YACV,kBAAkB,EAAE,CAAC;YACrB,OAAO,EAAE,EAAE;YACX,cAAc,EAAE,EAAE;YAClB,wBAAwB,EAAE,EAAE;YAC5B,eAAe,EAAE,CAAC;YAClB,YAAY,EAAE,KAAK;YACnB,cAAc,EAAE,KAAK;YACrB,qBAAqB,EAAE,2GAA2G;YAClI,qBAAqB,EAAE,wIAAwI;YAC/J,cAAc,EAAE,kDAAkD;YAClE,sBAAsB,EAAE,gGAAgG;YACxH,YAAY,EAAE;gBACZ;oBACE,IAAI,EAAE,WAAW;oBACjB,WAAW,EAAE,2BAA2B;oBACxC,GAAG,EAAE,mFAAmF;oBACxF,OAAO,EAAE,KAAK;oBACd,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,GAAG;oBACZ,WAAW,EAAE,EAAE;oBACf,gBAAgB,EAAE,KAAK;oBACvB,OAAO,EAAE;wBACP,IAAI,EAAE,kBAAkB;wBACxB,WAAW,EAAE,kCAAkC;wBAC/C,GAAG,EAAE,mFAAmF;wBACxF,OAAO,EAAE,IAAI;wBACb,OAAO,EAAE,IAAI;wBACb,gBAAgB,EAAE,IAAI;qBACvB;iBACF;gBACD;oBACE,IAAI,EAAE,WAAW;oBACjB,WAAW,EAAE,4BAA4B;oBACzC,GAAG,EAAE,+FAA+F;oBACpG,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,GAAG;oBACZ,WAAW,EAAE,EAAE;oBACf,gBAAgB,EAAE,KAAK;iBACxB;gBACD;oBACE,IAAI,EAAE,aAAa;oBACnB,WAAW,EAAE,6BAA6B;oBAC1C,GAAG,EAAE,qFAAqF;oBAC1F,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,GAAG;oBACZ,WAAW,EAAE,EAAE;oBACf,gBAAgB,EAAE,KAAK;iBACxB;gBACD;oBACE,IAAI,EAAE,aAAa;oBACnB,WAAW,EAAE,8BAA8B;oBAC3C,GAAG,EAAE,oFAAoF;oBACzF,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,IAAI;oBACb,OAAO,EAAE,GAAG;oBACZ,WAAW,EAAE,EAAE;oBACf,gBAAgB,EAAE,IAAI;iBACvB;aACF;YACD,kBAAkB,EAAE;gBAClB,CAAC,kBAAkB,EAAE,CAAC,UAAU,CAAC;gBACjC,CAAC,kBAAkB,EAAE,WAAW,CAAC;gBACjC,CAAC,iBAAiB,EAAE,WAAW,CAAC;gBAChC,CAAC,iBAAiB,EAAE,CAAC,UAAU,CAAC;gBAChC,CAAC,kBAAkB,EAAE,CAAC,UAAU,CAAC;aAClC;SACF;QACD,MAAM,EAAE;YACN,EAAE,EAAE;gBACF,GAAG,EAAE,0CAA0C;gBAC/C,UAAU,EAAE,EAAE;gBACd,UAAU,EAAE,IAAI;gBAChB,gBAAgB,EAAE,IAAI;gBACtB,YAAY,EAAE,gMAAgM;aAC/M;YACD,QAAQ,EAAE;gBACR,GAAG,EAAE,6BAA6B;gBAClC,UAAU,EAAE,EAAE;gBACd,QAAQ,EAAE,QAAQ;aACnB;YACD,iBAAiB,EAAE,CAAC;SACrB;QACD,MAAM,EAAE;YACN,QAAQ,EAAE;gBACR,IAAI,EAAE;oBACJ,CAAC,SAAS,EAAE,QAAQ,CAAC;oBACrB,CAAC,SAAS,EAAE,SAAS,CAAC;oBACtB,CAAC,SAAS,EAAE,SAAS,CAAC;oBACtB,CAAC,SAAS,EAAE,QAAQ,CAAC;iBACtB;aACF;SACF;QACD,oBAAoB,EAAE,EAAE;QACxB,gBAAgB,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC;QACxC,cAAc,EAAE,EAAE;QAClB,gBAAgB,EAAE,EAAE,CAAC,MAAM;KAC5B;IACD,sBAAsB,EAAE,YAAY;IACpC,mBAAmB,EAAE,uBAAuB;IAC5C,GAAG,EAAE;QACH,2BAA2B,EAAE;YAC3B,kBAAkB,EAAE,IAAI;YACxB,OAAO,EAAE,EAAE,GAAG,IAAI;YAClB,UAAU,EAAE,QAAQ,CAAC,iCAAiC;SACvD;KACF;IACD,mBAAmB,EAAE,QAAQ;IAC7B,WAAW,EAAE;QACX,OAAO,EAAE;YACP,IAAI,EAAE,YAAY;YAClB,WAAW,EAAE,kBAAkB;SAChC;QACD,MAAM,EAAE;YACN,IAAI,EAAE,YAAY;YAClB,WAAW,EAAE,kBAAkB;SAChC;KACF;IACD,WAAW,EAAE;QACX,gBAAgB,EAAE,CAAC;KACpB;IACD,SAAS,EAAE;QACT,gBAAgB,EAAE,CAAC;KACpB;IACD,MAAM,EAAE;QACN,IAAI,EAAE,IAAI;QACV,OAAO,EAAE,EAAE;KACZ;IACD,SAAS,EAAE,2DAA2D;IACtE,iBAAiB,EAAE,eAAe;IAClC,0BAA0B,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;IACzC,sBAAsB,EAAE,EAAE,GAAG,IAAI;IACjC,2BAA2B,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE;IACrD,eAAe,EAAE;QACf,SAAS,EAAE,eAAe;QAC1B,WAAW,EAAE,IAAI;KAClB;IACD,QAAQ,EAAE;QACR,YAAY,EAAE,IAAI;QAClB,kBAAkB,EAAE;YAClB,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,cAAc,EAAE;YACpC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,eAAe,EAAE;YACrC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE;YAC/B,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE;YAC/B,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,SAAS,EAAE;YAC/B,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,WAAW,EAAE;YACjC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE;SACjC;KACF;CACF,CAAC;;;;;;;;;;;ACrRF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA,wCAAwC;AACxC;AACA;;;;;;;;;;ACjOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;ACnSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AC3BA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA","sources":["./$_lazy_route_resources|lazy|groupOptions: {}|namespace object","./src/app/app-routing.module.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/app.providers.ts","./src/app/components/competence/competence.component.ts","./src/app/components/competence/competence.component.html","./src/app/components/img-swiper/img-swiper.component.ts","./src/app/components/img-swiper/img-swiper.component.html","./src/app/components/legal-terms/legal-terms.component.ts","./src/app/components/legal-terms/legal-terms.component.html","./src/app/components/observation/observation-list-card/observation-list-card.component.ts","./src/app/components/observation/observation-list-card/observation-list-card.component.html","./src/app/components/observation/observation-skeleton/observation-skeleton.component.ts","./src/app/components/observation/observation-skeleton/observation-skeleton.component.html","./src/app/components/observation/summary/summary.component.ts","./src/app/components/observation/summary/summary.component.html","./src/app/core/animations/custom.animation.ts","./src/app/core/app-init/deep-links-initializer.ts","./src/app/core/error-handler/error-handler.class.ts","./src/app/core/guards/auth.guard.ts","./src/app/core/guards/start-wizard.guard.ts","./src/app/core/helpers/cancel-promise-timer.ts","./src/app/core/helpers/competence-helper.ts","./src/app/core/helpers/data-url.helper.ts","./src/app/core/helpers/ionic/platform-helper.ts","./src/app/core/helpers/leaflet/border-helper.ts","./src/app/core/helpers/leaflet/user-marker/user-marker.ts","./src/app/core/helpers/nano-sql/NSqlFullUpdateObservable.ts","./src/app/core/helpers/number-helper.ts","./src/app/core/helpers/observable-helper.ts","./src/app/core/http-interceptor/ApiInterceptor.ts","./src/app/core/models/summmary-type.enum.ts","./src/app/core/models/topo-map.enum.ts","./src/app/core/services/app-version/app-version.service.ts","./src/app/core/services/background-download/background-download.service.ts","./src/app/core/services/background-download/http-client-download.service.ts","./src/app/core/services/background-geolocation/background-geolocation-native.service.ts","./src/app/core/services/background-geolocation/background-geolocation-web.service.ts","./src/app/core/services/background-geolocation/background-geolocation.service.ts","./src/app/core/services/data-marshall/data-marshall.service.ts","./src/app/core/services/db-helper/db-helper.service.ts","./src/app/core/services/external-link/external-link.service.ts","./src/app/core/services/fullscreen/fullscreen.service.ts","./src/app/core/services/geo-position/geo-position-error.enum.ts","./src/app/core/services/geo-position/geo-position.service.ts","./src/app/core/services/helpers/helper.service.ts","./src/app/core/services/kdv/kdv.service.ts","./src/app/core/services/observation/observation.service.ts","./src/app/core/services/offline-image/offline-image.service.ts","./src/app/core/services/offline-map/offline-map.service.ts","./src/app/core/services/offline-map/offline-tiles-registry.ts","./src/app/core/services/offline-map/progress-step.model.ts","./src/app/core/services/popup-info/popup-info.service.ts","./src/app/core/services/shortcut/shortcut.service.ts","./src/app/core/services/swipe-back/swipe-back.service.ts","./src/app/core/services/trip-logger/trip-logger.service.ts","./src/app/core/services/user-setting/user-setting.service.ts","./src/app/core/services/user-setting/user-settings.default.ts","./src/app/core/services/warning/warning-group.model.ts","./src/app/core/services/warning/warning.service.ts","./src/app/custom-translate.loader.ts","./src/app/modules/analytics/analytics.module.ts","./src/app/modules/analytics/enums/app-custom-dimension.enum.ts","./src/app/modules/analytics/enums/app-event-action.enum.ts","./src/app/modules/analytics/enums/app-event-category.enum.ts","./src/app/modules/analytics/services/analytic.service.ts","./src/app/modules/auth/auth-routing.module.ts","./src/app/modules/auth/auth.module.ts","./src/app/modules/auth/factories/auth-factory.ts","./src/app/modules/auth/factories/http-factory.ts","./src/app/modules/auth/factories/storage-factory.ts","./src/app/modules/auth/ng-http.service.ts","./src/app/modules/auth/services/regobs-auth-service-override.ts","./src/app/modules/auth/services/regobs-auth.service.ts","./src/app/modules/auth/services/token-response-full.ts","./src/app/modules/common-registration/db/schemas/attachment-meta.schema.ts","./src/app/modules/common-registration/db/schemas/generic.schema.ts","./src/app/modules/common-registration/db/schemas/registration-sync-progress.schema.ts","./src/app/modules/common-registration/db/schemas/registration.schema.ts","./src/app/modules/common-registration/db/schemas/upload-progress.schema.ts","./src/app/modules/common-registration/helpers/object-url-blob.helper.ts","./src/app/modules/common-registration/helpers/registration.helper.ts","./src/app/modules/common-registration/models/attachment-upload-edit.interface.ts","./src/app/modules/common-registration/models/registration-tid.enum.ts","./src/app/modules/common-registration/models/summary/summary-kind.enum.ts","./src/app/modules/common-registration/models/summary/text-summary.ts","./src/app/modules/common-registration/models/summary/url-summary.ts","./src/app/modules/common-registration/models/sync-status.enum.ts","./src/app/modules/common-registration/module.options.ts","./src/app/modules/common-registration/pipes/kdvDescription.pipe.ts","./src/app/modules/common-registration/registration.helpers.ts","./src/app/modules/common-registration/registration.models.ts","./src/app/modules/common-registration/registration.module.ts","./src/app/modules/common-registration/registration.pipes.ts","./src/app/modules/common-registration/registration.services.ts","./src/app/modules/common-registration/services/add-new-attachment/file-attachment.service.ts","./src/app/modules/common-registration/services/add-new-attachment/new-attachment.service.ts","./src/app/modules/common-registration/services/add-new-attachment/offline-db-new-attachment.service.ts","./src/app/modules/common-registration/services/api-sync-offline-base/api-sync-offline-base.service.ts","./src/app/modules/common-registration/services/help-text/help-text.service.ts","./src/app/modules/common-registration/services/item-sync-callback/fake-item-sync-callback.service.ts","./src/app/modules/common-registration/services/item-sync-callback/item-sync-callback.service.ts","./src/app/modules/common-registration/services/item-sync-callback/regobs-api-sync-callback.service.ts","./src/app/modules/common-registration/services/kdv/kdv.service.ts","./src/app/modules/common-registration/services/offline-db/offline-db-service.options.ts","./src/app/modules/common-registration/services/offline-db/offline-db.service.ts","./src/app/modules/common-registration/services/progress/progress.service.ts","./src/app/modules/common-registration/services/registration/registration.service.ts","./src/app/modules/common-registration/services/summary-providers/base.summary-provider.ts","./src/app/modules/common-registration/services/summary-providers/fallback-provider.ts","./src/app/modules/common-registration/services/summary-providers/general-observation/general-observation.summary-provider.ts","./src/app/modules/common-registration/services/summary-providers/snow/weather/weather.summary-provider.ts","./src/app/modules/data-load/services/data-load.service.ts","./src/app/modules/gps-debug/components/gps-debug/gps-debug.component.ts","./src/app/modules/gps-debug/components/gps-debug/gps-debug.component.html","./src/app/modules/gps-debug/gps-debug.module.ts","./src/app/modules/map-image/map-image.component.ts","./src/app/modules/map-image/map-image.component.html","./src/app/modules/map-image/map-image.module.ts","./src/app/modules/map/components/map-center-info/map-center-info.component.ts","./src/app/modules/map/components/map-center-info/map-center-info.component.html","./src/app/modules/map/components/map-controls/fullscreen-toggle/fullscreen-toggle.component.ts","./src/app/modules/map/components/map-controls/fullscreen-toggle/fullscreen-toggle.component.html","./src/app/modules/map/components/map-controls/gps-center/gps-center.component.ts","./src/app/modules/map/components/map-controls/gps-center/gps-center.component.html","./src/app/modules/map/components/map-controls/map-controls.component.ts","./src/app/modules/map/components/map-controls/map-controls.component.html","./src/app/modules/map/components/map-controls/map-search/map-search.component.ts","./src/app/modules/map/components/map-controls/map-search/map-search.component.html","./src/app/modules/map/components/map/map.component.ts","./src/app/modules/map/components/map/map.component.html","./src/app/modules/map/core/classes/regobs-geohazard-marker.ts","./src/app/modules/map/core/classes/regobs-tile-layer.ts","./src/app/modules/map/map.module.ts","./src/app/modules/map/pages/modal-map-image/modal-map-image.module.ts","./src/app/modules/map/pages/modal-map-image/modal-map-image.page.ts","./src/app/modules/map/pages/modal-map-image/modal-map-image.page.html","./src/app/modules/map/pages/modal-search/modal-search.module.ts","./src/app/modules/map/pages/modal-search/modal-search.page.ts","./src/app/modules/map/pages/modal-search/modal-search.page.html","./src/app/modules/map/pages/support-map-info/support-map-info.module.ts","./src/app/modules/map/pages/support-map-info/support-map-info.page.ts","./src/app/modules/map/pages/support-map-info/support-map-info.page.html","./src/app/modules/map/pipes/starts-with-highlight.pipe.ts","./src/app/modules/map/services/map-search/map-search.service.ts","./src/app/modules/map/services/map/map.service.ts","./src/app/modules/registration/pages/can-deactivate-route.guard.ts","./src/app/modules/registration/pages/save-as-draft.guard.ts","./src/app/modules/registration/registration-routing.module.ts","./src/app/modules/registration/registration.module.ts","./src/app/modules/registration/services/help-text/help-text.service.ts","./src/app/modules/registration/services/registration.service.ts","./src/app/modules/shared/components/add-menu/add-menu.component.ts","./src/app/modules/shared/components/add-menu/add-menu.component.html","./src/app/modules/shared/components/external-link/external-link.component.ts","./src/app/modules/shared/components/external-link/external-link.component.html","./src/app/modules/shared/components/geo-fab/geo-fab.component.ts","./src/app/modules/shared/components/geo-fab/geo-fab.component.html","./src/app/modules/shared/components/geo-icon/geo-icon.component.ts","./src/app/modules/shared/components/geo-icon/geo-icon.component.html","./src/app/modules/shared/components/geo-name/geo-name.component.ts","./src/app/modules/shared/components/geo-name/geo-name.component.html","./src/app/modules/shared/components/geo-select/geo-select.component.ts","./src/app/modules/shared/components/geo-select/geo-select.component.html","./src/app/modules/shared/components/header/header.component.ts","./src/app/modules/shared/components/header/header.component.html","./src/app/modules/shared/components/input/select/select.component.ts","./src/app/modules/shared/components/input/select/select.component.html","./src/app/modules/shared/components/offline-image/offline-image.component.ts","./src/app/modules/shared/components/offline-image/offline-image.component.html","./src/app/modules/shared/components/refresh-with-cancel/refresh-with-cancel.component.ts","./src/app/modules/shared/components/refresh-with-cancel/refresh-with-cancel.component.html","./src/app/modules/shared/directives/header-color/header-color.directive.ts","./src/app/modules/shared/directives/shadow-css/shadow-css.directive.ts","./src/app/modules/shared/pipes/abs.pipe.ts","./src/app/modules/shared/pipes/format-date/format-date.pipe.ts","./src/app/modules/shared/services/date-helper/date-helper.service.ts","./src/app/modules/shared/services/geo-helper/geo-helper.service.ts","./src/app/modules/shared/services/logging/console-logging.service.ts","./src/app/modules/shared/services/logging/file-logging.service.ts","./src/app/modules/shared/services/logging/log-level.model.ts","./src/app/modules/shared/services/logging/logging.service.ts","./src/app/modules/shared/services/logging/sentry.service.ts","./src/app/modules/shared/services/logging/url-utils.ts","./src/app/modules/shared/shared.module.ts","./src/app/modules/side-menu/components/observations-days-back/observations-days-back.component.ts","./src/app/modules/side-menu/components/observations-days-back/observations-days-back.component.html","./src/app/modules/side-menu/components/side-menu.component.ts","./src/app/modules/side-menu/components/side-menu.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/clayzones-legend/clayzones-legend.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/clayzones-legend/clayzones-legend.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/floodzones-legend/floodzones-legend.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/floodzones-legend/floodzones-legend.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/legends.config.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/steepness-common-legend/steepness-common-legend.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/steepness-common-legend/steepness-common-legend.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/steepness-legend/steepness-legend.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/steepness-legend/steepness-legend.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/support-tile-legend-loader/support-tile-legend-loader.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/support-tile-legend-loader/support-tile-legend-loader.component.html","./src/app/modules/side-menu/components/support-tiles-menu/legends/weakenedice-legend/weakenedice-legend.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/legends/weakenedice-legend/weakenedice-legend.component.html","./src/app/modules/side-menu/components/support-tiles-menu/support-tiles-menu.component.ts","./src/app/modules/side-menu/components/support-tiles-menu/support-tiles-menu.component.html","./src/app/modules/side-menu/components/update-observations/update-observations.component.ts","./src/app/modules/side-menu/components/update-observations/update-observations.component.html","./src/app/modules/side-menu/components/user-login/user-login.component.ts","./src/app/modules/side-menu/components/user-login/user-login.component.html","./src/app/modules/side-menu/side-menu.module.ts","./src/app/pages/modal-pages/fullscreen-image-modal/fullscreen-image-modal.page.ts","./src/app/pages/modal-pages/fullscreen-image-modal/fullscreen-image-modal.page.html","./src/app/pages/modal-pages/legal-terms-modal/legal-terms-modal.module.ts","./src/app/pages/modal-pages/legal-terms-modal/legal-terms-modal.page.ts","./src/app/pages/modal-pages/legal-terms-modal/legal-terms-modal.page.html","./src/environments/environment.ts","./src/main.ts","./src/nanosql.ts","./src/settings.ts","./node_modules/@ionic/core/dist/esm|lazy|/^/.*/.entry/.js$/|include: /.entry/.js$/|exclude: /.system/.entry/.js$/|groupOptions: {}|namespace object","./node_modules/moment/locale|sync|/^/.*$","./src/assets/json|sync|/^/helptexts/..*/.json$","./src/assets/json|sync|/^/kdvelements/..*/.json$","ignored|C:\\Repos\\regobs\\regObs4\\node_modules\\broadcast-channel\\dist\\es|../../src/methods/node.js","ignored|C:\\Repos\\regobs\\regObs4\\node_modules\\pouchdb-utils\\node_modules\\immediate\\lib|./nextTick","ignored|C:\\Repos\\regobs\\regObs4\\node_modules\\side-channel\\node_modules\\object-inspect|./util.inspect","ignored|C:\\Repos\\regobs\\regObs4\\node_modules\\unload\\dist\\es|./node.js"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 98255;\nmodule.exports = webpackEmptyAsyncContext;","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    loadChildren: () =>\r\n      import('./pages/tabs/tabs.module').then((m) => m.TabsPageModule)\r\n  },\r\n  {\r\n    path: 'my-observations',\r\n    loadChildren: () =>\r\n      import('./pages/my-observations/my-observations.module').then(\r\n        (m) => m.MyObservationsPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'user-settings',\r\n    loadChildren: () =>\r\n      import('./pages/user-settings/user-settings.module').then(\r\n        (m) => m.UserSettingsPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'trip-log',\r\n    loadChildren: () =>\r\n      import('./pages/trip-log/trip-log.module').then(\r\n        (m) => m.TripLogPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'start-wizard',\r\n    loadChildren: () =>\r\n      import('./pages/start-wizard/start-wizard.module').then(\r\n        (m) => m.StartWizardPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'view-observation/:id',\r\n    loadChildren: () =>\r\n      import('./pages/view-observation/view-observation.module').then(\r\n        (m) => m.ViewObservationPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'observation-list',\r\n    loadChildren: () =>\r\n      import('./pages/observation-list/observation-list.module').then(\r\n        (m) => m.ObservationListPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'offline-map',\r\n    loadChildren: () =>\r\n      import('./pages/offline-map/offline-map.module').then(\r\n        (m) => m.OfflineMapPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'login',\r\n    loadChildren: () =>\r\n      import('./modules/login/login.module').then((m) => m.LoginModule)\r\n  },\r\n  {\r\n    path: 'registration',\r\n    loadChildren: () =>\r\n      import('./modules/registration/registration.module').then(\r\n        (m) => m.RegistrationModule\r\n      )\r\n  },\r\n  {\r\n    path: 'legacy-trip',\r\n    loadChildren: () =>\r\n      import('./pages/legacy-trip/legacy-trip.module').then(\r\n        (m) => m.LegacyTripPageModule\r\n      )\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' })],\r\n  exports: [RouterModule]\r\n})\r\nexport class AppRoutingModule {}\r\n","import { Component } from '@angular/core';\r\nimport { Platform } from '@ionic/angular';\r\nimport { SplashScreen } from '@capacitor/splash-screen';\r\nimport { UserSettingService } from './core/services/user-setting/user-setting.service';\r\nimport { DataMarshallService } from './core/services/data-marshall/data-marshall.service';\r\nimport { OfflineImageService } from './core/services/offline-image/offline-image.service';\r\nimport { SwipeBackService } from './core/services/swipe-back/swipe-back.service';\r\nimport { Observable, from, forkJoin, of } from 'rxjs';\r\nimport { LoggingService } from './modules/shared/services/logging/logging.service';\r\nimport { DbHelperService } from './core/services/db-helper/db-helper.service';\r\nimport { ScreenOrientation } from '@ionic-native/screen-orientation/ngx';\r\nimport { ShortcutService } from './core/services/shortcut/shortcut.service';\r\nimport { isAndroidOrIos } from './core/helpers/ionic/platform-helper';\r\nimport { switchMap, take, concatMap, catchError, filter } from 'rxjs/operators';\r\nimport { UserSetting } from './core/models/user-settings.model';\r\nimport { FileLoggingService } from './modules/shared/services/logging/file-logging.service';\r\nimport { AuthService } from 'ionic-appauth';\r\nimport { StatusBar, Style } from '@capacitor/status-bar';\r\nimport { NavigationError, Router, RouterEvent } from '@angular/router';\r\nimport { removeOauthTokenFromUrl } from './modules/shared/services/logging/url-utils';\r\n\r\nconst DEBUG_TAG = 'AppComponent';\r\nconst ROUTER_DEBUG_TAG = 'Router';\r\n\r\n@Component({\r\n  selector: 'app-root',\r\n  templateUrl: 'app.component.html'\r\n})\r\nexport class AppComponent {\r\n  swipeBackEnabled$: Observable<boolean>;\r\n\r\n  constructor(\r\n    private platform: Platform,\r\n    private userSettings: UserSettingService,\r\n    private dataMarshallService: DataMarshallService,\r\n    private offlineImageService: OfflineImageService,\r\n    private swipeBackService: SwipeBackService,\r\n    private loggingService: LoggingService,\r\n    private dbHelperService: DbHelperService,\r\n    private screenOrientation: ScreenOrientation,\r\n    private shortcutService: ShortcutService,\r\n    private fileLoggingService: FileLoggingService,\r\n    private auth: AuthService,\r\n    private router: Router\r\n  ) {\r\n    this.swipeBackEnabled$ = this.swipeBackService.swipeBackEnabled$;\r\n    this.initializeApp();\r\n  }\r\n\r\n  initializeApp(): void {\r\n    from(this.fileLoggingService.init({})).pipe(switchMap(() =>\r\n      this.getUserSettings()\r\n        .pipe(this.initServices())))\r\n      .subscribe({ next: () => {\r\n        this.loggingService.debug('Init complete. Hide splash screen', DEBUG_TAG);\r\n        this.afterAppInitialized();\r\n      }, error: (err) => {\r\n        this.loggingService.error(err, DEBUG_TAG, 'Error when init app.');\r\n        this.afterAppInitialized();\r\n      }});\r\n  }\r\n\r\n  private afterAppInitialized() {\r\n    SplashScreen.hide();\r\n  }\r\n\r\n  private lockScreenOrientation() {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT);\r\n    }\r\n  }\r\n\r\n  private initServices(): (src: Observable<unknown>) => Observable<unknown> {\r\n    return (src: Observable<UserSetting>) =>\r\n      src.pipe(\r\n        concatMap((userSettings) =>\r\n          forkJoin([\r\n            of(this.lockScreenOrientation()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not lock lockScreenOrientation'\r\n                )\r\n              )\r\n            ),\r\n            from(this.dbHelperService.init()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(err, DEBUG_TAG, 'Could not init db')\r\n              )\r\n            ),\r\n            of(this.loggingService.configureLogging(userSettings.appMode)).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not configure logging'\r\n                )\r\n              )\r\n            ),\r\n            from(StatusBar.setStyle({ style: Style.Dark })).pipe(\r\n              catchError((err) => {\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not set styleLightContent'\r\n                );\r\n                return of(void null);\r\n              }\r\n              )\r\n            ),\r\n            from(StatusBar.setBackgroundColor({ color: '#99044962'})).pipe(\r\n              catchError((err) => {\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not set backgroundColorByHexString'\r\n                );\r\n                return of(void null);\r\n              }\r\n              )\r\n            ),\r\n            from(StatusBar.setOverlaysWebView({ overlay: false })).pipe(\r\n              catchError((err) =>\r\n              {\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not set overlaysWebView'\r\n                );\r\n                return of(void null);\r\n              }\r\n              )\r\n            ),\r\n            from(this.offlineImageService.cleanupOldItems()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not cleanup old items'\r\n                )\r\n              )\r\n            ),\r\n            of(this.shortcutService.init()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not init shortcutService'\r\n                )\r\n              )\r\n            ),\r\n            from(this.auth.init()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not init auth service'\r\n                )\r\n              )\r\n            ),\r\n            of( this.dataMarshallService.init()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not init dataMarshallService'\r\n                )\r\n              )\r\n            ),\r\n            of ( this.initRouteNavigationLogger()).pipe(\r\n              catchError((err) =>\r\n                this.loggingService.error(\r\n                  err,\r\n                  DEBUG_TAG,\r\n                  'Could not init route navigation logging'\r\n                )\r\n              )\r\n            )\r\n          ])\r\n        )\r\n      );\r\n  }\r\n\r\n  private getUserSettings() {\r\n    return from(this.platform.ready()).pipe(\r\n      switchMap(() => this.userSettings.userSetting$.pipe(take(1)))\r\n    );\r\n  }\r\n\r\n  private async initRouteNavigationLogger(): Promise<void> {\r\n    this.router.events.pipe(\r\n      filter((e): e is RouterEvent => e instanceof RouterEvent)\r\n    ).subscribe((event) => {\r\n      const eventInfo = removeOauthTokenFromUrl(event.toString());\r\n      if (event instanceof NavigationError) {\r\n        this.loggingService.error(event.error, ROUTER_DEBUG_TAG, eventInfo);\r\n      } else {\r\n        this.loggingService.debug(eventInfo);\r\n      }\r\n    });\r\n  }\r\n}\r\n","<ion-app>\r\n  <ion-menu contentId=\"main-content\" side=\"end\" type=\"overlay\" maxEdgeStart=\"0\">\r\n    <ion-content>\r\n      <app-side-menu></app-side-menu>\r\n    </ion-content>\r\n  </ion-menu>\r\n  <ion-router-outlet id=\"main-content\" [swipeGesture]=\"swipeBackEnabled$ | async\"></ion-router-outlet>\r\n  <app-gps-debug></app-gps-debug>\r\n</ion-app>","import { NgModule } from '@angular/core';\r\nimport { BrowserModule } from '@angular/platform-browser';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { AppComponent } from './app.component';\r\nimport { AppRoutingModule } from './app-routing.module';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { HttpClientModule } from '@angular/common/http';\r\nimport { APP_PROVIDERS } from './app.providers';\r\nimport { settings } from '../settings';\r\nimport { AngularSvgIconModule } from 'angular-svg-icon';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { SharedModule } from './modules/shared/shared.module';\r\nimport { RegistrationModule } from './modules/registration/registration.module';\r\nimport { LegalTermsModalPageModule } from './pages/modal-pages/legal-terms-modal/legal-terms-modal.module';\r\nimport { MarkdownModule } from 'ngx-markdown';\r\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nimport { SideMenuModule } from './modules/side-menu/side-menu.module';\r\nimport { AnalyticsModule } from './modules/analytics/analytics.module';\r\nimport { GpsDebugModule } from './modules/gps-debug/gps-debug.module';\r\nimport { MapModule } from './modules/map/map.module';\r\nimport { LeafletModule } from '@asymmetrik/ngx-leaflet';\r\nimport {\r\n  RegistrationModule as CommonRegistrationModule,\r\n} from './modules/common-registration/registration.module';\r\nimport {\r\n  RegobsApiModuleWithConfig,\r\n} from '@varsom-regobs-common/regobs-api';\r\n\r\n@NgModule({\r\n  declarations: [AppComponent],\r\n  imports: [\r\n    BrowserModule,\r\n    BrowserAnimationsModule,\r\n    HttpClientModule,\r\n    FormsModule,\r\n    IonicModule.forRoot(),\r\n    AppRoutingModule,\r\n    TranslateModule.forRoot(),\r\n    MarkdownModule.forRoot(),\r\n    AngularSvgIconModule.forRoot(),\r\n    SharedModule,\r\n    MapModule,\r\n    LeafletModule,\r\n    RegistrationModule,\r\n    LegalTermsModalPageModule,\r\n    SideMenuModule,\r\n    GpsDebugModule,\r\n    AnalyticsModule.forRoot(),\r\n    RegobsApiModuleWithConfig.forRoot(),\r\n    CommonRegistrationModule.forRoot(),\r\n  ],\r\n  providers: APP_PROVIDERS,\r\n  bootstrap: [AppComponent]\r\n})\r\n\r\nexport class AppModule {}\r\n","import { Router, RouteReuseStrategy } from '@angular/router';\r\nimport { IonicRouteStrategy, NavController, Platform } from '@ionic/angular';\r\nimport { BackgroundGeolocationNativeService } from './core/services/background-geolocation/background-geolocation-native.service';\r\nimport { BackgroundGeolocationWebService } from './core/services/background-geolocation/background-geolocation-web.service';\r\nimport { BackgroundGeolocationService } from './core/services/background-geolocation/background-geolocation.service';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { AndroidPermissions } from '@ionic-native/android-permissions/ngx';\r\nimport { BackgroundDownloadService } from './core/services/background-download/background-download.service';\r\n// import { BackgroundDownloadWebService } from './core/services/background-download/background-download-web.service';\r\n// import { BackgroundDownloadNativeService } from './core/services/background-download/background-download-native.service';\r\nimport { Zip } from '@ionic-native/zip/ngx';\r\nimport { Clipboard } from '@ionic-native/clipboard/ngx';\r\nimport { InAppBrowser } from '@ionic-native/in-app-browser/ngx';\r\nimport { UserSettingService } from './core/services/user-setting/user-setting.service';\r\nimport {\r\n  ErrorHandler,\r\n  Provider,\r\n  forwardRef,\r\n  LOCALE_ID,\r\n  APP_INITIALIZER,\r\n  NgZone\r\n} from '@angular/core';\r\nimport { AppErrorHandler } from './core/error-handler/error-handler.class';\r\nimport { HTTP } from '@ionic-native/http/ngx';\r\nimport { WebView } from '@ionic-native/ionic-webview/ngx';\r\nimport { HttpClient, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { Camera } from '@ionic-native/camera/ngx';\r\nimport { EmailComposer } from '@ionic-native/email-composer/ngx';\r\nimport { StartWizardGuard } from './core/guards/start-wizard.guard';\r\nimport { DataMarshallService } from './core/services/data-marshall/data-marshall.service';\r\nimport { AuthGuard } from './core/guards/auth.guard';\r\nimport { Keyboard } from '@ionic-native/keyboard/ngx';\r\nimport { SQLite } from '@ionic-native/sqlite/ngx';\r\nimport { SocialSharing } from '@ionic-native/social-sharing/ngx';\r\nimport { Network } from '@ionic-native/network/ngx';\r\nimport { LoggingService } from './modules/shared/services/logging/logging.service';\r\nimport { SentryService } from './modules/shared/services/logging/sentry.service';\r\nimport { ConsoleLoggingService } from './modules/shared/services/logging/console-logging.service';\r\nimport { environment } from '../environments/environment';\r\nimport { ScreenOrientation } from '@ionic-native/screen-orientation/ngx';\r\nimport { OfflineMapService } from './core/services/offline-map/offline-map.service';\r\nimport { TranslateLoader, TranslateService } from '@ngx-translate/core';\r\nimport { SafariViewController } from '@ionic-native/safari-view-controller/ngx';\r\nimport { Diagnostic } from '@ionic-native/diagnostic/ngx';\r\nimport { initTranslateService } from './custom-translate.loader';\r\nimport { DeviceOrientation } from '@ionic-native/device-orientation/ngx';\r\nimport { initDeepLinks } from './core/app-init/deep-links-initializer';\r\nimport { AuthService } from 'ionic-appauth';\r\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\r\nimport { API_KEY_TOKEN, IRegobsApiKeyProvider } from '@varsom-regobs-common/regobs-api';\r\nimport {\r\n  IRegistrationModuleOptions,\r\n  FOR_ROOT_OPTIONS_TOKEN as COMMON_REGISTRATION_FOR_ROOT_OPTIONS_TOKEN,\r\n} from './modules/common-registration/module.options';\r\nimport { AppModeService } from '@varsom-regobs-common/core';\r\nimport { addRxPlugin } from 'rxdb';\r\nimport { ApiInterceptor } from './core/http-interceptor/ApiInterceptor';\r\nimport { HttpClientDownloadService } from './core/services/background-download/http-client-download.service';\r\nimport { OfflineDbService } from './modules/common-registration/registration.services';\r\n\r\n// export const API_INTERCEPTOR_PROVIDER: Provider = {\r\n//   provide: HTTP_INTERCEPTORS,\r\n//   useExisting: forwardRef(() => ApiInterceptor),\r\n//   multi: true\r\n// };\r\n\r\nexport class DynamicLocaleId extends String {\r\n  constructor(protected service: TranslateService) {\r\n    super('');\r\n  }\r\n  toString(): string {\r\n    return this.service.currentLang;\r\n  }\r\n}\r\n\r\nfunction createTranslateLoader(http: HttpClient) {\r\n  return new TranslateHttpLoader(http, '../assets/i18n/', '.json');\r\n}\r\n\r\nexport function initCommonApiKey(): IRegobsApiKeyProvider {\r\n  return { apiKey: require('../assets/apikey.json').apiKey };\r\n}\r\n\r\nexport function initAppModeService(userSettingService: UserSettingService): any {\r\n  return { appMode$: userSettingService.appMode$  };\r\n}\r\n\r\n// export function initCommonApiOptions(\r\n//   appConfig: IAppConfig\r\n// ): RegobsApiConfigurationInterface {\r\n//   return { rootUrl: appConfig.api.baseUrl };\r\n// }\r\nexport function initCommonRegistrationOptions(\r\n): IRegistrationModuleOptions {\r\n  const options = {\r\n    autoSync: false,\r\n    adapter: 'idb',\r\n    attachmentsSupported: false\r\n  };\r\n  return options;\r\n}\r\n\r\nexport function initDb(dbService: OfflineDbService) {\r\n  return (): Promise<void> =>  {\r\n    return import('pouchdb-adapter-idb').then(addRxPlugin).then(() => dbService.initDatabase('idb'));\r\n  };\r\n}\r\n\r\n// export function initAppMode(userSettings: UserSettingService, appModeService: AppModeService){\r\n//   return () => {\r\n//     userSettings.appMode$.subscribe((appMode) => appModeService.setAppMode(appMode));\r\n//   }\r\n// }\r\n\r\nexport const APP_PROVIDERS = [\r\n  StartWizardGuard,\r\n  AuthGuard,\r\n  { provide: RouteReuseStrategy, useClass: IonicRouteStrategy },\r\n  {\r\n    provide: LOCALE_ID,\r\n    useClass: DynamicLocaleId,\r\n    deps: [TranslateService]\r\n  },\r\n  DeviceOrientation,\r\n  File,\r\n  AndroidPermissions,\r\n  Zip,\r\n  Clipboard,\r\n  Camera,\r\n  InAppBrowser,\r\n  SafariViewController,\r\n  HTTP,\r\n  WebView,\r\n  EmailComposer,\r\n  Keyboard,\r\n  SQLite,\r\n  SocialSharing,\r\n  Network,\r\n  ScreenOrientation,\r\n  Diagnostic,\r\n  {\r\n    provide: HTTP_INTERCEPTORS,\r\n    useClass: ApiInterceptor, // TODO: Move to auth module\r\n    multi: true\r\n  },\r\n  // API_INTERCEPTOR_PROVIDER,\r\n  // { provide: RegobsApiConfiguration, useClass: ApiConfiguration },\r\n\r\n  { provide: ErrorHandler, useClass: AppErrorHandler },\r\n  {\r\n    provide: LoggingService,\r\n    useClass: environment.production ? SentryService : ConsoleLoggingService\r\n  },\r\n  {\r\n    provide: TranslateLoader,\r\n    useFactory: createTranslateLoader,\r\n    deps: [HttpClient]\r\n  },\r\n\r\n  // APP initializers\r\n  {\r\n    provide: APP_INITIALIZER,\r\n    useFactory: initTranslateService,\r\n    deps: [TranslateService, UserSettingService],\r\n    multi: true\r\n  },\r\n  {\r\n    provide: APP_INITIALIZER,\r\n    useFactory: initDeepLinks,\r\n    deps: [Platform, NgZone, AuthService, NavController, Router],\r\n    multi: true\r\n  },\r\n\r\n  // @varsom-regobs-common providers\r\n  {\r\n    provide: API_KEY_TOKEN,\r\n    useFactory: initCommonApiKey,\r\n  },\r\n  {\r\n    provide: AppModeService,\r\n    useFactory: initAppModeService,\r\n    deps: [UserSettingService]\r\n  },\r\n  // {\r\n  //   provide: FOR_ROOT_OPTIONS_TOKEN,\r\n  //   useFactory: initCommonApiOptions,\r\n  //   deps: [APP_CONFIG]\r\n  // },\r\n  {\r\n    provide: COMMON_REGISTRATION_FOR_ROOT_OPTIONS_TOKEN,\r\n    useFactory: initCommonRegistrationOptions,\r\n    deps: []\r\n  },\r\n  {\r\n    provide: APP_INITIALIZER,\r\n    useFactory: initDb,\r\n    multi: true,\r\n    deps: [OfflineDbService]\r\n  },\r\n  // {\r\n  //   provide: APP_INITIALIZER,\r\n  //   useFactory: initAppMode,\r\n  //   multi: true,\r\n  //   deps: [UserSettingService, AppModeService]\r\n  // },\r\n\r\n  // Interface implementations\r\n  { provide: 'OnReset', useExisting: DataMarshallService, multi: true },\r\n  { provide: 'OnReset', useExisting: UserSettingService, multi: true },\r\n  { provide: 'OnReset', useExisting: OfflineMapService, multi: true },\r\n\r\n  // Custom native/web providers\r\n  {\r\n    provide: BackgroundGeolocationService,\r\n    useClass: window.hasOwnProperty('cordova')\r\n      ? BackgroundGeolocationNativeService\r\n      : BackgroundGeolocationWebService\r\n  },\r\n  {\r\n    provide: BackgroundDownloadService,\r\n    // useClass: window.hasOwnProperty('cordova')\r\n    //   ? BackgroundDownloadNativeService\r\n    //   : BackgroundDownloadWebService\r\n    // TODO: Implement Download Manager for Android\r\n    useClass: HttpClientDownloadService\r\n  }\r\n];\r\n","import { Component, OnInit, Input } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-competence',\r\n  templateUrl: './competence.component.html',\r\n  styleUrls: ['./competence.component.scss']\r\n})\r\nexport class CompetenceComponent implements OnInit {\r\n  readonly maxCompetenceLevel = 5;\r\n\r\n  @Input() competenceLevel = 0;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n}\r\n","<div class=\"competence-wrapper\">\r\n  <ng-container *ngIf=\"competenceLevel > 0 else noCompetence\">\r\n    <ng-container *ngFor=\"let index of [0,1,2,3,4]\">\r\n      <svg-icon *ngIf=\"competenceLevel > index else emptyStar\" src=\"/assets/icon/star-selected.svg\"\r\n        [svgStyle]=\"{'width.px':12, 'height.px':12  }\"></svg-icon>\r\n    </ng-container>\r\n  </ng-container>\r\n</div>\r\n<ng-template #emptyStar>\r\n  <svg-icon src=\"/assets/icon/star-empty.svg\" [svgStyle]=\"{'width.px':12, 'height.px':12  }\"></svg-icon>\r\n</ng-template>\r\n<ng-template #noCompetence>\r\n  <ion-label class=\"small-text\">({{'COMPETENCE.UNKNOWN' | translate}})</ion-label>\r\n</ng-template>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  EventEmitter,\r\n  Output,\r\n  ViewChild,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { IonSlides } from '@ionic/angular';\r\nimport { ImgSwiperSlide } from './img-swiper-slide';\r\nimport { Subject, interval, race } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { ImageLocation } from './image-location.model';\r\n\r\n@Component({\r\n  selector: 'app-img-swiper',\r\n  templateUrl: './img-swiper.component.html',\r\n  styleUrls: ['./img-swiper.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ImgSwiperComponent implements OnInit, OnChanges, OnDestroy {\r\n  @Input() imgUrl: string[] = [];\r\n  @Input() showLabels = true;\r\n  @Input() imgComments: string[] = [];\r\n  @Input() imgHeaders: string[] = [];\r\n  @Output() imgClick: EventEmitter<{\r\n    index: number;\r\n    imgUrl: string;\r\n  }> = new EventEmitter();\r\n  @Input() location: ImageLocation;\r\n  @Output() locationClick: EventEmitter<ImageLocation> = new EventEmitter();\r\n\r\n  slideOptions = {\r\n    autoplay: false,\r\n    slidesPerView: 'auto',\r\n    zoom: false\r\n  };\r\n\r\n  swiper: any;\r\n  state:\r\n    | 'loading'\r\n    | 'empty'\r\n    | 'singleimage'\r\n    | 'singlemap'\r\n    | 'loading-swiper'\r\n    | 'swiper-ready' = 'loading';\r\n  slides: ImgSwiperSlide[];\r\n  activeIndex = 0;\r\n\r\n  private ngDestroy$ = new Subject<void>();\r\n  private touchStart$ = new Subject<void>();\r\n\r\n  @ViewChild(IonSlides) slider: IonSlides;\r\n\r\n  get isEmpty() {\r\n    return this.state === 'empty';\r\n  }\r\n\r\n  get isLoaded() {\r\n    return this.state !== 'loading' && this.state !== 'loading-swiper';\r\n  }\r\n\r\n  get isSwiperLoaded() {\r\n    return this.state === 'swiper-ready';\r\n  }\r\n\r\n  get isSwiper() {\r\n    return this.state === 'swiper-ready' || this.state === 'loading-swiper';\r\n  }\r\n\r\n  get isSingleImage() {\r\n    return this.state === 'singleimage';\r\n  }\r\n\r\n  get isSingleMap() {\r\n    return this.state === 'singlemap';\r\n  }\r\n\r\n  get showLabel() {\r\n    return (\r\n      this.slides &&\r\n      this.slides[this.activeIndex] &&\r\n      (this.slides[this.activeIndex].header ||\r\n        this.slides[this.activeIndex].description)\r\n    );\r\n  }\r\n\r\n  get shouldMoveMap() {\r\n    return this.location && this.imgUrl && this.imgUrl.length > 0;\r\n  }\r\n\r\n  get imageLength() {\r\n    return this.imgUrl ? this.imgUrl.length : 0;\r\n  }\r\n\r\n  get imageIndex() {\r\n    if (\r\n      this.slides[this.activeIndex] &&\r\n      this.slides[this.activeIndex].type === 'image'\r\n    ) {\r\n      return this.getImageIndex(this.slides[this.activeIndex].img as string);\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  get showIndex() {\r\n    if (this.imgUrl && this.imgUrl.length > 1) {\r\n      return this.location ? this.activeIndex > 0 : true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  constructor(private cdr: ChangeDetectorRef) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  ngOnDestroy(): void {\r\n    this.cdr.detach();\r\n  }\r\n\r\n  slidesLoaded(el: any) {\r\n    this.swiper = el.target.swiper;\r\n    if (this.shouldMoveMap) {\r\n      this.activeIndex = 1;\r\n      interval(100)\r\n        .pipe(takeUntil(race(this.ngDestroy$, this.touchStart$)))\r\n        .subscribe(() => {\r\n          this.moveMapInSwiperToLeftOutsideView();\r\n        });\r\n    }\r\n    this.state = 'swiper-ready';\r\n    this.updateUi();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges) {\r\n    this.state = 'loading';\r\n    if (this.swiper) {\r\n      this.swiper.destroy();\r\n      this.swiper = undefined;\r\n    }\r\n    this.updateUi();\r\n    setTimeout(() => this.init(), 0);\r\n  }\r\n\r\n  private init() {\r\n    this.slides = [];\r\n    if (this.location) {\r\n      this.slides.push({\r\n        type: 'location',\r\n        img: this.location,\r\n        header: 'REGISTRATION.OBS_LOCATION.TITLE'\r\n      });\r\n    }\r\n    this.slides = [...this.getLocationSlides(), ...this.getImageSlides()];\r\n    this.activeIndex = 0;\r\n    this.state = this.calculateNewState();\r\n    this.updateUi();\r\n  }\r\n\r\n  private updateUi() {\r\n    if (!this.cdr['destroyed']) {\r\n      this.cdr.detectChanges();\r\n    }\r\n  }\r\n\r\n  private calculateNewState() {\r\n    if (this.location && (!this.imgUrl || this.imgUrl.length === 0)) {\r\n      return 'singlemap';\r\n    } else if (!this.location && this.imgUrl && this.imgUrl.length === 1) {\r\n      return 'singleimage';\r\n    } else if (!this.location && (!this.imgUrl || this.imgUrl.length === 0)) {\r\n      return 'empty';\r\n    } else {\r\n      return 'loading-swiper';\r\n    }\r\n  }\r\n\r\n  private getLocationSlides(): ImgSwiperSlide[] {\r\n    return this.location\r\n      ? [\r\n        {\r\n          type: 'location',\r\n          img: this.location,\r\n          header: 'REGISTRATION.OBS_LOCATION.TITLE'\r\n        }\r\n      ]\r\n      : [];\r\n  }\r\n\r\n  private getImageSlides(): ImgSwiperSlide[] {\r\n    return (this.imgUrl || []).map((img, index) => ({\r\n      type: 'image',\r\n      img,\r\n      header: this.imgHeaders[index],\r\n      description: this.imgComments[index]\r\n    }));\r\n  }\r\n\r\n  private moveMapInSwiperToLeftOutsideView() {\r\n    if (this.swiper && this.swiper.$wrapperEl && this.swiper.$wrapperEl[0]) {\r\n      this.swiper.$wrapperEl[0].style.transform = 'translate3d(-60%, 0px, 0px)';\r\n    }\r\n  }\r\n\r\n  getImageIndex(src: string) {\r\n    return this.imgUrl && this.imgUrl.length > 0\r\n      ? this.imgUrl.indexOf(src)\r\n      : -1;\r\n  }\r\n\r\n  onImageClick(imgUrlSrc: string) {\r\n    const index = this.getImageIndex(imgUrlSrc);\r\n    if (index >= 0) {\r\n      this.imgClick.emit({ index, imgUrl: imgUrlSrc });\r\n    }\r\n  }\r\n\r\n  onLocationClick() {\r\n    this.locationClick.emit(this.location);\r\n  }\r\n\r\n  onSlideTouchStart() {\r\n    this.touchStart$.next();\r\n  }\r\n\r\n  async getSwiperIndex() {\r\n    const index = await (this.slider ? this.slider.getActiveIndex() : 0);\r\n    const isEnd = await (this.slider\r\n      ? this.slider.isEnd()\r\n      : Promise.resolve(false));\r\n    return isEnd ? (this.slides ? this.slides.length - 1 : 0) : index;\r\n  }\r\n\r\n  async onSlideTransitionEnd() {\r\n    this.activeIndex = await this.getSwiperIndex();\r\n    this.updateUi();\r\n  }\r\n}\r\n","<div class=\"slides-wrapper\" *ngIf=\"!isEmpty\" [ngClass]=\"{'animated-background': isSwiper, 'loaded': isSwiperLoaded }\">\r\n  <ion-slides *ngIf=\"isSwiper\" [options]=\"slideOptions\" [pager]=\"false\" [ngClass]=\"{'loaded': isSwiperLoaded}\"\r\n    (ionSlideTransitionEnd)=\"onSlideTransitionEnd()\" (ionSlidesDidLoad)=\"slidesLoaded($event)\"\r\n    (ionSlideTouchStart)=\"onSlideTouchStart()\">\r\n    <ion-slide *ngFor=\"let slide of slides; let i = index\" [ngSwitch]=\"slide.type\">\r\n      <app-offline-image *ngSwitchCase=\"'image'\" [src]=\"slide.img\" (click)=\"onImageClick(slide.img)\">\r\n      </app-offline-image>\r\n      <app-map-image *ngSwitchCase=\"'location'\" [location]=\"slide.img\" (click)=\"onLocationClick()\"></app-map-image>\r\n    </ion-slide>\r\n  </ion-slides>\r\n  <app-offline-image *ngIf=\"isSingleImage\" class=\"single\" (click)=\"onImageClick(imgUrl[0])\" [src]=\"imgUrl[0]\">\r\n  </app-offline-image>\r\n  <app-map-image *ngIf=\"isSingleMap\" class=\"single\" [location]=\"location\" (click)=\"onLocationClick()\">\r\n  </app-map-image>\r\n  <ion-label *ngIf=\"showLabel\" [ngClass]=\"{'loaded': isLoaded}\">\r\n    <span class=\"img-comment-header\" *ngIf=\"showIndex\">{{imageIndex + 1}}/{{imageLength}}&nbsp;</span>\r\n    <span [ngClass]=\"{'img-comment-header': slides[activeIndex].description }\"\r\n      *ngIf=\"slides[activeIndex].header\">{{ slides[activeIndex].header | translate }}<ng-container\r\n        *ngIf=\"slides[activeIndex].description\">:&nbsp;\r\n      </ng-container></span>\r\n    <ng-container *ngIf=\"slides[activeIndex].description\">{{ slides[activeIndex].description }}</ng-container>\r\n  </ion-label>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-legal-terms',\r\n  templateUrl: './legal-terms.component.html',\r\n  styleUrls: ['./legal-terms.component.scss']\r\n})\r\nexport class LegalTermsComponent implements OnInit {\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n}\r\n","<ion-grid class=\"full-grid legal-grid\">\r\n  <ion-row class=\"legal-info-row\">\r\n    <ion-col class=\"ion-padding ion-align-self-bottom\">\r\n      <div class=\"legal-icon\">&sect;\r\n      </div>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row class=\"legal-text-row\">\r\n    <ion-col align-self-top>\r\n      <h2>{{'LEGAL_TERMS.HEADER' | translate}}</h2>\r\n      <h3 class=\"ion-no-padding ion-text-wrap\">\r\n        <ul>\r\n          <li>{{'LEGAL_TERMS.LINE_1' | translate}}</li>\r\n          <li>{{'LEGAL_TERMS.LINE_2' | translate}}</li>\r\n          <li>{{'LEGAL_TERMS.LINE_3' | translate}}</li>\r\n        </ul>\r\n      </h3>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import {\r\n  Component,\r\n  Input,\r\n  OnChanges,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef\r\n} from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { settings } from '../../../../settings';\r\nimport {\r\n  AttachmentViewModel,\r\n  RegistrationViewModel,\r\n  Summary\r\n} from '@varsom-regobs-common/regobs-api';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport { FullscreenImageModalPage } from '../../../pages/modal-pages/fullscreen-image-modal/fullscreen-image-modal.page';\r\nimport { SocialSharing } from '@ionic-native/social-sharing/ngx';\r\nimport { ExternalLinkService } from '../../../core/services/external-link/external-link.service';\r\nimport * as utils from '@nano-sql/core/lib/utilities';\r\nimport * as L from 'leaflet';\r\nimport { ModalMapImagePage } from '../../../modules/map/pages/modal-map-image/modal-map-image.page';\r\nimport { AnalyticService } from '../../../modules/analytics/services/analytic.service';\r\nimport { AppEventCategory } from '../../../modules/analytics/enums/app-event-category.enum';\r\nimport { AppEventAction } from '../../../modules/analytics/enums/app-event-action.enum';\r\nimport { ImageLocation } from '../../img-swiper/image-location.model';\r\nimport 'leaflet.utm';\r\nimport { getStarCount } from '../../../core/helpers/competence-helper';\r\nimport { take } from 'rxjs/operators';\r\nimport { RegobsAuthService } from 'src/app/modules/auth/services/regobs-auth.service';\r\n\r\n@Component({\r\n  selector: 'app-observation-list-card',\r\n  templateUrl: './observation-list-card.component.html',\r\n  styleUrls: ['./observation-list-card.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ObservationListCardComponent implements OnChanges {\r\n  @Input() obs: RegistrationViewModel;\r\n\r\n  dtObsDate: string;\r\n  icon: string;\r\n  settings = settings;\r\n  header: string;\r\n  summaries: Summary[] = [];\r\n  allSelected = true;\r\n  loaded = false;\r\n  imageHeader = '';\r\n  imageDecription = '';\r\n  competenceLevel: number;\r\n  geoHazard: GeoHazard;\r\n\r\n  imageUrls: string[] = [];\r\n  imageHeaders: string[] = [];\r\n  imageDescriptions: string[] = [];\r\n  location: ImageLocation;\r\n\r\n  constructor(\r\n    private modalController: ModalController,\r\n    private externalLinkService: ExternalLinkService,\r\n    private userSettingService: UserSettingService,\r\n    private socialSharing: SocialSharing,\r\n    private cdr: ChangeDetectorRef,\r\n    private analyticService: AnalyticService,\r\n    private regobsAuthService: RegobsAuthService\r\n  ) {}\r\n\r\n  private async load() {\r\n    const baseUrl = await this.getBaseUrl();\r\n    this.geoHazard = <GeoHazard>this.obs.GeoHazardTID;\r\n    this.header = this.obs.ObsLocation.Title;\r\n    this.location = this.getLocation(this.obs);\r\n    this.dtObsDate = this.obs.DtObsTime;\r\n    this.icon = this.getGeoHazardCircleIcon(this.geoHazard);\r\n    this.summaries = this.obs.Summaries;\r\n    this.competenceLevel = getStarCount(this.obs.Observer.CompetenceLevelName);\r\n    this.updateImages(baseUrl);\r\n    this.loaded = true;\r\n\r\n    this.cdr.markForCheck();\r\n  }\r\n\r\n  private getLocation(obs: RegistrationViewModel): ImageLocation {\r\n    return {\r\n      latLng: L.latLng(\r\n        this.obs.ObsLocation.Latitude,\r\n        this.obs.ObsLocation.Longitude\r\n      ),\r\n      geoHazard: this.geoHazard,\r\n      startStopLocation: this.getStartStopLocation(obs),\r\n      damageLocations: this.getDamagePositions(obs)\r\n    };\r\n  }\r\n\r\n  private getStartStopLocation(\r\n    obs: RegistrationViewModel\r\n  ): { start?: L.LatLng; stop?: L.LatLng } {\r\n    if (obs.AvalancheObs) {\r\n      return {\r\n        start:\r\n          obs.AvalancheObs.StartLat && obs.AvalancheObs.StartLong\r\n            ? L.latLng(obs.AvalancheObs.StartLat, obs.AvalancheObs.StartLong)\r\n            : undefined,\r\n        stop:\r\n          obs.AvalancheObs.StopLong && obs.AvalancheObs.StopLong\r\n            ? L.latLng(obs.AvalancheObs.StopLat, obs.AvalancheObs.StopLong)\r\n            : undefined\r\n      };\r\n    }\r\n    if (obs.LandSlideObs) {\r\n      return {\r\n        start:\r\n          obs.LandSlideObs.StartLat && obs.LandSlideObs.StartLong\r\n            ? L.latLng(obs.LandSlideObs.StartLat, obs.LandSlideObs.StartLong)\r\n            : undefined,\r\n        stop:\r\n          obs.LandSlideObs.StopLat && obs.LandSlideObs.StopLong\r\n            ? L.latLng(obs.LandSlideObs.StopLat, obs.LandSlideObs.StopLong)\r\n            : undefined\r\n      };\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private getDamagePositions(obs: RegistrationViewModel) {\r\n    if (obs && obs.DamageObs && obs.DamageObs.some((d) => d.DamagePosition)) {\r\n      return obs.DamageObs.filter(\r\n        (d) =>\r\n          d.DamagePosition &&\r\n          d.DamagePosition.Latitude &&\r\n          d.DamagePosition.Longitude\r\n      ).map((d) =>\r\n        L.latLng(d.DamagePosition.Latitude, d.DamagePosition.Longitude)\r\n      );\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  ngOnChanges(): void {\r\n    this.load();\r\n  }\r\n\r\n  getGeoHazardCircleIcon(geoHazard: GeoHazard): string {\r\n    switch (geoHazard) {\r\n    case GeoHazard.Soil:\r\n      return '/assets/icon/dirt_circle.svg';\r\n    case GeoHazard.Ice:\r\n      return '/assets/icon/ice_circle.svg';\r\n    case GeoHazard.Snow:\r\n      return '/assets/icon/snow_circle.svg';\r\n    case GeoHazard.Water:\r\n      return '/assets/icon/water_circle.svg';\r\n    }\r\n  }\r\n\r\n  updateImages(baseUrl: string): void {\r\n    this.imageHeaders = this.obs.Attachments.map((x) => x.RegistrationName);\r\n    this.imageDescriptions = this.obs.Attachments.map((x) => x.Comment);\r\n    this.imageUrls = this.obs.Attachments.map((x) =>\r\n      this.getImageUrl(x)\r\n    );\r\n  }\r\n\r\n  getImageUrl(\r\n    attachment: AttachmentViewModel,\r\n    size: 'Thumbnail' | 'Medium' | 'Large' | 'Original' | 'Raw' = 'Large'\r\n  ): string {\r\n    return attachment.UrlFormats[size] || attachment.Url;\r\n  }\r\n\r\n  getRegistrationNames(): string {\r\n    return this.obs.Summaries.map((reg) => reg.RegistrationName).join(', ');\r\n  }\r\n\r\n  async openImage(event: { index: number; imgUrl: string }): Promise<void> {\r\n    const image = this.obs.Attachments[event.index];\r\n    const modal = await this.modalController.create({\r\n      component: FullscreenImageModalPage,\r\n      componentProps: {\r\n        imgSrc: `${this.getImageUrl(\r\n          image,\r\n          'Original'\r\n        )}?r=${utils.uuid()}`,\r\n        header: this.obs.Attachments[event.index].RegistrationName,\r\n        description: this.obs.Attachments[event.index].Comment\r\n      }\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n  async openLocation(location: {\r\n    latLng: L.LatLng;\r\n    geoHazard: GeoHazard;\r\n  }): Promise<void> {\r\n    const modal = await this.modalController.create({\r\n      component: ModalMapImagePage,\r\n      componentProps: {\r\n        location\r\n      }\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n  private async getBaseUrl() {\r\n    const userSetings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    return settings.services.regObs.webUrl[userSetings.appMode];\r\n  }\r\n\r\n  private getRegistrationUrl(baseUrl: string, loginHint?: string) {\r\n    return `${baseUrl}/Registration/${this.obs.RegId}${\r\n      loginHint ? `?login_hint=${loginHint}` : ''\r\n    }`;\r\n  }\r\n\r\n  async openWeb(): Promise<void> {\r\n    const baseUrl = await this.getBaseUrl();\r\n    const user = await this.regobsAuthService.getLoggedInUserAsPromise();\r\n    const url = this.getRegistrationUrl(baseUrl, user.email);\r\n    this.analyticService.trackEvent(\r\n      AppEventCategory.Observations,\r\n      AppEventAction.Click,\r\n      url,\r\n      this.obs.RegId\r\n    );\r\n    this.externalLinkService.openExternalLink(url);\r\n  }\r\n\r\n  async share(): Promise<void> {\r\n    const baseUrl = await this.getBaseUrl();\r\n    const url = this.getRegistrationUrl(baseUrl);\r\n    this.analyticService.trackEvent(\r\n      AppEventCategory.Observations,\r\n      AppEventAction.Share,\r\n      url,\r\n      this.obs.RegId\r\n    );\r\n    this.socialSharing.share(null, null, null, url);\r\n  }\r\n}\r\n","<ion-card *ngIf=\"loaded\">\r\n  <ion-card-header>\r\n    <h3 color=\"medium\">{{ header }}</h3>\r\n  </ion-card-header>\r\n  <ion-card-content>\r\n    <ion-grid class=\"ion-no-padding\">\r\n      <ion-row class=\"row-padding-start\">\r\n        <ion-col size=\"12\">\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/time.svg\"\r\n              [svgStyle]=\"{'width.px':16, 'height.px':16  }\"></svg-icon>\r\n            {{\r\n            dtObsDate | formatDate | async }}\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" [src]=\"icon\" [svgStyle]=\"{'width.px':16, 'height.px':16  }\">\r\n            </svg-icon>\r\n            <app-geo-name [geoHazards]=\"[geoHazard]\"></app-geo-name>\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/moh.svg\"\r\n              [svgStyle]=\"{'width.px':16, 'height.px':16  }\"></svg-icon>\r\n            {{\r\n            obs.ObsLocation.Height }}\r\n            {{'MAP_CENTER_INFO.ABOVE_SEA_LEVEL' | translate}}\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/user.svg\"\r\n              [svgStyle]=\"{'width.px':16, 'height.px':16  }\"></svg-icon>\r\n            {{obs.Observer.NickName}}\r\n            <app-competence [competenceLevel]=\"competenceLevel\"></app-competence>\r\n          </div>\r\n          <div class=\"card-icon-item\" *ngIf=\"obs.ObserverGroupName\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/usergroup.svg\"\r\n              [svgStyle]=\"{'width.px':16, 'height.px':16  }\"></svg-icon>\r\n            {{obs.ObserverGroupName }}\r\n          </div>\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row>\r\n        <ion-col size=\"12\" class=\"ion-no-padding\">\r\n          <app-img-swiper [location]=\"location\" [imgUrl]=\"imageUrls\" [imgHeaders]=\"imageHeaders\"\r\n            [imgComments]=\"imageDescriptions\" (imgClick)=\"openImage($event)\" (locationClick)=\"openLocation($event)\">\r\n          </app-img-swiper>\r\n        </ion-col>\r\n      </ion-row>\r\n      <!-- <ng-container *ngIf=\"summaries.length > 1\">\r\n        <ion-row class=\"row-padding-start\">\r\n          <ion-col size=\"12\">\r\n            <ion-badge (click)=\"toggleAllSelected()\" [color]=\"allSelected ? 'medium' : 'light'\" [ngClass]=\"{'outline': !allSelected}\">\r\n              {{'OBSERVATION_LIST.ALL_OBSERVATIONS' | translate}}\r\n            </ion-badge>\r\n            <ion-badge (click)=\"toggleRegistration(i)\" class=\"ion-text-wrap\" [color]=\"(s.open && (summaries.length <= 1 || !allSelected)) ? 'medium' : 'light'\"\r\n              *ngFor=\"let s of summaries; let i = index\" [ngClass]=\"{'outline': !(s.open && (summaries.length <= 1 || !allSelected))}\">\r\n              {{ s.summary.RegistrationName }}\r\n            </ion-badge>\r\n          </ion-col>\r\n        </ion-row>\r\n      </ng-container> -->\r\n      <ion-row class=\"row-padding-start\">\r\n        <ion-col size=\"12\">\r\n          <app-summary [summaries]=\"summaries\" [showHeaders]=\"false\"></app-summary>\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n    <ion-item class=\"ion-no-padding\" color=\"light\">\r\n      <ion-button mode=\"ios\" fill=\"clear\" class=\"link-title\" (click)=\"openWeb()\">\r\n        {{'OBSERVATION_LIST.GO_TO_OBSERVATION' | translate}}\r\n      </ion-button>\r\n      <ion-button mode=\"ios\" fill=\"clear\" class=\"reg-id\" slot=\"end\" (click)=\"share()\">\r\n        ID: {{ obs.RegId }}\r\n        <ion-icon slot=\"end\" class=\"share-icon\" name=\"share-social\"></ion-icon>\r\n      </ion-button>\r\n    </ion-item>\r\n  </ion-card-content>\r\n</ion-card>","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-observation-skeleton',\r\n  templateUrl: './observation-skeleton.component.html',\r\n  styleUrls: ['./observation-skeleton.component.scss']\r\n})\r\nexport class ObservationSkeletonComponent implements OnInit {\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n}\r\n","<ion-card>\r\n  <ion-card-header>\r\n    <h3>\r\n      <ion-skeleton-text class=\"skeleton-header\" animated></ion-skeleton-text> / <ion-skeleton-text\r\n        class=\"skeleton-header\" animated></ion-skeleton-text>\r\n    </h3>\r\n  </ion-card-header>\r\n  <ion-card-content>\r\n    <ion-grid class=\"ion-no-padding\">\r\n      <ion-row class=\"row-padding-start\">\r\n        <ion-col size=\"12\">\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/time.svg\"\r\n              [svgStyle]=\"{'width.px':15, 'height.px':15  }\"></svg-icon>\r\n            <ion-skeleton-text class=\"time-skeleton\" animated></ion-skeleton-text>\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/moh.svg\"\r\n              [svgStyle]=\"{'width.px':15, 'height.px':15  }\"></svg-icon>\r\n            <ion-skeleton-text class=\"moh-skeleton\" animated></ion-skeleton-text>\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/user.svg\"\r\n              [svgStyle]=\"{'width.px':15, 'height.px':15  }\"></svg-icon>\r\n            <ion-skeleton-text class=\"user-skeleton\" animated></ion-skeleton-text>\r\n          </div>\r\n          <div class=\"card-icon-item\">\r\n            <svg-icon class=\"card-icon-item-icon\" src=\"/assets/icon/usergroup.svg\"\r\n              [svgStyle]=\"{'width.px':15, 'height.px':15  }\"></svg-icon>\r\n            <ion-skeleton-text class=\"usergroup-skeleton\" animated></ion-skeleton-text>\r\n          </div>\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row>\r\n        <ion-col size=\"12\" class=\"ion-no-padding\">\r\n          <ion-skeleton-text class=\"skeleton-image\" animated></ion-skeleton-text>\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row>\r\n        <ion-col size=\"12\" class=\"ion-no-padding\">\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n    <ion-item class=\"ion-no-padding\" color=\"light\">\r\n      <ion-button mode=\"ios\" fill=\"clear\" class=\"link-title\">\r\n        {{'OBSERVATION_LIST.GO_TO_OBSERVATION' | translate}}\r\n      </ion-button>\r\n      <ion-button mode=\"ios\" fill=\"clear\" class=\"reg-id\" slot=\"end\">\r\n        ID: - <ion-icon slot=\"end\" class=\"share-icon\" name=\"share-social\"></ion-icon>\r\n      </ion-button>\r\n    </ion-item>\r\n  </ion-card-content>\r\n</ion-card>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { Summary } from '@varsom-regobs-common/regobs-api';\r\nimport { SummaryType } from '../../../core/models/summmary-type.enum';\r\n\r\n@Component({\r\n  selector: 'app-summary',\r\n  templateUrl: './summary.component.html',\r\n  styleUrls: ['./summary.component.scss']\r\n})\r\nexport class SummaryComponent implements OnInit {\r\n  @Input() summaries: Summary[];\r\n  @Input() showHeaders = true;\r\n\r\n  SummaryType = SummaryType;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n}\r\n","<div class=\"summaries\" *ngFor=\"let summary of summaries; let i = index\">\r\n  <ng-container *ngIf=\"summary.Summaries.length > 0\">\r\n    <h3>{{ summary.RegistrationName }}</h3>\r\n    <ng-container *ngFor=\"let genericValue of summary.Summaries; let i = index\">\r\n      <span *ngIf=\"i>0\" class=\"bullet\">&nbsp;&bull;&nbsp;</span>\r\n      <ng-container *ngTemplateOutlet=\"RegObsGenericValue; context:genericValue\">\r\n      </ng-container>\r\n    </ng-container>\r\n  </ng-container>\r\n</div>\r\n<ng-template #RegObsGenericValue let-kind=\"Kind\" let-header=\"Header\" let-value=\"Value\">\r\n  <ng-container [ngSwitch]=\"kind\">\r\n    <ng-container *ngSwitchCase=\"SummaryType.Text\">\r\n      <ng-container *ngTemplateOutlet=\"TextSummary\"></ng-container>\r\n    </ng-container>\r\n    <ng-container *ngSwitchCase=\"SummaryType.Url\">\r\n      <ng-container *ngTemplateOutlet=\"UrlSummary\"></ng-container>\r\n    </ng-container>\r\n    <ng-container *ngSwitchCase=\"SummaryType.List\">\r\n      <ng-container *ngTemplateOutlet=\"List\"></ng-container>\r\n    </ng-container>\r\n  </ng-container>\r\n  <ng-template #TextSummary>\r\n    <span *ngIf=\"showHeaders\">{{ header }}:&nbsp;</span><span>{{ value }}</span>\r\n  </ng-template>\r\n  <ng-template #UrlSummary>\r\n    <app-external-link [src]=\"value\">{{header}}</app-external-link>\r\n  </ng-template>\r\n  <ng-template #List>\r\n    <ng-container *ngFor=\"let item of value; let j = index\">\r\n      <span *ngIf=\"j>0\" class=\"bullet\">&nbsp;&bull;&nbsp;</span>\r\n      <ng-container *ngTemplateOutlet=\"RegObsGenericValue; context:item\"></ng-container>\r\n    </ng-container>\r\n  </ng-template>\r\n</ng-template>","import { createAnimation } from '@ionic/core';\r\nimport { transition, style, animate } from '@angular/animations';\r\n\r\nexport const DEFAULT_DURATION = 200;\r\nexport const EASE_IN_OUT_BACK = 'cubic-bezier(0.68, -0.55, 0.265, 1.55)';\r\nexport const EASE_IN_OUT = 'ease-in-out';\r\n\r\nexport class CustomAnimation {\r\n  static createScaleInInitialStyle(fromScale = 0, fromOpacity = 0) {\r\n    return style({\r\n      transform: `scale3d(${fromScale},${fromScale},1)`,\r\n      opacity: fromOpacity\r\n    }); // initial\r\n  }\r\n\r\n  static createScaleInAnimation(\r\n    delay = 0,\r\n    duration: number = DEFAULT_DURATION,\r\n    easing = EASE_IN_OUT\r\n  ) {\r\n    return animate(\r\n      `${duration}ms ${delay}ms ${easing}`,\r\n      style({ transform: 'scale3d(1,1,1)', opacity: 1 })\r\n    );\r\n  }\r\n\r\n  static createScaleInTransition(\r\n    delay = 0,\r\n    duration: number = DEFAULT_DURATION,\r\n    easing = EASE_IN_OUT,\r\n    fromScale = 0,\r\n    fromOpacity = 0\r\n  ) {\r\n    return [\r\n      CustomAnimation.createScaleInInitialStyle(fromScale, fromOpacity), // initial\r\n      CustomAnimation.createScaleInAnimation(delay, duration, easing)\r\n    ];\r\n  }\r\n\r\n  static createEnterScaleInAnimation(\r\n    delay = 0,\r\n    duration: number = DEFAULT_DURATION,\r\n    easing = EASE_IN_OUT,\r\n    fromScale = 0,\r\n    fromOpacity = 0\r\n  ) {\r\n    return [\r\n      transition(\r\n        ':enter',\r\n        CustomAnimation.createScaleInTransition(\r\n          delay,\r\n          duration,\r\n          easing,\r\n          fromScale,\r\n          fromOpacity\r\n        )\r\n      )\r\n    ];\r\n  }\r\n\r\n  static scaleUpEnter(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0.01, 0.4);\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(baseEl.querySelector('.modal-wrapper'));\r\n\r\n    wrapperAnimation\r\n      .beforeStyles({ transform: 'scale3d(0.7,0.7,0.7)', opacity: 0.01 })\r\n      .fromTo('transform', 'scale3d(0.7,0.7,0.7)', 'scale3d(1,1,1)')\r\n      .fromTo('opacity', 0.01, 1);\r\n\r\n    return Promise.resolve(\r\n      baseAnimation\r\n        .addElement(baseEl)\r\n        .easing(EASE_IN_OUT_BACK)\r\n        .duration(DEFAULT_DURATION)\r\n        .beforeAddClass('show-modal')\r\n        .addAnimation(backdropAnimation)\r\n        .addAnimation(wrapperAnimation)\r\n    );\r\n  }\r\n\r\n  static scaleUpEnterV2(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0, 0.4);\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(baseEl.querySelector('.modal-wrapper'));\r\n\r\n    wrapperAnimation\r\n      .beforeStyles({ transform: 'scale3d(0.7,1,0.7)', opacity: 0 })\r\n      .fromTo('transform', 'scale3d(0.7,1,0.7)', 'scale3d(1,1,1)')\r\n      .fromTo('opacity', 0, 1);\r\n\r\n    return Promise.resolve(\r\n      baseAnimation\r\n        .addElement(baseEl)\r\n        .duration(DEFAULT_DURATION)\r\n        .beforeAddClass('show-modal')\r\n        .addAnimation(backdropAnimation)\r\n        .addAnimation(wrapperAnimation)\r\n    );\r\n  }\r\n\r\n  static scaleUpLeave(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0.4, 0.0);\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(baseEl.querySelector('.modal-wrapper'));\r\n\r\n    wrapperAnimation\r\n      .addElement(baseEl.querySelector('.modal-wrapper'))\r\n      .beforeStyles({ transform: 'scale3d(1,1,1)', opacity: 1 })\r\n      .fromTo('transform', 'scale3d(1,1,1)', 'scale3d(0.6,0.6,0.6)')\r\n      .fromTo('opacity', 1, 0);\r\n\r\n    return Promise.resolve(\r\n      baseAnimation\r\n        .addElement(baseEl)\r\n        .easing('cubic-bezier(.1, .7, .1, 1)')\r\n        .duration(DEFAULT_DURATION)\r\n        .addAnimation(backdropAnimation)\r\n        .addAnimation(wrapperAnimation)\r\n    );\r\n  }\r\n\r\n  static scaleUpLeaveV2(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0.4, 0.0);\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(baseEl.querySelector('.modal-wrapper'));\r\n\r\n    wrapperAnimation\r\n      .addElement(baseEl.querySelector('.modal-wrapper'))\r\n      .beforeStyles({ transform: 'scale3d(1,1,1)', opacity: 1 })\r\n      .fromTo('transform', 'scale3d(1,1,1)', 'scale3d(0.6,1,0.6)')\r\n      .fromTo('opacity', 1, 0);\r\n\r\n    return Promise.resolve(\r\n      baseAnimation\r\n        .addElement(baseEl)\r\n        .duration(DEFAULT_DURATION)\r\n        .addAnimation(backdropAnimation)\r\n        .addAnimation(wrapperAnimation)\r\n    );\r\n  }\r\n\r\n  static slideInFromRight(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0.01, 0.4);\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(baseEl.querySelector('.modal-wrapper'));\r\n\r\n    wrapperAnimation\r\n      .beforeStyles({ transform: 'translateX(100%)', opacity: 0.01 })\r\n      .fromTo('transform', 'translateX(100%)', 'translateX(0)')\r\n      .fromTo('opacity', 0.01, 1);\r\n\r\n    return baseAnimation\r\n      .addElement(baseEl)\r\n      .easing('ease-in')\r\n      .duration(DEFAULT_DURATION)\r\n      .beforeAddClass('show-modal')\r\n      .addAnimation(backdropAnimation)\r\n      .addAnimation(wrapperAnimation);\r\n  }\r\n\r\n  static slideOutToRight(baseEl: HTMLElement, opts?: any) {\r\n    const baseAnimation = createAnimation();\r\n\r\n    const backdropAnimation = createAnimation();\r\n    backdropAnimation.addElement(baseEl.querySelector('ion-backdrop'));\r\n\r\n    backdropAnimation.fromTo('opacity', 0.4, 0.0);\r\n    const modalWrapperElement = baseEl.querySelector('.modal-wrapper');\r\n\r\n    const wrapperAnimation = createAnimation();\r\n    wrapperAnimation.addElement(modalWrapperElement);\r\n    const currentTranslateX = baseEl.getAttribute('data-offset-x');\r\n    const currentOpacity = baseEl.getAttribute('data-opacity');\r\n\r\n    wrapperAnimation\r\n      .fromTo(\r\n        'transform',\r\n        `translateX(${\r\n          currentTranslateX ? parseInt(currentTranslateX, 10) : 0\r\n        }%)`,\r\n        'translateX(100%)'\r\n      )\r\n      .fromTo('opacity', currentOpacity ? parseInt(currentOpacity, 10) : 0, 0);\r\n\r\n    return baseAnimation\r\n      .addElement(baseEl)\r\n      .easing('ease-out')\r\n      .duration(DEFAULT_DURATION)\r\n      .beforeAddClass('show-modal')\r\n      .addAnimation(backdropAnimation)\r\n      .addAnimation(wrapperAnimation);\r\n  }\r\n}\r\n","import { NgZone } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { NavController, Platform } from '@ionic/angular';\r\nimport { AuthService } from 'ionic-appauth';\r\nimport { App } from '@capacitor/app';\r\n\r\nexport function initDeepLinks(\r\n  platform: Platform,\r\n  ngZone: NgZone,\r\n  authService: AuthService,\r\n  navController: NavController,\r\n  router: Router\r\n) {\r\n  return () => {\r\n    if (platform.is('hybrid')) {\r\n      App.addListener('appUrlOpen', (data: any) => {\r\n        ngZone.run(() => {\r\n          if (data?.url.indexOf('regobs://callback') >= 0) {\r\n            authService.authorizationCallback(data.url);\r\n          } else {\r\n            const deepLinkRoute = router.createUrlTree([\r\n              data?.url.replace('regobs://', '')\r\n            ]);\r\n            navController.navigateForward(deepLinkRoute);\r\n          }\r\n        });\r\n      });\r\n    }\r\n  };\r\n}\r\n","import { ErrorHandler, Injectable } from '@angular/core';\r\nimport { LoggingService } from '../../modules/shared/services/logging/logging.service';\r\n\r\n@Injectable()\r\nexport class AppErrorHandler implements ErrorHandler {\r\n  constructor(private loggingService: LoggingService) {}\r\n\r\n  handleError(error: Error) {\r\n    this.loggingService.error(\r\n      error,\r\n      'UnhandledException',\r\n      'Unhandled exception occurred in app.'\r\n    );\r\n    throw error;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  CanActivate,\r\n  ActivatedRouteSnapshot,\r\n  RouterStateSnapshot,\r\n  Router\r\n} from '@angular/router';\r\nimport { RegobsAuthService } from '../../modules/auth/services/regobs-auth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AuthGuard implements CanActivate {\r\n  constructor(private router: Router, private authService: RegobsAuthService) {}\r\n\r\n  async canActivate(\r\n    _: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): Promise<boolean> {\r\n    const loggedInUser = await this.authService.getLoggedInUserAsPromise();\r\n    if (!loggedInUser.isLoggedIn) {\r\n      this.authService.signIn();\r\n    }\r\n    return loggedInUser.isLoggedIn;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  Router,\r\n  CanActivate,\r\n  ActivatedRouteSnapshot,\r\n  RouterStateSnapshot\r\n} from '@angular/router';\r\nimport { UserSettingService } from '../services/user-setting/user-setting.service';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class StartWizardGuard implements CanActivate {\r\n  constructor(\r\n    private router: Router,\r\n    private userSettingService: UserSettingService\r\n  ) {}\r\n\r\n  async canActivate(\r\n    next: ActivatedRouteSnapshot,\r\n    state: RouterStateSnapshot\r\n  ): Promise<boolean> {\r\n    const userSetting = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    if (!userSetting.completedStartWizard) {\r\n      setTimeout(() => {\r\n        this.router.navigate(['start-wizard']);\r\n      }, 200); // Added 200ms timeout because of white screen on startup, this seems to help.\r\n    }\r\n\r\n    return userSetting.completedStartWizard;\r\n  }\r\n}\r\n","export class CancelPromiseTimer extends Promise<void> {\r\n  static createCancelPromiseTimer(timeoutMs: number) {\r\n    return new Promise<void>((resolve) => {\r\n      const id = setTimeout(() => {\r\n        clearTimeout(id);\r\n        resolve();\r\n      }, timeoutMs);\r\n    });\r\n  }\r\n}\r\n","export function getStarCount(competenceLevel: string): number {\r\n  if (!competenceLevel) {\r\n    return 0;\r\n  }\r\n  return competenceLevel.split('').filter((s) => s === '*').length;\r\n}\r\n","import { Observable, of } from 'rxjs';\r\n\r\nconst BASE64_MARKER = ';base64,';\r\n\r\nexport class DataUrlHelper {\r\n  static async toDataUrlWithSize(\r\n    blob: Blob,\r\n    mimeType: string\r\n  ): Promise<{ dataUrl: string; size: number }> {\r\n    const dataUrl = await this.toDataUrl(blob, mimeType);\r\n    return { size: blob.size, dataUrl };\r\n  }\r\n\r\n  static async toDataUrlWithSizeFromArrayBuffer(\r\n    buffer: ArrayBuffer,\r\n    mimeType: string\r\n  ): Promise<{ dataUrl: string; size: number }> {\r\n    const dataUrl = await this.toDataUrl(\r\n      new Blob([new Uint8Array(buffer, 0, buffer.byteLength)]),\r\n      mimeType\r\n    );\r\n    return { size: buffer.byteLength, dataUrl };\r\n  }\r\n\r\n  static getDataUrlFromSrcUrl(\r\n    src: string,\r\n    mimeType = 'image/jpeg'\r\n  ): Promise<string> {\r\n    return new Promise((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.onload = async () => {\r\n        const result = await DataUrlHelper.toDataUrl(\r\n          <Blob>xhr.response,\r\n          mimeType\r\n        );\r\n        resolve(result);\r\n      };\r\n      xhr.onabort = () => reject();\r\n      xhr.onerror = () => reject();\r\n      xhr.open('GET', src);\r\n      xhr.responseType = 'blob';\r\n      xhr.send();\r\n    });\r\n  }\r\n\r\n  static toDataUrl(blob: Blob, mimeType: string) {\r\n    return new Promise<string>((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () =>\r\n        resolve(this.ensureCorrectMimeType(reader.result as string, mimeType));\r\n      reader.onerror = () => reject();\r\n      reader.onabort = () => reject();\r\n      reader.readAsDataURL(blob);\r\n    });\r\n  }\r\n\r\n  private static ensureCorrectMimeType(dataUrl: string, mimeType: string) {\r\n    if (dataUrl.startsWith(`data:${mimeType};`)) {\r\n      return dataUrl;\r\n    } else {\r\n      const index = dataUrl.indexOf(BASE64_MARKER) + BASE64_MARKER.length;\r\n      return `data:${mimeType}${BASE64_MARKER}${dataUrl.substr(index)}`;\r\n    }\r\n  }\r\n\r\n  static convertDataURIToBinary(dataUri: string) {\r\n    const index = dataUri.indexOf(BASE64_MARKER) + BASE64_MARKER.length;\r\n    const base64 = dataUri.substring(index);\r\n    const raw = atob(base64);\r\n    const rawLength = raw.length;\r\n    const array = new Uint8Array(rawLength);\r\n\r\n    for (let i = 0; i < rawLength; i++) {\r\n      array[i] = raw.charCodeAt(i);\r\n    }\r\n    return array;\r\n  }\r\n\r\n  static getDataUriByteLength(dataUri: string) {\r\n    const blob = this.convertDataURIToBinary(dataUri);\r\n    return blob.length;\r\n  }\r\n}\r\n","import { Platform } from '@ionic/angular';\r\n\r\nexport function isAndroidOrIos(platform: Platform): boolean {\r\n  return (\r\n    platform.is('hybrid') && (platform.is('android') || platform.is('ios'))\r\n  );\r\n}\r\n","import * as L from 'leaflet';\r\nimport { settings } from '../../../../settings';\r\nimport { of } from 'rxjs';\r\nimport {\r\n  bboxPolygon,\r\n  GeometryObject,\r\n  booleanWithin,\r\n  point,\r\n  Feature\r\n} from '@turf/turf';\r\nexport const SVALBARD_BOUNDS = L.latLngBounds(\r\n  settings.map.bounds.svalbard.bbox.map((coordinate) =>\r\n    L.latLng(coordinate[0], coordinate[1])\r\n  )\r\n);\r\nexport const NORWEGIAN_BOUNDS = require('../../../../assets/json/norway-mainland-simple.json')\r\n  .features[0].geometry;\r\n// export const NORWEGIAN_LATLNG_BOUNDS = L.geoJSON(NORWEGIAN_BOUNDS);\r\n\r\nexport class BorderHelper {\r\n  static isInSvalbard(latLng: L.LatLng, bounds = SVALBARD_BOUNDS) {\r\n    return bounds.contains(latLng);\r\n  }\r\n\r\n  static isInNorway(latLng: L.LatLng) {\r\n    const p = point([latLng.lng, latLng.lat]);\r\n    return booleanWithin(p, NORWEGIAN_BOUNDS);\r\n  }\r\n\r\n  static getSvalbardPolygon() {\r\n    return bboxPolygon(this.toBBox(SVALBARD_BOUNDS));\r\n  }\r\n\r\n  static getLatLngBoundInSvalbardOrNorwayAsObservable(latLng: L.LatLng) {\r\n    return this.isInSvalbard(latLng)\r\n      ? of({ inSvalbard: true, inNorway: true })\r\n      : this.isInNorway(latLng)\r\n        ? of({ inSvalbard: false, inNorway: true })\r\n        : of({ inSvalbard: false, inNorway: false });\r\n  }\r\n\r\n  static toBBox(\r\n    latLngBounds: L.LatLngBounds\r\n  ): [number, number, number, number] {\r\n    return [\r\n      latLngBounds.getSouthWest().lng, // minx\r\n      latLngBounds.getSouthWest().lat, // miny\r\n      latLngBounds.getNorthEast().lng, // maxx\r\n      latLngBounds.getNorthEast().lat // maxy\r\n    ];\r\n  }\r\n\r\n  static isInside(\r\n    latLngBounds: L.LatLngBounds,\r\n    geometry: Feature<GeometryObject>\r\n  ) {\r\n    return booleanWithin(bboxPolygon(this.toBBox(latLngBounds)), geometry);\r\n  }\r\n}\r\n","import * as L from 'leaflet';\r\nimport { Subscription } from 'rxjs';\r\nimport { Position } from '@capacitor/geolocation';\r\n\r\nexport class UserMarker {\r\n  userMarker: L.Marker;\r\n  userMarkerIcon: L.DivIcon;\r\n  headingSubscription: Subscription;\r\n  accuracyMarker: L.Circle;\r\n  map: L.Map;\r\n  position: Position;\r\n  watchId: number;\r\n\r\n  accuracyCircleStyle = {\r\n    stroke: true,\r\n    color: '#03f',\r\n    weight: 3,\r\n    opacity: 0.5,\r\n    fillOpacity: 0.15,\r\n    fillColor: '#03f',\r\n    clickable: false\r\n  };\r\n\r\n  constructor(map: L.Map, position: Position) {\r\n    this.map = map;\r\n    this.position = position;\r\n    this.userMarkerIcon = L.divIcon({\r\n      className: 'leaflet-usermarker',\r\n      iconSize: [18, 18],\r\n      html: '<div class=\\'heading\\'></div><i class=\\'pulse\\'></i>'\r\n    });\r\n    const latLng = {\r\n      lat: position.coords.latitude,\r\n      lng: position.coords.longitude\r\n    };\r\n    this.userMarker = L.marker(latLng, { icon: this.userMarkerIcon });\r\n    this.userMarker.addTo(this.map);\r\n    this.setAccuracy(position);\r\n  }\r\n\r\n  getPosition(): Position {\r\n    return this.position;\r\n  }\r\n\r\n  updatePosition(position: Position) {\r\n    this.position = position;\r\n    const latLng = {\r\n      lat: position.coords.latitude,\r\n      lng: position.coords.longitude\r\n    };\r\n    this.userMarker.setLatLng(latLng);\r\n    this.setAccuracy(position);\r\n    // if (position.coords.heading !== null) {\r\n    //     this.setHeading(position.coords.heading);\r\n    // }\r\n    // NOTE: This is set by compass instead of gps\r\n  }\r\n\r\n  setHeading(degrees: number) {\r\n    const element: HTMLElement = this.userMarker.getElement()\r\n      .childNodes[0] as HTMLElement;\r\n    const rotateZ = degrees - 90;\r\n    element.style['-webkit-transform'] =\r\n      'rotate(' + rotateZ + 'deg) translateX(15px)';\r\n    element.style.display = 'block';\r\n  }\r\n\r\n  private setAccuracy(position: Position) {\r\n    const latLng = {\r\n      lat: position.coords.latitude,\r\n      lng: position.coords.longitude\r\n    };\r\n    if (!this.accuracyMarker) {\r\n      this.accuracyMarker = L.circle(\r\n        latLng,\r\n        position.coords.accuracy,\r\n        this.accuracyCircleStyle\r\n      );\r\n      this.accuracyMarker.addTo(this.map);\r\n    } else {\r\n      this.accuracyMarker.setRadius(position.coords.accuracy);\r\n      this.accuracyMarker.setLatLng(latLng);\r\n    }\r\n  }\r\n}\r\n","import { InanoSQLObserverQuery } from '@nano-sql/core/lib/interfaces';\r\nimport { Observable } from 'rxjs';\r\n\r\nexport class NSqlFullUpdateObservable<T> extends Observable<T> {\r\n  constructor(query: InanoSQLObserverQuery) {\r\n    super((observer) => {\r\n      query.exec((val, err) => {\r\n        if (err) {\r\n          observer.error(err);\r\n        } else {\r\n          observer.next((val as unknown) as T);\r\n        }\r\n      });\r\n      return () => query.unsubscribe();\r\n    });\r\n  }\r\n}\r\n","export class NumberHelper {\r\n  static isNumeric(n: any) {\r\n    return !isNaN(parseFloat(n)) && isFinite(n);\r\n  }\r\n\r\n  static setDecimalPlaces(n: number, decimalPlaces?: number) {\r\n    if (this.isNumeric(n)) {\r\n      // return parseFloat(n.toFixed(decimalPlaces));\r\n      const sign = n >= 0 ? 1 : -1;\r\n      return parseFloat(\r\n        (\r\n          Math.round(n * Math.pow(10, decimalPlaces) + sign * 0.0001) /\r\n          Math.pow(10, decimalPlaces)\r\n        ).toFixed(decimalPlaces)\r\n      );\r\n    } else {\r\n      return n;\r\n    }\r\n  }\r\n\r\n  static isNullOrEmpty(n: any) {\r\n    return n === undefined || n === null || n === '';\r\n  }\r\n\r\n  static isValid(\r\n    n: any,\r\n    min?: number,\r\n    max?: number,\r\n    required = false,\r\n    integer = false\r\n  ) {\r\n    if (required && this.isNullOrEmpty(n)) {\r\n      return false;\r\n    }\r\n    if (!required && this.isNullOrEmpty(n)) {\r\n      return true;\r\n    }\r\n    if (!this.isNumeric(n)) {\r\n      return false;\r\n    }\r\n    const nNumverValue = parseFloat(n);\r\n    if (integer && !Number.isInteger(nNumverValue)) {\r\n      return false;\r\n    }\r\n    if (min !== undefined && nNumverValue < min) {\r\n      return false;\r\n    }\r\n    if (max !== undefined && nNumverValue > max) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","import { Observable, Subject, Subscription } from 'rxjs';\r\nimport { NgZone, OnDestroy, Injectable } from '@angular/core';\r\nimport { timeout } from 'rxjs/operators';\r\n\r\nexport function toPromiseWithCancel<T>(\r\n  observable: Observable<T>,\r\n  cancel?: Promise<void>,\r\n  timeoutInMs?: number,\r\n) {\r\n  return new Promise<T>((resolve, reject) => {\r\n    let subscription: Subscription = undefined;\r\n    subscription =\r\n    (timeoutInMs != null ? observable.pipe(timeout(timeoutInMs)) : observable).subscribe({\r\n      next: (result) => {\r\n        if(subscription) {\r\n          subscription.unsubscribe();\r\n        }\r\n        resolve(result);\r\n      },\r\n      error: (error) => {\r\n        if(subscription) {\r\n          subscription.unsubscribe();\r\n        }\r\n        reject(error);\r\n      }\r\n    });\r\n    if (cancel) {\r\n      cancel.then(() => {\r\n        if(subscription) {\r\n          subscription.unsubscribe();\r\n        }\r\n        reject(new Error('Cancelled'));\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nexport function enterZone(zone: NgZone) {\r\n  return <T>(source: Observable<T>) =>\r\n    new Observable<T>((observer) =>\r\n      source.subscribe({\r\n        next: (x) => zone.run(() => observer.next(x)),\r\n        error: (err) => observer.error(err),\r\n        complete: () => observer.complete()\r\n      })\r\n    );\r\n}\r\n\r\nexport function setObservableTimeout() {\r\n  return <T>(source: Observable<T>) =>\r\n    new Observable<T>((observer) =>\r\n      source.subscribe({\r\n        next: (x) => setTimeout(() => observer.next(x)),\r\n        error: (err) => observer.error(err),\r\n        complete: () => observer.complete()\r\n      })\r\n    );\r\n}\r\n\r\n@Injectable()\r\nexport class NgDestoryBase implements OnDestroy {\r\n  protected readonly ngDestroy$: Subject<void>;\r\n  constructor() {\r\n    this.ngDestroy$ = new Subject();\r\n  }\r\n  ngOnDestroy(): void {\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n}\r\n","import { catchError, map, switchMap, tap } from 'rxjs/operators';\r\nimport {\r\n  HttpRequest,\r\n  HttpInterceptor,\r\n  HttpHandler,\r\n  HttpEvent,\r\n  HttpEventType\r\n} from '@angular/common/http';\r\nimport { EMPTY, from, Observable } from 'rxjs';\r\nimport { Injectable } from '@angular/core';\r\nimport { settings } from '../../../settings';\r\nimport { LoggingService } from 'src/app/modules/shared/services/logging/logging.service';\r\nimport {\r\n  RegobsAuthService,\r\n  TOKEN_RESPONSE_FULL_KEY\r\n} from 'src/app/modules/auth/services/regobs-auth.service';\r\nimport { StorageBackend } from '@openid/appauth';\r\n\r\n/**\r\n * Sender innloggings-token med kall til Regobs API der kallene krever at man er logget inn.\r\n * Hvis api-kallet feiler pga. innloggingsfeil (HTTP 401), prøver vi å fornye tokenet og kjører kallet en gang til\r\n */\r\n@Injectable()\r\nexport class ApiInterceptor implements HttpInterceptor {\r\n  constructor(\r\n    private regobsAuthService: RegobsAuthService,\r\n    private loggerService: LoggingService,\r\n    private storage: StorageBackend\r\n  ) {}\r\n\r\n  private isRegObsApi(url: string): boolean {\r\n    return (\r\n      url.startsWith(\r\n        `${settings.services.regObs.apiUrl['TEST']}/Registration`\r\n      ) ||\r\n      url.startsWith(\r\n        `${settings.services.regObs.apiUrl['DEMO']}/Registration`\r\n      ) ||\r\n      url.startsWith(\r\n        `${settings.services.regObs.apiUrl['PROD']}/Registration`\r\n      ) ||\r\n      url.startsWith(`${settings.services.regObs.apiUrl['TEST']}/Account`) ||\r\n      url.startsWith(`${settings.services.regObs.apiUrl['DEMO']}/Account`) ||\r\n      url.startsWith(`${settings.services.regObs.apiUrl['PROD']}/Account`)\r\n    );\r\n  }\r\n\r\n  private isB2cApi(url: string): boolean {\r\n    return url.indexOf('/token') > -1;\r\n  }\r\n\r\n  intercept(\r\n    req: HttpRequest<unknown>,\r\n    next: HttpHandler\r\n  ): Observable<HttpEvent<unknown>> {\r\n    if (this.isB2cApi(req.url)) {\r\n      return next.handle(req).pipe(\r\n        tap((response) => {\r\n          if (response.type === HttpEventType.Response) {\r\n            this.storage.setItem(\r\n              TOKEN_RESPONSE_FULL_KEY,\r\n              JSON.stringify(response.body)\r\n            );\r\n          }\r\n        })\r\n      );\r\n    }\r\n    if (this.isRegObsApi(req.url) && !req.headers.has('Authorization')) {\r\n      return this.addAuthHeader(req).pipe(\r\n        switchMap((requestWithAuthHeader) => {\r\n          return next.handle(requestWithAuthHeader).pipe(\r\n            catchError((err) => {\r\n              return this.handleResponseError(err, requestWithAuthHeader, next);\r\n            })\r\n          );\r\n        })\r\n      );\r\n    }\r\n    return next.handle(req);\r\n  }\r\n\r\n  private addAuthHeader(\r\n    request: HttpRequest<unknown>\r\n  ): Observable<HttpRequest<unknown>> {\r\n    return this.regobsAuthService.loggedInUser$.pipe(\r\n      catchError((err) => {\r\n        this.loggerService.debug(\r\n          'Could not get valid token',\r\n          'API interceptor',\r\n          err\r\n        );\r\n        this.regobsAuthService.signIn();\r\n        return EMPTY; //TODO: Why this?\r\n      }),\r\n      map((user) => {\r\n        const headers = request.headers.set(\r\n          'Authorization',\r\n          `Bearer ${user.token}`\r\n        );\r\n        return request.clone({ headers });\r\n      })\r\n    );\r\n  }\r\n\r\n  private handleResponseError(\r\n    error,\r\n    request,\r\n    next: HttpHandler\r\n  ): Observable<HttpEvent<unknown>> {\r\n    if (error.status === 401) {\r\n      // Vi er ikke autorisert, trolig fordi tokenet ikke er gyldig\r\n      this.loggerService.debug(\r\n        'Got 401 from API, trying to refresh token and repeat API-call...'\r\n      );\r\n      return from(this.regobsAuthService.refreshToken()).pipe(\r\n        switchMap(() => this.addAuthHeader(request)),\r\n        switchMap((req) => next.handle(req))\r\n      );\r\n    }\r\n    throw error;\r\n  }\r\n}\r\n","export enum SummaryType {\r\n  List = 0,\r\n  Text = 1,\r\n  Url = 2\r\n}\r\n","export enum TopoMap {\r\n  default = 'mixArcGisOnline',\r\n  openTopo = 'openTopo',\r\n  arcGisOnline = 'arcGisOnline',\r\n  statensKartverk = 'statensKartverk',\r\n  mixArcGisOnline = 'mixArcGisOnlineV2',\r\n  mixOpenTopo = 'mixOpenTopo',\r\n  geoDataLandskap = 'geoDataLandskap',\r\n  mixGeoDataLandskap = 'mixGeoDataLandskap'\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AppVersion } from '../../models/app-version.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AppVersionService {\r\n  getAppVersion(): AppVersion {\r\n    try {\r\n      // tslint:disable-next-line:no-var-requires\r\n      return require('../../../../environments/version.json');\r\n    } catch {\r\n      return {\r\n        version: '0.0.0',\r\n        buildNumber: 0,\r\n        revision: '',\r\n        branch: '',\r\n        date: new Date().toISOString()\r\n      };\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { DownloadProgress } from './download-progress';\r\n\r\n@Injectable()\r\nexport abstract class BackgroundDownloadService {\r\n  abstract download(\r\n     url: string\r\n  ): Observable<DownloadProgress>\r\n  // abstract downloadFile(\r\n  //   path: string,\r\n  //   filename: string,\r\n  //   url: string,\r\n  //   onComplete: () => void,\r\n  //   onProgress: (progress: Progress) => void,\r\n  //   onError: (error: Error) => void,\r\n  //   skipLocationSelector?: boolean\r\n  // ): Promise<void>;\r\n  // abstract cancelDownload(filename: string);\r\n  // abstract deleteFolder(path: string, dirName: string): Promise<void>;\r\n  // abstract getFileUrl(path: string, filename: string): Promise<string>;\r\n  // abstract selectDowloadFolder(): Promise<string>;\r\n  // abstract getAllFiles(path: string, dirName: string): Promise<{ directory: string, name: string, url: string, size: number }[]>;\r\n  // abstract downloadToDataUrl(url: string, type: string): Promise<{ dataUrl: string, size: number }>;\r\n}\r\n","import { HttpClient, HttpEvent, HttpEventType, HttpProgressEvent, HttpResponse } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { scan } from 'rxjs/operators';\r\nimport { BackgroundDownloadService } from './background-download.service';\r\nimport { DownloadProgress } from './download-progress';\r\n\r\n@Injectable()\r\nexport class HttpClientDownloadService implements BackgroundDownloadService {\r\n\r\n  constructor(private http: HttpClient) {\r\n  }\r\n\r\n  download(url: string): Observable<DownloadProgress> {\r\n    return this.http.get(url, {\r\n      reportProgress: true,\r\n      observe: 'events',\r\n      responseType: 'blob'\r\n    }).pipe(scan((previous: DownloadProgress, event: HttpEvent<Blob>): DownloadProgress => {\r\n      if (this.isHttpProgressEvent(event)) {\r\n        return {\r\n          progress: event.total\r\n            ?  (event.loaded / event.total)\r\n            : previous.progress,\r\n          state: 'IN_PROGRESS',\r\n          loaded: event.loaded,\r\n          total: event.total,\r\n          content: null\r\n        };\r\n      }\r\n      if (this.isHttpResponse(event)) {\r\n        return {\r\n          progress: 100,\r\n          state: 'DONE',\r\n          total: event.body.size,\r\n          loaded: event.body.size,\r\n          content: event.body\r\n        };\r\n      }\r\n      return previous;\r\n    },\r\n    {state: 'PENDING', progress: 0, loaded: 0, content: null}\r\n    ));\r\n  }\r\n\r\n  private isHttpResponse<T>(event: HttpEvent<T>): event is HttpResponse<T> {\r\n    return event.type === HttpEventType.Response;\r\n  }\r\n\r\n  private isHttpProgressEvent(event: HttpEvent<unknown>): event is HttpProgressEvent {\r\n    return event.type === HttpEventType.DownloadProgress\r\n        || event.type === HttpEventType.UploadProgress;\r\n  }\r\n}","import { Injectable } from '@angular/core';\r\nimport { BackgroundGeolocationService } from './background-geolocation.service';\r\n// import { BackgroundGeolocationConfig, BackgroundGeolocationResponse } from '@ionic-native/background-geolocation';\r\nimport { Platform } from '@ionic/angular';\r\nimport { TripLoggerService } from '../trip-logger/trip-logger.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Geolocation } from '@capacitor/geolocation';\r\nimport { TripLogState } from '../trip-logger/trip-log-state.enum';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\n\r\nconst DEBUG_TAG = 'BackgroundGeolocationNativeService';\r\n\r\n@Injectable()\r\nexport class BackgroundGeolocationNativeService\r\nimplements BackgroundGeolocationService {\r\n  backgroundGeolocation: any;\r\n\r\n  constructor(\r\n    private platform: Platform,\r\n    private tripLogger: TripLoggerService,\r\n    private translateService: TranslateService,\r\n    private geolocation: Geolocation,\r\n    private loggingService: LoggingService\r\n  ) {\r\n    this.platform.ready().then(() => {\r\n      this.backgroundGeolocation = (<any>window).BackgroundGeolocation;\r\n    });\r\n  }\r\n\r\n  private async configureBackgroundGeoLocation() {\r\n    await this.platform.ready();\r\n    const translations = await this.translateService\r\n      .get([\r\n        'GEOLOCATION_SERVICE.NOTIFICATION_TITLE',\r\n        'GEOLOCATION_SERVICE.NOTIFICATION_TEXT'\r\n      ])\r\n      .toPromise();\r\n    // const config: BackgroundGeolocationConfig = {\r\n    //     locationProvider: this.backgroundGeolocation.DISTANCE_FILTER_PROVIDER, // ANDROID_DISTANCE_FILTER_PROVIDER\r\n    //     desiredAccuracy: this.backgroundGeolocation.LOW_ACCURACY, // Low\r\n    //     stationaryRadius: 50,\r\n    //     distanceFilter: 50,\r\n    //     debug: false, //  enable this hear sounds for background-geolocation life-cycle.\r\n    //     stopOnTerminate: false, // enable this to clear background location settings when the app terminate\r\n    //     startForeground: true,\r\n    //     notificationTitle: translations['GEOLOCATION_SERVICE.NOTIFICATION_TITLE'],\r\n    //     notificationText: translations['GEOLOCATION_SERVICE.NOTIFICATION_TEXT'],\r\n    //     activityType: 'OtherNavigation',\r\n    //     maxLocations: 1, // Disable local storage of locations, because we handle this in nanoSQL instead\r\n    // };\r\n    // this.backgroundGeolocation.configure(config, () => {\r\n    //     this.loggingService.debug('BackgroundGeolocation set up success!', DEBUG_TAG);\r\n    // }, (error) => {\r\n    //     this.loggingService.error(error, DEBUG_TAG, 'Could not configure background geolocation!');\r\n    // });\r\n  }\r\n\r\n  // savePositionUpdate(location: BackgroundGeolocationResponse) {\r\n  //     return this.tripLogger.saveTripLogItem({\r\n  //         latitude: location.latitude,\r\n  //         longitude: location.longitude,\r\n  //         timestamp: location.time,\r\n  //         accuracy: location.accuracy,\r\n  //         altitude: location.altitude,\r\n  //         heading: location.bearing,\r\n  //         speed: location.speed\r\n  //     });\r\n  // }\r\n\r\n  async start() {\r\n    // await this.tripLogger.updateState(TripLogState.Running);\r\n    // await this.configureBackgroundGeoLocation();\r\n    // this.backgroundGeolocation.on('location', (location: BackgroundGeolocationResponse) => {\r\n    //     // handle your locations here\r\n    //     // to perform long running operation on iOS\r\n    //     // you need to create background task\r\n    //     this.backgroundGeolocation.startTask(async (taskKey) => {\r\n    //         // execute long running task\r\n    //         // eg. ajax post location\r\n    //         // IMPORTANT: task has to be ended by endTask\r\n    //         try {\r\n    //             await this.savePositionUpdate(location);\r\n    //         } catch (error) {\r\n    //             this.loggingService.error(error, DEBUG_TAG, 'Error saving position update!');\r\n    //         } finally {\r\n    //             this.backgroundGeolocation.endTask(taskKey);\r\n    //         }\r\n    //     });\r\n    // });\r\n    // this.backgroundGeolocation.on('error', async (error) => {\r\n    //     this.loggingService.error(\r\n    //         new Error(`Error code: ${error.code}. Message:${error.message}`),\r\n    //         DEBUG_TAG, 'Error in background geolocation!');\r\n    //     await this.tripLogger.updateState(TripLogState.Paused);\r\n    // });\r\n    // this.backgroundGeolocation.on('start', () => {\r\n    //     this.loggingService.debug('BackgroundGeolocation service has been started', DEBUG_TAG);\r\n    // });\r\n    // this.backgroundGeolocation.on('stop', () => {\r\n    //     this.loggingService.debug('BackgroundGeolocation service has been stopped', DEBUG_TAG);\r\n    // });\r\n    // this.backgroundGeolocation.on('authorization', (status) => {\r\n    //     this.loggingService.debug('BackgroundGeolocation authorization status', DEBUG_TAG, status);\r\n    //     if (status !== this.backgroundGeolocation.AUTHORIZED) {\r\n    //         return this.backgroundGeolocation.showAppSettings();\r\n    //     }\r\n    // });\r\n    // this.backgroundGeolocation.checkStatus((status) => {\r\n    //     this.loggingService.debug('BackgroundGeolocation service status', DEBUG_TAG, status);\r\n    //     // you don't need to check status before start (this is just the example)\r\n    //     if (!status.isRunning) {\r\n    //         this.backgroundGeolocation.start(); // triggers start on start event\r\n    //     }\r\n    // });\r\n  }\r\n\r\n  async stop() {\r\n    // await this.platform.ready();\r\n    // await this.tripLogger.updateState(TripLogState.Paused);\r\n    // this.backgroundGeolocation.stop();\r\n    // const lastPosition = await this.geolocation.getCurrentPosition({\r\n    //     enableHighAccuracy: true,\r\n    //     maximumAge: 60 * 1000,\r\n    // });\r\n    // if (lastPosition.coords) {\r\n    //     await this.tripLogger.saveTripLogItem({\r\n    //         latitude: lastPosition.coords.latitude,\r\n    //         longitude: lastPosition.coords.longitude,\r\n    //         accuracy: lastPosition.coords.accuracy,\r\n    //         altitude: lastPosition.coords.altitude,\r\n    //         speed: lastPosition.coords.speed,\r\n    //         timestamp: lastPosition.timestamp,\r\n    //         heading: lastPosition.coords.heading,\r\n    //     });\r\n    // }\r\n    // this.tripLogger.updateState(TripLogState.Paused);\r\n    // for (const event of this.backgroundGeolocation.events) {\r\n    //     return this.backgroundGeolocation.removeAllListeners(event);\r\n    // }\r\n  }\r\n\r\n  isRunning(): Promise<boolean> {\r\n    return Promise.resolve(false);\r\n    // return new Promise((resolve) => {\r\n    //     this.backgroundGeolocation.checkStatus((status) => {\r\n    //         resolve(status.isRunning);\r\n    //     });\r\n    // });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BackgroundGeolocationService } from './background-geolocation.service';\r\nimport { Subscription } from 'rxjs';\r\n// import {\r\n//   Geoposition,\r\n//   Geolocation,\r\n//   PositionError\r\n// } from '@ionic-native/geolocation/ngx';\r\nimport { TripLoggerService } from '../trip-logger/trip-logger.service';\r\nimport { TripLogState } from '../trip-logger/trip-log-state.enum';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\n\r\n//TODO: Har kommentert ut denne servicen når vi fjernet @ionic-native/geolocation/ngx, siden det later til at den ikke er i bruk. Vurder om vi skal slette servicen!\r\n@Injectable()\r\nexport class BackgroundGeolocationWebService\r\nimplements BackgroundGeolocationService {\r\n  watchSubscription?: Subscription;\r\n\r\n  constructor(\r\n    private geolocation: Geolocation,\r\n    private tripLogger: TripLoggerService,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  async start() {\r\n    // await this.tripLogger.updateState(TripLogState.Running);\r\n    // this.watchSubscription = this.geolocation\r\n    //   .watchPosition({ maximumAge: 60000, enableHighAccuracy: true })\r\n    //   .subscribe(\r\n    //     (data) => this.onPositionUpdate(data),\r\n    //     (error) => this.onPositionError(error)\r\n    //   );\r\n  }\r\n\r\n  // private onPositionUpdate(data: Geoposition | PositionError) {\r\n  //   // data can be a set of coordinates, or an error (if an error occurred).\r\n  //   // data.coords.latitude\r\n  //   // data.coords.longitude\r\n  //   const pos = data as Geoposition;\r\n  //   if (pos.coords) {\r\n  //     this.tripLogger.saveTripLogItem({\r\n  //       latitude: pos.coords.latitude,\r\n  //       longitude: pos.coords.longitude,\r\n  //       accuracy: pos.coords.accuracy,\r\n  //       altitude: pos.coords.altitude,\r\n  //       speed: pos.coords.speed,\r\n  //       timestamp: pos.timestamp,\r\n  //       heading: pos.coords.heading\r\n  //     });\r\n  //   }\r\n  // }\r\n\r\n  // private onPositionError(error: any) {\r\n  //   this.loggingService.error(error, 'BackgroundGeolocationWebService');\r\n  // }\r\n\r\n  async stop() {\r\n    // await this.tripLogger.updateState(TripLogState.Paused);\r\n    // this.watchSubscription.unsubscribe();\r\n    // this.watchSubscription = null;\r\n  }\r\n\r\n  isRunning() {\r\n    return Promise.resolve(false);\r\n    // return Promise.resolve(!!this.watchSubscription);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport abstract class BackgroundGeolocationService {\r\n  abstract start(): void;\r\n  abstract stop(): void;\r\n  abstract isRunning(): Promise<boolean>;\r\n}\r\n","import { Injectable, NgZone } from '@angular/core';\r\nimport { WarningService } from '../warning/warning.service';\r\nimport { ObservationService } from '../observation/observation.service';\r\nimport { KdvService } from '../kdv/kdv.service';\r\nimport { CancelPromiseTimer } from '../../helpers/cancel-promise-timer';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { settings } from '../../../../settings';\r\nimport { Platform } from '@ionic/angular';\r\nimport { RegistrationService } from '../../../modules/registration/services/registration.service';\r\nimport { HelpTextService } from '../../../modules/registration/services/help-text/help-text.service';\r\nimport { TripLoggerService } from '../trip-logger/trip-logger.service';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport {\r\n  map,\r\n  switchMap,\r\n  distinctUntilChanged,\r\n  pairwise,\r\n  filter,\r\n  take\r\n} from 'rxjs/operators';\r\nimport { OnReset } from '../../../modules/shared/interfaces/on-reset.interface';\r\nimport { AnalyticService } from '../../../modules/analytics/services/analytic.service';\r\nimport { LangKey, GeoHazard } from '@varsom-regobs-common/core';\r\nimport { AppCustomDimension } from '../../../modules/analytics/enums/app-custom-dimension.enum';\r\nimport { RegobsAuthService } from '../../../modules/auth/services/regobs-auth.service';\r\nimport { Router } from '@angular/router';\r\nconst DEBUG_TAG = 'DataMarshallService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DataMarshallService implements OnReset {\r\n  foregroundUpdateInterval: NodeJS.Timeout;\r\n  private cancelUpdateObservationsSubject: Subject<boolean>;\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  get observableCancelSubject(): Subject<boolean> {\r\n    return this.cancelUpdateObservationsSubject;\r\n  }\r\n\r\n  get cancelObservationsPromise(): Promise<boolean> {\r\n    return this.cancelUpdateObservationsSubject\r\n      .asObservable()\r\n      .pipe(take(1))\r\n      .toPromise();\r\n  }\r\n\r\n  constructor(\r\n    private ngZone: NgZone,\r\n    private warningService: WarningService,\r\n    private observationService: ObservationService,\r\n    private kdvService: KdvService,\r\n    private helpTextService: HelpTextService,\r\n    private userSettingService: UserSettingService,\r\n    private regobsAuthService: RegobsAuthService,\r\n    private platform: Platform,\r\n    private registrationService: RegistrationService,\r\n    private tripLoggerService: TripLoggerService,\r\n    private loggingService: LoggingService,\r\n    private analyticService: AnalyticService,\r\n    private router: Router\r\n  ) {\r\n    this.cancelUpdateObservationsSubject = new Subject<boolean>();\r\n  }\r\n\r\n  init(): void {\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.subscriptions.push(\r\n        this.hasDaysBackChangedToLargerValue().subscribe(() => {\r\n          this.loggingService.debug(\r\n            'DaysBack has changed to a larger value. Update observations.',\r\n            DEBUG_TAG\r\n          );\r\n          this.updateObservations();\r\n        })\r\n      );\r\n\r\n      this.subscriptions.push(\r\n        this.userSettingService.appModeAndLanguage$.subscribe(() => {\r\n          this.kdvService.updateKdvElements();\r\n          this.helpTextService.updateHelpTexts();\r\n          this.loggingService.debug(\r\n            'AppMode or Language has changed. Update kdv elements and help texts.',\r\n            DEBUG_TAG\r\n          );\r\n        })\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.appModeLanguageAndCurrentGeoHazard$.subscribe(\r\n          ([appMode, langKey, geoHazards]) => {\r\n            this.loggingService.debug(\r\n              'AppMode, Language or CurrentGeoHazard has changed. Update observations and warnings.',\r\n              DEBUG_TAG\r\n            );\r\n            this.analyticService.trackDimension(\r\n              AppCustomDimension.language,\r\n              LangKey[langKey]\r\n            );\r\n            this.analyticService.trackDimension(\r\n              AppCustomDimension.appMode,\r\n              appMode\r\n            );\r\n            this.analyticService.trackDimension(\r\n              AppCustomDimension.geoHazard,\r\n              geoHazards.map((gh) => GeoHazard[gh]).join(',')\r\n            );\r\n            this.updateObservations();\r\n            this.warningService.updateWarnings();\r\n          }\r\n        )\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.userSetting$\r\n          .pipe(\r\n            map((userSetting) => userSetting.consentForSendingAnalytics),\r\n            distinctUntilChanged()\r\n          )\r\n          .subscribe((consent) => {\r\n            if (consent) {\r\n              this.analyticService.enable();\r\n              this.loggingService.enable();\r\n              this.analyticService.trackDimension(\r\n                AppCustomDimension.enabledAnalytics,\r\n                consent\r\n              );\r\n            } else {\r\n              this.analyticService.trackDimension(\r\n                AppCustomDimension.enabledAnalytics,\r\n                consent\r\n              );\r\n              this.analyticService.disable();\r\n              this.loggingService.disable();\r\n            }\r\n          })\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.showMapCenter$.subscribe((showMapCenter) => {\r\n          this.analyticService.trackDimension(\r\n            AppCustomDimension.showMapCenter,\r\n            showMapCenter.toString()\r\n          );\r\n        })\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.userSetting$\r\n          .pipe(\r\n            map((userSetting) => userSetting.topoMap),\r\n            distinctUntilChanged()\r\n          )\r\n          .subscribe((topoMap) => {\r\n            this.analyticService.trackDimension(\r\n              AppCustomDimension.topoMap,\r\n              topoMap\r\n            );\r\n          })\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.supportTiles$\r\n          .pipe(\r\n            map((st) =>\r\n              st\r\n                .filter((x) => x.enabled)\r\n                .map((x) => x.name)\r\n                .join(',')\r\n            ),\r\n            distinctUntilChanged()\r\n          )\r\n          .subscribe((supportMap) => {\r\n            this.analyticService.trackDimension(\r\n              AppCustomDimension.supportMap,\r\n              supportMap\r\n            );\r\n          })\r\n      );\r\n      this.subscriptions.push(\r\n        this.regobsAuthService.loggedInUser$.subscribe((user) =>\r\n          this.loggingService.setUser(user)\r\n        )\r\n      );\r\n      this.subscriptions.push(\r\n        this.userSettingService.appMode$.subscribe((appMode) =>\r\n          this.loggingService.configureLogging(appMode)\r\n        )\r\n      );\r\n\r\n      this.subscriptions.push(\r\n        this.platform.pause.subscribe(() => {\r\n          this.loggingService.debug(\r\n            'App paused. Stop foreground updates.',\r\n            DEBUG_TAG\r\n          );\r\n          this.stopForegroundUpdate();\r\n        })\r\n      );\r\n      this.subscriptions.push(\r\n        this.platform.resume.subscribe(() => {\r\n          this.loggingService.debug(\r\n            `App resumed. Start foreground updates. Current route is '${this.router.url}'`,\r\n            DEBUG_TAG\r\n          );\r\n          this.startForegroundUpdate();\r\n        })\r\n      );\r\n    });\r\n    // this.startForegroundUpdate();\r\n    // No need to unsubscribe this observables when the service is singleton. It get destroyed when app exits.\r\n  }\r\n\r\n  appOnReset(): void {\r\n    this.loggingService.debug('App reset. Unsubscribe all.', DEBUG_TAG);\r\n    this.unsubscribeAll();\r\n  }\r\n\r\n  appOnResetComplete(): void {\r\n    this.init(); // Re-Init service after reset has completed\r\n  }\r\n\r\n  private unsubscribeAll() {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n    this.subscriptions = [];\r\n  }\r\n\r\n  cancelUpdateObservations(): void {\r\n    this.cancelUpdateObservationsSubject.next(true);\r\n  }\r\n\r\n  updateObservations(): void {\r\n    this.observationService.updateObservations(this.cancelObservationsPromise);\r\n  }\r\n\r\n  /**\r\n   * Emits only when days back has changed to a larger value for current geoHazard\r\n   */\r\n  private hasDaysBackChangedToLargerValue() {\r\n    return this.userSettingService.currentGeoHazard$.pipe(\r\n      switchMap((currentGeoHazard) =>\r\n        this.userSettingService.daysBack$.pipe(\r\n          map(\r\n            (val) =>\r\n              val.find((x) => x.geoHazard === currentGeoHazard[0]).daysBack\r\n          ),\r\n          distinctUntilChanged(),\r\n          pairwise(),\r\n          filter(([prev, next]) => next > prev)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  startForegroundUpdate(): void {\r\n    if (this.foregroundUpdateInterval) {\r\n      this.stopForegroundUpdate();\r\n    }\r\n    this.foregroundUpdateInterval = setInterval(() => {\r\n      this.backgroundFetchUpdate();\r\n    }, settings.foregroundUpdateIntervalMs);\r\n    this.backgroundFetchUpdate(); // Update on resume\r\n  }\r\n\r\n  stopForegroundUpdate(): void {\r\n    clearTimeout(this.foregroundUpdateInterval);\r\n  }\r\n\r\n  backgroundFetchUpdate(useTimeout = false): Promise<void> {\r\n    return this.ngZone.runOutsideAngular(async () => {\r\n      const cancelTimer = useTimeout\r\n        ? CancelPromiseTimer.createCancelPromiseTimer(\r\n          settings.backgroundFetchTimeout\r\n        )\r\n        : null;\r\n      // Use max 20 seconds to backround update, else app will crash (after 30 seconds)\r\n      await this.registrationService.syncRegistrations(cancelTimer);\r\n      const cancelPromiseForObservations = cancelTimer\r\n        ? Promise.race([this.cancelObservationsPromise, cancelTimer])\r\n        : this.cancelObservationsPromise;\r\n      await this.observationService.updateObservations(\r\n        cancelPromiseForObservations\r\n      );\r\n      await this.warningService.updateWarnings(cancelTimer);\r\n      await this.kdvService.updateKdvElements(cancelTimer);\r\n      await this.helpTextService.updateHelpTexts(cancelTimer);\r\n      await this.tripLoggerService.cleanupOldLegacyTrip();\r\n      this.loggingService.debug('Background update completed', DEBUG_TAG);\r\n    });\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport {\r\n  SQLite,\r\n  SQLiteObject,\r\n  SQLiteDatabaseConfig\r\n} from '@ionic-native/sqlite/ngx';\r\nimport { Platform } from '@ionic/angular';\r\nimport { settings } from '../../../../settings';\r\nimport '../../helpers/ionic/platform-helper';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { isAndroidOrIos } from '../../helpers/ionic/platform-helper';\r\nconst stringify = require('json-stringify-safe');\r\n\r\nconst DEBUG_CONTEXT = 'DbHelperService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DbHelperService {\r\n  sqliteobj: SQLiteObject;\r\n\r\n  constructor(\r\n    private sqlite: SQLite,\r\n    private platform: Platform,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  async init() {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.loggingService.debug(\r\n        'Create sqlite database connection (helper methods)',\r\n        DEBUG_CONTEXT\r\n      );\r\n      const config: SQLiteDatabaseConfig = {\r\n        name: settings.db.nanoSql.dbName,\r\n        location: 'default'\r\n      };\r\n      this.sqliteobj = await this.sqlite.create(<any>{\r\n        ...config,\r\n        androidDatabaseProvider: 'system'\r\n      });\r\n\r\n      try {\r\n        await this.sqliteobj.executeSql(\r\n          'PRAGMA journal_mode = WAL; PRAGMA synchronous = NORMAL',\r\n          []\r\n        );\r\n      } catch (err) {\r\n        this.loggingService.log(\r\n          'Could not execute PRAGMA',\r\n          err,\r\n          LogLevel.Warning,\r\n          DEBUG_CONTEXT\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * A faster query than NanoSQL. Does a direct qurey by id against SQlite database\r\n   * @param table table name\r\n   * @param id id\r\n   */\r\n  async getItemById<T>(table: string, id: string | number, idColumn = 'id') {\r\n    if (this.sqliteobj) {\r\n      return this.getItemByIdSqlLite<T>(table, id, idColumn);\r\n    } else {\r\n      return this.fallbackGetItemById<T>(table, id, idColumn);\r\n    }\r\n  }\r\n\r\n  async resetDb(onError?: (tableName: string, ex: Error) => void) {\r\n    if (this.sqliteobj) {\r\n      try {\r\n        await this.sqliteobj.executeSql(\r\n          'CREATE TABLE IF NOT EXISTS \"_ai\" (id TEXT PRIMARY KEY UNIQUE, inc BIGINT)'\r\n        );\r\n      } catch (err) {\r\n        if (onError) {\r\n          onError('Could not create _ai table', err);\r\n        }\r\n      }\r\n    }\r\n    await NanoSql.resetDb(onError);\r\n    // await this.init();\r\n  }\r\n\r\n  private async getItemByIdSqlLite<T>(\r\n    table: string,\r\n    id: string | number,\r\n    idColumn = 'id'\r\n  ): Promise<T> {\r\n    const select = `SELECT data FROM '${table}' where id = ?1`;\r\n    const sqlResult = await this.sqliteobj.executeSql(select, [id]);\r\n    if (sqlResult.rows && sqlResult.rows.length > 0) {\r\n      const jsonString = sqlResult.rows.item(0).data;\r\n      if (jsonString) {\r\n        const result: T = JSON.parse(jsonString);\r\n        return result;\r\n      }\r\n    }\r\n  }\r\n\r\n  private async fallbackGetItemById<T>(\r\n    table: string,\r\n    id: string | number,\r\n    idColumn = 'id'\r\n  ): Promise<T> {\r\n    const nanoSqlResult = await nSQL(table)\r\n      .query('select', [`${idColumn}`, '=', id])\r\n      .exec();\r\n    return <T>nanoSqlResult[0];\r\n  }\r\n\r\n  async fastInsert<T>(\r\n    table: string,\r\n    data: T[],\r\n    idSelector?: (data: T) => any,\r\n    rebuildIndexes = false\r\n  ) {\r\n    if (this.sqliteobj) {\r\n      await this.fastInsertSqlLite(table, data, idSelector);\r\n    } else {\r\n      await this.fastInsertNanoSql(table, data, idSelector);\r\n    }\r\n    if (rebuildIndexes) {\r\n      nSQL(table).query('rebuild indexes').exec();\r\n      // NOTE: There is a bug in rebuild indexes, so this might throw an exception\r\n    }\r\n  }\r\n\r\n  private fastInsertSqlLite<T>(\r\n    table: string,\r\n    data: T[],\r\n    idSelector?: (data: T) => any\r\n  ) {\r\n    const _idSelector = idSelector ? idSelector : (_data: T) => (<any>_data).id;\r\n    const statements = data.map((val) => [\r\n      `INSERT OR REPLACE INTO ${table} VALUES (?1, ?2)`,\r\n      [_idSelector(val), stringify(val)]\r\n    ]);\r\n    return this.sqliteobj.sqlBatch(statements);\r\n  }\r\n\r\n  private fastInsertNanoSql<T>(\r\n    table: string,\r\n    data: T[],\r\n    idSelector?: (data: T) => any\r\n  ) {\r\n    return nSQL().rawImport({ [table]: data }, false);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { InAppBrowser } from '@ionic-native/in-app-browser/ngx';\r\nimport { SafariViewController } from '@ionic-native/safari-view-controller/ngx';\r\nimport { Platform } from '@ionic/angular';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\n\r\nconst DEBUG_TAG = 'ExternalLinkService';\r\nconst VALID_URL_PROTOCOLS = ['http', 'https'];\r\nexport const SAFARI_TINT_COLOR = '#ffffff';\r\nexport const SAFARI_BAR_COLOR = '#044962';\r\nexport const SAFARI_TOOLBAR_COLOR = '#044962';\r\nexport const SAFARI_CONTROL_TINT_COLOR = '#ffffff';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ExternalLinkService {\r\n  constructor(\r\n    private inAppBrowser: InAppBrowser,\r\n    private safariViewController: SafariViewController,\r\n    private loggingService: LoggingService,\r\n    private platform: Platform\r\n  ) {}\r\n\r\n  async openExternalLink(url: string) {\r\n    const validatedUrl = this.ensureCorrectUrl(url);\r\n    if (!this.platform.is('hybrid')) {\r\n      this.openExternalLinkFallback(validatedUrl);\r\n      return;\r\n    }\r\n    const available = await this.safariViewController.isAvailable();\r\n    if (!available) {\r\n      this.loggingService.debug(\r\n        'Safari ViewController or Chrome Custom Tabs not available. Fallback to ianAppBrowser.',\r\n        DEBUG_TAG\r\n      );\r\n      this.openExternalLinkFallback(validatedUrl);\r\n      return;\r\n    }\r\n    this.safariViewController\r\n      .show({\r\n        url: validatedUrl,\r\n        tintColor: SAFARI_TINT_COLOR,\r\n        barColor: SAFARI_BAR_COLOR,\r\n        toolbarColor: SAFARI_TOOLBAR_COLOR,\r\n        controlTintColor: SAFARI_CONTROL_TINT_COLOR\r\n      })\r\n      .subscribe(\r\n        () => {\r\n          this.loggingService.debug(\r\n            'External url opened in Safari ViewController or Chrome Custom Tabs',\r\n            DEBUG_TAG\r\n          );\r\n        },\r\n        (error) => {\r\n          // tslint:disable-next-line:max-line-length\r\n          this.loggingService.log(\r\n            'Could not open external url in Safari ViewController or Chrome Custom Tabs. Fallback to ianAppBrowser.',\r\n            error,\r\n            LogLevel.Warning,\r\n            DEBUG_TAG\r\n          );\r\n          this.openExternalLinkFallback(validatedUrl);\r\n        }\r\n      );\r\n  }\r\n\r\n  openExternalLinkFallback(url: string) {\r\n    this.inAppBrowser.create(url, '_system', 'location=yes,hardwareback=yes');\r\n  }\r\n\r\n  private ensureCorrectUrl(url: string) {\r\n    if (url !== null) {\r\n      if (\r\n        VALID_URL_PROTOCOLS.some((validProtocol) =>\r\n          url.toLowerCase().startsWith(validProtocol)\r\n        )\r\n      ) {\r\n        return url;\r\n      }\r\n      return `http://${url}`;\r\n    }\r\n    return url;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, from } from 'rxjs';\r\nimport { switchMap, takeUntil } from 'rxjs/operators';\r\nimport { StatusBar } from '@capacitor/status-bar';\r\nimport { NgDestoryBase } from '../../helpers/observable-helper';\r\nimport { Platform } from '@ionic/angular';\r\nimport { isAndroidOrIos } from '../../helpers/ionic/platform-helper';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FullscreenService extends NgDestoryBase {\r\n  private readonly _subject: BehaviorSubject<boolean>;\r\n\r\n  get isFullscreen$() {\r\n    return this._subject.asObservable();\r\n  }\r\n\r\n  constructor(private platform: Platform) {\r\n    super();\r\n    this._subject = new BehaviorSubject(false);\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.platform.ready().then(() => {\r\n        this.isFullscreen$.pipe(\r\n          switchMap((isFullscreen) => from(isFullscreen ? StatusBar.hide() : StatusBar.show())),\r\n          takeUntil(this.ngDestroy$)\r\n        ).subscribe();\r\n      });\r\n    }\r\n  }\r\n\r\n  toggleFullscreen() {\r\n    this._subject.next(!this._subject.value);\r\n  }\r\n}\r\n","export enum GeoPositionErrorCode {\r\n  Unknown = 0,\r\n  PermissionDenied = 1,\r\n  PositionUnavailable = 2,\r\n  Timeout = 3\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport {\r\n  BehaviorSubject,\r\n  ReplaySubject,\r\n  of,\r\n  Observable,\r\n  Subscription,\r\n  combineLatest,\r\n  merge,\r\n  fromEvent,\r\n  firstValueFrom\r\n} from 'rxjs';\r\nimport {\r\n  filter,\r\n  map,\r\n  distinctUntilChanged,\r\n  startWith\r\n} from 'rxjs/operators';\r\nimport {\r\n  CallbackID,\r\n  ClearWatchOptions,\r\n  Geolocation, Position, WatchPositionCallback,\r\n} from '@capacitor/geolocation';\r\nimport { settings } from '../../../../settings';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { AlertController, Platform } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { GeoPositionLog, PositionError } from './geo-position-log.interface';\r\nimport { GeoPositionErrorCode } from './geo-position-error.enum';\r\nimport moment from 'moment';\r\nimport { isAndroidOrIos } from '../../helpers/ionic/platform-helper';\r\nimport { DeviceOrientation } from '@ionic-native/device-orientation/ngx';\r\n\r\nconst DEBUG_TAG = 'GeoPositionService';\r\n\r\n/**\r\n * Henter posisjon fra GPS og himmelretning fra kompasset\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GeoPositionService implements OnDestroy {\r\n  private highAccuracyEnabled = new BehaviorSubject(true);\r\n  private gpsPositionLog: ReplaySubject<GeoPositionLog> = new ReplaySubject(20);\r\n  private currentPosition: BehaviorSubject<Position> = new BehaviorSubject(\r\n    null\r\n  );\r\n  private currentHeading: BehaviorSubject<number> = new BehaviorSubject(null);\r\n\r\n  private readonly trackingComponents = new BehaviorSubject<string[]>([]);\r\n\r\n  // Subscriptions\r\n  private watchPositionCallbackId: CallbackID = null;\r\n  private headingSubscription: Subscription;\r\n\r\n  get currentPosition$(): Observable<Position> {\r\n    return this.currentPosition.pipe(filter((cp) => cp !== null));\r\n  }\r\n\r\n  get currentHeading$(): Observable<number> {\r\n    return this.currentHeading.pipe(filter((cp) => cp !== null));\r\n  }\r\n\r\n  get log$(): Observable<GeoPositionLog> {\r\n    return this.gpsPositionLog.asObservable();\r\n  }\r\n\r\n  constructor(\r\n    private deviceOrientation: DeviceOrientation,\r\n    private platform: Platform,\r\n    private loggingService: LoggingService,\r\n    private alertController: AlertController,\r\n    private translateService: TranslateService\r\n  ) {\r\n    this.startGeolocationTrackingSubscription();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.stopSubscriptions();\r\n  }\r\n\r\n  /**\r\n   * @returns last known position\r\n   * @see https://github.com/ionic-team/capacitor/issues/1279\r\n   */\r\n  getSingleCurrentPosition(): Promise<Position> {\r\n    // this.currentPosition always returns a value.\r\n    return firstValueFrom<Position>(this.currentPosition);\r\n  }\r\n\r\n  private startGeolocationTrackingSubscription() {\r\n    const anyComponentsTracking = this.trackingComponents.pipe(\r\n      map((val) => val.length > 0),\r\n      distinctUntilChanged()\r\n    );\r\n    combineLatest([this.getPlatformIsActiveObservable(), anyComponentsTracking])\r\n      .pipe(\r\n        map(([platformIsActive, anyComponentsTracking]) =>\r\n          platformIsActive && anyComponentsTracking ? true : false\r\n        )\r\n      )\r\n      .subscribe((activate) => {\r\n        if (activate) {\r\n          this.startSubscriptions();\r\n        } else {\r\n          this.stopSubscriptions();\r\n        }\r\n      });\r\n  }\r\n\r\n  private getPlatformIsActiveObservable() {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      return merge(\r\n        this.platform.resume.pipe(map(() => true)),\r\n        this.platform.pause.pipe(map(() => false))\r\n      ).pipe(startWith(true));\r\n    }\r\n    return of(true);\r\n  }\r\n\r\n  private createPositionError(\r\n    message: string,\r\n    code: GeoPositionErrorCode = GeoPositionErrorCode.Unknown,\r\n    highAccuracyEnabled = true\r\n  ): GeoPositionLog {\r\n    return {\r\n      timestamp: moment().unix(),\r\n      status: 'PositionError',\r\n      pos: undefined,\r\n      highAccuracyEnabled,\r\n      err: {\r\n        code,\r\n        message\r\n      }\r\n    };\r\n  }\r\n\r\n  getTimestamp(geopos: Position) {\r\n    if (geopos && geopos.timestamp > 0) {\r\n      if (this.platform.is('hybrid') && this.platform.is('ios')) {\r\n        return geopos.timestamp / 1000;\r\n      }\r\n      return geopos.timestamp;\r\n    }\r\n    return moment().unix();\r\n  }\r\n\r\n  private createGpsPositionLogElement(pos: Position): GeoPositionLog {\r\n    const log: GeoPositionLog = {\r\n      timestamp: this.getTimestamp(pos),\r\n      status: (pos.coords === undefined\r\n        ? 'PositionError'\r\n        : 'PositionUpdate') as 'PositionError' | 'PositionUpdate',\r\n      pos,\r\n      highAccuracyEnabled: true,\r\n      err:\r\n        pos.coords === undefined\r\n          ? ((pos as unknown) as PositionError)\r\n          : undefined\r\n    };\r\n    return log;\r\n  }\r\n\r\n  private addStatusToGpsPositionLog(status: 'StartGpsTracking' | 'StopGpsTracking') {\r\n    this.gpsPositionLog.next({\r\n      timestamp: moment().unix(),\r\n      status,\r\n      highAccuracyEnabled: this.highAccuracyEnabled.value\r\n    });\r\n  }\r\n\r\n  public async startTrackingComponent(\r\n    name: string,\r\n    forcePermissionDialog = false\r\n  ) {\r\n    if (forcePermissionDialog) {\r\n      const valid = await this.checkPermissions();\r\n      if (!valid) {\r\n        this.gpsPositionLog.next(\r\n          this.createPositionError(\r\n            'Permission denied',\r\n            GeoPositionErrorCode.PermissionDenied\r\n          )\r\n        );\r\n        return;\r\n      }\r\n    }\r\n    this.trackingComponents.next([\r\n      ...this.getTrackingComponentsExcludeByName(name),\r\n      name\r\n    ]);\r\n  }\r\n\r\n  public stopTrackingComponent(name: string) {\r\n    this.trackingComponents.next([\r\n      ...this.getTrackingComponentsExcludeByName(name)\r\n    ]);\r\n  }\r\n\r\n  private getTrackingComponentsExcludeByName(name: string) {\r\n    return this.trackingComponents.value.filter((x) => x !== name);\r\n  }\r\n\r\n  private startSubscriptions() {\r\n    this.startWatchingPosition();\r\n    this.startWatchingHeading();\r\n  }\r\n\r\n  private stopSubscriptions() {\r\n    this.stopWatchingHeading();\r\n    this.stopWatchingPosition();\r\n  }\r\n\r\n  private stopWatchingPosition() {\r\n    if (this.watchPositionCallbackId !== null) {\r\n      this.loggingService.debug(`Stop current GPS position watch subscription with callback ID: ${this.watchPositionCallbackId}`, DEBUG_TAG);\r\n      this.addStatusToGpsPositionLog('StopGpsTracking');\r\n      const options:  ClearWatchOptions = { id : this.watchPositionCallbackId };\r\n      Geolocation.clearWatch(options);\r\n      this.watchPositionCallbackId = null;\r\n    }\r\n  }\r\n\r\n\r\n  private async startWatchingPosition(): Promise<void> {\r\n    const watchPositionCallback: WatchPositionCallback = (position: Position, err: any) => {\r\n      if (err) {\r\n        this.loggingService.log(\r\n          'Error when watchPosition',\r\n          err,\r\n          LogLevel.Warning,\r\n          DEBUG_TAG,\r\n          err\r\n        );\r\n        this.gpsPositionLog.next(this.createPositionError('Unknown error'));\r\n      }\r\n      if (position !== null) {\r\n        this.gpsPositionLog.next(this.createGpsPositionLogElement(position));\r\n        if (this.isValidPosition(position)) {\r\n          this.currentPosition.next(position);\r\n        }\r\n      }\r\n    };\r\n    this.addStatusToGpsPositionLog('StartGpsTracking');\r\n    this.stopWatchingPosition(); //we need to stop current watch of position if any\r\n    this.watchPositionCallbackId = await Geolocation.watchPosition(settings.gps.highAccuracyPositionOptions, watchPositionCallback);\r\n    this.loggingService.debug(`Start current GPS position watch subscription with callback ID: ${this.watchPositionCallbackId}`, DEBUG_TAG);\r\n  }\r\n\r\n  private isValidPosition(pos: Position): boolean {\r\n    return (\r\n      pos !== undefined &&\r\n      pos !== null &&\r\n      pos.coords !== undefined &&\r\n      pos.coords !== null &&\r\n      pos.coords.latitude >= -90 &&\r\n      pos.coords.latitude <= 90 &&\r\n      pos.coords.longitude >= -180 &&\r\n      pos.coords.longitude <= 180\r\n    );\r\n  }\r\n\r\n  private isValidHeading(heading: number) {\r\n    return heading >= 0 && heading <= 360;\r\n  }\r\n\r\n\r\n  private async checkPermissions(): Promise<boolean> {\r\n    // https://www.devhybrid.com/ionic-4-requesting-user-permissions/\r\n    try {\r\n      const currentPermissions = await Geolocation.checkPermissions();\r\n      this.loggingService.debug(`Geolocation (PermissionState) is ${currentPermissions?.location}`, DEBUG_TAG);\r\n      const authorized = currentPermissions.location === 'granted';\r\n      if (!authorized) {\r\n        if (this.platform.is('ios')) {\r\n          await this.showPermissionDeniedError();\r\n          return false;\r\n        }\r\n        // location is not authorized, request new. This only works on Android\r\n        const newPermissionsAfterRequest = await Geolocation.requestPermissions();\r\n        this.loggingService.debug(`Geolocation (PermissionState) after new request is ${newPermissionsAfterRequest?.location}`, DEBUG_TAG);\r\n        if (newPermissionsAfterRequest?.location === 'denied') {\r\n          await this.showPermissionDeniedError();\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    } catch (err) {\r\n      this.loggingService.error(\r\n        err,\r\n        DEBUG_TAG,\r\n        'Error asking for location permissions'\r\n      );\r\n      return true; // continute anyway on error\r\n    }\r\n  }\r\n\r\n  private async showPermissionDeniedError() {\r\n    const translations = await this.translateService\r\n      .get([\r\n        'ALERT.OK',\r\n        'PERMISSION.LOCATION_DENIED_HEADER',\r\n        'PERMISSION.LOCATION_DENIED_MESSAGE'\r\n      ])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations['PERMISSION.LOCATION_DENIED_HEADER'],\r\n      message: translations['PERMISSION.LOCATION_DENIED_MESSAGE'],\r\n      buttons: [translations['ALERT.OK']]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  private startWatchingHeading() {\r\n    if (this.headingSubscription && !this.headingSubscription.closed) {\r\n      this.headingSubscription.unsubscribe();\r\n    }\r\n    // NOTE! Because of issues with show heading with W3C Devece Orientation API in iOS 13, the depricated\r\n    // plugin cordova-plugin-device-orientation is used instead on ios\r\n    // https://github.com/apache/cordova-plugin-device-orientation/issues/52\r\n    this.headingSubscription = (this.isIos()\r\n      ? this.getHeadingNative()\r\n      : this.getWebHeadingObservable()\r\n    ).subscribe((heading: number) => this.validateAndSetHeading(heading));\r\n  }\r\n\r\n  private isIos(): boolean {\r\n    return this.platform.is('hybrid') && this.platform.is('ios');\r\n  }\r\n\r\n  private getHeadingNative() {\r\n    return this.deviceOrientation\r\n      .watchHeading({filter: 1}) //get notified only if heading changes > 1 degree\r\n      .pipe(map((val) => val?.magneticHeading));\r\n  }\r\n\r\n  private getWebHeadingObservable() {\r\n    return merge(\r\n      fromEvent(<any>window, 'deviceorientationabsolute'),\r\n      fromEvent(<any>window, 'deviceorientation')\r\n    ).pipe(\r\n      map((event: DeviceOrientationEvent) => {\r\n        const appleHeading = (<any>event).webkitCompassHeading;\r\n        const heading: number = appleHeading || this.getAbsoluteHeading(event);\r\n        return heading;\r\n      })\r\n    );\r\n  }\r\n\r\n  // private requestDeviceOrientationPermission(): Promise<boolean> {\r\n  // TODO: iOS 13 ask for permission every time, and from localhost.\r\n  // this needs to be better supported before turning on\r\n  // or use another native plugin than depricated\r\n  // https://github.com/apache/cordova-plugin-device-orientation\r\n  // https://medium.com/flawless-app-stories/how-to-request-device-motion-and-orientation-permission-in-ios-13-74fc9d6cd140\r\n  // https://github.com/apache/cordova-plugin-device-orientation/issues/52\r\n\r\n  // const doe = <any>DeviceOrientationEvent;\r\n  // if (typeof doe.requestPermission === 'function') {\r\n  //   // iOS 13+\r\n  //   const response = await doe.requestPermission();\r\n  //   return response === 'granted';\r\n  // } else {\r\n  //   // non iOS 13+\r\n  // return Promise.resolve(true);\r\n  // }\r\n  // }\r\n\r\n  private getAbsoluteHeading(event: DeviceOrientationEvent) {\r\n    return event.alpha !== undefined && event.absolute\r\n      ? 360 - event.alpha\r\n      : undefined;\r\n  }\r\n\r\n  private validateAndSetHeading(heading: number) {\r\n    if (this.isValidHeading(heading)) {\r\n      this.currentHeading.next(heading);\r\n    }\r\n  }\r\n\r\n  private stopWatchingHeading() {\r\n    if (this.headingSubscription && !this.headingSubscription.closed) {\r\n      this.headingSubscription.unsubscribe();\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HelperService {\r\n  constructor() {}\r\n\r\n  getDistanceText(distanceInMeter: number, numDecimals = 1): string {\r\n    const options = {\r\n      minimumFractionDigits: numDecimals,\r\n      maximumFractionDigits: numDecimals\r\n    };\r\n    if (distanceInMeter > 1000) {\r\n      return `${(distanceInMeter / 1000).toLocaleString(\r\n        undefined,\r\n        options\r\n      )}  km`;\r\n    } else {\r\n      return `${(distanceInMeter || 0).toFixed(0)} m`;\r\n    }\r\n  }\r\n\r\n  formatMsToTime(duration: number, showMilliseconds = false) {\r\n    const milliseconds = Math.floor((duration % 1000) / 100);\r\n    const seconds = Math.floor((duration / 1000) % 60);\r\n    const minutes = Math.floor((duration / (1000 * 60)) % 60);\r\n    const hours = Math.floor((duration / (1000 * 60 * 60)) % 24);\r\n\r\n    return (\r\n      `${hours < 10 ? '0' + hours : hours}` +\r\n      `:${minutes < 10 ? '0' + minutes : minutes}` +\r\n      `:${seconds < 10 ? '0' + seconds : seconds}` +\r\n      (showMilliseconds ? `.${milliseconds}` : '')\r\n    );\r\n  }\r\n\r\n  humanReadableByteSize(bytes: number, fractionDigits = 1, si = true) {\r\n    const thresh = si ? 1000 : 1024;\r\n    if (Math.abs(bytes) < thresh) {\r\n      return bytes + ' B';\r\n    }\r\n    const units = si\r\n      ? ['kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\r\n      : ['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB'];\r\n    let u = -1;\r\n    do {\r\n      bytes /= thresh;\r\n      ++u;\r\n    } while (Math.abs(bytes) >= thresh && u < units.length - 1);\r\n    return bytes.toFixed(fractionDigits) + ' ' + units[u];\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport * as RegobsApi from '@varsom-regobs-common/regobs-api';\r\nimport { settings } from '../../../../settings';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { LangKey, AppMode } from '@varsom-regobs-common/core';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { KdvElementsResponseDto } from '@varsom-regobs-common/regobs-api';\r\nimport { combineLatest, Observable } from 'rxjs';\r\nimport { switchMap, map, shareReplay, take } from 'rxjs/operators';\r\nimport { DataLoadService } from '../../../modules/data-load/services/data-load.service';\r\nimport moment from 'moment';\r\nimport { toPromiseWithCancel } from '../../helpers/observable-helper';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { NSqlFullUpdateObservable } from '../../helpers/nano-sql/NSqlFullUpdateObservable';\r\n\r\nconst DEBUG_TAG = 'KdvService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class KdvService {\r\n  private _kdvElements$: Observable<KdvElementsResponseDto>;\r\n\r\n  get kdvElements$() {\r\n    return this._kdvElements$;\r\n  }\r\n\r\n  constructor(\r\n    private kdvApiService: RegobsApi.KdvElementsService,\r\n    private userSettingService: UserSettingService,\r\n    private dataLoadService: DataLoadService,\r\n    private loggingService: LoggingService\r\n  ) {\r\n    this._kdvElements$ = this.getKdvElementsObservable();\r\n  }\r\n\r\n  async updateKdvElements(cancel?: Promise<void>) {\r\n    const userSetting = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    await this.checkLastUpdatedAndUpdateDataIfNeeded(\r\n      userSetting.appMode,\r\n      userSetting.language,\r\n      cancel\r\n    );\r\n  }\r\n\r\n  private getDataLoadId(appMode: AppMode, language: LangKey) {\r\n    return `${NanoSql.TABLES.KDV_ELEMENTS.name}_${appMode}_${language}`;\r\n  }\r\n\r\n  private async checkLastUpdatedAndUpdateDataIfNeeded(\r\n    appMode: AppMode,\r\n    language: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoad = await this.dataLoadService.getState(\r\n      this.getDataLoadId(appMode, language)\r\n    );\r\n    const isLoadingTimeout = moment().subtract(\r\n      settings.foregroundUpdateIntervalMs,\r\n      'milliseconds'\r\n    );\r\n    if (\r\n      dataLoad.isLoading &&\r\n      moment(dataLoad.startedDate).isAfter(isLoadingTimeout)\r\n    ) {\r\n      this.loggingService.debug(\r\n        'Kdv elements is allready being updated.',\r\n        DEBUG_TAG\r\n      );\r\n    } else {\r\n      const lastUpdateLimit = moment().subtract(\r\n        settings.kdvElements.daysBeforeUpdate,\r\n        'day'\r\n      );\r\n      if (\r\n        !dataLoad.lastUpdated ||\r\n        moment(dataLoad.lastUpdated).isBefore(lastUpdateLimit)\r\n      ) {\r\n        await this.updateKdvElementsForLanguage(appMode, language, cancel);\r\n      }\r\n    }\r\n  }\r\n\r\n  async updateKdvElementsForLanguage(\r\n    appMode: AppMode,\r\n    language: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoadId = this.getDataLoadId(appMode, language);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    try {\r\n      const kdvElements = await toPromiseWithCancel(\r\n        this.kdvApiService.KdvElementsGetKdvs({ langkey: language }),\r\n        cancel,\r\n        20000\r\n      );\r\n      await NanoSql.getInstance(NanoSql.TABLES.KDV_ELEMENTS.name, appMode)\r\n        .query('upsert', { langKey: language, ...kdvElements })\r\n        .exec();\r\n      await this.dataLoadService.loadingCompleted(dataLoadId);\r\n      return true;\r\n    } catch (err) {\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  getKdvRepositoryByKeyObservable(key: string) {\r\n    return this.kdvElements$.pipe(map((val) => val.KdvRepositories[key]));\r\n  }\r\n\r\n  getViewRepositoryByKeyObservable(key: string) {\r\n    return this.kdvElements$.pipe(map((val) => val.ViewRepositories[key]));\r\n  }\r\n\r\n  private getKdvElementsObservable() {\r\n    return combineLatest([\r\n      this.userSettingService.appMode$,\r\n      this.userSettingService.language$\r\n    ]).pipe(\r\n      switchMap(([appMode, langKey]) =>\r\n        this.getKdvElementsFromDbAsStream(appMode, langKey)\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private getKdvElementsFromDbAsStream(appMode: AppMode, langKey: LangKey) {\r\n    return new NSqlFullUpdateObservable<KdvElementsResponseDto[]>(\r\n      NanoSql.getInstance(NanoSql.TABLES.KDV_ELEMENTS.name, appMode)\r\n        .query('select')\r\n        .where(['langKey', '=', langKey])\r\n        .listen()\r\n    ).pipe(\r\n      map((val: KdvElementsResponseDto[]) =>\r\n        val.length > 0 ? val[0] : this.getDefaultKdvElements(langKey)\r\n      )\r\n    );\r\n  }\r\n\r\n  private getDefaultKdvElements(langKey: LangKey) {\r\n    const langKeyName = LangKey[langKey];\r\n    const defaultKdvElements: KdvElementsResponseDto = require(`../../../../assets/json/kdvelements.${langKeyName}.json`);\r\n    return defaultKdvElements;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { settings } from '../../../../settings';\r\nimport { RowCount } from '../../models/row-count.model';\r\nimport { Observable, combineLatest, of, BehaviorSubject } from 'rxjs';\r\nimport moment from 'moment';\r\nimport 'moment-timezone';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport {\r\n  map,\r\n  distinctUntilChanged,\r\n  switchMap,\r\n  shareReplay,\r\n  tap,\r\n  catchError,\r\n  take\r\n} from 'rxjs/operators';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { DataLoadService } from '../../../modules/data-load/services/data-load.service';\r\nimport { UserSetting } from '../../models/user-settings.model';\r\nimport { LangKey, GeoHazard, AppMode } from '@varsom-regobs-common/core';\r\nimport { SearchService } from '@varsom-regobs-common/regobs-api';\r\nimport {\r\n  RegistrationViewModel,\r\n  ObserverResponseDto\r\n} from '@varsom-regobs-common/regobs-api';\r\nimport { toPromiseWithCancel } from '../../helpers/observable-helper';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { DbHelperService } from '../db-helper/db-helper.service';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { NSqlFullUpdateObservable } from '../../helpers/nano-sql/NSqlFullUpdateObservable';\r\n\r\nconst DEBUG_TAG = 'ObservationService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ObservationService {\r\n  private _observationsObservable: Observable<RegistrationViewModel[]>;\r\n  private _dataLoadObservable: Observable<string>;\r\n  private latestObservations: BehaviorSubject<{\r\n    [key: string]: RegistrationViewModel[];\r\n  }>;\r\n\r\n  get observations$() {\r\n    return this._observationsObservable;\r\n  }\r\n\r\n  get dataLoad$() {\r\n    return this._dataLoadObservable;\r\n  }\r\n\r\n  constructor(\r\n    private searchService: SearchService,\r\n    private userSettingService: UserSettingService,\r\n    private dataLoadService: DataLoadService,\r\n    private loggingService: LoggingService,\r\n    private dbHelperService: DbHelperService\r\n  ) {\r\n    this.latestObservations = new BehaviorSubject({});\r\n    this._observationsObservable = this.getObservationsAsObservable();\r\n    this._dataLoadObservable = this.getDataLoadObservable();\r\n  }\r\n\r\n  async updateObservations(cancel?: Promise<any>) {\r\n    let cancelled = false;\r\n    if (cancel) {\r\n      cancel.then(() => {\r\n        cancelled = true;\r\n      });\r\n    }\r\n    const userSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    if (!cancelled) {\r\n      const result = await this.checkLastUpdatedAndUpdateDataIfNeeded(\r\n        userSettings.currentGeoHazard,\r\n        userSettings,\r\n        cancel\r\n      );\r\n      return result;\r\n    } else {\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  private getDataLoadId(\r\n    appMode: AppMode,\r\n    geoHazards: GeoHazard[],\r\n    langKey: LangKey\r\n  ) {\r\n    return `${NanoSql.TABLES.OBSERVATION.name}_${geoHazards.join(\r\n      '-'\r\n    )}_${appMode}_${langKey}`;\r\n  }\r\n\r\n  private getDataLoadObservable() {\r\n    return this.userSettingService.appModeLanguageAndCurrentGeoHazard$.pipe(\r\n      map(([appMode, language, currentGeoHazard]) =>\r\n        this.getDataLoadId(appMode, currentGeoHazard, language)\r\n      )\r\n    );\r\n  }\r\n\r\n  private async checkLastUpdatedAndUpdateDataIfNeeded(\r\n    geoHazards: GeoHazard[],\r\n    userSetting: UserSetting,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoadId = this.getDataLoadId(\r\n      userSetting.appMode,\r\n      geoHazards,\r\n      userSetting.language\r\n    );\r\n    const dataLoad = await this.dataLoadService.getState(dataLoadId);\r\n    const isLoadingTimeout = moment().subtract(\r\n      settings.foregroundUpdateIntervalMs,\r\n      'milliseconds'\r\n    );\r\n    if (\r\n      dataLoad.isLoading &&\r\n      moment(dataLoad.startedDate).isAfter(isLoadingTimeout)\r\n    ) {\r\n      this.loggingService.debug('Observations is already loading.', DEBUG_TAG);\r\n      return 0;\r\n    } else {\r\n      const lastUpdateLimit = moment().subtract(15, 'minutes');\r\n      const fromDate = await this.getDaysBackToFetchAsDate(\r\n        userSetting,\r\n        geoHazards\r\n      );\r\n      if (\r\n        !dataLoad.lastUpdated ||\r\n        moment(dataLoad.lastUpdated).isBefore(lastUpdateLimit) ||\r\n        moment(dataLoad.itemsFromDate).isAfter(fromDate)\r\n      ) {\r\n        return this.updateObservationsForGeoHazard(\r\n          geoHazards,\r\n          userSetting,\r\n          cancel\r\n        );\r\n      } else {\r\n        this.loggingService.debug(\r\n          `No need to update ${geoHazards.join(', ')}.\r\n        Last updated is: ${dataLoad.lastUpdated}`,\r\n          DEBUG_TAG\r\n        );\r\n        return 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  getLastUpdatedForCurrentGeoHazardAsObservable() {\r\n    return this.userSettingService.appModeLanguageAndCurrentGeoHazard$.pipe(\r\n      switchMap(([appMode, language, currentGeoHazard]) =>\r\n        this.dataLoadService.getStateAsObservable(\r\n          this.getDataLoadId(appMode, currentGeoHazard, language)\r\n        )\r\n      ),\r\n      map((val) =>\r\n        val && val.lastUpdated ? moment(val.lastUpdated).toDate() : null\r\n      )\r\n    );\r\n  }\r\n\r\n  async forceUpdateObservationsForCurrentGeoHazard(cancel?: Promise<any>) {\r\n    const userSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    return this.updateObservationsForGeoHazard(\r\n      userSettings.currentGeoHazard,\r\n      userSettings,\r\n      cancel\r\n    );\r\n  }\r\n\r\n  private async getDaysBackToFetchAsDate(\r\n    userSetting: UserSetting,\r\n    geoHazards: GeoHazard[]\r\n  ) {\r\n    const daysBack = await this.getObservationsDaysBack(\r\n      userSetting,\r\n      geoHazards\r\n    );\r\n    const fromDate = moment().subtract(daysBack, 'days').startOf('day');\r\n    return fromDate.toDate();\r\n  }\r\n\r\n  async updateObservationsForGeoHazard(\r\n    geoHazards: GeoHazard[],\r\n    userSetting: UserSetting,\r\n    cancel?: Promise<any>\r\n  ) {\r\n    this.loggingService.debug(\r\n      `Updating observations for geoHazard: ${geoHazards.join(', ')}`,\r\n      DEBUG_TAG\r\n    );\r\n    const dataLoadId = this.getDataLoadId(\r\n      userSetting.appMode,\r\n      geoHazards,\r\n      userSetting.language\r\n    );\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    const fromDate = await this.getDaysBackToFetchAsDate(\r\n      userSetting,\r\n      geoHazards\r\n    );\r\n    let isCanceled = false;\r\n    if (cancel) {\r\n      cancel.then(() => {\r\n        isCanceled = true;\r\n      });\r\n    }\r\n    try {\r\n      const searchResult = await toPromiseWithCancel(\r\n        this.searchService.SearchSearch({\r\n          FromDtObsTime: fromDate.toISOString(),\r\n          SelectedGeoHazards: geoHazards,\r\n          NumberOfRecords: settings.observations.maxObservationsToFetch,\r\n          LangKey: userSetting.language,\r\n          TimeZone: moment().format('Z')\r\n        }),\r\n        cancel,\r\n        60000\r\n      );\r\n      this.loggingService.debug(\r\n        `Got ${\r\n          searchResult.length\r\n        } new observations for geoHazards ${geoHazards.join(', ')}`,\r\n        DEBUG_TAG\r\n      );\r\n      if (!isCanceled) {\r\n        this.updateLatestObservations(\r\n          userSetting.appMode,\r\n          userSetting.language,\r\n          geoHazards,\r\n          searchResult\r\n        );\r\n        await this.dataLoadService.loadingCompleted(\r\n          dataLoadId,\r\n          searchResult.length,\r\n          fromDate,\r\n          new Date()\r\n        );\r\n        this.saveAndClenupOfflineObservations(\r\n          fromDate,\r\n          geoHazards,\r\n          userSetting,\r\n          searchResult\r\n        );\r\n        return searchResult.length;\r\n      } else {\r\n        this.loggingService.debug(\r\n          'Operation cancelled. Saving load error.',\r\n          DEBUG_TAG\r\n        );\r\n        await this.dataLoadService.loadingError(\r\n          dataLoadId,\r\n          'Operation cancelled'\r\n        );\r\n        return 0;\r\n      }\r\n    } catch (err) {\r\n      if (isCanceled) {\r\n        this.loggingService.debug(err, DEBUG_TAG, 'Operation cancelled');\r\n      } else {\r\n        this.loggingService.log(\r\n          'Loading error. Is network available?',\r\n          err,\r\n          LogLevel.Warning\r\n        );\r\n      }\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n      return 0;\r\n    }\r\n  }\r\n\r\n  private updateLatestObservations(\r\n    appMode: AppMode,\r\n    langKey: LangKey,\r\n    geoHazards: GeoHazard[],\r\n    observations: RegistrationViewModel[]\r\n  ) {\r\n    const latestObs = this.latestObservations.getValue();\r\n    const key = this.getGeoHazardKeyFull(appMode, langKey, geoHazards);\r\n    latestObs[key] = observations;\r\n    this.latestObservations.next(latestObs);\r\n  }\r\n\r\n  private async saveAndClenupOfflineObservations(\r\n    fromDate: Date,\r\n    geoHazards: GeoHazard[],\r\n    userSetting: UserSetting,\r\n    result: RegistrationViewModel[]\r\n  ) {\r\n    const instanceName = NanoSql.getInstanceName(\r\n      NanoSql.TABLES.OBSERVATION.name,\r\n      userSetting.appMode\r\n    );\r\n    const now = new Date();\r\n    await this.dbHelperService.fastInsert(\r\n      instanceName,\r\n      result,\r\n      (data) => data.RegId\r\n    );\r\n    this.loggingService.debug(\r\n      `fastInsert took ${new Date().getTime() - now.getTime()} ms`,\r\n      DEBUG_TAG\r\n    );\r\n    const deleteResult = await this.deleteObservationNoLongerInResult(\r\n      userSetting.appMode,\r\n      geoHazards,\r\n      fromDate,\r\n      result\r\n    );\r\n    this.loggingService.debug(\r\n      'Deleted items no longer in updated result',\r\n      DEBUG_TAG,\r\n      deleteResult\r\n    );\r\n    await this.deleteOldObservations(userSetting.appMode, geoHazards);\r\n  }\r\n\r\n  getObservationsForCurrentUser(\r\n    appMode: AppMode,\r\n    langKey: LangKey,\r\n    pageNr?: number,\r\n    numberOfRecords = 10\r\n  ): Observable<RegistrationViewModel[]> {\r\n    return this.searchService\r\n      .SearchSearch({\r\n        NumberOfRecords: numberOfRecords,\r\n        LangKey: langKey,\r\n        Offset: (pageNr || 0) * numberOfRecords,\r\n        ObserverGuid: 'user.Guid', //TODO: Create call for \"My registrations\" in api v5\r\n        TimeZone: moment().format('Z')\r\n      })\r\n      .pipe(catchError((err) => of([]))); // Return empty list if http request fails);\r\n  }\r\n\r\n  async updateObservationById(\r\n    regId: number,\r\n    appMode: AppMode,\r\n    langKey: LangKey,\r\n    currentGeoHazards: GeoHazard[]\r\n  ) {\r\n    const result = await this.getRegistrationByRegIdFromApi(\r\n      regId,\r\n      appMode,\r\n      langKey\r\n    ).toPromise();\r\n    if (result) {\r\n      await NanoSql.getInstance(NanoSql.TABLES.OBSERVATION.name, appMode)\r\n        .query('upsert', result)\r\n        .exec();\r\n      // Reset next observations, so it will be fetched from db when one item is updated\r\n      this.updateLatestObservations(\r\n        appMode,\r\n        langKey,\r\n        currentGeoHazards,\r\n        undefined\r\n      );\r\n    }\r\n    return result;\r\n  }\r\n\r\n  private getRegistrationByRegIdFromApi(\r\n    regId: number,\r\n    appMode: AppMode,\r\n    langKey: LangKey\r\n  ) {\r\n    return this.searchService\r\n      .SearchSearch({ RegId: regId, LangKey: langKey })\r\n      .pipe(map((result) => result[0]));\r\n  }\r\n\r\n  getObservationsDaysBack(\r\n    userSettings: UserSetting,\r\n    geoHazards: GeoHazard[]\r\n  ): number {\r\n    const daysBackForCurrentGeoHazard = userSettings.observationDaysBack.find(\r\n      (setting) => setting.geoHazard === geoHazards[0]\r\n    );\r\n    const daysBack = daysBackForCurrentGeoHazard\r\n      ? daysBackForCurrentGeoHazard.daysBack\r\n      : 3; // default to 3 days back if not found\r\n    return daysBack;\r\n  }\r\n\r\n  private getObservationDaysBackAsDate(userSettings: UserSetting): Date {\r\n    const daysBack = this.getObservationsDaysBack(\r\n      userSettings,\r\n      userSettings.currentGeoHazard\r\n    );\r\n    const fromDate = moment().subtract(daysBack, 'days').startOf('day');\r\n    return fromDate.toDate();\r\n  }\r\n\r\n  private deleteObservationNoLongerInResult(\r\n    appMode: AppMode,\r\n    geoHazards: GeoHazard[],\r\n    fromDate: Date,\r\n    items: RegistrationViewModel[]\r\n  ) {\r\n    return NanoSql.getInstance(NanoSql.TABLES.OBSERVATION.name, appMode)\r\n      .query('delete')\r\n      .where((reg: RegistrationViewModel) => {\r\n        return (\r\n          reg &&\r\n          geoHazards.indexOf(reg.GeoHazardTID) >= 0 &&\r\n          moment(reg.DtObsTime).isSameOrAfter(fromDate) &&\r\n          !items.find((item) => item.RegId === reg.RegId)\r\n        );\r\n      })\r\n      .exec();\r\n  }\r\n\r\n  private async deleteOldObservations(\r\n    appMode: AppMode,\r\n    geoHazards: GeoHazard[]\r\n  ) {\r\n    const daysBack = await this.getMaxDaysBackForGeoHazard(geoHazards);\r\n    const deleteOldRecordsFrom = moment().subtract(daysBack + 1, 'days');\r\n    return NanoSql.getInstance(NanoSql.TABLES.OBSERVATION.name, appMode)\r\n      .query('delete')\r\n      .where((reg: RegistrationViewModel) => {\r\n        return (\r\n          reg &&\r\n          moment(reg.DtObsTime).isBefore(deleteOldRecordsFrom) &&\r\n          geoHazards.indexOf(reg.GeoHazardTID) >= 0\r\n        );\r\n      })\r\n      .exec();\r\n  }\r\n\r\n  private getMaxDaysBackForGeoHazard(geoHazards: GeoHazard[]) {\r\n    const geoHazardString = this.getGeoHazardKey(geoHazards);\r\n    const daysBackForCurrentGeoHazard: number[] =\r\n      settings.observations.daysBack[geoHazardString];\r\n    return Math.max(...daysBackForCurrentGeoHazard);\r\n  }\r\n\r\n  private getUserSettingsObservableDistinctToChangeObservations() {\r\n    return this.userSettingService.userSetting$.pipe(\r\n      distinctUntilChanged<UserSetting, string>(\r\n        (x, y) => x.localeCompare(y) === 0,\r\n        (x) => this.getDistinctUserSettingsToChangeObservations(x)\r\n      )\r\n    );\r\n  }\r\n\r\n  private getGeoHazardKey(geoHazards: GeoHazard[]) {\r\n    return GeoHazard[geoHazards[0]];\r\n  }\r\n\r\n  private getGeoHazardKeyFull(\r\n    appMode: AppMode,\r\n    language: LangKey,\r\n    geoHazards: GeoHazard[]\r\n  ) {\r\n    return `${appMode}_${language}_${this.getGeoHazardKey(geoHazards)}`;\r\n  }\r\n\r\n  private getObservationsAsObservable(): Observable<RegistrationViewModel[]> {\r\n    return combineLatest([\r\n      this.getUserSettingsObservableDistinctToChangeObservations(),\r\n      this.latestObservations.asObservable()\r\n    ]).pipe(\r\n      tap((val) =>\r\n        this.loggingService.debug(\r\n          'User settings or latest observations triggered change',\r\n          DEBUG_TAG,\r\n          val\r\n        )\r\n      ),\r\n      switchMap(([userSetting, latestObservations]) => {\r\n        const key = this.getGeoHazardKeyFull(\r\n          userSetting.appMode,\r\n          userSetting.language,\r\n          userSetting.currentGeoHazard\r\n        );\r\n        if (latestObservations[key] !== undefined) {\r\n          const filteredObservations = latestObservations[key].filter((reg) =>\r\n            this.observationByParameterFilter(\r\n              reg,\r\n              userSetting.language,\r\n              userSetting.currentGeoHazard,\r\n              this.getObservationDaysBackAsDate(userSetting)\r\n            )\r\n          );\r\n          return of(filteredObservations);\r\n        }\r\n        return this.getObservationsByParametersAsObservable(\r\n          userSetting.appMode,\r\n          userSetting.language,\r\n          userSetting.currentGeoHazard,\r\n          this.getObservationDaysBackAsDate(userSetting)\r\n        );\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private getDistinctUserSettingsToChangeObservations(\r\n    userSetting: UserSetting\r\n  ) {\r\n    const dateString = this.getObservationDaysBackAsDate(\r\n      userSetting\r\n    ).toISOString();\r\n    return `${userSetting.appMode}#${\r\n      userSetting.language\r\n    }#${userSetting.currentGeoHazard.join(',')}#${dateString}`;\r\n  }\r\n\r\n  private getObservationsByParametersQuery(\r\n    appMode: AppMode,\r\n    langKey: LangKey,\r\n    geoHazards?: GeoHazard[],\r\n    fromDate?: Date,\r\n  ) {\r\n    return NanoSql.getInstance(NanoSql.TABLES.OBSERVATION.name, appMode)\r\n      .query('select')\r\n      .where((reg: RegistrationViewModel) =>\r\n        this.observationByParameterFilter(\r\n          reg,\r\n          langKey,\r\n          geoHazards,\r\n          fromDate,\r\n        )\r\n      );\r\n  }\r\n\r\n  private observationByParameterFilter(\r\n    reg: RegistrationViewModel,\r\n    langKey: LangKey,\r\n    geoHazards?: GeoHazard[],\r\n    fromDate?: Date,\r\n    observerGuid?: string\r\n  ) {\r\n    return (\r\n      !!reg &&\r\n      (geoHazards ? geoHazards.indexOf(reg.GeoHazardTID) >= 0 : true) &&\r\n      (fromDate ? moment(reg.DtObsTime).isAfter(fromDate) : true)\r\n    );\r\n  }\r\n\r\n  // NOTE: Since we are using fastInsert, normal NanoSQL change feed is not supported, using subject trigger instead\r\n  /**\r\n   * Query observations by parameters\r\n   * @param appMode\r\n   * @param geoHazard\r\n   * @param fromDate\r\n   * @param user\r\n   */\r\n  getObservationsByParametersAsObservable(\r\n    appMode: AppMode,\r\n    langKey: LangKey,\r\n    geoHazards?: GeoHazard[],\r\n    fromDate?: Date,\r\n  ): Observable<RegistrationViewModel[]> {\r\n    return new NSqlFullUpdateObservable<RegistrationViewModel[]>(\r\n      this.getObservationsByParametersQuery(\r\n        appMode,\r\n        langKey,\r\n        geoHazards,\r\n        fromDate,\r\n      ).listen({\r\n        debounce: 500,\r\n        unique: true,\r\n        compareFn: (a, b) => this.isDifferent(a, b, langKey)\r\n      })\r\n    ).pipe(\r\n      map((items) =>\r\n        items.sort((a, b) => moment(b.DtObsTime).diff(moment(a.DtObsTime)))\r\n      ),\r\n      tap((items) =>\r\n        this.loggingService.debug(\r\n          'Observations observable change feed',\r\n          DEBUG_TAG,\r\n          items\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  isDifferent(rowsA: RegistrationViewModel[], rowsB: RegistrationViewModel[], langKey: LangKey) {\r\n    return (\r\n      this.getUniqueObservations(rowsA, langKey) !== this.getUniqueObservations(rowsB, langKey)\r\n    );\r\n  }\r\n\r\n  uniqueObservation(obs: RegistrationViewModel, langKey: LangKey) {\r\n    return `${obs.RegId}_${langKey}_${obs.DtChangeTime}`;\r\n  }\r\n\r\n  getUniqueObservations(rows: RegistrationViewModel[], langKey: LangKey) {\r\n    if (!rows) {\r\n      return '';\r\n    }\r\n    return rows.map((x) => this.uniqueObservation(x, langKey)).join('#');\r\n  }\r\n\r\n  async getObservationById(id: number, appMode: AppMode, langKey: LangKey) {\r\n    const result = await NanoSql.getInstance(\r\n      NanoSql.TABLES.OBSERVATION.name,\r\n      appMode\r\n    )\r\n      .query('select')\r\n      .where(['RegId', '=', id])\r\n      .exec();\r\n    return result[0] as RegistrationViewModel;\r\n  }\r\n\r\n  getObserableCount(appMode: AppMode): Observable<number> {\r\n    return new NSqlFullUpdateObservable<RowCount[]>(\r\n      NanoSql.getInstance(NanoSql.TABLES.OBSERVATION.name, appMode)\r\n        .query('select', ['COUNT(*) as count'])\r\n        .listen({\r\n          debounce: 100\r\n        })\r\n    ).pipe(\r\n      map((val: RowCount[]) => val[0].count),\r\n      distinctUntilChanged()\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport moment from 'moment';\r\nimport { IOfflineAsset } from './offline-asset.interface';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport '../../helpers/ionic/platform-helper';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { DataUrlHelper } from '../../helpers/data-url.helper';\r\n\r\nconst DEBUG_TAG = 'OfflineImageService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OfflineImageService {\r\n  constructor(private loggingService: LoggingService) {}\r\n\r\n  async getOfflineImage(url: string) {\r\n    const offlineAsset = await this.getOfflineAssetFromDb(url);\r\n    if (offlineAsset) {\r\n      this.updateLastAccess(offlineAsset);\r\n      return offlineAsset.dataUrl;\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  private updateLastAccess(offlineAsset: IOfflineAsset) {\r\n    offlineAsset.lastAccess = moment().unix();\r\n    return nSQL(NanoSql.TABLES.OFFLINE_ASSET.name)\r\n      .query('upsert', offlineAsset)\r\n      .exec();\r\n  }\r\n\r\n  async saveOfflineImageDataUrl(\r\n    url: string,\r\n    dataUrl: string,\r\n    type = 'image/jpg'\r\n  ) {\r\n    try {\r\n      const size = DataUrlHelper.getDataUriByteLength(dataUrl);\r\n\r\n      const offlineAsset: IOfflineAsset = {\r\n        url,\r\n        type,\r\n        lastAccess: moment().unix(),\r\n        size,\r\n        dataUrl\r\n      };\r\n      await nSQL(NanoSql.TABLES.OFFLINE_ASSET.name)\r\n        .query('upsert', offlineAsset)\r\n        .exec();\r\n      return offlineAsset;\r\n    } catch (error) {\r\n      this.loggingService.log(\r\n        'Could not save offline asset',\r\n        error,\r\n        LogLevel.Warning,\r\n        DEBUG_TAG,\r\n        url\r\n      );\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async getOfflineAssetFromDb(url: string) {\r\n    const result = (await nSQL(NanoSql.TABLES.OFFLINE_ASSET.name)\r\n      .query('select')\r\n      .where(['url', '=', url])\r\n      .exec()) as IOfflineAsset[];\r\n    if (result.length > 0) {\r\n      return result[0];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n\r\n  async cleanupOldItems() {\r\n    const fromDate = moment().subtract(1, 'month').unix();\r\n    return nSQL(NanoSql.TABLES.OFFLINE_ASSET.name)\r\n      .query('delete')\r\n      .where((x) => x.lastAccess < fromDate)\r\n      .exec();\r\n  }\r\n\r\n  async reset() {\r\n    await nSQL(NanoSql.TABLES.OFFLINE_ASSET.name).query('delete').exec();\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Directory, Encoding, Filesystem } from '@capacitor/filesystem';\r\nimport { WebView } from '@ionic-native/ionic-webview/ngx';\r\nimport { AlertController, Platform } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport JSZip from 'jszip';\r\nimport moment from 'moment';\r\nimport { BehaviorSubject, firstValueFrom, from, Observable, Subject, Subscription } from 'rxjs';\r\nimport { finalize, map, mergeMap, switchMap } from 'rxjs/operators';\r\nimport { CompoundPackage, Part } from 'src/app/pages/offline-map/metadata.model';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { isAndroidOrIos } from '../../helpers/ionic/platform-helper';\r\nimport { BackgroundDownloadService } from '../background-download/background-download.service';\r\nimport { HelperService } from '../helpers/helper.service';\r\nimport { OfflineMapPackage, OfflineTilesMetadata } from './offline-map.model';\r\nimport { OfflineTilesRegistry } from './offline-tiles-registry';\r\nimport { ProgressStep } from './progress-step.model';\r\nimport { Progress } from './progress.model';\r\n\r\nconst DEBUG_TAG = 'OfflineMapService';\r\nconst METADATA_FILE = 'metadata.json';\r\nconst ROOT_MAP_DIR = 'maps';\r\n\r\nfunction arrayBufferToBase64(buffer: ArrayBuffer) {\r\n  let binary = '';\r\n  new Uint8Array(buffer).forEach((byte) => binary += String.fromCharCode(byte));\r\n  return btoa(binary);\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OfflineMapService {\r\n  private packages: BehaviorSubject<OfflineMapPackage[]> = new BehaviorSubject([]);\r\n  packages$: Observable<OfflineMapPackage[]> = this.packages.asObservable();\r\n\r\n  private finishedPackageIds: Subject<string> = new Subject();\r\n\r\n  /**\r\n   * Through this you get name of packages when unpacking is finished and they are ready to use\r\n   */\r\n  finishedPackageIds$: Observable<string> = this.finishedPackageIds.asObservable();\r\n\r\n  private downloadAndUnzipProgress: BehaviorSubject<OfflineMapPackage[]> = new BehaviorSubject([]);\r\n  downloadAndUnzipProgress$ = this.downloadAndUnzipProgress.asObservable();\r\n\r\n  availableDiskspace: { available: number; used: number };\r\n  private downloadSubscription: Subscription;\r\n  private cancel = false;\r\n\r\n  private rootFileUrl = '';\r\n  offlineTilesRegistry = new OfflineTilesRegistry();\r\n\r\n  constructor(\r\n    private loggingService: LoggingService,\r\n    private webView: WebView,\r\n    private backgroundDownloadService: BackgroundDownloadService,\r\n    private platform: Platform,\r\n    private helperService: HelperService,\r\n    private translateService: TranslateService,\r\n    private alertController: AlertController\r\n  ) {\r\n    // Start with map packages already downloaded\r\n    this.getMapPackages()\r\n      .then((packages) => {\r\n        this.packages.next(packages);\r\n      })\r\n      .catch((err) => {\r\n        this.loggingService.error(err, DEBUG_TAG, 'Failed to get map packages');\r\n      });\r\n    this.packages$\r\n      .pipe(\r\n        switchMap((packages) =>\r\n          from(this.getDeviceFreeDiskSpace()).pipe(\r\n            map((available) => ({\r\n              available,\r\n              used: this.calculateTotalOfflinePackagesDiskspaceUsed(packages)\r\n            }))\r\n          )\r\n        )\r\n      )\r\n      .subscribe((val) => {\r\n        setTimeout(() => {\r\n          this.availableDiskspace = val;\r\n        });\r\n      });\r\n\r\n    this.packages$.subscribe((packages) =>\r\n      this.registerOfflineMapPackages(packages)\r\n    );\r\n  }\r\n\r\n  private async getMapPackages(): Promise<OfflineMapPackage[]> {\r\n    // TODO: Create own provider for fetching offline packages from storage\r\n    if (!isAndroidOrIos(this.platform)) {\r\n      return [];\r\n    }\r\n\r\n    // Read offline map package names\r\n    const readDirResult = await Filesystem.readdir({\r\n      path: await this.getRootFileUrl()\r\n    });\r\n    const packageNames = await this.getFolderNameWithCompleteFiles(\r\n      readDirResult.files\r\n    );\r\n    this.loggingService.debug('packageNames', DEBUG_TAG, packageNames);\r\n\r\n    // Read all package metadata\r\n    const packages = await Promise.all(\r\n      packageNames.map((name) => this.getMetadata(name))\r\n    );\r\n\r\n    return packages;\r\n  }\r\n\r\n  private registerOfflineMapPackages(mapPackages: OfflineMapPackage[]) {\r\n    this.loggingService.debug('registerOfflineMapPackages', DEBUG_TAG);\r\n\r\n    this.offlineTilesRegistry.clear();\r\n    for (const mapPackage of mapPackages) {\r\n      this.offlineTilesRegistry.add(mapPackage);\r\n    }\r\n  }\r\n\r\n  private calculateTotalOfflinePackagesDiskspaceUsed(\r\n    packages: OfflineMapPackage[]\r\n  ): number {\r\n    return packages.reduce(\r\n      (pv, cv) => (cv.downloadComplete && cv.size != null ? cv.size : 0) + pv,\r\n      0\r\n    );\r\n  }\r\n\r\n  private async getFolderNameWithCompleteFiles(folders: string[]): Promise<string[]> {\r\n    return (\r\n      await Promise.all(\r\n        folders.map((folder: string) =>\r\n          this.hasCompleteFile(folder).then((result) =>\r\n            result ? folder : null\r\n          )\r\n        )\r\n      )\r\n    ).filter((packageName) => packageName != null);\r\n  }\r\n\r\n  public async downloadPackage(\r\n    packageMetadataCombined: CompoundPackage,\r\n    checkAvailableDiskSpace = false\r\n  ): Promise<void> {\r\n    if (checkAvailableDiskSpace) {\r\n      //TODO: Ask user to prefer saving to external SD card if available?\r\n      const availableSpace = await this.checkAvailableDiskSpace(\r\n        packageMetadataCombined\r\n      );\r\n      if (!availableSpace) {\r\n        return;\r\n      }\r\n    }\r\n\r\n    if (await this.isPermissionToSaveFilesDenied()) {\r\n      return;\r\n    }\r\n\r\n    const mapPackage = this.createOfflineMapPackage(packageMetadataCombined);\r\n\r\n    // Add new map package to progress subject\r\n    this.downloadAndUnzipProgress.next([\r\n      ...this.downloadAndUnzipProgress.value,\r\n      mapPackage\r\n    ]);\r\n\r\n    if (this.downloadSubscription == null) {\r\n      //Start downlaod if not anyting currently downloading\r\n      this.startDownloadNextItemInQueue();\r\n    }\r\n  }\r\n\r\n  private async isPermissionToSaveFilesDenied(): Promise<boolean> {\r\n    if (!this.platform.is('android')) {\r\n      return false; //this check is only required in Android\r\n    }\r\n    const permissionStatus = await Filesystem.checkPermissions();\r\n    if (permissionStatus.publicStorage !== 'granted') {\r\n      const permissionStatusAfterRequest =\r\n        await Filesystem.requestPermissions();\r\n      if (permissionStatusAfterRequest.publicStorage !== 'granted') {\r\n        this.loggingService.debug(\r\n          `Permission to save files = ${permissionStatusAfterRequest.publicStorage}`,\r\n          DEBUG_TAG\r\n        );\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private startDownloadNextItemInQueue() {\r\n    const nextInQueue = this.downloadAndUnzipProgress.value.filter(\r\n      (p) => p.progress.step === ProgressStep.pending\r\n    )[0];\r\n    if (nextInQueue != null) {\r\n      this.onProgress(nextInQueue, {\r\n        step: ProgressStep.download,\r\n        percentage: 0,\r\n        description: ''\r\n      });\r\n\r\n      this.startDownloadPackage(nextInQueue);\r\n    }\r\n  }\r\n\r\n  private startDownloadPackage(offlineMapPackage: OfflineMapPackage) {\r\n    // Find all zip-files (urls) to download and unzip\r\n    const parts = offlineMapPackage.compoundPackageMetadata.getParts();\r\n\r\n    // Start recursive download and unzip\r\n    this.downloadAndUnzipPart(\r\n      parts[0],\r\n      parts,\r\n      offlineMapPackage,\r\n      0,\r\n    );\r\n  }\r\n\r\n  public cancelDownloadPackage(offlineMapPackage: OfflineMapPackage) {\r\n    if (offlineMapPackage.progress.step === ProgressStep.pending) {\r\n      this.removePackageFromDownloadAndProgress(offlineMapPackage);\r\n    } else if (offlineMapPackage.error) {\r\n      this.onCancelled(offlineMapPackage);\r\n    } else if (\r\n      offlineMapPackage.progress.step === ProgressStep.download ||\r\n      offlineMapPackage.progress.step === ProgressStep.extractZip\r\n    ) {\r\n      this.cancel = true;\r\n      this.downloadSubscription?.unsubscribe();\r\n    }\r\n  }\r\n\r\n  private removePackageFromDownloadAndProgress(\r\n    offlineMapPackage: OfflineMapPackage\r\n  ) {\r\n    this.downloadAndUnzipProgress.next(\r\n      this.downloadAndUnzipProgress.value.filter(\r\n        (mapPackage) => mapPackage.name !== offlineMapPackage.name\r\n      )\r\n    );\r\n  }\r\n\r\n  private downloadAndUnzipPart(\r\n    part: Part,\r\n    parts: Part[],\r\n    mapPackage: OfflineMapPackage,\r\n    partNumber: number,\r\n  ) {\r\n    this.downloadSubscription = this.backgroundDownloadService\r\n      .download(part.url)\r\n      .pipe(\r\n        finalize(() => {\r\n          if (this.cancel) {\r\n            this.onCancelled(mapPackage);\r\n          }\r\n        })\r\n      )\r\n      .subscribe(\r\n        async (downloadProgress) => {\r\n          switch (downloadProgress.state) {\r\n          case 'IN_PROGRESS':\r\n            await this.reportDownloadProgress(mapPackage, downloadProgress.progress, partNumber, parts.length);\r\n            break;\r\n          case 'DONE':\r\n            await this.handleUnzip(mapPackage, downloadProgress.content, part, partNumber, parts);\r\n            break;\r\n          default:\r\n            break;\r\n          }\r\n        },\r\n        (err) => this.onUnzipOrDownloadError(mapPackage, err, true)\r\n      );\r\n  }\r\n\r\n  private async handleUnzip(\r\n    mapPackage: OfflineMapPackage,\r\n    blob: Blob,\r\n    part: Part,\r\n    partNumber: number,\r\n    parts: Part[]): Promise<void> {\r\n\r\n    const folder = `${mapPackage.name}/${part.name}`;\r\n    const totalParts = parts.length;\r\n    const root = await this.getRootFileUrl();\r\n    await this.unzipFile(\r\n      blob,\r\n      root,\r\n      folder,\r\n      () => this.onUnzipStepComplete(parts, mapPackage, partNumber),\r\n      async (progress) =>\r\n        this.onProgress(mapPackage, {\r\n          step: ProgressStep.extractZip,\r\n          percentage: this.calculateTotalProgress(progress, partNumber, totalParts, 'Unzipping'),\r\n          description: await firstValueFrom(this.translateService.get(\r\n            'OFFLINE_MAP.STATUS.UNZIP_PART_X_OF_Y', {\r\n              n: partNumber + 1,\r\n              totalParts\r\n            }))\r\n        }),\r\n      (error) => this.onUnzipOrDownloadError(mapPackage, error, false)\r\n    );\r\n  }\r\n\r\n  private async reportDownloadProgress(mapPackage: OfflineMapPackage,\r\n    progress: number,\r\n    partNumber: number,\r\n    totalParts: number): Promise<void> {\r\n\r\n    this.onProgress(mapPackage, {\r\n      step: ProgressStep.download,\r\n      percentage: this.calculateTotalProgress(progress, partNumber, totalParts, 'Downloading'),\r\n      description: await firstValueFrom(this.translateService.get(\r\n        'OFFLINE_MAP.STATUS.DOWNLOADING_PART_X_OF_Y', {\r\n          n: partNumber + 1,\r\n          totalParts\r\n        }))\r\n    });\r\n  }\r\n\r\n  public calculateTotalProgress(\r\n    currentProgress: number,\r\n    currentPart: number,\r\n    totalParts: number,\r\n    partOfStep: 'Downloading' | 'Unzipping'\r\n  ) {\r\n    const stepsForEachPart = 2; // Download and unzip\r\n    const totalPartsOfWork = totalParts * stepsForEachPart;\r\n    const currentPartOfWork =\r\n      (currentPart * stepsForEachPart +\r\n        (partOfStep === 'Downloading' ? 0 : 1)) /\r\n      totalPartsOfWork;\r\n    const progressForTotalParts =\r\n      currentProgress / totalPartsOfWork + currentPartOfWork;\r\n    return progressForTotalParts;\r\n  }\r\n\r\n  private onUnzipStepComplete(parts: Part[], mapPackage: OfflineMapPackage, partNumber: number) {\r\n    if (this.cancel) {\r\n      this.onCancelled(mapPackage);\r\n      return;\r\n    }\r\n\r\n    const nextPart = partNumber + 1;\r\n    const totalParts = parts.length;\r\n    if (nextPart < totalParts) {\r\n      this.downloadAndUnzipPart(\r\n        parts[nextPart],\r\n        parts,\r\n        mapPackage,\r\n        nextPart,\r\n      );\r\n    } else {\r\n      this.onDownloadAndUnzipComplete(mapPackage);\r\n    }\r\n  }\r\n\r\n  public async checkAvailableDiskSpace(\r\n    packageMetadataCombined: CompoundPackage\r\n  ): Promise<boolean> {\r\n    if (isAndroidOrIos(this.platform) && this.availableDiskspace != null) {\r\n      const neededSpace = await this.getNeededDiskSpaceForPackage(\r\n        packageMetadataCombined\r\n      );\r\n\r\n      this.loggingService.debug(\r\n        `Available storage is ${this.helperService.humanReadableByteSize(\r\n          this.availableDiskspace.available\r\n        )}. \r\n      Needs ${this.helperService.humanReadableByteSize(neededSpace)}`,\r\n        DEBUG_TAG\r\n      );\r\n\r\n      if (this.availableDiskspace.available < neededSpace) {\r\n        this.loggingService.log(\r\n          'Not enough disk space to save and extract package',\r\n          null,\r\n          LogLevel.Warning,\r\n          DEBUG_TAG\r\n        );\r\n\r\n        await this.showNotEnoughDiskSpaceAvailableErrorMessage();\r\n        return false;\r\n      }\r\n    } else {\r\n      return Promise.resolve(true);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  public async getNeededDiskSpaceForPackage(\r\n    packageMetadataCombined: CompoundPackage,\r\n    compressionFactor = 1.1\r\n  ): Promise<number> {\r\n    const neededSpaceForCurrentPackage =\r\n      packageMetadataCombined.getSizeInMiB() * 1024 * 1024 * compressionFactor;\r\n    const neededSpaceForItemsInQueue = await this.getNeededSpaceForItemsInQueue(compressionFactor);\r\n    return neededSpaceForCurrentPackage + neededSpaceForItemsInQueue;\r\n  }\r\n\r\n  private async getNeededSpaceForItemsInQueue(compressionFactor): Promise<number> {\r\n    return firstValueFrom(this.downloadAndUnzipProgress$\r\n      .pipe(\r\n        map((items) =>\r\n          items\r\n            .filter((x) => x.downloadComplete == null && x.error == null)\r\n            .reduce((pv, cv) => (pv += cv.size * compressionFactor), 0)\r\n        )\r\n      ));\r\n  }\r\n\r\n  private async showNotEnoughDiskSpaceAvailableErrorMessage() {\r\n    const translations = await this.translateService\r\n      .get(['OFFLINE_MAP.DISKSPACE_ERROR_MESSAGE', 'ALERT.OK'])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      message: translations['OFFLINE_MAP.DISKSPACE_ERROR_MESSAGE'],\r\n      buttons: [\r\n        {\r\n          text: translations['ALERT.OK']\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  private async showDownloadOrUnzipErrorMessage(isDownloading: boolean) {\r\n    let messageKey = null;\r\n    if (isDownloading) {\r\n      messageKey = 'OFFLINE_MAP.DOWNLOAD_ERROR_MESSAGE';\r\n    } else if (this.availableDiskspace?.available > 300000000) {\r\n      //we have more than 300MB available\r\n      messageKey = 'OFFLINE_MAP.UNZIP_ERROR_MESSAGE_GENERIC';\r\n    } else {\r\n      messageKey = 'OFFLINE_MAP.UNZIP_ERROR_MESSAGE_NO_SPACE_LEFT';\r\n    }\r\n    const translations = await firstValueFrom(this.translateService.get([messageKey, 'ALERT.OK']));\r\n    const alert = await this.alertController.create({\r\n      message: translations[messageKey],\r\n      buttons: [\r\n        {\r\n          text: translations['ALERT.OK']\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n\r\n  private getDeviceFreeDiskSpace(externalStorage = false): Promise<number> {\r\n    if (!isAndroidOrIos(this.platform)) {\r\n      return Promise.resolve(0);\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n      (window as any)?.DiskSpacePlugin?.info(\r\n        { location: externalStorage ? 2 : 1 },\r\n        (success) => resolve(success.free),\r\n        (err) => reject(err)\r\n      );\r\n    });\r\n  }\r\n\r\n  private addMapPackage(newPackage: OfflineMapPackage) {\r\n    const packages = this.packages.value;\r\n    this.packages.next([...packages, newPackage]);\r\n  }\r\n\r\n  async removeMapPackageByName(packageNameToRemove: string) {\r\n    // Delete files\r\n    const root = await this.getRootFileUrl();\r\n    await this.deleteDirectory(root, packageNameToRemove);\r\n    // Remove package from installed packages subject list\r\n    this.packages.next(\r\n      this.packages.value.filter(\r\n        (mapPackage) => mapPackage.name !== packageNameToRemove\r\n      )\r\n    );\r\n    // Also remove any pending / downloading packages in progress\r\n    this.downloadAndUnzipProgress.next(\r\n      this.downloadAndUnzipProgress.value.filter(\r\n        (mapPackage) => mapPackage.name !== packageNameToRemove\r\n      )\r\n    );\r\n  }\r\n\r\n  private async readCompleteFile(\r\n    packageName: string\r\n  ): Promise<{ size: number; downloadComplete: number }> {\r\n    const path = await this.getCompleteFileUrl(packageName);\r\n    try {\r\n      const fileContent = await Filesystem.readFile({\r\n        path,\r\n        encoding: Encoding.ASCII\r\n      });\r\n      const fileStat = await Filesystem.stat({ path });\r\n      return { size: +fileContent.data, downloadComplete: fileStat.mtime / 1000 };\r\n    } catch (error) {\r\n      const niceError = new Error(`Couldn't read COMPLETE file: ${path}`);\r\n      niceError.stack = error.stack;\r\n      throw niceError;\r\n    }\r\n  }\r\n\r\n  private async hasCompleteFile(packageName: string): Promise<boolean> {\r\n    try {\r\n      const path = await this.getCompleteFileUrl(packageName);\r\n      const uri = (await Filesystem.stat({ path })).uri;\r\n      this.loggingService.debug(\r\n        `Package '${packageName}' has complete file: ${uri}`,\r\n        DEBUG_TAG\r\n      );\r\n      return true;\r\n    } catch (err) {\r\n      // throws error if file does not exist\r\n      return false;\r\n    }\r\n  }\r\n\r\n  private async getMapsInPackageFolder(packageName: string): Promise<string[]> {\r\n    const path = await this.getMapPackageFileUrl(packageName);\r\n    const filenames = await (await Filesystem.readdir({ path })).files;\r\n    //TODO: Hack, assumes that all files in folder is a directory unless it has name 'COMPLETE'\r\n    return filenames.filter((filename) => filename != 'COMPLETE');\r\n  }\r\n\r\n  /**\r\n   * @returns map package metadata\r\n   */\r\n  private async getMetadata(packageName: string): Promise<OfflineMapPackage> {\r\n    this.loggingService.debug(\r\n      'Reading metadata for package:',\r\n      DEBUG_TAG,\r\n      packageName\r\n    );\r\n    const path = await this.getMapPackageFileUrl(packageName);\r\n    const completeFile = await this.readCompleteFile(packageName);\r\n\r\n    const offlineMapPackage: OfflineMapPackage = {\r\n      name: packageName,\r\n      downloadComplete: completeFile.downloadComplete,\r\n      size: completeFile.size,\r\n      maps: {}\r\n    };\r\n\r\n    const maps = await this.getMapsInPackageFolder(packageName);\r\n    for (const map of maps) {\r\n      const metadataPath = `${path}/${map}/${METADATA_FILE}`;\r\n      this.loggingService.debug('Metadata path:', DEBUG_TAG, metadataPath);\r\n      const readFileResult = await Filesystem.readFile({\r\n        path: metadataPath,\r\n        encoding: Encoding.UTF8\r\n      });\r\n      const metadata = JSON.parse(readFileResult.data) as OfflineTilesMetadata;\r\n      this.loggingService.debug('Metadata:', DEBUG_TAG, metadata);\r\n\r\n      offlineMapPackage.maps[map] = {\r\n        ...metadata,\r\n        url: this.webView.convertFileSrc(`${path}/${map}`)\r\n      };\r\n    }\r\n\r\n    this.loggingService.debug(\r\n      'Offline map package metadata: ',\r\n      DEBUG_TAG,\r\n      offlineMapPackage\r\n    );\r\n\r\n    return offlineMapPackage;\r\n  }\r\n\r\n  private createOfflineMapPackage(\r\n    compoundPackageMetadata: CompoundPackage\r\n  ): OfflineMapPackage {\r\n    const mapPackage: OfflineMapPackage = {\r\n      name: compoundPackageMetadata.getName(),\r\n      size: compoundPackageMetadata.getSizeInMiB() * 1024 * 1024,\r\n      downloadStart: moment().unix(),\r\n      progress: {\r\n        percentage: 0,\r\n        step: ProgressStep.pending,\r\n        description: 'In queue...'\r\n      },\r\n      downloadComplete: null,\r\n      maps: {},\r\n      compoundPackageMetadata\r\n    };\r\n    return mapPackage;\r\n  }\r\n\r\n  async unzipFile(\r\n    zipFile: Blob,\r\n    path: string,\r\n    folder: string,\r\n    onComplete: () => void,\r\n    onProgress: (progress: number) => void,\r\n    onError: (error: Error) => void\r\n  ): Promise<void> {\r\n    try {\r\n      const zip = new JSZip();\r\n      const content = await zip.loadAsync(zipFile, {\r\n        createFolders: true\r\n      });\r\n      const zipEntries = Object.keys(content.files);\r\n      this.loggingService.debug(`Loaded ${zipEntries.length} zip entries`, DEBUG_TAG);\r\n\r\n      let i = 0;\r\n      const files = zipEntries.filter((name) => !content.files[name].dir);\r\n      const mod = Math.floor(files.length / 100);\r\n\r\n      const unzipFile = async (fileName: string) => {\r\n        if (this.cancel) {\r\n          return;\r\n        }\r\n        const zippedFile: JSZip.JSZipObject = content.files[fileName];\r\n        const blob: Blob = await zippedFile.async('blob');\r\n        const fileNameWithPath = `${path}/${folder}/${fileName}`;\r\n        await this.writeFile(blob, fileNameWithPath);\r\n\r\n        i++;\r\n        if (i % mod === 0) {\r\n          this.loggingService.debug(\r\n            `Har pakket ut ${i} av ${files.length} filer. Framdrift: ${(i / files.length) * 100}%`,\r\n            DEBUG_TAG\r\n          );\r\n\r\n          onProgress(i / files.length);\r\n        }\r\n      };\r\n\r\n      this.loggingService.debug('Unzipping files');\r\n      await from(files)\r\n        .pipe(mergeMap((file) => unzipFile(file), 10))\r\n        .toPromise();\r\n      onComplete();\r\n    } catch (err) {\r\n      onError(err);\r\n    }\r\n  }\r\n\r\n  private async writeFile(blob: Blob, path: string): Promise<void> {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      const buffer = await blob.arrayBuffer();\r\n      const base64 = arrayBufferToBase64(buffer);\r\n\r\n      let done = false;\r\n      let numAttemptsLeft = 5;\r\n      while (!done && numAttemptsLeft > 0) {\r\n        try {\r\n          await Filesystem.writeFile({\r\n            path,\r\n            data: base64,\r\n            recursive: true\r\n          });\r\n          done = true;\r\n        } catch (error) {\r\n          numAttemptsLeft --;\r\n          const message = `Write of ${path} failed. ${numAttemptsLeft} attempts left`;\r\n          this.loggingService.error(error, DEBUG_TAG, message);\r\n          if (numAttemptsLeft === 0) {\r\n            const noMoreAttemptsError = new Error(message);\r\n            noMoreAttemptsError.stack = error.stack;\r\n            throw noMoreAttemptsError;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private onProgress(metadata: OfflineMapPackage, progress: Progress) {\r\n    metadata.progress = progress;\r\n    const unzipProgress = this.downloadAndUnzipProgress.value.filter(\r\n      (p) => p.name !== metadata.name\r\n    );\r\n    this.downloadAndUnzipProgress.next([...unzipProgress, metadata]);\r\n  }\r\n\r\n  private async onUnzipOrDownloadError(\r\n    metadata: OfflineMapPackage,\r\n    error: Error,\r\n    isDownloading: boolean\r\n  ) {\r\n    this.loggingService.error(\r\n      error,\r\n      DEBUG_TAG,\r\n      `Error downloading map ${metadata.name}`\r\n    );\r\n    metadata.error = error || new Error('Unknown error');\r\n    const errorMessageKey = isDownloading ? 'OFFLINE_MAP.STATUS.DOWNLOAD_ERROR' : 'OFFLINE_MAP.STATUS.UNZIP_ERROR';\r\n    metadata.progress.description = await firstValueFrom(this.translateService.get(errorMessageKey));\r\n    const unzipProgress = this.downloadAndUnzipProgress.value.filter(\r\n      (p) => p.name !== metadata.name\r\n    );\r\n    this.downloadAndUnzipProgress.next([...unzipProgress, metadata]);\r\n    this.resetCancelAndStartNextItemInQueue();\r\n    this.showDownloadOrUnzipErrorMessage(isDownloading);\r\n  }\r\n\r\n  private async onDownloadAndUnzipComplete(mapPackage: OfflineMapPackage) {\r\n    if (!isAndroidOrIos(this.platform)) {\r\n      this.onUnzipOrDownloadError(\r\n        mapPackage,\r\n        new Error('Offline maps for web not implemented!'),\r\n        false\r\n      );\r\n      return;\r\n    }\r\n    mapPackage.downloadComplete = moment().unix();\r\n    mapPackage.progress = { percentage: 1.0 };\r\n\r\n    // Store new combined metadata\r\n    const path = await this.getCompleteFileUrl(mapPackage.name);\r\n    await Filesystem.writeFile({\r\n      path,\r\n      data: `${mapPackage.size}`,\r\n      encoding: Encoding.ASCII\r\n    });\r\n\r\n    // Remove from progress tracking\r\n    const unzipProgress = this.downloadAndUnzipProgress.value.filter(\r\n      (p) => p.name !== mapPackage.name\r\n    );\r\n    this.downloadAndUnzipProgress.next(unzipProgress);\r\n\r\n    // Start any pending downloads\r\n    this.resetCancelAndStartNextItemInQueue();\r\n\r\n    const secondsSpent = mapPackage.downloadComplete - mapPackage.downloadStart;\r\n    const rate = mapPackage.size / 1024 / secondsSpent;\r\n    this.loggingService.debug(\r\n      `Unzip of ${mapPackage.name} finished in ${secondsSpent}s. Speed: ${rate}kb/s`,\r\n      DEBUG_TAG\r\n    );\r\n\r\n    // Add metadata from map package\r\n    const newPackage = await this.getMetadata(mapPackage.name);\r\n    setTimeout(() => {\r\n      this.addMapPackage(newPackage);\r\n    });\r\n\r\n    this.finishedPackageIds.next(newPackage.name);\r\n  }\r\n\r\n  private onCancelled(mapPackage: OfflineMapPackage) {\r\n    this.removeMapPackageByName(mapPackage.name);\r\n    this.resetCancelAndStartNextItemInQueue();\r\n  }\r\n\r\n  private resetCancelAndStartNextItemInQueue() {\r\n    this.cancel = false;\r\n    this.downloadSubscription = null;\r\n    this.startDownloadNextItemInQueue();\r\n  }\r\n\r\n  //#region Directories and file urls\r\n\r\n  /**\r\n   * Get file url for data directory\r\n   *\r\n   * @returns file url as string, with trailing /\r\n   */\r\n  private async getDataDirectory(): Promise<Directory.Data> {\r\n    // if (this.platform.is('android')) {\r\n    //   const userSettings = await this.userSettingService.getUserSettings();\r\n    //   // TODO: Prefer save offline map on SD card? Show a dialog to ask if user wants to save on external directory?\r\n    //   if (false) {\r\n    //     return this.file.externalDataDirectory;\r\n    //   }\r\n    // }\r\n    return Directory.Data;\r\n  }\r\n\r\n  /**\r\n   * Get file url to the root directory\r\n   * containing all map packages.\r\n   *\r\n   * @returns file url as string, without trailing /\r\n   */\r\n  private async getRootFileUrl(): Promise<string> {\r\n    if (this.rootFileUrl === '') {\r\n      const dataDirectory = await this.getDataDirectory();\r\n      const readDirResult = await Filesystem.readdir({\r\n        path: '',\r\n        directory: dataDirectory\r\n      });\r\n      if (!readDirResult.files.includes(ROOT_MAP_DIR)) {\r\n        await Filesystem.mkdir({\r\n          path: ROOT_MAP_DIR,\r\n          directory: dataDirectory\r\n        });\r\n      }\r\n      const uriResult = await Filesystem.getUri({\r\n        path: ROOT_MAP_DIR,\r\n        directory: dataDirectory\r\n      });\r\n      this.rootFileUrl = uriResult.uri;\r\n\r\n      if (this.rootFileUrl.endsWith('/')) {\r\n        this.rootFileUrl = this.rootFileUrl.slice(0, -1);\r\n      }\r\n    }\r\n    return this.rootFileUrl;\r\n  }\r\n\r\n  /**\r\n   * Get file url to map package\r\n   *\r\n   * @param name - map package name\r\n   * @returns file url as string\r\n   */\r\n  private async getMapPackageFileUrl(name: string): Promise<string> {\r\n    const root = await this.getRootFileUrl();\r\n    return `${root}/${name}`;\r\n  }\r\n\r\n  /**\r\n   * Get file url to COMPLETE file in map package\r\n   *\r\n   * @param name - map package name\r\n   * @returns file url as string\r\n   */\r\n  private async getCompleteFileUrl(packageName: string): Promise<string> {\r\n    const path = await this.getMapPackageFileUrl(packageName);\r\n    return `${path}/COMPLETE`;\r\n  }\r\n\r\n  private async deleteDirectory(path: string, dirName: string): Promise<void> {\r\n    if (!isAndroidOrIos(this.platform)) {\r\n      return;\r\n    }\r\n    const folderUrl = `${path}/${dirName}`;\r\n    await Filesystem.rmdir({ path: folderUrl, recursive: true })\r\n      .then(() => {\r\n        this.loggingService.debug(`removed folder: ${folderUrl}`);\r\n      })\r\n      .catch((err) => {\r\n        this.loggingService.error(\r\n          err,\r\n          'background download native',\r\n          `remove folder failed: ${folderUrl}`\r\n        );\r\n      });\r\n  }\r\n\r\n  // TODO: Kan vi bruke disse til noe?\r\n  // Dette blir kalt når brukeren trykker \"resett app\" i innstillinger, så her må alle kartpakker slettes fra disk..\r\n  // appOnReset(): void | Promise<any> {}\r\n  // appOnResetComplete(): void | Promise<any> {}\r\n}\r\n","import { OfflineMapPackage } from './offline-map.model';\r\n\r\ninterface RegisteredPackageInfo {url: string; zMin: number; zMax: number}\r\ntype RegisterForMapType = Map<string, RegisteredPackageInfo>;\r\n\r\n\r\n/**\r\n * Registry structure (map of maps):\r\n *\r\n *   statensKartverk       // First map\r\n *       152_48_8          // Nested map, x_y_z key (root tile)\r\n *         url: \"...\"\r\n *         zMin: 14\r\n *         zMax: 8\r\n *\r\n *       152_49_8\r\n *         ...\r\n *\r\n *   steepness-outlet\r\n *       152_49_8\r\n *         ...\r\n */\r\nexport class OfflineTilesRegistry {\r\n  private registry: Map<string, RegisterForMapType> = new Map();\r\n  private lowestRootTileZ: number;\r\n  private highestRootTileZ: number;\r\n  private highestZmax = 0;\r\n\r\n  clear(): void {\r\n    this.registry.clear();\r\n  }\r\n\r\n  add(mapPackage: OfflineMapPackage): void {\r\n    for (const mapType in mapPackage.maps) {\r\n      const map = mapPackage.maps[mapType];\r\n      if (!this.registry.has(mapType)) {\r\n        this.registry.set(mapType, new Map());\r\n      }\r\n      const registryForMapType = this.registry.get(mapType);\r\n      const registryKey = this.getKey(map.rootTile.x, map.rootTile.y, map.rootTile.z);\r\n      registryForMapType.set(registryKey, { url: map.url, zMin: map.rootTile.z, zMax: map.zMax});\r\n      if (!this.lowestRootTileZ || map.rootTile.z < this.lowestRootTileZ) {\r\n        this.lowestRootTileZ = map.rootTile.z;\r\n      }\r\n      if (!this.highestRootTileZ || map.rootTile.z > this.highestRootTileZ) {\r\n        this.highestRootTileZ = map.rootTile.z;\r\n      }\r\n      if (map.zMax > this.highestZmax) {\r\n        this.highestZmax = map.zMax;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Return a url template to an offline map package valid for the provided\r\n   * coordinates and map type. If there is no match between the coordinates\r\n   * / map types and registered packages, undefined is returned.\r\n   *\r\n   * @param mapType example: statensKartverk\r\n   */\r\n  getUrl(mapType: string, x: number, y: number, z: number): string | undefined {\r\n    if (z > this.highestZmax) {\r\n      return undefined;\r\n    }\r\n    const packageInfo = this.findRegisteredPackage(mapType, x, y, z);\r\n    if (packageInfo && packageInfo.zMax >= z) {\r\n      return packageInfo.url;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Finds registered packages that overlaps with the search x,y coordinates.\r\n   * The returned package does not need to overlap in z axis.\r\n   */\r\n  findRegisteredPackage(mapType: string, x: number, y: number, z: number): RegisteredPackageInfo | undefined {\r\n    if (!this.registry.has(mapType)) {\r\n      return undefined;\r\n    }\r\n\r\n    let _x = x;\r\n    let _y = y;\r\n    let _z = z;\r\n\r\n    //find topmost tile x and y\r\n    while (_z > this.highestRootTileZ) {\r\n      _z--;\r\n      _x = Math.floor(_x / 2);\r\n      _y = Math.floor(_y / 2);\r\n    }\r\n    while (_z >= this.lowestRootTileZ) {\r\n      const registryKey = this.getKey(_x, _y, _z);\r\n      const rootTileInfo = this.registry.get(mapType).get(registryKey);\r\n      if (rootTileInfo) {\r\n        return rootTileInfo;\r\n      }\r\n      _x = Math.floor(_x / 2);\r\n      _y = Math.floor(_y / 2);\r\n      _z--;\r\n    }\r\n    return undefined; //we didn't find any topmost tile\r\n  }\r\n\r\n  private getKey(x: number, y: number, z: number): string {\r\n    return `${x}_${y}_${z}`;\r\n  }\r\n}","export enum ProgressStep {\r\n  pending = 0,\r\n  download = 1,\r\n  extractZip = 2,\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { map, take, filter, switchMap, delay } from 'rxjs/operators';\r\nimport moment from 'moment';\r\nimport { AlertController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable, of, from } from 'rxjs';\r\nimport { settings } from '../../../../settings';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class PopupInfoService {\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private alertController: AlertController,\r\n    private translateService: TranslateService\r\n  ) {}\r\n\r\n  checkObservationInfoPopup(_: string = null, delayMs = 2000) {\r\n    return this.checkInfoPopup(\r\n      delayMs,\r\n      'infoAboutObservationsRecievedTimestamps',\r\n      'static',\r\n      'POPUP_DISCLAMER.ABOUT_OBSERVATIONS.HEADER',\r\n      'POPUP_DISCLAMER.ABOUT_OBSERVATIONS.MESSAGE',\r\n      'POPUP_DISCLAMER.OK_I_UNDERSTAND'\r\n    );\r\n  }\r\n\r\n  checkSupportMapInfoPopup(_: string = null, delayMs = 2000) {\r\n    return this.checkInfoPopup(\r\n      delayMs,\r\n      'infoAboutSupportMapsRecievedTimestamps',\r\n      'static',\r\n      'POPUP_DISCLAMER.ABOUT_SUPPORT_MAPS.HEADER',\r\n      'POPUP_DISCLAMER.ABOUT_SUPPORT_MAPS.MESSAGE',\r\n      'POPUP_DISCLAMER.OK_I_UNDERSTAND'\r\n    );\r\n  }\r\n\r\n  checkOfflineSupportMapInfoPopup(name: string, delayMs = 2000) {\r\n    return this.checkInfoPopup(\r\n      delayMs,\r\n      'infoAboutOfflineSupportMapsRecievedTimestamps',\r\n      name,\r\n      'POPUP_DISCLAMER.ABOUT_OFFLINE_SUPPORT_MAPS.HEADER',\r\n      'POPUP_DISCLAMER.ABOUT_OFFLINE_SUPPORT_MAPS.MESSAGE',\r\n      'POPUP_DISCLAMER.OK_I_UNDERSTAND'\r\n    );\r\n  }\r\n\r\n  checkLastTimestamp(\r\n    limitMs: number,\r\n    lastTimestamp?: number,\r\n    showWhenNull = true\r\n  ): boolean {\r\n    if (lastTimestamp === undefined || lastTimestamp === null) {\r\n      return showWhenNull;\r\n    }\r\n    const limit = moment().subtract(limitMs, 'milliseconds');\r\n    return moment.unix(lastTimestamp).isBefore(limit);\r\n  }\r\n\r\n  async showAlert(\r\n    header: string,\r\n    message: string,\r\n    okText: string\r\n  ): Promise<void> {\r\n    const alert = await this.alertController.create({\r\n      header,\r\n      message,\r\n      buttons: [okText]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  geAlertTranslations(\r\n    headerKey: string,\r\n    messageKey: string,\r\n    okKey: string\r\n  ): Observable<{ header: string; message: string; okText: string }> {\r\n    return this.translateService.get([headerKey, messageKey, okKey]).pipe(\r\n      map((translations) => ({\r\n        header: translations[headerKey],\r\n        message: translations[messageKey],\r\n        okText: translations[okKey]\r\n      }))\r\n    );\r\n  }\r\n\r\n  async saveInfoAboutRecievedTimestamp(timestampType: string, timestampName: string) {\r\n    let userSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    userSettings = {\r\n      ...userSettings,\r\n      [timestampType]: timestampType in userSettings ? {\r\n        ...userSettings[timestampType],\r\n        [timestampName]: moment().unix(),\r\n      } : {[timestampName]: moment().unix()}\r\n    };\r\n    this.userSettingService.saveUserSettings(userSettings);\r\n  }\r\n\r\n  private checkInfoPopup(\r\n    delayMs = 2000,\r\n    timestampType: string,\r\n    timestampName: string,\r\n    header: string,\r\n    msg: string,\r\n    ok_txt: string,\r\n    refreshTimeMs: number = settings.popupDisclamerRefreshTimeMs,\r\n  ) {\r\n    return this.userSettingService.userSetting$.pipe(\r\n      take(1),\r\n      delay(delayMs),\r\n      filter((us) =>\r\n        this.checkLastTimestamp(\r\n          refreshTimeMs,\r\n          timestampType in us ? us[timestampType][timestampName] : null,\r\n        )\r\n      ),\r\n      switchMap(() =>\r\n        this.geAlertTranslations(header, msg, ok_txt)\r\n      ),\r\n      switchMap((translations) =>\r\n        from(\r\n          this.showAlert(\r\n            translations.header,\r\n            translations.message,\r\n            translations.okText\r\n          )\r\n        )\r\n      ),\r\n      switchMap(() => from(this.saveInfoAboutRecievedTimestamp(timestampType, timestampName)))\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Platform } from '@ionic/angular';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { GeoHelperService } from '../../../modules/shared/services/geo-helper/geo-helper.service';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\n\r\nconst DEBUG_TAG = 'ShortcutService';\r\nconst FLAG_ACTIVITY_CLEAR_TOP = 67108864;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ShortcutService {\r\n  constructor(\r\n    private platform: Platform,\r\n    private loggingService: LoggingService,\r\n    private translateService: TranslateService,\r\n    private geoHelperService: GeoHelperService\r\n  ) {}\r\n\r\n  init() {\r\n    const w = <any>window;\r\n    if (\r\n      this.platform.is('hybrid') &&\r\n      this.platform.is('android') &&\r\n      w.plugins &&\r\n      w.plugins.Shortcuts\r\n    ) {\r\n      this.initAndroidShortcusts();\r\n      return;\r\n    }\r\n    this.loggingService.debug('Dynamic shortcuts not supported', DEBUG_TAG);\r\n  }\r\n\r\n  private getImage(geoHazard: GeoHazard) {\r\n    switch (geoHazard) {\r\n    case GeoHazard.Snow:\r\n      return 'ic_snow';\r\n    case GeoHazard.Soil:\r\n      return 'ic_dirt';\r\n    case GeoHazard.Ice:\r\n      return 'ic_ice';\r\n    case GeoHazard.Water:\r\n      return 'ic_water';\r\n    }\r\n  }\r\n\r\n  private async getShortcuts() {\r\n    const geoHazards = this.geoHelperService.getAllGeoHazards();\r\n    const geoHazardsKeys = this.geoHelperService.getTranslationKeys(geoHazards);\r\n    const translations = await this.translateService\r\n      .get([\r\n        'ADD_MENU.NEW_OBSERVATION',\r\n        'MAP_ITEM_BAR.OBSERVATION',\r\n        ...geoHazardsKeys\r\n      ])\r\n      .toPromise();\r\n\r\n    const getLongLabelTranslation = (geoHazardName: string) =>\r\n      `${\r\n        translations['ADD_MENU.NEW_OBSERVATION']\r\n      } ${geoHazardName.toLowerCase()} ${\r\n        translations['MAP_ITEM_BAR.OBSERVATION']\r\n      }`;\r\n    const getShortLabel = (geoHazardName: string) => `+ ${geoHazardName}`;\r\n\r\n    return geoHazards.map((geoHazard) => ({\r\n      id: `regobs_shortcut_new_registration_${geoHazard}`,\r\n      url: `regobs://registration/new/${geoHazard}`,\r\n      shortLabel: getShortLabel(\r\n        translations[this.geoHelperService.getTranslationKey(geoHazard)]\r\n      ),\r\n      longLabel: getLongLabelTranslation(\r\n        translations[this.geoHelperService.getTranslationKey(geoHazard)]\r\n      ),\r\n      iconFromResource: this.getImage(geoHazard)\r\n    }));\r\n  }\r\n\r\n  private initAndroidShortcusts() {\r\n    this.loggingService.debug(\r\n      'Initializing dynamic shortcuts for Android',\r\n      DEBUG_TAG\r\n    );\r\n    const w = <any>window;\r\n    w.plugins.Shortcuts.supportsDynamic(\r\n      async (supported) => {\r\n        if (!supported) {\r\n          this.loggingService.debug(\r\n            'Dynamic shortcuts not supported',\r\n            DEBUG_TAG\r\n          );\r\n          return;\r\n        }\r\n        const shortcuts = await this.getShortcuts();\r\n        const shortcutsFull = shortcuts.map((s) => ({\r\n          ...s,\r\n          intent: {\r\n            action: 'android.intent.action.VIEW',\r\n            flags: FLAG_ACTIVITY_CLEAR_TOP, // FLAG_ACTIVITY_CLEAR_TOP\r\n            data: s.url // Must be a well-formed URI\r\n          }\r\n        }));\r\n        this.loggingService.debug(\r\n          'Adding dynamic shortcuts:',\r\n          DEBUG_TAG,\r\n          shortcutsFull\r\n        );\r\n        w.plugins.Shortcuts.setDynamic(\r\n          shortcutsFull,\r\n          () => {\r\n            this.loggingService.debug(\r\n              'Shortcuts were applied successfully',\r\n              DEBUG_TAG\r\n            );\r\n          },\r\n          (error) => {\r\n            this.loggingService.log(\r\n              'Error setting dynamic shortcuts!',\r\n              error,\r\n              LogLevel.Warning,\r\n              DEBUG_TAG\r\n            );\r\n          }\r\n        );\r\n      },\r\n      (error) => {\r\n        this.loggingService.log(\r\n          'Error when checking support for dynamic shortcuts!',\r\n          error,\r\n          LogLevel.Warning,\r\n          DEBUG_TAG\r\n        );\r\n      }\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Subject, Observable } from 'rxjs';\r\nimport { shareReplay } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SwipeBackService {\r\n  private _subject: Subject<boolean>;\r\n\r\n  swipeBackEnabled$: Observable<boolean>;\r\n\r\n  constructor() {\r\n    this._subject = new Subject<boolean>();\r\n    this.swipeBackEnabled$ = this._subject.asObservable().pipe(shareReplay(1));\r\n    this._subject.next(true);\r\n  }\r\n\r\n  enableSwipeBack() {\r\n    this._subject.next(true);\r\n  }\r\n\r\n  disableSwipeBack() {\r\n    this._subject.next(false);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { TripLogItem } from './trip-log-item.model';\r\nimport moment from 'moment';\r\nimport { TripLogState } from './trip-log-state.enum';\r\nimport { TripLogActivity } from './trip-log-activity.model';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { Observable, from, BehaviorSubject, throwError } from 'rxjs';\r\nimport { CreateTripDto, TripService } from '@varsom-regobs-common/regobs-api';\r\nimport {\r\n  switchMap,\r\n  take,\r\n  map,\r\n  concatMap,\r\n  filter,\r\n  tap,\r\n  catchError\r\n} from 'rxjs/operators';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { ToastController, AlertController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { LegacyTrip } from './legacy-trip.model';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { NSqlFullUpdateObservable } from '../../helpers/nano-sql/NSqlFullUpdateObservable';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\n\r\nconst DEBUG_TAG = 'TripLoggerService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class TripLoggerService {\r\n  get isTripRunning$(): Observable<boolean> {\r\n    return this.tripStartedSubject.asObservable();\r\n  }\r\n\r\n  private tripStartedSubject = new BehaviorSubject(false);\r\n\r\n  constructor(\r\n    private tripService: TripService,\r\n    private userSettingService: UserSettingService,\r\n    private translateService: TranslateService,\r\n    private alertController: AlertController,\r\n    private loggingService: LoggingService,\r\n    private toastController: ToastController\r\n  ) {\r\n    this.userSettingService.appMode$\r\n      .pipe(\r\n        switchMap((appMode) => from(this.getLegacyTripFromDbByAppMode(appMode)))\r\n      )\r\n      .subscribe((legacyTrip) => {\r\n        this.tripStartedSubject.next(legacyTrip != null);\r\n      });\r\n  }\r\n\r\n  saveTripLogItem(item: TripLogItem): Promise<unknown> {\r\n    return nSQL(NanoSql.TABLES.TRIP_LOG.name).query('upsert', item).exec();\r\n  }\r\n\r\n  getTripLogAsObservable(): Observable<TripLogItem[]> {\r\n    return new NSqlFullUpdateObservable<TripLogItem[]>(\r\n      nSQL(NanoSql.TABLES.TRIP_LOG.name).query('select').listen()\r\n    );\r\n  }\r\n\r\n  updateState(state: TripLogState): Promise<unknown> {\r\n    return nSQL(NanoSql.TABLES.TRIP_LOG_ACTIVITY.name)\r\n      .query('upsert', { state, timestamp: moment().unix() })\r\n      .exec();\r\n  }\r\n\r\n  getTripLogStateAsObservable(): Observable<TripLogActivity> {\r\n    return new NSqlFullUpdateObservable<TripLogActivity[]>(\r\n      nSQL(NanoSql.TABLES.TRIP_LOG_ACTIVITY.name)\r\n        .query('select')\r\n        .orderBy(['id: desc'])\r\n        .limit(1)\r\n        .listen({})\r\n    ).pipe(map((ta) => ta[0]));\r\n  }\r\n\r\n  getTripLogActivityAsObservable(): Observable<TripLogActivity[]> {\r\n    return new NSqlFullUpdateObservable<TripLogActivity[]>(\r\n      nSQL(NanoSql.TABLES.TRIP_LOG_ACTIVITY.name).query('select').listen()\r\n    );\r\n  }\r\n\r\n  getLegacyTripAsObservable(): Observable<LegacyTrip> {\r\n    return this.userSettingService.appMode$.pipe(\r\n      switchMap((appMode) => from(this.getLegacyTripFromDbByAppMode(appMode)))\r\n    );\r\n  }\r\n\r\n  async getLegacyTripFromDbByAppMode(appMode: AppMode): Promise<LegacyTrip> {\r\n    const result = (await NanoSql.getInstance(\r\n      NanoSql.TABLES.LEGACY_TRIP_LOG.name,\r\n      appMode\r\n    )\r\n      .query('select')\r\n      .exec()) as LegacyTrip[];\r\n    return result[0];\r\n  }\r\n\r\n  startLegacyTrip(tripDto: CreateTripDto): Observable<void> {\r\n    const legacyTrip: LegacyTrip = {\r\n      id: 'legacytrip',\r\n      timestamp: moment().unix(),\r\n      request: tripDto\r\n    };\r\n    return this.userSettingService.appMode$.pipe(\r\n      take(1),\r\n      switchMap((appMode) =>\r\n        this.tripService\r\n          .TripPost(tripDto)\r\n          .pipe(\r\n            switchMap(() =>\r\n              from(\r\n                NanoSql.getInstance(\r\n                  NanoSql.TABLES.LEGACY_TRIP_LOG.name,\r\n                  appMode\r\n                )\r\n                  .query('upsert', legacyTrip)\r\n                  .exec()\r\n              )\r\n            )\r\n          )\r\n      ),\r\n      tap(() => this.tripStartedSubject.next(true)),\r\n      switchMap(() => this.infoMessage(true)),\r\n      catchError((err) => {\r\n        this.tripStartedSubject.next(false);\r\n        return throwError(err);\r\n      })\r\n    );\r\n  }\r\n\r\n  stopLegacyTrip(showConfirm = true): void {\r\n    if (showConfirm) {\r\n      this.confirmStopTrip();\r\n    } else {\r\n      this.callStopLegacyTripApiAndDeleteFromDb();\r\n    }\r\n  }\r\n\r\n  async showTripErrorMessage(start: boolean): Promise<void> {\r\n    const translations = await this.translateService\r\n      .get(['ALERT.DEFAULT_HEADER', 'ALERT.OK', 'TRIP.ERROR', 'TRIP.END_ERROR'])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations['ALERT.DEFAULT_HEADER'],\r\n      message: start\r\n        ? translations['TRIP.ERROR']\r\n        : translations['TRIP.END_ERROR'],\r\n      buttons: [translations['ALERT.OK']]\r\n    });\r\n    return alert.present();\r\n  }\r\n\r\n  async showTripNoPositionErrorMessage(): Promise<void> {\r\n    const translations = await this.translateService\r\n      .get(['ALERT.DEFAULT_HEADER', 'ALERT.OK', 'TRIP.ERROR_POSITION'])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations['ALERT.DEFAULT_HEADER'],\r\n      message: translations['TRIP.ERROR_POSITION'],\r\n      buttons: [translations['ALERT.OK']]\r\n    });\r\n    return alert.present();\r\n  }\r\n\r\n  private async confirmStopTrip(): Promise<void> {\r\n    const translations = await this.translateService\r\n      .get([\r\n        'TRIP.STOP_TRIP',\r\n        'REGISTRATION.DELETE_CONFIRM',\r\n        'ALERT.OK',\r\n        'ALERT.CANCEL'\r\n      ])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations['TRIP.STOP_TRIP'] + '?',\r\n      message: translations['REGISTRATION.DELETE_CONFIRM'],\r\n      buttons: [\r\n        {\r\n          text: translations['ALERT.CANCEL'],\r\n          role: 'cancel',\r\n          cssClass: 'secondary'\r\n        },\r\n        {\r\n          text: translations['ALERT.OK'],\r\n          handler: () => this.callStopLegacyTripApiAndDeleteFromDb()\r\n        }\r\n      ]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  private callStopLegacyTripApiAndDeleteFromDb() {\r\n    this.getLegacyTripAsObservable()\r\n      .pipe(\r\n        take(1),\r\n        filter((trip) => !!trip),\r\n        concatMap((trip) =>\r\n          this.tripService.TripPut({ DeviceGuid: trip.request.DeviceGuid })\r\n        ),\r\n        concatMap(() => this.deleteLegacyTripsFromDb()),\r\n        concatMap(() => this.infoMessage(false))\r\n      )\r\n      .subscribe(\r\n        () => {\r\n          this.tripStartedSubject.next(false);\r\n        },\r\n        async (error) => {\r\n          this.loggingService.error(error, DEBUG_TAG, 'Could not stop trip');\r\n          this.tripStartedSubject.next(false);\r\n          await this.showTripErrorMessage(false);\r\n        }\r\n      );\r\n  }\r\n\r\n  private deleteLegacyTripsFromDb() {\r\n    return this.userSettingService.appMode$.pipe(\r\n      concatMap((appMode) =>\r\n        from(\r\n          NanoSql.getInstance(NanoSql.TABLES.LEGACY_TRIP_LOG.name, appMode)\r\n            .query('delete')\r\n            .exec()\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  cleanupOldLegacyTrip(): Promise<unknown> {\r\n    return this.getLegacyTripAsObservable()\r\n      .pipe(\r\n        filter(\r\n          (trip) => trip && trip.timestamp < moment().startOf('day').unix()\r\n        ),\r\n        concatMap(() => this.deleteLegacyTripsFromDb()),\r\n        take(1)\r\n      )\r\n      .toPromise();\r\n  }\r\n\r\n  private infoMessage(started: boolean) {\r\n    const key = started ? 'TRIP.STARTED' : 'TRIP.STOPPED';\r\n    return this.translateService\r\n      .get(key)\r\n      .pipe(switchMap((message) => from(this.presentToast(message))));\r\n  }\r\n\r\n  async presentToast(message: string): Promise<void> {\r\n    const toast = await this.toastController.create({\r\n      message,\r\n      mode: 'md',\r\n      duration: 2000\r\n    });\r\n    return toast.present();\r\n  }\r\n\r\n  // getTripLogSummaryAsObservable(): Observer<TripLogSummary> {\r\n  //   return nSQL().observable<TripLogItem[]>(() => {\r\n  //     return nSQL(tableName).query('select').emit();\r\n  //   }).map((tripLog) => ({\r\n  //       started: moment(tripLog[0].timestamp)\r\n  //    }));\r\n  // }\r\n\r\n  // async endTrip() {\r\n  //   await nSQL(tableName)\r\n  //     .query('upsert', { stop: new Date() })\r\n  //     .where(['tripLogId', '=', this.currentTripLoggerId])\r\n  //     .exec();\r\n  //   this.currentTripLoggerId = null;\r\n  // }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UserSetting } from '../../models/user-settings.model';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { GeoHazard, LangKey, AppMode } from '@varsom-regobs-common/core';\r\nimport { settings } from '../../../../settings';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { Observable, combineLatest, BehaviorSubject, from, of } from 'rxjs';\r\nimport {\r\n  map,\r\n  shareReplay,\r\n  distinctUntilChanged,\r\n  tap,\r\n  takeUntil,\r\n  catchError,\r\n  debounceTime,\r\n  switchMap,\r\n  concatMap,\r\n  filter\r\n} from 'rxjs/operators';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { OnReset } from '../../../modules/shared/interfaces/on-reset.interface';\r\nimport equal from 'fast-deep-equal';\r\nimport { NgDestoryBase } from '../../helpers/observable-helper';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { DEFAULT_USER_SETTINGS } from './user-settings.default';\r\nimport { registerLocaleData } from '@angular/common';\r\nimport nbData from '@angular/common/locales/nb';\r\nimport svData from '@angular/common/locales/sv';\r\nimport enData from '@angular/common/locales/en';\r\nimport deData from '@angular/common/locales/de';\r\nimport slData from '@angular/common/locales/sl';\r\nimport nnData from '@angular/common/locales/nn';\r\nimport frData from '@angular/common/locales/fr';\r\nimport { UserSettingsPage } from 'src/app/pages/user-settings/user-settings.page';\r\nimport { SupportTile } from '../../models/support-tile.model';\r\n\r\nconst DEBUG_TAG = 'UserSettingService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UserSettingService extends NgDestoryBase implements OnReset {\r\n  // Setting this observable to be a shared instance since\r\n  // UserSettingService is a singleton service.\r\n  // The observable will be shared with many services\r\n  public readonly currentGeoHazard$: Observable<GeoHazard[]>;\r\n  public readonly appMode$: Observable<AppMode>;\r\n  public readonly showMapCenter$: Observable<boolean>;\r\n  public readonly appModeAndLanguage$: Observable<[AppMode, LangKey]>;\r\n  public readonly appModeLanguageAndCurrentGeoHazard$: Observable<\r\n    [AppMode, LangKey, GeoHazard[]]\r\n  >;\r\n  public readonly language$: Observable<LangKey>;\r\n  public readonly daysBack$: Observable<\r\n    { geoHazard: GeoHazard; daysBack: number }[]\r\n  >;\r\n  public readonly showObservations$: Observable<boolean>;\r\n  public readonly userSetting$: Observable<UserSetting>;\r\n\r\n  private userSettingInMemory = new BehaviorSubject<UserSetting>(null);\r\n  // private userSettingsReady = new BehaviorSubject(false);\r\n\r\n  // get userSettingsReady$() {\r\n  //   return this.userSettingsReady.asObservable();\r\n  // }\r\n\r\n  // get currentSettings() {\r\n  //   return this.userSettingInMemory.getValue();\r\n  // }\r\n\r\n  // set currentSettings(val: UserSetting) {\r\n  //   this.saveUserSettings(val);\r\n  // }\r\n\r\n  get supportTiles$() {\r\n    return this.userSetting$.pipe(map((us) => this.getSupportTilesOptions(us, true)));\r\n  }\r\n\r\n  get supportTilesWithSubTiles$() {\r\n    return this.userSetting$.pipe(map((us) => this.getSupportTilesOptions(us, false)));\r\n  }\r\n\r\n  constructor(\r\n    private translate: TranslateService,\r\n    private loggingService: LoggingService\r\n  ) {\r\n    super();\r\n    this.userSetting$ = this.userSettingInMemory.asObservable().pipe(\r\n      concatMap((val) =>\r\n        val ? of(val) : this.getUserSettingsFromDbOrDefaultSettings()\r\n      ),\r\n      tap((val) => {\r\n        this.loggingService?.debug('User settings is: ', DEBUG_TAG, val);\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n    this.currentGeoHazard$ = this.userSetting$.pipe(\r\n      map((val) => val.currentGeoHazard),\r\n      distinctUntilChanged(equal),\r\n      tap((val) =>\r\n        this.loggingService?.debug(\r\n          `Current geohazard changed to: ${val.join(',')}`,\r\n          DEBUG_TAG\r\n        )\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.appMode$ = this.userSetting$.pipe(\r\n      map((val) => val.appMode),\r\n      distinctUntilChanged(),\r\n      tap((val) => {\r\n        this.loggingService?.debug('App mode is: ', DEBUG_TAG, val);\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.showMapCenter$ = this.userSetting$.pipe(\r\n      map((val) => val.showMapCenter),\r\n      distinctUntilChanged(),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.language$ = this.userSetting$.pipe(\r\n      map((val) => val.language),\r\n      distinctUntilChanged(),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.appModeAndLanguage$ = combineLatest([\r\n      this.appMode$,\r\n      this.language$\r\n    ]).pipe(shareReplay(1));\r\n\r\n    this.appModeLanguageAndCurrentGeoHazard$ = combineLatest([\r\n      this.appMode$,\r\n      this.language$,\r\n      this.currentGeoHazard$\r\n    ]).pipe(shareReplay(1));\r\n\r\n    this.daysBack$ = this.userSetting$.pipe(\r\n      map((val) => val.observationDaysBack),\r\n      distinctUntilChanged(equal),\r\n      tap((val) =>\r\n        this.loggingService?.debug('Days back changed to:', DEBUG_TAG, val)\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.showObservations$ = this.userSetting$.pipe(\r\n      map((val) => val.showObservations),\r\n      distinctUntilChanged(),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  public init() {\r\n    this.createLanguageChangeListener();\r\n    // this.updateInMemoryRegistrationsFromDb();\r\n    this.createSaveToDbOnChangeListener();\r\n  }\r\n\r\n  private createLanguageChangeListener() {\r\n    this.language$.pipe(takeUntil(this.ngDestroy$)).subscribe((langKey) => {\r\n      const lang = LangKey[langKey];\r\n      switch (langKey) {\r\n      case LangKey.nb:\r\n        registerLocaleData(nbData);\r\n        break;\r\n      case LangKey.en:\r\n        registerLocaleData(enData);\r\n        break;\r\n      case LangKey.de:\r\n        registerLocaleData(deData);\r\n        break;\r\n      case LangKey.sv:\r\n        registerLocaleData(svData);\r\n        break;\r\n      case LangKey.sl:\r\n        registerLocaleData(slData);\r\n        break;\r\n      case LangKey.nn:\r\n        registerLocaleData(nnData);\r\n        break;\r\n      //TODO: Ta med denne når API'et støtter fransk\r\n      // case LangKey.fr:\r\n      //   registerLocaleData(frData);\r\n      //   break;\r\n      }\r\n      this.translate.use(lang);\r\n    });\r\n  }\r\n\r\n  private createSaveToDbOnChangeListener() {\r\n    this.userSettingInMemory\r\n      .pipe(\r\n        filter((result) => !!result),\r\n        debounceTime(200),\r\n        tap((result) =>\r\n          this.loggingService?.debug(\r\n            'InMemory user settings changed. Saving to db: ',\r\n            DEBUG_TAG,\r\n            result\r\n          )\r\n        ),\r\n        switchMap((result) => this.saveUserSettingsToDb(result)),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  saveUserSettings(userSetting: UserSetting) {\r\n    this.userSettingInMemory.next(userSetting);\r\n  }\r\n\r\n  getSupportTilesOptions(us: UserSetting, flat = true): SupportTile[] {\r\n    const supportTilesForCurrentGeoHazard: SupportTile[] = settings.map.tiles.supportTiles.filter(\r\n      (setting) => us.currentGeoHazard.indexOf(setting.geoHazardId) >= 0\r\n    ).map((tile) => {\r\n      const usSupportTile = us.supportTiles.find(\r\n        (usTiles) => usTiles.name === tile.name\r\n      );\r\n      let subTile = tile.subTile;\r\n      if (subTile && usSupportTile && usSupportTile.subTile) {\r\n        subTile = {...tile.subTile, ...usSupportTile.subTile};\r\n      }\r\n      return {\r\n        ...(usSupportTile ? {...tile, ...usSupportTile} : tile),\r\n        subTile: subTile,\r\n      };\r\n    });\r\n\r\n    if (flat) {\r\n      supportTilesForCurrentGeoHazard\r\n        .filter((tile) => tile.subTile)\r\n        .forEach((tile) => {\r\n          supportTilesForCurrentGeoHazard.push({\r\n            ...tile.subTile,\r\n            opacity: tile.opacity,\r\n            geoHazardId: tile.geoHazardId,\r\n          });\r\n          delete tile.subTile;\r\n        });\r\n    }\r\n\r\n    return supportTilesForCurrentGeoHazard;\r\n  }\r\n\r\n  private getUserSettingsFromDbOrDefaultSettings(): Observable<UserSetting> {\r\n    return this.getUserSettingsFromDb().pipe(\r\n      map((result) => (result ? result : DEFAULT_USER_SETTINGS(null)))\r\n    );\r\n  }\r\n\r\n  private getUserSettingsFromDb(): Observable<UserSetting> {\r\n    return from(\r\n      nSQL(NanoSql.TABLES.USER_SETTINGS.name).query('select').exec() as Promise<\r\n        UserSetting[]\r\n      >\r\n    ).pipe(map((result) => result[0]));\r\n  }\r\n\r\n  private saveUserSettingsToDb(\r\n    userSetting: UserSetting\r\n  ): Observable<UserSetting[]> {\r\n    return from(\r\n      nSQL(NanoSql.TABLES.USER_SETTINGS.name)\r\n        .query('upsert', { id: 'usersettings', ...userSetting })\r\n        .exec() as Promise<UserSetting[]>\r\n    ).pipe(\r\n      catchError((err) => {\r\n        this.loggingService?.log(\r\n          'Could not save user settings to offline db',\r\n          err,\r\n          LogLevel.Warning,\r\n          DEBUG_TAG\r\n        );\r\n        return of(null);\r\n      })\r\n    );\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\r\n  appOnReset() {}\r\n\r\n  appOnResetComplete() {\r\n    this.loggingService.debug(\r\n      'App reset complete. Re-init observables.',\r\n      DEBUG_TAG\r\n    );\r\n    // const defaultSettings = DEFAULT_USER_SETTINGS(null);\r\n    // this.saveUserSettings(defaultSettings);\r\n    this.userSettingInMemory.next(null); // Reset in memory observable\r\n  }\r\n}\r\n","import { UserSetting } from '../../models/user-settings.model';\r\nimport { GeoHazard, LangKey, AppMode } from '@varsom-regobs-common/core';\r\nimport { settings } from '../../../../settings';\r\nimport { TopoMap } from '../../models/topo-map.enum';\r\n\r\nexport const DEFAULT_USER_SETTINGS: (langKey: LangKey) => UserSetting = (\r\n  langKey: LangKey\r\n) => ({\r\n  appMode: AppMode.Prod,\r\n  language: langKey || LangKey.nb,\r\n  currentGeoHazard: [GeoHazard.Snow],\r\n  observationDaysBack: [\r\n    { geoHazard: GeoHazard.Snow, daysBack: 2 },\r\n    { geoHazard: GeoHazard.Ice, daysBack: 7 },\r\n    { geoHazard: GeoHazard.Soil, daysBack: 3 },\r\n    { geoHazard: GeoHazard.Water, daysBack: 3 }\r\n  ],\r\n  completedStartWizard: false,\r\n  supportTiles: [],\r\n  showMapCenter: false,\r\n  tilesCacheSizev2: settings.map.tiles.cacheSize,\r\n  showObservations: true,\r\n  emailReceipt: true,\r\n  topoMap: TopoMap.default,\r\n  showGeoSelectInfo: true,\r\n  useRetinaMap: false,\r\n  consentForSendingAnalytics: true,\r\n  consentForSendingAnalyticsDialogCompleted: false,\r\n  featureToggeGpsDebug: false,\r\n  featureToggleDeveloperMode: false\r\n});\r\n","import { WarningGroupKey } from './warning-group-key.interface';\r\nimport moment from 'moment';\r\nimport { IWarningGroup } from './warning-group.interface';\r\n\r\nexport class WarningGroup {\r\n  private _warningGroup: IWarningGroup;\r\n\r\n  get key(): WarningGroupKey {\r\n    return {\r\n      geoHazard: this._warningGroup.geoHazard,\r\n      groupId: this._warningGroup.regionId,\r\n      groupName: this._warningGroup.regionName\r\n    };\r\n  }\r\n\r\n  get warnings() {\r\n    return this._warningGroup.warnings;\r\n  }\r\n\r\n  get groupType() {\r\n    return this._warningGroup.regionType;\r\n  }\r\n\r\n  get url() {\r\n    return this._warningGroup.url;\r\n  }\r\n\r\n  get counties() {\r\n    return this._warningGroup.counties;\r\n  }\r\n\r\n  get validFrom() {\r\n    return this._warningGroup.validFrom;\r\n  }\r\n\r\n  get validTo() {\r\n    return this._warningGroup.validTo;\r\n  }\r\n\r\n  get sortOrder() {\r\n    return this._warningGroup.sortOrder;\r\n  }\r\n\r\n  getWarningForDay(date: Date) {\r\n    const warningsForDay = this._warningGroup.warnings.filter((x) =>\r\n      moment(date).isBetween(x.validFrom, x.validTo, null, '[]')\r\n    );\r\n    if (warningsForDay.length > 0) {\r\n      return warningsForDay.reduce((pv, v) => {\r\n        if (pv && pv.warningLevel < v.warningLevel) {\r\n          return pv;\r\n        } else {\r\n          return v;\r\n        }\r\n      });\r\n    } else {\r\n      return warningsForDay[0];\r\n    }\r\n  }\r\n\r\n  getDayWarning(daysToAdd: number) {\r\n    const day = this.getMomentAtNoon(moment().add(daysToAdd, 'days'));\r\n    return this.getWarningForDay(day.toDate());\r\n  }\r\n\r\n  private getMomentAtNoon(m: moment.Moment) {\r\n    return m.clone().hours(12).minutes(0).seconds(0);\r\n  }\r\n\r\n  hasAnyWarnings(daysAhead = 2) {\r\n    return this.getMaxWarning(daysAhead).max > 0;\r\n  }\r\n\r\n  getMaxWarning(daysAhead = 2) {\r\n    let max = 0;\r\n    let hasWarning = false;\r\n    for (let i = 0; i <= daysAhead; i++) {\r\n      const dayWarning = this.getDayWarning(i);\r\n      if (dayWarning && dayWarning.warningLevel > max) {\r\n        max = dayWarning.warningLevel;\r\n        hasWarning = false;\r\n      }\r\n      if (\r\n        dayWarning &&\r\n        dayWarning.warningLevel === max &&\r\n        dayWarning.emergencyWarning\r\n      ) {\r\n        hasWarning = true;\r\n      }\r\n    }\r\n    return { max, hasWarning };\r\n  }\r\n\r\n  getKeyAsString() {\r\n    return `${this._warningGroup.geoHazard}_${this._warningGroup.regionId}_${this._warningGroup.regionName}`;\r\n  }\r\n\r\n  constructor(group: IWarningGroup) {\r\n    this._warningGroup = group;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { settings } from '../../../../settings';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport moment, { lang } from 'moment';\r\nimport 'moment-timezone';\r\nimport { LangKey, GeoHazard } from '@varsom-regobs-common/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport {\r\n  map,\r\n  tap,\r\n  switchMap,\r\n  shareReplay,\r\n  distinctUntilChanged,\r\n  take\r\n} from 'rxjs/operators';\r\nimport { IWarning } from './warning.interface';\r\nimport { WarningGroup } from './warning-group.model';\r\nimport { IWarningApiResult } from './warning-api-result.interface';\r\nimport { IAvalancheWarningApiResult } from './avalanche-warning-api-result.interface';\r\nimport { combineLatest, Observable, BehaviorSubject, of } from 'rxjs';\r\nimport { IWarningGroupInMapView } from './warninggroup-in-mapview.interface';\r\nimport { DataLoadService } from '../../../modules/data-load/services/data-load.service';\r\nimport { IWarningGroup } from './warning-group.interface';\r\nimport { IIceWarningApiResult } from './ice-warning-api-result.interface';\r\nimport { Platform } from '@ionic/angular';\r\nimport { HTTP } from '@ionic-native/http/ngx';\r\nimport { MapService } from '../../../modules/map/services/map/map.service';\r\nimport { IMapViewAndArea } from '../../../modules/map/services/map/map-view-and-area.interface';\r\nimport { toPromiseWithCancel } from '../../helpers/observable-helper';\r\nimport { IAvalancheWarningSimple } from './avalanche-warning-simple.interface';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { DbHelperService } from '../db-helper/db-helper.service';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { UserSetting } from '../../models/user-settings.model';\r\nimport { NSqlFullUpdateObservable } from '../../helpers/nano-sql/NSqlFullUpdateObservable';\r\n\r\nconst DEBUG_TAG = 'WarningService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WarningService {\r\n  private _warningsObservable: Observable<WarningGroup[]>;\r\n  private _warningsForCurrentGeoHazardObservable: Observable<WarningGroup[]>;\r\n  private _warningGroupInMapViewObservable: Observable<IWarningGroupInMapView>;\r\n  private latestWarnings: BehaviorSubject<{ [key: string]: IWarningGroup[] }>;\r\n\r\n  get warningsObservable$() {\r\n    return this._warningsObservable;\r\n  }\r\n\r\n  get warningsForCurrentGeoHazardObservable$() {\r\n    return this._warningsForCurrentGeoHazardObservable;\r\n  }\r\n\r\n  get warningGroupInMapViewObservable$() {\r\n    return this._warningGroupInMapViewObservable;\r\n  }\r\n\r\n  constructor(\r\n    private httpClient: HttpClient,\r\n    private userSettingService: UserSettingService,\r\n    private mapService: MapService,\r\n    private dataLoadService: DataLoadService,\r\n    private platform: Platform,\r\n    private nativeHttp: HTTP,\r\n    private loggingService: LoggingService,\r\n    private dbHelperService: DbHelperService\r\n  ) {\r\n    this.latestWarnings = new BehaviorSubject({});\r\n    this._warningsObservable = this.getWarningsForCurrentLanguageAsObservable();\r\n    this._warningsForCurrentGeoHazardObservable = this.getWarningsForCurrentLanguageAndCurrentGeoHazard();\r\n    this._warningGroupInMapViewObservable = this.getWarningsForCurrentMapViewAsObservable();\r\n  }\r\n\r\n  private getDataLoadId(geoHazard: GeoHazard, language: LangKey) {\r\n    return `${NanoSql.TABLES.WARNING.name}_${this.getLatestWarningKey(\r\n      geoHazard,\r\n      language\r\n    )}`;\r\n  }\r\n\r\n  private getLatestWarningKey(geoHazard: GeoHazard, langKey: LangKey) {\r\n    return `${geoHazard}_${this.getSupportedLanguage(langKey)}`;\r\n  }\r\n\r\n  private updateLatestWarnings(\r\n    geoHazard: GeoHazard,\r\n    langKey: LangKey,\r\n    result: IWarningGroup[]\r\n  ) {\r\n    const currentValue = this.latestWarnings.getValue();\r\n    currentValue[this.getLatestWarningKey(geoHazard, langKey)] = result;\r\n    this.latestWarnings.next(currentValue);\r\n  }\r\n\r\n  async updateWarnings(cancel?: Promise<void>) {\r\n    let cancelled = false;\r\n    if (cancel) {\r\n      cancel.then(() => {\r\n        cancelled = true;\r\n      });\r\n    }\r\n    this.loggingService.debug('Updating warnings by priority', DEBUG_TAG);\r\n    const userSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    const geoHazards = await this.getGeoHazardsToUpdate(userSettings);\r\n    for (const geoHazard of geoHazards) {\r\n      if (!cancelled) {\r\n        await this.checkLastUpdatedAndUpdateDataIfNeeded(\r\n          geoHazard,\r\n          this.getSupportedLanguage(userSettings.language),\r\n          cancel\r\n        );\r\n      }\r\n    }\r\n    this.loggingService.debug('Updating warnings completed', DEBUG_TAG);\r\n  }\r\n\r\n  async updateWarningsForCurrentGeoHazard(cancel?: Promise<void>) {\r\n    let cancelled = false;\r\n    if (cancel) {\r\n      cancel.then(() => {\r\n        cancelled = true;\r\n      });\r\n    }\r\n    const userSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    const geoHazards = await this.getGeoHazardsToUpdate(userSettings);\r\n    for (const geoHazard of geoHazards) {\r\n      if (!cancelled) {\r\n        await this.updateWarningsForGeoHazard(\r\n          geoHazard,\r\n          this.getSupportedLanguage(userSettings.language),\r\n          cancel\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  private async getGeoHazardsToUpdate(userSetting: UserSetting) {\r\n    const favourites = await this.getFavouritesAsObservable()\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    const currentGeoHazards = userSetting.currentGeoHazard;\r\n    const favouriteGeoHazards = favourites.reduce(\r\n      (acc: GeoHazard[], current: { groupId: string; geoHazard: GeoHazard }) =>\r\n        acc.indexOf(current.geoHazard) >= 0 ? acc : [...acc, current.geoHazard],\r\n      []\r\n    );\r\n    return Array.from(new Set([...currentGeoHazards, ...favouriteGeoHazards]));\r\n  }\r\n\r\n  private async checkLastUpdatedAndUpdateDataIfNeeded(\r\n    geoHazard: GeoHazard,\r\n    langKey: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoad = await this.dataLoadService.getState(\r\n      this.getDataLoadId(geoHazard, langKey)\r\n    );\r\n    const isLoadingTimeout = moment().subtract(\r\n      settings.foregroundUpdateIntervalMs,\r\n      'milliseconds'\r\n    );\r\n    if (\r\n      dataLoad.isLoading &&\r\n      moment(dataLoad.startedDate).isAfter(isLoadingTimeout)\r\n    ) {\r\n      this.loggingService.debug(\r\n        'Warnings is allready being updated.',\r\n        DEBUG_TAG\r\n      );\r\n    } else {\r\n      const lastUpdateLimit = moment().subtract(1, 'hour');\r\n      if (\r\n        !dataLoad.lastUpdated ||\r\n        moment(dataLoad.lastUpdated).isBefore(lastUpdateLimit)\r\n      ) {\r\n        await this.updateWarningsForGeoHazard(geoHazard, langKey, cancel);\r\n      } else {\r\n        this.loggingService.debug(\r\n          `No need to update ${geoHazard}. Last updated is: ${dataLoad.lastUpdated}`,\r\n          DEBUG_TAG\r\n        );\r\n      }\r\n    }\r\n  }\r\n\r\n  updateWarningsForGeoHazard(\r\n    geoHazard: GeoHazard,\r\n    langKey: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    if (geoHazard === GeoHazard.Snow) {\r\n      return this.updateAvalancheWarnings(langKey, null, null, cancel);\r\n    } else if (geoHazard === GeoHazard.Ice) {\r\n      return this.updateIceWarnings(langKey);\r\n    } else {\r\n      return this.updateFloodAndLandslideWarnings(\r\n        geoHazard,\r\n        langKey,\r\n        null,\r\n        null,\r\n        cancel\r\n      );\r\n    }\r\n  }\r\n\r\n  addToFavourite(groupId: string, geoHazard: GeoHazard) {\r\n    const id = `${geoHazard}_${groupId}`;\r\n    return nSQL(NanoSql.TABLES.WARNING_FAVOURITE.name)\r\n      .query('upsert', { id, groupId, geoHazard })\r\n      .exec();\r\n  }\r\n\r\n  removeFromFavourite(groupId: string, geoHazard: GeoHazard) {\r\n    const id = `${geoHazard}_${groupId}`;\r\n    return nSQL(NanoSql.TABLES.WARNING_FAVOURITE.name)\r\n      .query('delete')\r\n      .where((g) => g.id === id)\r\n      .exec();\r\n  }\r\n\r\n  getIsFavouriteObservable(\r\n    groupId: string,\r\n    geoHazard: GeoHazard\r\n  ): Observable<boolean> {\r\n    const id = `${geoHazard}_${groupId}`;\r\n    return new NSqlFullUpdateObservable<\r\n      { id: string; groupId: string; geoHazard: GeoHazard }[]\r\n    >(\r\n      nSQL(NanoSql.TABLES.WARNING_FAVOURITE.name)\r\n        .query('select')\r\n        .where(['id', '=', id])\r\n        .listen()\r\n    ).pipe(\r\n      map((val) => (val.length > 0 ? true : false)),\r\n      distinctUntilChanged()\r\n    );\r\n  }\r\n\r\n  private getOfflineWarningsAsObservable(geoHazard: GeoHazard) {\r\n    return new NSqlFullUpdateObservable<IWarningGroup[]>(\r\n      nSQL(NanoSql.TABLES.WARNING.name).query('select').listen({\r\n        debounce: 200\r\n      })\r\n    ).pipe(\r\n      map((warningGroups) =>\r\n        warningGroups.filter((wg) => wg.geoHazard === geoHazard)\r\n      ),\r\n      map((warningGroups) =>\r\n        warningGroups.length === 0\r\n          ? this.getDefaultWarningGroups(geoHazard)\r\n          : warningGroups\r\n      )\r\n    );\r\n  }\r\n\r\n  private getWarningsAsObservable(): Observable<IWarningGroup[]> {\r\n    return combineLatest([\r\n      this.userSettingService.appModeLanguageAndCurrentGeoHazard$,\r\n      this.latestWarnings.asObservable()\r\n    ]).pipe(\r\n      switchMap(([[_, langKey, __], latestWarnings]) =>\r\n        combineLatest(\r\n          [\r\n            GeoHazard.Snow,\r\n            GeoHazard.Ice,\r\n            GeoHazard.Water,\r\n            GeoHazard.Soil\r\n          ].map((geoHazard) =>\r\n            this.getLatestWarningsOrFallbackToOffline(\r\n              latestWarnings,\r\n              geoHazard,\r\n              langKey\r\n            )\r\n          )\r\n        ).pipe(map((result) => [].concat(...result)))\r\n      ),\r\n      tap((result) =>\r\n        this.loggingService.debug(\r\n          'Warnings observable changed',\r\n          DEBUG_TAG,\r\n          result\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private getLatestWarningsOrFallbackToOffline(\r\n    latestWarnings: { [key: string]: IWarningGroup[] },\r\n    geoHazard: GeoHazard,\r\n    langKey: LangKey\r\n  ) {\r\n    if (\r\n      latestWarnings[this.getLatestWarningKey(geoHazard, langKey)] !== undefined\r\n    ) {\r\n      return of(latestWarnings[this.getLatestWarningKey(geoHazard, langKey)]);\r\n    }\r\n    return this.getOfflineWarningsAsObservable(geoHazard);\r\n  }\r\n\r\n  private getDefaultWarningGroups(geoHazard: GeoHazard) {\r\n    switch (geoHazard) {\r\n    case GeoHazard.Snow:\r\n      return this.getDefaultAvalancheWarningGroups();\r\n    case GeoHazard.Ice:\r\n      return this.getDefaultIceWarningGroups();\r\n    default:\r\n      return this.getCountyWarningGroups(geoHazard);\r\n    }\r\n  }\r\n\r\n  private getDefaultIceWarningGroups() {\r\n    const iceRegionsDefaultJson = this.getDefaultIceForecastRegions();\r\n    const geoHazard = GeoHazard.Ice;\r\n    const regionGroups: IWarningGroup[] = iceRegionsDefaultJson.forecastRegions.map(\r\n      (region, index) => ({\r\n        id: `${region.name}_${geoHazard}`,\r\n        regionId: region.name,\r\n        regionName: region.name,\r\n        counties: region.counties,\r\n        url: region.url,\r\n        validFrom: null,\r\n        validTo: null,\r\n        geoHazard,\r\n        warnings: [],\r\n        sortOrder: index\r\n      })\r\n    );\r\n    return regionGroups;\r\n  }\r\n\r\n  private getCountyWarningGroups(geoHazard: GeoHazard) {\r\n    const regions = require('../../../../assets/json/regions.json');\r\n    const regionGroups: IWarningGroup[] = regions.map((region) => ({\r\n      id: `${region.Id}_${geoHazard}`,\r\n      regionId: region.Id,\r\n      regionName: region.Name,\r\n      counties: [region.Id],\r\n      geoHazard: geoHazard,\r\n      warnings: [],\r\n      sortOrder: this.convertCoutyToSortOrder(region.Id)\r\n    }));\r\n    return regionGroups;\r\n  }\r\n\r\n  private convertCoutyToSortOrder(countyId: string) {\r\n    const countyNr = parseInt(countyId, 10);\r\n    // Move Trøndelag to sort order 16 (Previous Sør-Trøndelag)\r\n    const regionFixedCountyNr = countyNr === 50 ? 16 : countyNr;\r\n    // Sort should be from north to south, so we have to reverse numbers\r\n    return regionFixedCountyNr * -1 + 22; // 22 is the max region nr (Jan Mayen)\r\n  }\r\n\r\n  private getDefaultAvalancheWarningGroups() {\r\n    const regions = require('../../../../assets/json/varslingsomraader.json');\r\n    const avalancheRegions: IWarningGroup[] = regions.features.map(\r\n      (region) => ({\r\n        id: `${region.properties.omradeID}_${GeoHazard.Snow}`,\r\n        regionId: `${region.properties.omradeID}`,\r\n        regionName: region.properties.omradeNavn,\r\n        regionType: region.properties.regionType,\r\n        counties: [],\r\n        geoHazard: GeoHazard.Snow,\r\n        warnings: [],\r\n        sortOrder: region.properties.sortID\r\n      })\r\n    );\r\n    return avalancheRegions;\r\n  }\r\n\r\n  private getFavouritesAsObservable() {\r\n    return new NSqlFullUpdateObservable<\r\n      { groupId: string; geoHazard: GeoHazard }[]\r\n    >(nSQL(NanoSql.TABLES.WARNING_FAVOURITE.name).query('select').listen());\r\n  }\r\n\r\n  getWarningGroupFavouritesObservable(): Observable<WarningGroup[]> {\r\n    return combineLatest([\r\n      this.getWarningsAsObservable(),\r\n      this.getFavouritesAsObservable()\r\n    ]).pipe(\r\n      map(([regions, favourites]) =>\r\n        this.mapAndSort(\r\n          regions.filter(\r\n            (region) =>\r\n              !!favourites.find(\r\n                (x) =>\r\n                  x.groupId === region.regionId &&\r\n                  x.geoHazard === region.geoHazard\r\n              )\r\n          )\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private mapAndSort(waringGroup: IWarningGroup[]): WarningGroup[] {\r\n    return waringGroup\r\n      .map((group) => new WarningGroup(group))\r\n      .sort((a, b) => {\r\n        if (a.sortOrder === b.sortOrder) {\r\n          return a.key.geoHazard - b.key.geoHazard;\r\n        } else {\r\n          return a.sortOrder - b.sortOrder;\r\n        }\r\n      });\r\n  }\r\n\r\n  private getWarningsForCurrentLanguageAsObservable() {\r\n    return this.getWarningsAsObservable().pipe(\r\n      map((warningGroups) => this.mapAndSort(warningGroups)),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private getWarningsForCurrentLanguageAndCurrentGeoHazard() {\r\n    return combineLatest([\r\n      this.getWarningsForCurrentLanguageAsObservable(),\r\n      this.userSettingService.currentGeoHazard$\r\n    ]).pipe(\r\n      map(([warningGroups, currentGeoHazard]) => {\r\n        return warningGroups.filter((wg) =>\r\n          currentGeoHazard.find((g) => g === wg.key.geoHazard)\r\n        );\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private getWarningsForCurrentMapViewAsObservable() {\r\n    return combineLatest([\r\n      this.mapService.mapViewAndAreaObservable$,\r\n      this.getWarningsAsObservable()\r\n    ]).pipe(\r\n      switchMap(([mapViewArea, _]) =>\r\n        this.getWarningsForCurrentMapView(mapViewArea)\r\n      ),\r\n      map((result) => result),\r\n      tap((val) => {\r\n        this.loggingService.debug(\r\n          'getWarningsForCurrentMapViewAsObservable changed',\r\n          DEBUG_TAG,\r\n          val\r\n        );\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private groupIsInRegion(warningGroup: WarningGroup, regionId: string) {\r\n    const arr = [warningGroup.key.groupId, ...warningGroup.counties];\r\n    return arr.indexOf(regionId) >= 0;\r\n  }\r\n\r\n  private isGroupInMapCenter(\r\n    mapViewArea: IMapViewAndArea,\r\n    warningGroup: WarningGroup\r\n  ) {\r\n    return this.groupIsInRegion(warningGroup, mapViewArea.regionInCenter);\r\n  }\r\n\r\n  private isGroupInViewBounds(\r\n    mapViewArea: IMapViewAndArea,\r\n    warningGroup: WarningGroup\r\n  ) {\r\n    return (\r\n      mapViewArea.regionsInViewBounds.filter((region) =>\r\n        this.groupIsInRegion(warningGroup, region)\r\n      ).length > 0\r\n    );\r\n  }\r\n\r\n  private isGroupInViewBuffer(\r\n    mapViewArea: IMapViewAndArea,\r\n    warningGroup: WarningGroup\r\n  ) {\r\n    return (\r\n      mapViewArea.regionsInViewBuffer.filter((region) =>\r\n        this.groupIsInRegion(warningGroup, region)\r\n      ).length > 0\r\n    );\r\n  }\r\n\r\n  private getWarningsForCurrentMapView(\r\n    mapViewArea: IMapViewAndArea\r\n  ): Observable<IWarningGroupInMapView> {\r\n    return this.warningsForCurrentGeoHazardObservable$.pipe(\r\n      map((warnings) => {\r\n        const center = warnings.filter((warningGroup) =>\r\n          this.isGroupInMapCenter(mapViewArea, warningGroup)\r\n        );\r\n        const viewBounds = warnings.filter(\r\n          (warningGroup) =>\r\n            this.isGroupInViewBounds(mapViewArea, warningGroup) &&\r\n            !this.isGroupInMapCenter(mapViewArea, warningGroup)\r\n        );\r\n        const buffer = warnings.filter(\r\n          (warningGroup) =>\r\n            this.isGroupInViewBuffer(mapViewArea, warningGroup) &&\r\n            !this.isGroupInViewBounds(mapViewArea, warningGroup) &&\r\n            !this.isGroupInMapCenter(mapViewArea, warningGroup)\r\n        );\r\n        return {\r\n          center,\r\n          viewBounds,\r\n          buffer\r\n        };\r\n      })\r\n    );\r\n  }\r\n\r\n  private async updateFloodAndLandslideWarnings(\r\n    geoHazard: GeoHazard,\r\n    language: LangKey,\r\n    fromDate?: Date,\r\n    toDate?: Date,\r\n    cancelPromise?: Promise<void>\r\n  ) {\r\n    this.loggingService.debug(\r\n      `Updating ${GeoHazard[geoHazard]} warnings`,\r\n      DEBUG_TAG\r\n    );\r\n    const dateRange = this.getDefaultDateRange(fromDate, toDate);\r\n    const dataLoadId = this.getDataLoadId(geoHazard, language);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    const url =\r\n      `${this.getBaseUrl(geoHazard)}` +\r\n      `/Warning/All/${language}` +\r\n      `/${dateRange.from.format(settings.services.warning.dateFormat)}` +\r\n      `/${dateRange.to.format(settings.services.warning.dateFormat)}`;\r\n    try {\r\n      const warningsresult = await toPromiseWithCancel(\r\n        this.httpClient.get<IWarningApiResult[]>(url),\r\n        cancelPromise,\r\n        30000\r\n      );\r\n      const regions = this.aggregateWarningRegions(\r\n        warningsresult,\r\n        geoHazard,\r\n        language,\r\n        moment()\r\n      );\r\n      this.updateLatestWarnings(geoHazard, language, regions);\r\n      await this.dataLoadService.loadingCompleted(\r\n        dataLoadId,\r\n        regions.length,\r\n        dateRange.from.toDate(),\r\n        new Date()\r\n      );\r\n      this.saveWarningResultsToDb(geoHazard, regions);\r\n    } catch (err) {\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n    }\r\n  }\r\n\r\n  shouldReplaceWarning(existing: IWarning, newWarning: IWarning) {\r\n    if (moment(newWarning.publishTime).isAfter(moment(existing.publishTime))) {\r\n      return true;\r\n    }\r\n    if (\r\n      moment(newWarning.publishTime).isSame(moment(existing.publishTime)) &&\r\n      newWarning.warningLevel > existing.warningLevel\r\n    ) {\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  getWarningByRegions(warningsresult: IWarningApiResult[]) {\r\n    const regionMap = new Map<string, IWarningApiResult[]>();\r\n    for (const item of warningsresult) {\r\n      const regionId = item.CountyList[0].Id;\r\n      const collection = regionMap.get(regionId);\r\n      if (!collection) {\r\n        regionMap.set(regionId, [item]);\r\n      } else {\r\n        collection.push(item);\r\n      }\r\n    }\r\n    return regionMap;\r\n  }\r\n\r\n  getWarningByDay(\r\n    warningsresult: { subRegionId: string; warning: IWarning }[]\r\n  ) {\r\n    const dayWarningMap = new Map<\r\n      string,\r\n      { subRegionId: string; warning: IWarning }[]\r\n    >();\r\n    for (const item of warningsresult) {\r\n      const key = moment(item.warning.validTo).startOf('day').toISOString();\r\n      const collection = dayWarningMap.get(key);\r\n      if (!collection) {\r\n        dayWarningMap.set(key, [item]);\r\n      } else {\r\n        collection.push(item);\r\n      }\r\n    }\r\n    return dayWarningMap;\r\n  }\r\n\r\n  getMostRelevantWarningForSubRegion(\r\n    warningsresult: { subRegionId: string; warning: IWarning }[]\r\n  ) {\r\n    const subRegionMap = new Map<string, IWarning>();\r\n    for (const item of warningsresult) {\r\n      const warning = subRegionMap.get(item.subRegionId);\r\n      if (!warning || this.shouldReplaceWarning(warning, item.warning)) {\r\n        subRegionMap.set(item.subRegionId, item.warning);\r\n      }\r\n    }\r\n    return subRegionMap;\r\n  }\r\n\r\n  filterWarningsForGroup(\r\n    warningsresult: { subRegionId: string; warning: IWarning }[]\r\n  ) {\r\n    return Array.from(this.getWarningByDay(warningsresult)).map(([_, value]) =>\r\n      this.getMostRelevantDayWarning(value)\r\n    );\r\n  }\r\n\r\n  getMostRelevantDayWarning(\r\n    warningsresult: { subRegionId: string; warning: IWarning }[]\r\n  ): IWarning {\r\n    const warningsForSubRegions = this.getMostRelevantWarningForSubRegion(\r\n      warningsresult\r\n    );\r\n    const warningsForSubRegionsArray = Array.from(warningsForSubRegions).map(\r\n      ([_, value]) => value\r\n    );\r\n    const max = Math.max(\r\n      ...warningsForSubRegionsArray.map((v) => v.warningLevel)\r\n    );\r\n    return warningsForSubRegionsArray.find((w) => w.warningLevel === max);\r\n  }\r\n\r\n  aggregateWarningRegions(\r\n    warningsresult: IWarningApiResult[],\r\n    geoHazard: GeoHazard,\r\n    language: LangKey,\r\n    now: moment.Moment\r\n  ) {\r\n    const regionGroups = this.getWarningByRegions(warningsresult);\r\n    return Array.from(regionGroups).map(([key, value]) => ({\r\n      id: `${key}_${geoHazard}`,\r\n      regionId: key,\r\n      regionName: value[0].CountyList[0].Name,\r\n      counties: [key],\r\n      geoHazard,\r\n      warnings: this.filterWarningsForGroup(\r\n        value.map((w) => ({\r\n          subRegionId: w.MunicipalityCsvString,\r\n          warning: {\r\n            language,\r\n            mainText: w.MainText,\r\n            validFrom: this.getDate(w.ValidFrom),\r\n            validTo: this.getDate(w.ValidTo),\r\n            publishTime: this.getDate(w.PublishTime),\r\n            warningLevel: parseInt(w.ActivityLevel, 10)\r\n          }\r\n        }))\r\n      ),\r\n      sortOrder: this.convertCoutyToSortOrder(key)\r\n    }));\r\n  }\r\n\r\n  private async saveWarningResultsToDb(\r\n    geoHazard: GeoHazard,\r\n    regionResult: IWarningGroup[]\r\n  ) {\r\n    try {\r\n      this.loggingService.debug(\r\n        `Saving new ${GeoHazard[geoHazard]} warnings`,\r\n        DEBUG_TAG,\r\n        regionResult\r\n      );\r\n      const now = new Date();\r\n      await this.dbHelperService.fastInsert(\r\n        NanoSql.TABLES.WARNING.name,\r\n        regionResult,\r\n        (data) => data.id\r\n      );\r\n      this.loggingService.debug(\r\n        `fastInsert took ${new Date().getTime() - now.getTime()} ms`,\r\n        DEBUG_TAG\r\n      );\r\n      await this.deleteRegionsNoLongerInResult(geoHazard, regionResult); // NOTE: This also trigger change\r\n    } catch (err) {\r\n      this.loggingService.log(\r\n        'Could not save new warnings to db',\r\n        err,\r\n        LogLevel.Warning,\r\n        DEBUG_TAG\r\n      );\r\n    }\r\n  }\r\n\r\n  private getSupportedLanguage(language: LangKey): LangKey {\r\n    return language === LangKey.nb ? LangKey.nb : LangKey.en;\r\n  }\r\n\r\n  private async updateAvalancheWarnings(\r\n    language: LangKey,\r\n    fromDate?: Date,\r\n    toDate?: Date,\r\n    cancelPromise?: Promise<void>\r\n  ) {\r\n    this.loggingService.debug('Updating avalanche warnings', DEBUG_TAG);\r\n    let cancelled = false;\r\n    if (cancelPromise) {\r\n      cancelPromise.then(() => {\r\n        cancelled = true;\r\n      });\r\n    }\r\n    const supportedLang = lang;\r\n    const dateRange = this.getDefaultDateRange(fromDate, toDate);\r\n    const dataLoadId = this.getDataLoadId(GeoHazard.Snow, language);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    const url =\r\n      `${this.getBaseUrl(GeoHazard.Snow)}` +\r\n      `/RegionSummary/Detail/${language}` +\r\n      `/${dateRange.from.format(settings.services.warning.dateFormat)}` +\r\n      `/${dateRange.to.format(settings.services.warning.dateFormat)}`;\r\n    try {\r\n      const warningsresult = await toPromiseWithCancel(\r\n        this.httpClient.get<IAvalancheWarningApiResult[]>(url),\r\n        cancelPromise,\r\n        30000\r\n      );\r\n      if (!cancelled) {\r\n        const regionResult: IWarningGroup[] = warningsresult.map(\r\n          (region, index) => ({\r\n            id: `${region.Id}_${GeoHazard.Snow}`,\r\n            regionId: region.Id.toString(),\r\n            regionName: region.Name,\r\n            regionType: region.TypeName,\r\n            geoHazard: GeoHazard.Snow,\r\n            counties: [],\r\n            warnings: region.AvalancheWarningList.map((simpleWarning) =>\r\n              this.convertSimpleWarningToAppWarning(language, simpleWarning)\r\n            ),\r\n            sortOrder: index\r\n          })\r\n        );\r\n        this.updateLatestWarnings(GeoHazard.Snow, language, regionResult);\r\n        await this.dataLoadService.loadingCompleted(\r\n          dataLoadId,\r\n          regionResult.length,\r\n          dateRange.from.toDate(),\r\n          new Date()\r\n        );\r\n        this.saveWarningResultsToDb(GeoHazard.Snow, regionResult);\r\n      } else {\r\n        await this.dataLoadService.loadingError(\r\n          dataLoadId,\r\n          'Operation cancelled'\r\n        );\r\n      }\r\n    } catch (err) {\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n    }\r\n  }\r\n\r\n  private convertSimpleWarningToAppWarning(\r\n    language: LangKey,\r\n    simpleWarning: IAvalancheWarningSimple\r\n  ): IWarning {\r\n    return {\r\n      warningLevel: parseInt(simpleWarning.DangerLevel, 10),\r\n      publishTime: this.getDate(simpleWarning.PublishTime),\r\n      validFrom: this.getDate(simpleWarning.ValidFrom),\r\n      validTo: this.getDate(simpleWarning.ValidTo),\r\n      mainText: simpleWarning.MainText,\r\n      language,\r\n      emergencyWarning:\r\n        simpleWarning.EmergencyWarning !==\r\n        (language === LangKey.en ? 'Not given' : 'Ikke gitt')\r\n          ? simpleWarning.EmergencyWarning\r\n          : null\r\n    };\r\n  }\r\n\r\n  private async deleteRegionsNoLongerInResult(\r\n    geoHazard: GeoHazard,\r\n    regions: IWarningGroup[]\r\n  ) {\r\n    if (regions.length > 0) {\r\n      const ids = regions.map((r) => r.id);\r\n      const deleteResult = await nSQL(NanoSql.TABLES.WARNING.name)\r\n        .query('delete')\r\n        .where(\r\n          (dbItem: IWarningGroup) =>\r\n            dbItem.geoHazard === geoHazard && ids.indexOf(dbItem.id) < 0\r\n        )\r\n        .exec();\r\n      this.loggingService.debug(\r\n        'Deleted regions no longer in result:',\r\n        DEBUG_TAG,\r\n        deleteResult\r\n      );\r\n    }\r\n  }\r\n\r\n  private async updateIceWarnings(language: LangKey) {\r\n    this.loggingService.debug('Updating ice warnings', DEBUG_TAG);\r\n    const geoHazard = GeoHazard.Ice;\r\n    const dataLoadId = this.getDataLoadId(geoHazard, language);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    try {\r\n      const url = this.getBaseUrl(geoHazard);\r\n      const result = await this.getIceWarningsFromApi(url);\r\n      const regionResult: IWarningGroup[] = result.forecastRegions.map(\r\n        (region, index) => ({\r\n          id: `${region.name}_${geoHazard}`,\r\n          regionId: region.name,\r\n          regionName: region.name,\r\n          counties: region.counties,\r\n          url: region.url,\r\n          validFrom: this.getDate(region.validFrom),\r\n          validTo: this.getDate(region.validTo),\r\n          geoHazard,\r\n          warnings: [],\r\n          sortOrder: index\r\n        })\r\n      );\r\n      this.loggingService.debug(\r\n        'New updates for ice warnings:',\r\n        DEBUG_TAG,\r\n        regionResult\r\n      );\r\n\r\n      this.updateLatestWarnings(geoHazard, language, regionResult);\r\n      await this.dataLoadService.loadingCompleted(\r\n        dataLoadId,\r\n        regionResult.length,\r\n        null,\r\n        null\r\n      );\r\n      this.saveWarningResultsToDb(geoHazard, regionResult);\r\n    } catch (err) {\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n    }\r\n  }\r\n\r\n  private getIceWarningsFromApi(url: string) {\r\n    if (\r\n      this.platform.is('hybrid') &&\r\n      (this.platform.is('android') || this.platform.is('ios'))\r\n    ) {\r\n      return this.getIceWarningsFromApiNative(url);\r\n    } else {\r\n      return Promise.resolve(this.getDefaultIceForecastRegions());\r\n    }\r\n  }\r\n\r\n  private async getIceWarningsFromApiNative(\r\n    url: string\r\n  ): Promise<IIceWarningApiResult> {\r\n    this.nativeHttp.setDataSerializer('json');\r\n    const result = await this.nativeHttp.get(\r\n      url,\r\n      {},\r\n      {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    );\r\n    if (result.status === 200) {\r\n      return JSON.parse(result.data.trim());\r\n    } else {\r\n      throw Error(\r\n        `Could not download warnings from: ${url}. Status: ${result.status}. Message: ${result.error}`\r\n      );\r\n    }\r\n  }\r\n\r\n  private getDefaultIceForecastRegions(): IIceWarningApiResult {\r\n    // NOTE: Mocking ice warnings for web because of missing CORS headers in api (just a static file)\r\n    return require('../../../../assets/json/ice_forecast_regions.json');\r\n  }\r\n\r\n  private getDate(dateString: string) {\r\n    return moment.tz(dateString, settings.services.warning.timezone).toDate();\r\n  }\r\n\r\n  private getBaseUrl(geoHazard: GeoHazard) {\r\n    return settings.services.warning[GeoHazard[geoHazard]].apiUrl;\r\n  }\r\n\r\n  private getDefaultDateRange(fromDate?: Date, toDate?: Date) {\r\n    const fromMoment = fromDate ? moment(fromDate) : moment().startOf('day');\r\n    // const fromMoment = fromDate ? moment(fromDate) : moment().subtract(1, 'day');\r\n    const toMoment = toDate\r\n      ? moment(toDate)\r\n      : moment()\r\n        .endOf('day')\r\n        .add(settings.services.warning.defaultWarningDaysAhead, 'days');\r\n    return { from: fromMoment, to: toMoment };\r\n  }\r\n}\r\n","import { TranslateService } from '@ngx-translate/core';\r\nimport { settings } from '../settings';\r\nimport { UserSettingService } from './core/services/user-setting/user-setting.service';\r\n\r\nexport function initTranslateService(\r\n  translateService: TranslateService,\r\n  userSettingService: UserSettingService\r\n): () => void {\r\n  return () => {\r\n    translateService.addLangs(\r\n      settings.language.supportedLanguages.map((l) => l.lang)\r\n    );\r\n    translateService.setDefaultLang(settings.language.fallbackLang);\r\n    userSettingService.init();\r\n  };\r\n}\r\n","import {\r\n  NgModule,\r\n  ModuleWithProviders,\r\n  APP_INITIALIZER,\r\n  Injector\r\n} from '@angular/core';\r\nimport { AnalyticService } from './services/analytic.service';\r\n\r\n@NgModule({\r\n  imports: [],\r\n  declarations: [],\r\n  exports: [],\r\n  providers: [\r\n    AnalyticService,\r\n    {\r\n      provide: APP_INITIALIZER,\r\n      useFactory: initializeAnalyticService,\r\n      multi: true,\r\n      deps: [AnalyticService]\r\n    }\r\n  ]\r\n})\r\nexport class AnalyticsModule {\r\n  static forRoot(): ModuleWithProviders<AnalyticsModule> {\r\n    return {\r\n      ngModule: AnalyticsModule\r\n    };\r\n  }\r\n}\r\n\r\nexport function initializeAnalyticService(analyticService: AnalyticService) {\r\n  return () => analyticService.init();\r\n}\r\n","export enum AppCustomDimension {\r\n  appName = 'appName',\r\n  appVersion = 'appVersion',\r\n  language = 'dimension6',\r\n  appMode = 'dimension1',\r\n  geoHazard = 'dimension2',\r\n  supportMap = 'dimension3',\r\n  showMapCenter = 'dimension4',\r\n  topoMap = 'dimension5',\r\n  enabledAnalytics = 'dimension7'\r\n}\r\n","export enum AppEventAction {\r\n  Click = 'click',\r\n  Share = 'share'\r\n}\r\n","export enum AppEventCategory {\r\n  Observations = 'observations',\r\n  Warnings = 'warnings'\r\n}\r\n","import { Injectable, Injector } from '@angular/core';\r\nimport { Router, NavigationEnd } from '@angular/router';\r\nimport { filter, map, distinctUntilChanged } from 'rxjs/operators';\r\nimport { settings } from '../../../../settings';\r\nimport { LoggingService } from '../../../modules/shared/services/logging/logging.service';\r\nimport { LogLevel } from '../../../modules/shared/services/logging/log-level.model';\r\nimport { environment } from '../../../../environments/environment';\r\nimport { AppVersionService } from '../../../core/services/app-version/app-version.service';\r\nimport { AppCustomDimension } from '../enums/app-custom-dimension.enum';\r\nimport { AppEventAction } from '../enums/app-event-action.enum';\r\nimport { AppEventCategory } from '../enums/app-event-category.enum';\r\nimport { removeOauthTokenFromUrl } from '../../shared/services/logging/url-utils';\r\n\r\nconst DEBUG_TAG = 'AnalyticService';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class AnalyticService {\r\n  get router() {\r\n    return this.injector.get(Router);\r\n  }\r\n\r\n  constructor(\r\n    private injector: Injector,\r\n    private loggingService: LoggingService,\r\n    private appVersionService: AppVersionService\r\n  ) {}\r\n\r\n  trackView(url: string) {\r\n    if (ga) {\r\n      const safeUrl = removeOauthTokenFromUrl(url);\r\n      this.loggingService.debug(`Tracking pageview ${safeUrl}`, DEBUG_TAG);\r\n      ga('set', 'page', url);\r\n      ga('send', 'pageview');\r\n    }\r\n  }\r\n\r\n  trackDimension(\r\n    dimension: AppCustomDimension,\r\n    value: string | number | boolean\r\n  ) {\r\n    if (ga) {\r\n      this.loggingService.debug(\r\n        `Tracking dimension ${dimension}: ${value}`,\r\n        DEBUG_TAG\r\n      );\r\n      ga('set', dimension, value);\r\n      ga('send', 'pageview');\r\n    }\r\n  }\r\n\r\n  trackEvent(\r\n    eventCategory: AppEventCategory,\r\n    eventAction: AppEventAction,\r\n    eventLabel?: string,\r\n    eventValue?: number\r\n  ) {\r\n    if (ga) {\r\n      this.loggingService.debug(\r\n        `Tracking event eventCategory:${eventCategory}, eventAction:${eventAction},` +\r\n          ` eventLabel:${eventLabel || ''}, eventValue: ${eventValue || ''}`,\r\n        DEBUG_TAG\r\n      );\r\n      ga('send', 'event', {\r\n        eventCategory,\r\n        eventAction,\r\n        eventLabel,\r\n        eventValue\r\n      });\r\n    }\r\n  }\r\n\r\n  disable() {\r\n    this.loggingService.debug('Disable Google Analytics', DEBUG_TAG);\r\n    window[`ga-disable-${settings.googleAnalytics.trackerId}`] = true;\r\n  }\r\n\r\n  enable() {\r\n    this.loggingService.debug(\r\n      `Enable Google Analytics ${\r\n        environment.production\r\n          ? ''\r\n          : '(DEV-MODE! Analytics data is not sent to server!)'\r\n      }`,\r\n      DEBUG_TAG\r\n    );\r\n    if (environment.production) {\r\n      window[`ga-disable-${settings.googleAnalytics.trackerId}`] = false;\r\n    }\r\n  }\r\n\r\n  init() {\r\n    if (!ga) {\r\n      this.loggingService.log(\r\n        'Could not load Google Analytics script. Probably ad blocker installed.',\r\n        null,\r\n        LogLevel.Warning,\r\n        DEBUG_TAG\r\n      );\r\n      return;\r\n    }\r\n    this.loggingService.debug(\r\n      `Init Google Analytics ${\r\n        environment.production\r\n          ? ''\r\n          : '(DEV-MODE! Analytics data is not sent to server!)'\r\n      }`,\r\n      DEBUG_TAG\r\n    );\r\n    if (!environment.production) {\r\n      // Disable sending events unless production build\r\n      this.disable();\r\n    }\r\n\r\n    this.loggingService.debug('Setup google analytics', DEBUG_TAG);\r\n    if (window.localStorage) {\r\n      ga('create', settings.googleAnalytics.trackerId, 'auto', {\r\n        storage: 'none',\r\n        clientId: window.localStorage.getItem('ga_clientId')\r\n      });\r\n      ga('set', 'checkProtocolTask', null);\r\n      ga(function (tracker) {\r\n        window.localStorage.setItem('ga_clientId', tracker.get('clientId'));\r\n      });\r\n    } else {\r\n      ga('create', settings.googleAnalytics.trackerId, 'auto');\r\n    }\r\n\r\n    const appVersion = this.appVersionService.getAppVersion();\r\n    ga('set', 'appName', 'regObs4');\r\n    ga('set', 'anonymizeIp', settings.googleAnalytics.anonymizeIp);\r\n    ga('set', 'appVersion', appVersion.version);\r\n    ga('send', 'pageview');\r\n\r\n    this.startTrackingPageViews();\r\n    this.loggingService.debug('Google analytics setup completed', DEBUG_TAG);\r\n  }\r\n\r\n  private startTrackingPageViews() {\r\n    this.router.events\r\n      .pipe(filter((event) => event instanceof NavigationEnd))\r\n      .pipe(\r\n        map((val: NavigationEnd) => val.urlAfterRedirects),\r\n        distinctUntilChanged()\r\n      )\r\n      .subscribe((url: string) => {\r\n        const safeUrl = removeOauthTokenFromUrl(url);\r\n        this.trackView(safeUrl);\r\n      });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'auth/callback',\r\n    loadChildren: () =>\r\n      import('./pages/auth-callback/auth-callback.module').then(\r\n        (m) => m.AuthCallbackPageModule\r\n      )\r\n  }\r\n  // { path: 'auth/endsession', loadChildren: () => import('./pages/auth-callback/auth-callback.module').then(m => m.AuthCallbackPageModule) },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class AuthRoutingModule {}\r\n","import { NgModule, NgZone } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Requestor, StorageBackend } from '@openid/appauth';\r\nimport { AuthRoutingModule } from './auth-routing.module';\r\nimport { AuthService, Browser } from 'ionic-appauth';\r\nimport { authFactory } from './factories/auth-factory';\r\nimport { Platform } from '@ionic/angular';\r\nimport { httpFactory } from './factories/http-factory';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { storageFactory } from './factories/storage-factory';\r\nimport { UserSettingService } from '../../core/services/user-setting/user-setting.service';\r\nimport { CapacitorBrowser } from 'ionic-appauth/lib/capacitor';\r\n\r\n@NgModule({\r\n  declarations: [],\r\n  imports: [CommonModule, AuthRoutingModule],\r\n  providers: [\r\n    {\r\n      provide: StorageBackend,\r\n      useFactory: storageFactory,\r\n      deps: [Platform]\r\n    },\r\n    {\r\n      provide: Requestor,\r\n      useFactory: httpFactory,\r\n      deps: [Platform, HttpClient]\r\n    },\r\n    {\r\n      provide: Browser,\r\n      useClass: CapacitorBrowser\r\n    },\r\n    {\r\n      provide: AuthService,\r\n      useFactory: authFactory,\r\n      deps: [\r\n        Platform,\r\n        NgZone,\r\n        Requestor,\r\n        Browser,\r\n        StorageBackend,\r\n        UserSettingService\r\n      ]\r\n    }\r\n  ]\r\n})\r\nexport class AuthModule {}\r\n","import { Platform } from '@ionic/angular';\r\nimport { StorageBackend, Requestor } from '@openid/appauth';\r\nimport { AuthService, Browser } from 'ionic-appauth';\r\nimport { NgZone } from '@angular/core';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport { settings } from '../../../../settings';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { RegobsAuthServiceOverride } from '../services/regobs-auth-service-override';\r\n\r\nexport const AUTH_CALLBACK_PATH = 'auth/callback';\r\n\r\nexport const authFactory = (\r\n  platform: Platform,\r\n  ngZone: NgZone,\r\n  requestor: Requestor,\r\n  browser: Browser,\r\n  storage: StorageBackend,\r\n  userSettingService: UserSettingService\r\n): AuthService => {\r\n  const authService = new RegobsAuthServiceOverride(browser, storage, requestor);\r\n  userSettingService.appMode$.subscribe((appMode: AppMode) => {\r\n    authService.authConfig = settings.authConfig[appMode];\r\n    if (!platform.is('cordova')) {\r\n      const url = `${window.location.origin}/${AUTH_CALLBACK_PATH}`;\r\n      authService.authConfig.redirect_url = url;\r\n      authService.authConfig.end_session_redirect_url = url;\r\n    }\r\n  });\r\n  return authService;\r\n};\r\n","import { HttpClient } from '@angular/common/http';\r\nimport { Platform } from '@ionic/angular';\r\n// import { CordovaRequestor } from 'ionic-appauth/lib/cordova';\r\nimport { NgHttpService } from '../ng-http.service';\r\n\r\nexport const httpFactory = (platform: Platform, httpClient: HttpClient) => {\r\n  // return platform.is('cordova') ? new CordovaRequestor() : new NgHttpService(httpClient);\r\n  return new NgHttpService(httpClient); // NgHttpService works fine, no need to use advanced http\r\n};\r\n","import { Platform } from '@ionic/angular';\r\n// import { CordovaSecureStorage } from 'ionic-appauth/lib/cordova';\r\n// import { CapacitorStorage } from 'ionic-appauth/lib/capacitor';\r\nimport { LocalStorageBackend } from '@openid/appauth';\r\n\r\nexport const storageFactory = (platform: Platform) => {\r\n  return new LocalStorageBackend();\r\n  // return platform.is('cordova') ? new CordovaSecureStorage() : new CapacitorStorage();\r\n};\r\n","import { Injectable } from '@angular/core';\r\nimport { Requestor } from '@openid/appauth';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { XhrSettings } from 'ionic-appauth/lib/cordova';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgHttpService implements Requestor {\r\n  constructor(private http: HttpClient) {}\r\n\r\n  public async xhr<T>(settings: XhrSettings): Promise<T> {\r\n    if (!settings.method) {\r\n      settings.method = 'GET';\r\n    }\r\n\r\n    switch (settings.method) {\r\n    case 'GET':\r\n      return this.http\r\n        .get<T>(settings.url, { headers: this.getHeaders(settings.headers) })\r\n        .toPromise();\r\n    case 'POST':\r\n      return this.http\r\n        .post<T>(settings.url, settings.data, {\r\n          headers: this.getHeaders(settings.headers)\r\n        })\r\n        .toPromise();\r\n    case 'PUT':\r\n      return this.http\r\n        .put<T>(settings.url, settings.data, {\r\n          headers: this.getHeaders(settings.headers)\r\n        })\r\n        .toPromise();\r\n    case 'DELETE':\r\n      return this.http\r\n        .delete<T>(settings.url, {\r\n          headers: this.getHeaders(settings.headers)\r\n        })\r\n        .toPromise();\r\n    }\r\n  }\r\n\r\n  private getHeaders(headers: any): HttpHeaders {\r\n    let httpHeaders: HttpHeaders = new HttpHeaders();\r\n\r\n    if (headers !== undefined) {\r\n      Object.keys(headers).forEach((key) => {\r\n        httpHeaders = httpHeaders.append(key, headers[key]);\r\n      });\r\n    }\r\n\r\n    return httpHeaders;\r\n  }\r\n}\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { JQueryRequestor, LocalStorageBackend, Requestor, StorageBackend } from '@openid/appauth';\r\nimport { AuthActionBuilder, AuthService, Browser, DefaultBrowser } from 'ionic-appauth';\r\nimport { TOKEN_RESPONSE_KEY, TOKEN_RESPONSE_FULL_KEY } from 'src/app/modules/auth/services/regobs-auth.service';\r\nimport { TokenResponseFull } from './token-response-full';\r\n\r\n/**\r\n * Class to wrap ionic-appauth AuthService to handle error coming from requestAccessToken when\r\n * the user is coming from \"Reset password flow\". The error returned from /token endpoint contains AADB2C90090\r\n * and must be handled special.\r\n */\r\nexport class RegobsAuthServiceOverride extends AuthService {\r\n  constructor(\r\n    protected browser: Browser = new DefaultBrowser(),\r\n    protected storage: StorageBackend = new LocalStorageBackend(),\r\n    protected requestor: Requestor = new JQueryRequestor()\r\n  ) {\r\n    super(browser, storage, requestor);\r\n  }\r\n\r\n  protected async requestAccessToken(code: string, codeVerifier?: string): Promise<void> {\r\n    try {\r\n      await super.requestAccessToken(code, codeVerifier);\r\n    } catch (err) {\r\n      if (err.error?.error_description?.indexOf('AADB2C90090') >= 0) {\r\n        this.notifyActionListers(AuthActionBuilder.RefreshFailed(new Error('AADB2C90090')));\r\n        // Error in action listeners is only a string (toString)\r\n        // and error_description is not included, so we have to pass this in as a custom Error.\r\n      } else {\r\n        this.notifyActionListers(AuthActionBuilder.RefreshFailed(err));\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Refresh token. If refresh fails, you can just try again.\r\n   * Will only remove cached tokens if refresh token is expired\r\n   */\r\n  public async refreshToken() {\r\n    await super.requestTokenRefresh().catch((error) => {\r\n      this.clearTokensIfRefreshTokenIsExpired(error);\r\n    });\r\n  }\r\n\r\n  private async clearTokensIfRefreshTokenIsExpired(error: unknown) {\r\n    if (error && error instanceof HttpErrorResponse && error.status !== 401 && error.status !== 400) {\r\n      // Only check if refresh token is valid if not 401 - Unauthorized or 400 - Bad request is returned from token endpoint\r\n      const tokenResponseFullString: string | null = await this.storage.getItem(TOKEN_RESPONSE_FULL_KEY);\r\n      if (tokenResponseFullString != null) {\r\n        const tokenResponseFull = new TokenResponseFull(JSON.parse(tokenResponseFullString));\r\n        if (tokenResponseFull.isRefreshTokenValid()) {\r\n          return; // Do not clear token from storage if refresh token is still valid\r\n        }\r\n      }\r\n    }\r\n    await this.storage.removeItem(TOKEN_RESPONSE_KEY);\r\n    await this.storage.removeItem(TOKEN_RESPONSE_FULL_KEY);\r\n    this.notifyActionListers(AuthActionBuilder.RefreshFailed(error));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { AlertController, NavController, Platform } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { AuthActions, AuthService } from 'ionic-appauth';\r\nimport { BehaviorSubject, firstValueFrom, from, lastValueFrom, Observable, of, ReplaySubject } from 'rxjs';\r\nimport { filter, map, shareReplay, skip, switchMap, tap, withLatestFrom } from 'rxjs/operators';\r\nimport { LangKey } from '@varsom-regobs-common/core';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport { LoggedInUser } from '../../login/models/logged-in-user.model';\r\nimport { AccountService, MyPageData, ObserverResponseDto } from '@varsom-regobs-common/regobs-api';\r\nimport { LoggingService } from '../../shared/services/logging/logging.service';\r\nimport { Location } from '@angular/common';\r\nimport { nowInSeconds, StorageBackend } from '@openid/appauth';\r\nimport { isAndroidOrIos } from 'src/app/core/helpers/ionic/platform-helper';\r\n\r\nconst DEBUG_TAG = 'RegobsAuthService';\r\nexport const RETURN_URL_KEY = 'authreturnurl';\r\nexport const TOKEN_RESPONSE_KEY = 'token_response';\r\nexport const TOKEN_RESPONSE_FULL_KEY = 'token_response_full';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RegobsAuthService {\r\n  private _isLoggingInSubject = new BehaviorSubject<boolean>(false);\r\n  private myPageDataSubject = new ReplaySubject<MyPageData>();\r\n\r\n  public readonly loggedInUser$: Observable<LoggedInUser>;\r\n  private readonly initComplete$: Observable<boolean>;\r\n  readonly myPageData$: Observable<MyPageData>;\r\n\r\n  get isLoggingIn$(): Observable<boolean> {\r\n    return this._isLoggingInSubject.asObservable();\r\n  }\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private userSettingService: UserSettingService,\r\n    private logger: LoggingService,\r\n    private translateService: TranslateService,\r\n    private alertController: AlertController,\r\n    private router: Router,\r\n    private navCtrl: NavController,\r\n    private location: Location,\r\n    private accountService: AccountService,\r\n    private storage: StorageBackend,\r\n    private platform: Platform,\r\n    private accountApi: AccountService\r\n  ) {\r\n    this.initComplete$ = this.authService.initComplete$.pipe(\r\n      filter((isComplete) => isComplete),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.loggedInUser$ = this.createLoggedInUser$();\r\n\r\n    const events$ = this.initComplete$.pipe(switchMap(() => this.authService.events$));\r\n\r\n    events$\r\n      .pipe(filter((action) => action.action === AuthActions.SignInFailed && action.error !== 'Handle Not Available'))\r\n      .subscribe((action) => this.showErrorMessage(500, action.error));\r\n\r\n    events$\r\n      .pipe(filter((action) => action.action === AuthActions.RefreshFailed && action.error === 'AADB2C90090'))\r\n      .subscribe(() => this.signIn(false)); // Hack to detect user is coming from reset password flow. Route user back to login.\r\n\r\n    events$.pipe(filter((action) => action.action === AuthActions.SignInSuccess)).subscribe(async () => {\r\n      await this.redirectToReturnUrl();\r\n      await this.checkAndSetNickIfNickIsNull();\r\n    });\r\n\r\n    this.userSettingService.appMode$.pipe(skip(1)).subscribe(() => {\r\n      this.logout(); // When user change app mode, just logout and force user to login again for the new environment.\r\n    });\r\n\r\n    // TODO: This could be saved in offline storage if we want to presist\r\n    // myPage data and the user start app when offline and want to edit registration\r\n    this.myPageData$ = this.loggedInUser$.pipe(\r\n      switchMap((loggedInUser) => {\r\n        if (loggedInUser.isLoggedIn) {\r\n          return this.accountApi.AccountGetMyPageData();\r\n        } else {\r\n          return of(undefined);\r\n        }\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n\r\n    this.initRefreshTokenOnStartup();\r\n  }\r\n\r\n  private createLoggedInUser$(): Observable<LoggedInUser> {\r\n    const tokenWithClaims$ = this.createTokenWithClaims$();\r\n    return this.initComplete$.pipe(\r\n      switchMap(() => tokenWithClaims$),\r\n      tap((tokenResponseWithClaims) => {\r\n        const tokenResponse = tokenResponseWithClaims.tokenResponse;\r\n        const issuedAt = tokenResponseWithClaims.tokenResponse?.issuedAt;\r\n        const issuedAtNice = issuedAt ? new Date(issuedAt * 1000) : undefined;\r\n        const gotToken = tokenResponse?.idToken ? 'OK' : 'NO TOKEN';\r\n        this.logger.debug(`Token: ${gotToken}, issued at: ${issuedAtNice}`, DEBUG_TAG);\r\n      }),\r\n      map((tokenResponseWithClaims) => ({\r\n        isLoggedIn: tokenResponseWithClaims?.tokenResponse != null,\r\n        token: tokenResponseWithClaims?.tokenResponse?.idToken,\r\n        tokenIssuedAt: tokenResponseWithClaims?.tokenResponse?.issuedAt,\r\n        email: tokenResponseWithClaims?.claims?.email\r\n      })),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private createTokenWithClaims$() {\r\n    return this.initComplete$.pipe(\r\n      switchMap(() =>\r\n        this.authService.token$.pipe(\r\n          map((tokenResponse) => ({\r\n            tokenResponse,\r\n            claims: tokenResponse?.idToken ? this.parseJwt(tokenResponse.idToken) : undefined\r\n          }))\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private initRefreshTokenOnStartup() {\r\n    this.initComplete$\r\n      .pipe(\r\n        switchMap(() => (isAndroidOrIos(this.platform) ? this.platform.resume : from(this.platform.ready()))),\r\n        withLatestFrom(this.loggedInUser$)\r\n      )\r\n      .subscribe(([, user]) => {\r\n        if (user?.token && this.isTokenOlderThan(user?.tokenIssuedAt, 300)) {\r\n          //token is older than 5 minutes, so refresh\r\n          this.logger.debug('App resumed. Refresh token...', DEBUG_TAG);\r\n          this.refreshToken();\r\n        }\r\n      });\r\n  }\r\n\r\n  isTokenOlderThan(tokenIssuedAt: number, ageInSeconds: number): boolean {\r\n    return tokenIssuedAt && tokenIssuedAt < nowInSeconds() - ageInSeconds;\r\n  }\r\n\r\n  public refreshToken(): Promise<void> {\r\n    return this.authService.refreshToken();\r\n  }\r\n\r\n  public authorizationCallback(url: string): void {\r\n    try {\r\n      this.authService.authorizationCallback(url);\r\n    } catch (err) {\r\n      this.logger.error(err, DEBUG_TAG, 'Could not call authorizationCallback');\r\n    }\r\n  }\r\n\r\n  public async signIn(setReturnUrl = true): Promise<void> {\r\n    const currentLang = await firstValueFrom(this.userSettingService.language$);\r\n    if (setReturnUrl) {\r\n      const url = this.router.url;\r\n      this.logger.debug(`SignIn: ReturnUrl = '${url}'`, DEBUG_TAG);\r\n      localStorage.setItem(RETURN_URL_KEY, url);\r\n    }\r\n    try {\r\n      await this.authService.signIn({\r\n        ui_locales: this.getSupportedLoginLocales(currentLang),\r\n        prompt: 'login' // Force login screen\r\n      });\r\n    } catch (err) {\r\n      this.logger.error(err, DEBUG_TAG, 'Could not signIn');\r\n    }\r\n  }\r\n\r\n  public async logout(): Promise<void> {\r\n    await this.storage.removeItem(TOKEN_RESPONSE_KEY);\r\n    this.authService.endSessionCallback();\r\n  }\r\n\r\n  private async checkAndSetNickIfNickIsNull(): Promise<ObserverResponseDto> {\r\n    try {\r\n      const user = await lastValueFrom(this.accountService.AccountGetObserver());\r\n      if (user && user.Nick != null && user.Nick != '') {\r\n        return;\r\n      }\r\n      const nick = await this.showSetNickDialog();\r\n      await lastValueFrom(this.accountService.AccountUpdateObserver({ Nick: nick }));\r\n    } catch (err) {\r\n      this.logger.error(err, DEBUG_TAG, 'Could not save nick');\r\n    }\r\n  }\r\n\r\n  private async showSetNickDialog(): Promise<string> {\r\n    const headerTextKey = 'SET_NICK_ALERT.INPUT_TEXT';\r\n    const messageTextKey = 'SET_NICK_ALERT.HELP_TEXT';\r\n    const okTextKey = 'DIALOGS.OK';\r\n    const translations = await lastValueFrom(this.translateService.get([headerTextKey, messageTextKey, okTextKey]));\r\n    const alert = await this.alertController.create({\r\n      header: translations[headerTextKey],\r\n      message: translations[messageTextKey],\r\n      backdropDismiss: false,\r\n      inputs: [\r\n        {\r\n          name: 'nick',\r\n          type: 'text',\r\n          max: 24\r\n        }\r\n      ],\r\n      buttons: [\r\n        {\r\n          text: translations[okTextKey],\r\n          handler: (data: { nick: string }) => {\r\n            return data && data.nick != null && data.nick != '';\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n\r\n    const result = (await alert.onDidDismiss()) as {\r\n      data: { values: { nick: string } };\r\n    };\r\n    return result?.data?.values?.nick;\r\n  }\r\n\r\n  public getLoggedInUserAsPromise(): Promise<LoggedInUser> {\r\n    return firstValueFrom(this.loggedInUser$);\r\n  }\r\n\r\n  private async redirectToReturnUrl(): Promise<void> {\r\n    if (this.location.path().indexOf('auth/callback') >= 0) {\r\n      const returnUrl = localStorage.getItem(RETURN_URL_KEY);\r\n      this.logger.debug(`redirectToReturnUrl: returnUrl from localStorage = '${returnUrl}'`, DEBUG_TAG);\r\n      if (returnUrl) {\r\n        localStorage.removeItem(RETURN_URL_KEY);\r\n        this.location.replaceState(this.router.serializeUrl(this.router.createUrlTree([''])));\r\n        await this.navCtrl.navigateForward(returnUrl);\r\n      } else {\r\n        await this.navCtrl.navigateRoot('');\r\n      }\r\n    }\r\n  }\r\n\r\n  private async showErrorMessage(status: number, message: string) {\r\n    const text = status === 401 ? 'UNAUTHORIZED' : status <= 0 ? 'SERVICE_UNAVAILABLE' : 'UNKNOWN_ERROR';\r\n    const messageText = `LOGIN.${text}`;\r\n    const extraMessage = text === 'UNKNOWN_ERROR' ? ` ${message}` : '';\r\n    const translations = await lastValueFrom(this.translateService.get(['ALERT.DEFAULT_HEADER', 'ALERT.OK', messageText]));\r\n    const alert = await this.alertController.create({\r\n      header: translations['ALERT.DEFAULT_HEADER'],\r\n      message: `${translations[messageText]}${extraMessage}`,\r\n      buttons: [translations['ALERT.OK']]\r\n    });\r\n    await alert.present();\r\n  }\r\n\r\n  private getSupportedLoginLocales(langKey: LangKey) {\r\n    if (langKey === LangKey.nb || langKey === LangKey.nn) {\r\n      return 'nb-NO';\r\n    }\r\n    return 'en';\r\n  }\r\n\r\n  private parseJwt(token: string) {\r\n    const base64Url = token.split('.')[1];\r\n    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\r\n    const jsonPayload = decodeURIComponent(\r\n      atob(base64)\r\n        .split('')\r\n        .map(function (c) {\r\n          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\r\n        })\r\n        .join('')\r\n    );\r\n    return JSON.parse(jsonPayload);\r\n  }\r\n}\r\n","import {\r\n  nowInSeconds,\r\n  TokenResponse,\r\n  TokenResponseJson\r\n} from '@openid/appauth';\r\n\r\nexport const AUTH_EXPIRY_BUFFER = 10 * 60 * -1; // 10 mins in seconds\r\n\r\nexport interface TokenResponseFullJson extends TokenResponseJson {\r\n  refresh_token_expires_in: string;\r\n}\r\n\r\nexport class TokenResponseFull extends TokenResponse {\r\n  // eslint-disable-next-line max-len\r\n  // id_token: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6IjQ5SVcxMGI3bjVSVTJsNFNqem9VblpvekdkYWpna3Z0QjgyQUswVHFHTU0ifQ.eyJleHAiOjE2MzIxOTM2ODksIm5iZiI6MTYzMjE1MDQ4OSwidmVyIjoiMS4wIiwiaXNzIjoiaHR0cHM6Ly9udmViMmMwMXRlc3QuYjJjbG9naW4uY29tLzQ3YjM5ZTRkLTA2MmYtNDhkZi05YTVhLWFiY2Y4OWQ4N2E0YS92Mi4wLyIsInN1YiI6IjcxOWFjYjVjLTI4MTAtNDA2NS1iNGIxLWU5YjY4ZDNmYTc3ZiIsImF1ZCI6IjEzMjcwODE1LTdkZWYtNDgwMC04ZmM5LTE3OGRkNTE3ZjU3NCIsImlhdCI6MTYzMjE1MDQ4OSwiYXV0aF90aW1lIjoxNjMyMTUwNDg2LCJ1aWQiOiI3MTlhY2I1Yy0yODEwLTQwNjUtYjRiMS1lOWI2OGQzZmE3N2YiLCJlbWFpbCI6Im9teUBudmUubm8iLCJuYW1lIjoiVW5rbm93biIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJwaG9uZV92ZXJpZmllZCI6ZmFsc2UsImNvbnNlbnRfb3BlcmF0aW5nX2luZm8iOmZhbHNlLCJjb25zZW50X25ld3NsZXR0ZXIiOmZhbHNlLCJjb25zZW50X3VzZXJfc3VydmV5IjpmYWxzZSwicm9sZXMiOlsicmVnT2JzX2FkbWluIl0sInBpZCI6IkIyQ18xQV9zaWduX3VwX3NpZ25faW5fbnZlIn0.zgzFYDrhttICNlK7-ddn4RMqu-JnXTTniP-qsI1KR939geLvoj8hemvjc7Oi67VMPUOxVhD0hzaGZ0l22uvAFFVnUjAb3mAyvdCDnnb3JKuzBoc-sNzvsp4LH3Uavl-szD-aHvUJ5PM_MJmXPpERBloYf3HK57hSyCfmpl1wwkFuB6vElPudedBBwn8vri_v6mzbEFy2Xo9HXRsC0bLbdXxYA1BD70Rq_JK-6XgKj2jwXiPFB5Z6-gULb5oSt7izkPo-BnjDdSdR6dF2WQcFQ5N07h_lS9QmFrHRvU7ML7xc3Y6mBJ4syIGa5xWTOG3UdMWaF87TSc8G4TqZXbEkkA\"\r\n  // id_token_expires_in: 43200\r\n  // not_before: 1632150489 //samme som issued_at\r\n  // profile_info: \"eyJ2ZXIiOiIxLjAiLCJ0aWQiOiI0N2IzOWU0ZC0wNjJmLTQ4ZGYtOWE1YS1hYmNmODlkODdhNGEiLCJzdWIiOm51bGwsIm5hbWUiOiJVbmtub3duIiwicHJlZmVycmVkX3VzZXJuYW1lIjpudWxsLCJpZHAiOm51bGx9\"\r\n  // eslint-disable-next-line max-len\r\n  // refresh_token: \"eyJraWQiOiJlTzRSeHRyR1Q3cEhTX1lBMTFsQzZhaVpFS21oTlRfd3ppcU5KakFQaVZ3IiwidmVyIjoiMS4wIiwiemlwIjoiRGVmbGF0ZSIsInNlciI6IjEuMCJ9.aCB-s3tzaJpKdi4Jle-it5amN5r7gQu_oQH-jQ30smduADaYCLeUKBJR8qdQLw-1JjOmyZ9akgf0r06Gi7HKDm1ekp_MQnetiB5IesHAVQv__18lcrojVQaEb5q_ifIjR8bngXMNJ8j7vM53yVHNVfIyBzVPniA8MkTFYByEtACFg-3HhGNt89rG4303fpbAc2gu-vP3YFYGCsmCoBzpIerRssuqS0jApMhJxBgSVbWpB4_k4rTmde7uQJ5i2ooO55-YJaD1ZcMcfA00wmd394PbGg7yxPIt8Ss2js6f30-wNOcENt0mV0mTlB_6LFgQ4XWiAXgZzxkGLBlCLHmOwA.eqkMEie0UXNorSYP.4vNmYAgRuUEWyKqQ0imSBsYhM6vB9DUcCST6_31TE_biQPNXD05fpa0XIckkFCDXoLkPW7B76qFrzCYkGgqp4y8TRNu7mtK-xtt9N-OSn_9MNnfen4pmOXSrzfV5R2tZyWB4zmoySHabPe44nliSimiewFh3nvYNBy-m9ayVbk90KOnjhvW6H-yPw3lzwCY1FnfhEIAfvWIcmZaujhMGdl0jYlsz0YbYm7ex_1hpkVs60U6wN-Qih5hRR3nCZblcmGOUa8rby0e2_PcAz_caXCj1hifQ5Id_TRjNPylroEwG1_6d5scYsPgTLPPkcOVXSTTmaYBQ_fYv8oQHCme3w3DxGsn5gSI66Rllm9WdeUQ5CSYpFZgaaUs7VqEdZglTnGKS8N8gcREtlHIdwnjwIkylpASAfdhvpMPCrmi3xzFZQbziyUjUHNADyFGl_b37JegP64KybuO9D4CDiGxKVaqi_bmdH9VmjiGuv9TXsE5ugFDGfxw1EZhvOrUuXqZO2OsTUcK_AIT_MsvJJ2b12bq25QtCU0fd1B9CyUe6E9qt4oYheI4dwpF04ADQBVCOzqCbEQEdMeN6LL9bmoR2xhy4is2q4kuBbbxDOU_Gp3H3UsEF5__YofTsJ9UlO758bEhqZTKHh-ya_4w3Dc3s513mPXMnuiaE-7sgIrjrjjENlIfVdAhittxh49EBmwqzU-AkM1q180Yax_WCX-c.uqm4ebK3LfQMSgCV3TcCgg\"\r\n  // refresh_token_expires_in: 86400\r\n  // scope: \"offline_access openid\"\r\n  // token_type: \"Bearer\"\r\n\r\n  refreshTokenExpiresIn: number | undefined; /* lifetime in seconds. */\r\n\r\n  constructor(response: TokenResponseFullJson) {\r\n    super(response);\r\n    if (response.refresh_token_expires_in) {\r\n      this.refreshTokenExpiresIn = parseInt(\r\n        response.refresh_token_expires_in,\r\n        10\r\n      );\r\n    }\r\n  }\r\n\r\n  isRefreshTokenValid(buffer: number = AUTH_EXPIRY_BUFFER): boolean {\r\n    if (this.expiresIn) {\r\n      const now = nowInSeconds();\r\n      return now < this.issuedAt + this.expiresIn + buffer;\r\n    } else {\r\n      return true;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  RxJsonSchema\r\n} from 'rxdb';\r\nexport const AttachmentMetaSchema : RxJsonSchema = {\r\n  title: 'Attachment Metadata schema',\r\n  description: 'Attachment Metadata',\r\n  version: 0,\r\n  keyCompression: false,\r\n  type: 'object',\r\n  properties: {\r\n    id: {\r\n      type: 'string',\r\n      primary: true,\r\n    },\r\n    GeoHazardTID: {\r\n      type: 'number',\r\n    },\r\n    RegistrationTID: {\r\n      type: 'number',\r\n    },\r\n    ref: {\r\n      type: 'string',\r\n    },\r\n    type: {\r\n      type: 'string',\r\n    },\r\n    error: {\r\n    },\r\n    fileSize: {\r\n      type: 'number'\r\n    },\r\n    AttachmentId: {\r\n      type: 'number'\r\n    },\r\n    AttachmentUploadId: {\r\n      type: 'string',\r\n    },\r\n    Photographer: {\r\n      type: 'string',\r\n    },\r\n    Copyright: {\r\n      type: 'string',\r\n    },\r\n    Aspect: {\r\n      type: 'number'\r\n    },\r\n    Comment: {\r\n      type: 'string',\r\n    },\r\n    AttachmentMimeType: {\r\n      type: 'string',\r\n    },\r\n    IsMainAttachment: {\r\n    }\r\n  },\r\n  required: ['id', 'GeoHazardTID', 'RegistrationTID'],\r\n};\r\n","import {\r\n  RxJsonSchema\r\n} from 'rxdb';\r\nexport const GenericSchema : RxJsonSchema = {\r\n  title: 'Generic schema',\r\n  description: 'Generic offline table with string id',\r\n  version: 0,\r\n  keyCompression: false,\r\n  type: 'object',\r\n  properties: {\r\n    id: {\r\n      type: 'string',\r\n      primary: true\r\n    },\r\n    lastUpdated: {\r\n      type: 'number'\r\n    },\r\n    data: {\r\n      type: ['object', 'array' ]\r\n    }\r\n  },\r\n};\r\n","import {\r\n  RxJsonSchema\r\n} from 'rxdb';\r\nexport const RegistrationSyncProgressSchema : RxJsonSchema = {\r\n  title: 'Registration sync progress schema',\r\n  description: 'Registration sync progress',\r\n  version: 0,\r\n  keyCompression: false,\r\n  type: 'object',\r\n  properties: {\r\n    id: {\r\n      type: 'string',\r\n      primary: true,\r\n    },\r\n    recordsLeft: {\r\n      type: 'array',\r\n      uniqueItems: true,\r\n      items: {\r\n        type: 'string'\r\n      }\r\n    },\r\n    totalRecords: {\r\n      type: 'number',\r\n    },\r\n    startedTimestamp: {\r\n      type: 'number',\r\n    },\r\n    errors: {\r\n      type: 'array',\r\n      items: {\r\n        type: 'object',\r\n        properties: {\r\n          id: {\r\n            type: 'string'\r\n          },\r\n          error: {\r\n            type: 'string'\r\n          }\r\n        }\r\n      }\r\n    }\r\n  },\r\n  required: ['id'],\r\n};\r\n","import { RxJsonSchema } from 'rxdb';\r\nexport const RegistrationSchema: RxJsonSchema = {\r\n  title: 'Registration schema',\r\n  description: 'Registrations',\r\n  version: 0,\r\n  keyCompression: false,\r\n  type: 'object',\r\n  properties: {\r\n    id: {\r\n      type: 'string',\r\n      primary: true\r\n    },\r\n    changed: {\r\n      type: 'number'\r\n    },\r\n    geoHazard: {\r\n      type: 'number'\r\n    },\r\n    syncStatus: {\r\n      type: 'string'\r\n    },\r\n    lastSync: {\r\n      type: 'number'\r\n    },\r\n    syncError: {\r\n      type: 'string'\r\n    },\r\n    syncStatusCode: {\r\n      type: 'number'\r\n    },\r\n    request: {\r\n      type: 'object',\r\n      properties: {}\r\n    },\r\n    response: {\r\n      type: 'object',\r\n      properties: {}\r\n    },\r\n    changedRegistrationTid: {\r\n      type: ['number', 'null']\r\n    }\r\n  },\r\n  required: ['id', 'changed', 'geoHazard', 'syncStatus'],\r\n  attachments: {\r\n    encrypted: false\r\n  }\r\n};\r\n","import {\r\n  RxJsonSchema\r\n} from 'rxdb';\r\nexport const UploadProgressSchema : RxJsonSchema = {\r\n  title: 'Upload progress schema',\r\n  description: 'Upload progress',\r\n  version: 0,\r\n  keyCompression: false,\r\n  type: 'object',\r\n  properties: {\r\n    id: {\r\n      type: 'string',\r\n      primary: true,\r\n    },\r\n    totalBytes: {\r\n      type: 'number',\r\n    },\r\n    complete: {\r\n      type: 'number',\r\n    }\r\n  },\r\n  required: ['id', 'totalBytes', 'complete'],\r\n};\r\n","export function getBlobFromUrl(url: string): Promise<Blob> {\r\n  return new Promise((resolve, reject) => {\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', url, true);\r\n    xhr.responseType = 'blob';\r\n    xhr.onerror = ((err) => reject(err));\r\n    xhr.onload = () => {\r\n      if (xhr.status == 200) {\r\n        resolve(xhr.response);\r\n      }else{\r\n        reject(new Error('Not found'));\r\n      }\r\n    };\r\n    xhr.send();\r\n  });\r\n}","import { RegistrationTid } from '../models/registration-tid.enum';\r\nimport { IRegistration } from '../models/registration.interface';\r\nimport { isEmpty, GeoHazard } from '@varsom-regobs-common/core';\r\nimport { ValidRegistrationType } from '../models/valid-registration.type';\r\nimport { AttachmentEditModel, AttachmentViewModel, RegistrationEditModel, RegistrationViewModel } from '@varsom-regobs-common/regobs-api';\r\nimport { SyncStatus } from '../registration.models';\r\n\r\nexport function getAllAttachments(reg: IRegistration, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  if(!reg) {\r\n    return [];\r\n  }\r\n  if(reg.syncStatus === SyncStatus.InSync && reg.response) {\r\n    return getAllAttachmentsFromResponse(reg, registrationTid);\r\n  }\r\n  return getAllAttachmentsFromRequest(reg, registrationTid);\r\n}\r\n\r\nexport function getAttachmentsFromRegistrationViewModel(viewModel: RegistrationEditModel | RegistrationViewModel, registrationTid?: RegistrationTid): AttachmentEditModel[] {\r\n  if(!viewModel || !viewModel.Attachments) {\r\n    return [];\r\n  }\r\n  return (viewModel.Attachments as AttachmentViewModel[])\r\n    .filter((a) => ((registrationTid > 0) ? a.RegistrationTID === registrationTid : true))\r\n    .map((a) => ({ ...a, type: 'Attachment'  }));\r\n}\r\n\r\nexport function getDamageObsAttachments(viewModel: RegistrationEditModel, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  if(!viewModel || !viewModel.DamageObs) {\r\n    return [];\r\n  }\r\n  return [].concat(...viewModel.DamageObs.map((item) => item.Attachments || []))\r\n    .filter((a) => ((registrationTid > 0) ? a.RegistrationTID === registrationTid : true));\r\n}\r\n\r\nexport function getWaterLevelAttachments(viewModel: RegistrationEditModel, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  if(!viewModel || !viewModel.WaterLevel2 || !viewModel.WaterLevel2.WaterLevelMeasurement) {\r\n    return [];\r\n  }\r\n  return [].concat(...viewModel.WaterLevel2.WaterLevelMeasurement.map((item) => item.Attachments || []))\r\n    .filter((a) => ((registrationTid > 0) ? a.RegistrationTID === registrationTid : true));\r\n}\r\n\r\nexport function getAllAttachmentsFromViewModel(viewModel: RegistrationEditModel, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  const attachments = getAttachmentsFromRegistrationViewModel(viewModel, registrationTid);\r\n  const damageObsAttachments = getDamageObsAttachments(viewModel, registrationTid);\r\n  const waterLevelAttachmetns = getWaterLevelAttachments(viewModel, registrationTid);\r\n  return  [].concat(...attachments, ...damageObsAttachments, ...waterLevelAttachmetns);\r\n}\r\n\r\nexport function getAllAttachmentsFromRequest(reg: IRegistration, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  return  getAllAttachmentsFromViewModel(reg.request, registrationTid);\r\n}\r\n\r\nexport function getAllAttachmentsFromResponse(reg: IRegistration, registrationTid?: RegistrationTid):  AttachmentEditModel[] {\r\n  return  getAllAttachmentsFromViewModel(reg.response, registrationTid);\r\n}\r\n\r\nexport function deleteExistingAttachmentById(reg: IRegistration, attachmentId: number): void {\r\n  if(reg && reg.request) {\r\n    if(reg.request.Attachments && reg.request.Attachments.length > 0) {\r\n      reg.request.Attachments = reg.request.Attachments.filter((a) => a.AttachmentId !== attachmentId);\r\n    }\r\n    if(reg.request.WaterLevel2 && reg.request.WaterLevel2.WaterLevelMeasurement) {\r\n      for(const wlm of reg.request.WaterLevel2.WaterLevelMeasurement) {\r\n        wlm.Attachments = wlm.Attachments.filter((a) => a.AttachmentId !== attachmentId);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function editExistingAttachmentById(reg: IRegistration, attachmentId: number, model: AttachmentEditModel): void {\r\n  if(reg && reg.request) {\r\n    if(reg.request.Attachments && reg.request.Attachments.length > 0) {\r\n      reg.request.Attachments = (reg.request.Attachments || []).map((a) => {\r\n        if(a.AttachmentId === attachmentId) {\r\n          return Object.assign(a, model);\r\n        }\r\n        return a;\r\n      });\r\n    }\r\n    if(reg.request.WaterLevel2 && reg.request.WaterLevel2.WaterLevelMeasurement) {\r\n      for(const wlm of reg.request.WaterLevel2.WaterLevelMeasurement) {\r\n        wlm.Attachments = (wlm.Attachments || []).map((a) => {\r\n          if(a.AttachmentId === attachmentId) {\r\n            return Object.assign(a, model);\r\n          }\r\n          return a;\r\n        });\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function getPropertyName(registrationTid: RegistrationTid): string {\r\n  return RegistrationTid[registrationTid];\r\n}\r\n\r\nexport function getRegistationPropertyForModel(regModel: RegistrationEditModel | RegistrationViewModel, registrationTid: RegistrationTid): ValidRegistrationType {\r\n  if (regModel && registrationTid) {\r\n    return regModel[getPropertyName(registrationTid)];\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function getRegistationProperty(reg: IRegistration, registrationTid: RegistrationTid): ValidRegistrationType {\r\n  return getRegistationPropertyForModel(reg.request, registrationTid);\r\n}\r\n\r\nexport function getRegistrationTids(): RegistrationTid[] {\r\n  return Object.keys(RegistrationTid)\r\n    .map((key) => RegistrationTid[key]).filter((val: RegistrationTid) => typeof (val) !== 'string');\r\n}\r\n\r\nexport function isObservationModelEmptyForRegistrationTid(regModel: RegistrationEditModel | RegistrationViewModel, registrationTid: RegistrationTid): boolean {\r\n  if (regModel && registrationTid) {\r\n    return isEmpty(getRegistationPropertyForModel(regModel, registrationTid));\r\n  }\r\n  return true;\r\n}\r\n\r\nexport function isObservationEmptyForRegistrationTid(reg: IRegistration, registrationTid: RegistrationTid): boolean {\r\n  return isObservationModelEmptyForRegistrationTid(reg.request, registrationTid);\r\n}\r\n\r\nexport function hasAnyObservations(reg: IRegistration): boolean {\r\n  if (reg === undefined || reg === null) {\r\n    return false;\r\n  }\r\n  const registrationTids = getRegistrationTids();\r\n  return registrationTids.some((x) => !isObservationEmptyForRegistrationTid(reg, x));\r\n}\r\n\r\nexport function isArrayType(tid: RegistrationTid): boolean {\r\n  return [\r\n    RegistrationTid.AvalancheActivityObs,\r\n    RegistrationTid.AvalancheActivityObs2,\r\n    RegistrationTid.AvalancheDangerObs,\r\n    RegistrationTid.AvalancheEvalProblem2,\r\n    RegistrationTid.CompressionTest,\r\n    RegistrationTid.DangerObs,\r\n    RegistrationTid.Picture,\r\n    RegistrationTid.DamageObs\r\n  ].indexOf(tid) >= 0;\r\n}\r\n\r\nexport function getRegistrationTidsForGeoHazard(geoHazard: GeoHazard): RegistrationTid[] {\r\n  const commonTypes = [RegistrationTid.GeneralObservation];\r\n  const geoHazardValidTypes = new Map<GeoHazard, RegistrationTid[]>([\r\n    [GeoHazard.Snow, [\r\n      RegistrationTid.DangerObs,\r\n      RegistrationTid.AvalancheObs,\r\n      RegistrationTid.AvalancheActivityObs2,\r\n      RegistrationTid.WeatherObservation,\r\n      RegistrationTid.SnowSurfaceObservation,\r\n      RegistrationTid.CompressionTest,\r\n      RegistrationTid.SnowProfile2,\r\n      RegistrationTid.AvalancheEvalProblem2,\r\n      RegistrationTid.AvalancheEvaluation3,\r\n      RegistrationTid.Incident\r\n    ]],\r\n    [GeoHazard.Ice, [\r\n      RegistrationTid.IceCoverObs,\r\n      RegistrationTid.IceThickness,\r\n      RegistrationTid.DangerObs,\r\n      RegistrationTid.Incident\r\n    ]],\r\n    [GeoHazard.Water, [\r\n      RegistrationTid.WaterLevel2,\r\n      RegistrationTid.DamageObs\r\n    ]],\r\n    [GeoHazard.Soil, [\r\n      RegistrationTid.DangerObs,\r\n      RegistrationTid.LandSlideObs\r\n    ]]\r\n  ]);\r\n  return geoHazardValidTypes.get(geoHazard).concat(commonTypes);\r\n}\r\n\r\nexport function getOrCreateNewRegistrationForm(reg: IRegistration, tid: RegistrationTid): ValidRegistrationType {\r\n  if (isObservationEmptyForRegistrationTid(reg, tid)) {\r\n    return isArrayType(tid) ? [] : {};\r\n  }\r\n  return getRegistationProperty(reg, tid);\r\n}\r\n\r\n","import { AttachmentEditModel } from '@varsom-regobs-common/regobs-api';\r\n\r\nexport interface AttachmentUploadEditModel extends AttachmentEditModel {\r\n  id: string;\r\n  type: AttachmentType;\r\n  fileSize?: number;\r\n  fileName?: string; //attachment filename\r\n  error?: Error;\r\n  ref?: string; // Guid\r\n}\r\n\r\nexport type ExistingOrNewAttachmentModel = AttachmentUploadEditModel | AttachmentEditModel;\r\nexport type NewAttachmentType = 'new';\r\nexport type ExistingAttachmentType = 'existing';\r\nexport type ExistingOrNewAttachmentType = NewAttachmentType | ExistingAttachmentType;\r\nexport interface ExistingOrNewAttachment {\r\n  type: ExistingOrNewAttachmentType;\r\n  attachment: ExistingOrNewAttachmentModel;\r\n}\r\n\r\nexport type AttachmentType = 'Attachment' | 'DamageObsAttachment' | 'WaterLevelMeasurementAttachment';\r\n","export enum RegistrationTid {\r\n    GeneralObservation = 10,\r\n    Incident = 11,\r\n    Picture = 12,\r\n    DangerObs = 13,\r\n    DamageObs = 14,\r\n    WeatherObservation = 21,\r\n    SnowSurfaceObservation = 22,\r\n    SnowCoverObs = 23,\r\n    AvalancheDangerObs = 24,\r\n    CompressionTest = 25,\r\n    AvalancheObs = 26,\r\n    AvalancheActivityObs = 27,\r\n    AvalancheEvaluation = 28,\r\n    AvalancheEvaluation2 = 30,\r\n    AvalancheEvaluation3 = 31,\r\n    AvalancheEvalProblem2 = 32,\r\n    AvalancheActivityObs2 = 33,\r\n    SnowTempObs = 34,\r\n    DensityProfile = 35,\r\n    SnowProfile2 = 36,\r\n    StratProfile = 37,\r\n    IceThickness = 50,\r\n    IceCoverObs = 51,\r\n    WaterLevel = 61,\r\n    WaterLevel2 = 62,\r\n    LandSlideObs = 71,\r\n}\r\n","export enum SummaryKind {\r\n    List = 0,\r\n    Text = 1,\r\n    Url = 2,\r\n}\r\n","import { RegObsGenericValue } from '@varsom-regobs-common/regobs-api';\r\nimport { SummaryKind } from './summary-kind.enum';\r\n\r\nexport class TextSummary implements RegObsGenericValue {\r\n    readonly Kind = SummaryKind.Text;\r\n    readonly KindType = 'Text';\r\n\r\n    private _header: string;\r\n    private _value: string;\r\n\r\n    get Header() {\r\n      return this._header;\r\n    }\r\n\r\n    set Header(header: string) {\r\n      this._header = header;\r\n    }\r\n\r\n    get Value() {\r\n      return this._value;\r\n    }\r\n\r\n    set Value(value: string) {\r\n      this._value = value;\r\n    }\r\n\r\n    constructor(header: string, value: string) {\r\n      this._header = header;\r\n      this._value = value;\r\n    }\r\n\r\n}\r\n","import { RegObsGenericValue } from '@varsom-regobs-common/regobs-api';\r\nimport { SummaryKind } from './summary-kind.enum';\r\n\r\nexport class UrlSummary implements RegObsGenericValue {\r\n    readonly Kind = SummaryKind.Url;\r\n    readonly KindType = 'Url';\r\n\r\n    private _header: string;\r\n    private _value: string;\r\n\r\n    get Header() {\r\n      return this._header;\r\n    }\r\n\r\n    set Header(header: string) {\r\n      this._header = header;\r\n    }\r\n\r\n    get Value() {\r\n      return this.ensureValidUrl(this._value);\r\n    }\r\n\r\n    set Value(value: string) {\r\n      this._value = value;\r\n    }\r\n\r\n    constructor(header: string, value: string) {\r\n      this._header = header;\r\n      this._value = value;\r\n    }\r\n\r\n    private ensureValidUrl(url: string) {\r\n      const validProtocols = ['http', 'https'];\r\n      if (url && url.length > 0 && !validProtocols.some((vp) => url.toLocaleLowerCase().startsWith(vp))) {\r\n        const pIndex = url.indexOf('://');\r\n        if (pIndex >= 0) {\r\n          return `http://${url.substr(pIndex + 3)}`;\r\n        }\r\n\r\n        return `http://${url}`;\r\n      }\r\n      return url;\r\n    }\r\n\r\n}\r\n","/**\r\n * If a registration is changed locally or not\r\n */\r\nexport enum SyncStatus {\r\n  /**\r\n   * New registration or changes made locally, which is not sent to server (yet)\r\n   */\r\n  Draft = 'draft',\r\n\r\n  /**\r\n   * Registration is on its way to the server, but we have not confirmed that it is received (yet)\r\n   */\r\n  Sync = 'sync',\r\n\r\n  /**\r\n   * Registration is not changed locally. Same version exists on server\r\n   */\r\n  InSync = 'in-sync'\r\n}\r\n","import { InjectionToken } from '@angular/core';\r\nimport { ISummaryProvider } from './services/summary-providers/summary-provider.interface';\r\n\r\nexport const FOR_ROOT_OPTIONS_TOKEN = new InjectionToken<IRegistrationModuleOptions>('forRoot() Module configuration');\r\nexport const SUMMARY_PROVIDER_TOKEN = new InjectionToken<ISummaryProvider>('Registration summary provider token');\r\n\r\nexport interface IRegistrationModuleOptions {\r\n  adapter?: string;\r\n  autoSync?: boolean;\r\n  attachmentsSupported?: boolean;\r\n}","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { take } from 'rxjs/operators';\r\nimport { KdvService } from '../services/kdv/kdv.service';\r\nimport { KdvKey } from '../models/kdv-key.type';\r\n\r\n@Pipe({\r\n  name: 'kdvDescription'\r\n})\r\nexport class KdvDescriptionPipe implements PipeTransform {\r\n  constructor(private kdvService: KdvService) { }\r\n\r\n  async transform(value: number, kdvKey: KdvKey, returnDescription = false): Promise<string> {\r\n    const kdvelements = await this.kdvService.getKdvRepositoryByKeyObservable(kdvKey).pipe(take(1)).toPromise();\r\n    const kdvelement = kdvelements.find((x) => x.Id === value);\r\n    const result = kdvelement ? (returnDescription ? kdvelement.Description : kdvelement.Name) : '';\r\n    return result.trim();\r\n  }\r\n\r\n}\r\n","export * from './helpers/registration.helper';\r\nexport * from './helpers/object-url-blob.helper';","export { IRegistration } from './models/registration.interface';\r\nexport { SyncStatus } from './models/sync-status.enum';\r\nexport { IRegistrationSettings } from './models/registration-settings.interface';\r\nexport { RegistrationTid } from './models/registration-tid.enum';\r\nexport { ValidRegistrationType } from './models/valid-registration.type';\r\nexport { SummaryKind } from './models/summary/summary-kind.enum';\r\nexport { SummaryWithAttachments } from './models/summary/summary-with-attachments';\r\nexport { KdvKey } from './models/kdv-key.type';\r\nexport { KdvViewRepositoryKey } from './models/view-repository-key.type';\r\nexport { IRegistrationType } from './models/registration-type.interface';\r\nexport * from './models/attachment-upload-edit.interface';\r\nexport { WaterLevelMeasurementUploadModel } from './models/water-level-measurement-upload-model';\r\nexport { ISyncProgressRecord } from './models/sync-progress-record.interface';\r\nexport { ISyncProgress } from './models/sync-progress.interface';\r\nexport { IUplaodProgress } from './models/upload-progress.interface';\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CoreModule } from '@varsom-regobs-common/core';\r\nimport { FakeItemSyncCallbackService } from './services/item-sync-callback/fake-item-sync-callback.service';\r\nimport { RegobsApiSyncCallbackService } from './services/item-sync-callback/regobs-api-sync-callback.service';\r\nimport { RegobsApiModuleWithConfig, KdvElementsService, HelptextService as HelpTextApiService } from '@varsom-regobs-common/regobs-api';\r\nimport { OfflineDbServiceOptions } from './services/offline-db/offline-db-service.options';\r\nimport { TranslateLoader, TranslateModule, TranslateService } from '@ngx-translate/core';\r\nimport { GeneralObservationSummaryProvider } from './services/summary-providers/general-observation/general-observation.summary-provider';\r\nimport { HttpClient, HTTP_INTERCEPTORS } from '@angular/common/http';\r\nimport { HttpConnectivityInterceptor } from 'ngx-connectivity';\r\nimport { NewAttachmentService } from './services/add-new-attachment/new-attachment.service';\r\nimport { throwError } from 'rxjs';\r\nimport { WeatherSummaryProvider } from './services/summary-providers/snow/weather/weather.summary-provider';\r\nimport { RegobsRegistrationPipesModule } from './registration.pipes';\r\nimport { OfflineDbNewAttachmentService } from './services/add-new-attachment/offline-db-new-attachment.service';\r\nimport { FOR_ROOT_OPTIONS_TOKEN, IRegistrationModuleOptions, SUMMARY_PROVIDER_TOKEN } from './module.options';\r\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\r\nimport FileAttachmentService from './services/add-new-attachment/file-attachment.service';\r\n\r\nexport function offlineDbServiceOptionsFactory(options?: IRegistrationModuleOptions): OfflineDbServiceOptions {\r\n  const offlineDbServiceOptions = new OfflineDbServiceOptions();\r\n  // If the optional options were provided via the .forRoot() static method, then apply\r\n  // them to the MyServiceOptions Type provider.\r\n  if (options) {\r\n    if (options.adapter) {\r\n      offlineDbServiceOptions.adapter = options.adapter;\r\n    }\r\n  }\r\n  return offlineDbServiceOptions;\r\n}\r\n\r\nexport function getFakeKdvElementsService(): unknown {\r\n  const fakeService = { KdvElementsGetKdvs: () => throwError(Error('Fake service')) };\r\n  return fakeService;\r\n}\r\n\r\nexport function getFakeHelpTextApiService(): unknown {\r\n  const fakeService = { HelptextGet: () => throwError(Error('Fake service')) };\r\n  return fakeService;\r\n}\r\n\r\nexport function createTranslateLoader(http: HttpClient): TranslateHttpLoader {\r\n  return new TranslateHttpLoader(http, './assets/i18n/', '.json');\r\n}\r\n\r\nexport const translateModuleForRoot = TranslateModule.forRoot({\r\n  loader: {\r\n    provide: TranslateLoader,\r\n    useFactory: createTranslateLoader,\r\n    deps: [HttpClient]\r\n  }\r\n});\r\n\r\n@NgModule({\r\n  imports: [CoreModule, RegobsApiModuleWithConfig, translateModuleForRoot],\r\n  declarations: [],\r\n  exports: [RegobsRegistrationPipesModule]\r\n})\r\nexport class RegistrationModule {\r\n  static forRoot(options?: IRegistrationModuleOptions): ModuleWithProviders<RegistrationModule> {\r\n    return {\r\n      ngModule: RegistrationModule,\r\n      providers: [\r\n        {\r\n          provide: FOR_ROOT_OPTIONS_TOKEN,\r\n          useValue: options\r\n        },\r\n        {\r\n          provide: OfflineDbServiceOptions,\r\n          useFactory: offlineDbServiceOptionsFactory,\r\n          deps: [FOR_ROOT_OPTIONS_TOKEN]\r\n        },\r\n        {\r\n          provide: 'OfflineRegistrationSyncService',\r\n          useClass: RegobsApiSyncCallbackService\r\n        },\r\n        {\r\n          provide: SUMMARY_PROVIDER_TOKEN,\r\n          useClass: GeneralObservationSummaryProvider,\r\n          multi: true\r\n        },\r\n        {\r\n          provide: SUMMARY_PROVIDER_TOKEN,\r\n          useClass: WeatherSummaryProvider,\r\n          multi: true\r\n        },\r\n        {\r\n          provide: HTTP_INTERCEPTORS,\r\n          useClass: HttpConnectivityInterceptor,\r\n          multi: true\r\n        },\r\n        {\r\n          provide: NewAttachmentService,\r\n          useClass: window.hasOwnProperty('cordova') ? FileAttachmentService : OfflineDbNewAttachmentService\r\n        },\r\n        TranslateService\r\n      ]\r\n    };\r\n  }\r\n\r\n  static forChild(options?: IRegistrationModuleOptions): ModuleWithProviders<RegistrationModule> {\r\n    return RegistrationModule.forRoot(options);\r\n  }\r\n\r\n  static forTesting(): ModuleWithProviders<RegistrationModule> {\r\n    return {\r\n      ngModule: RegistrationModule,\r\n      providers: [\r\n        {\r\n          provide: FOR_ROOT_OPTIONS_TOKEN,\r\n          useValue: { adapter: 'memory' }\r\n        },\r\n        {\r\n          provide: OfflineDbServiceOptions,\r\n          useValue: { adapter: 'memory' }\r\n        },\r\n        {\r\n          provide: 'OfflineRegistrationSyncService',\r\n          useClass: FakeItemSyncCallbackService\r\n        },\r\n        {\r\n          provide: SUMMARY_PROVIDER_TOKEN,\r\n          useClass: GeneralObservationSummaryProvider,\r\n          multi: true\r\n        },\r\n        {\r\n          provide: SUMMARY_PROVIDER_TOKEN,\r\n          useClass: WeatherSummaryProvider,\r\n          multi: true\r\n        },\r\n        {\r\n          provide: NewAttachmentService,\r\n          useClass: OfflineDbNewAttachmentService\r\n        },\r\n        { provide: KdvElementsService, useFactory: getFakeKdvElementsService },\r\n        { provide: HelpTextApiService, useFactory: getFakeHelpTextApiService }\r\n      ]\r\n    };\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { KdvDescriptionPipe } from './pipes/kdvDescription.pipe';\r\n\r\nconst PIPES = [\r\n  KdvDescriptionPipe,\r\n];\r\n\r\n@NgModule({\r\n  declarations: PIPES,\r\n  imports: [],\r\n  exports: PIPES,\r\n})\r\nexport class RegobsRegistrationPipesModule {}\r\n\r\nexport { KdvDescriptionPipe } from './pipes/kdvDescription.pipe';\r\n","export { RegistrationService } from './services/registration/registration.service';\r\nexport { OfflineDbService } from './services/offline-db/offline-db.service';\r\nexport { ItemSyncCallbackService } from './services/item-sync-callback/item-sync-callback.service';\r\nexport { FakeItemSyncCallbackService } from './services/item-sync-callback/fake-item-sync-callback.service';\r\nexport { KdvService } from './services/kdv/kdv.service';\r\nexport { HelpTextService } from './services/help-text/help-text.service';\r\nexport { ProgressService } from './services/progress/progress.service';\r\nexport { NewAttachmentService } from './services/add-new-attachment/new-attachment.service';\r\nexport { OfflineDbNewAttachmentService } from './services/add-new-attachment/offline-db-new-attachment.service';","import { GeoHazard, uuidv4 } from '@varsom-regobs-common/core';\r\nimport { BehaviorSubject, firstValueFrom, from, Observable, switchMap, tap } from 'rxjs';\r\nimport { LoggingService } from 'src/app/modules/shared/services/logging/logging.service';\r\nimport { AttachmentType, AttachmentUploadEditModel } from '../../models/attachment-upload-edit.interface';\r\nimport { RegistrationTid } from '../../registration.models';\r\nimport { NewAttachmentService } from './new-attachment.service';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { Injectable } from '@angular/core';\r\n\r\nconst DEBUG_TAG = 'FileAttachmentService';\r\nconst ROOT_DIR = 'attachments';\r\n\r\n/**\r\n * Provides attachments saved on local drive\r\n */\r\n@Injectable()\r\nexport default class FileAttachmentService implements NewAttachmentService {\r\n  private hasCreatedRootFolder = false;\r\n  private attachmentsChanged = new BehaviorSubject<void>(undefined); //get a tick each time a registration's attachment changes\r\n\r\n  constructor(private file: File, private loggingService: LoggingService) {\r\n    this.attachmentsChanged.pipe(tap(() => this.loggingService.debug('Attachments changed', DEBUG_TAG)));\r\n  }\r\n\r\n  async addAttachment(\r\n    registrationId: string,\r\n    data: Blob,\r\n    mimeType: string,\r\n    geoHazard: GeoHazard,\r\n    registrationTid: RegistrationTid,\r\n    type?: AttachmentType,\r\n    ref?: string\r\n  ): Promise<void> {\r\n    const rootDir = await this.getRootPath();\r\n    await this.file.createDir(rootDir, registrationId, true);\r\n    const attachmentId = uuidv4();\r\n\r\n    const attachmentFileName = `${attachmentId}.${this.getFileExtension(mimeType)}`;\r\n    await this.file.writeFile(`${rootDir}/${registrationId}`, attachmentFileName, data, { replace: true });\r\n\r\n    const metadata: AttachmentUploadEditModel = {\r\n      GeoHazardTID: geoHazard,\r\n      RegistrationTID: registrationTid,\r\n      AttachmentMimeType: mimeType,\r\n      id: attachmentId,\r\n      type,\r\n      fileSize: data.size,\r\n      fileName: attachmentFileName,\r\n      ref\r\n    };\r\n    this.loggingService.debug(`Attachment saved in ${rootDir}/${registrationId}/${attachmentFileName}`, DEBUG_TAG, metadata);\r\n    await firstValueFrom(this.saveAttachmentMeta$(registrationId, metadata));\r\n  }\r\n\r\n  saveAttachmentMeta$(registrationId: string, meta: AttachmentUploadEditModel): Observable<unknown> {\r\n    return from(\r\n      this.getRootPath().then((rootDir) =>\r\n        this.file.writeFile(`${rootDir}/${registrationId}`, `${meta.id}.json`, JSON.stringify(meta), { replace: true })\r\n      )\r\n    ).pipe(tap(() => this.attachmentsChanged.next()));\r\n  }\r\n\r\n  getAttachments(registrationId: string): Observable<AttachmentUploadEditModel[]> {\r\n    return this.attachmentsChanged.pipe(switchMap(() => from(this.getAttachmentsFromFile(registrationId))));\r\n  }\r\n\r\n  getBlob(registrationId: string, attachmentId: string): Observable<Blob> {\r\n    return from(this.getBlobInternal(registrationId, attachmentId));\r\n  }\r\n\r\n  removeAttachment$(registrationId: string, attachmentId: string): Observable<boolean> {\r\n    return from(this.removeAttachmentInternal(registrationId, attachmentId));\r\n  }\r\n\r\n  removeAttachment(registrationId: string, attachmentId: string): void {\r\n    this.removeAttachment$(registrationId, attachmentId).subscribe();\r\n  }\r\n\r\n  async removeAttachments(registrationId: string): Promise<void> {\r\n    const path = await this.getRootPath();\r\n    await this.file.removeDir(`${path}/`, registrationId);\r\n    this.attachmentsChanged.next();\r\n  }\r\n\r\n  removeAttachments$(registrationId: string): Observable<void> {\r\n    return from(this.removeAttachments(registrationId));\r\n  }\r\n\r\n  /**\r\n   * Get file url for data directory\r\n   * @returns file url as string, with trailing /\r\n   */\r\n  private getDataDirectoryFileUrl(): string {\r\n    if (this.file && this.file.dataDirectory) {\r\n      const fileUrl = this.file.dataDirectory;\r\n      return fileUrl;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Get root directory folder path\r\n   * @returns directory path as string\r\n   */\r\n  private async getRootPath(): Promise<string> {\r\n    const dataFolder = this.getDataDirectoryFileUrl();\r\n    if (!this.hasCreatedRootFolder) {\r\n      await this.file.createDir(dataFolder, ROOT_DIR, true);\r\n      this.hasCreatedRootFolder = true;\r\n    }\r\n    return `${dataFolder}${ROOT_DIR}`;\r\n  }\r\n\r\n  private async getAttachmentsFromFile(registrationId: string): Promise<AttachmentUploadEditModel[]> {\r\n    const path = await this.getRootPath();\r\n    if (await this.directoryForRegistrationExists(registrationId)) {\r\n      const entries = await this.file.listDir(path, registrationId);\r\n      return await Promise.all(\r\n        entries\r\n          .filter((entry) => entry.isFile && entry.name.endsWith('.json'))\r\n          .map((entry) => this.readMetadataFile(registrationId, entry.name))\r\n      );\r\n    }\r\n    return [];\r\n  }\r\n\r\n  private async readMetadataFile(registrationId: string, filename: string): Promise<AttachmentUploadEditModel> {\r\n    const rootDir = await this.getRootPath();\r\n    if (!(await this.directoryForRegistrationExists(registrationId))) {\r\n      throw Error(`Directory for registration ${rootDir}/${registrationId} does not exist`);\r\n    }\r\n    const content = await this.file.readAsText(`${rootDir}/${registrationId}`, filename);\r\n    return JSON.parse(content);\r\n  }\r\n\r\n  private async getBlobInternal(registrationId: string, attachmentId: string): Promise<Blob> {\r\n    const rootDir = await this.getRootPath();\r\n    const metadata = await this.readMetadataFile(registrationId, `${attachmentId}.json`);\r\n    const buffer = await this.file.readAsArrayBuffer(`${rootDir}/${registrationId}`, metadata.fileName);\r\n    return new Blob([buffer], { type: metadata.AttachmentMimeType });\r\n  }\r\n\r\n  private async removeAttachmentInternal(registrationId: string, attachmentId: string): Promise<boolean> {\r\n    const rootPath = await this.getRootPath();\r\n    const path = `${rootPath}/${registrationId}/`;\r\n    const metadataFileName = this.getMetadataFileName(attachmentId);\r\n    const metadata = await this.readMetadataFile(registrationId, metadataFileName);\r\n    await this.file.removeFile(path, metadata.fileName);\r\n    await this.file.removeFile(path, metadataFileName);\r\n\r\n    const remainingEntries = await this.file.listDir(rootPath, registrationId);\r\n    if (remainingEntries.length === 0) {\r\n      await this.file.removeDir(rootPath, registrationId);\r\n    }\r\n    this.attachmentsChanged.next();\r\n    return true;\r\n  }\r\n\r\n  private getMetadataFileName(attachmentId: string): string {\r\n    return `${attachmentId}.json`;\r\n  }\r\n\r\n  private getFileExtension(mimeType: string): string {\r\n    switch (mimeType) {\r\n      case 'image/jpeg':\r\n        return 'jpg';\r\n      case 'image/png':\r\n        return 'png';\r\n    }\r\n    return 'jpg';\r\n  }\r\n\r\n  private async directoryForRegistrationExists(registrationId: string): Promise<boolean> {\r\n    const path = await this.getRootPath();\r\n    try {\r\n      await this.file.checkDir(`${path}/`, registrationId);\r\n      return true;\r\n    } catch (err) {\r\n      return false;\r\n    }\r\n  }\r\n}\r\n","import { Observable } from 'rxjs';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { AttachmentType, AttachmentUploadEditModel, RegistrationTid } from '../../registration.models';\r\n\r\n/**\r\n * Handle storage of new registration attachments on client before they are sent to server\r\n */\r\nexport abstract class NewAttachmentService {\r\n  abstract addAttachment(\r\n    registrationId: string,\r\n    data: Blob,\r\n    mimeType: string,\r\n    geoHazard: GeoHazard,\r\n    registrationTid: RegistrationTid,\r\n    type?: AttachmentType,\r\n    ref?: string\r\n  ): Promise<void>;\r\n  abstract saveAttachmentMeta$(registrationId: string, meta: AttachmentUploadEditModel): Observable<unknown>;\r\n\r\n  /**\r\n   * Get list of attachment metadata each time an attachment (or attachment metadata) changes on provided registration\r\n   */\r\n  abstract getAttachments(registrationId: string): Observable<AttachmentUploadEditModel[]>;\r\n\r\n  abstract getBlob(registrationId: string, attachmentId: string): Observable<Blob>;\r\n  abstract removeAttachment(registrationId: string, attachmentId: string): void;\r\n  abstract removeAttachment$(registrationId: string, attachmentId: string): Observable<boolean>;\r\n  abstract removeAttachments(registrationId: string): Promise<void>;\r\n  abstract removeAttachments$(registrationId: string): Observable<void>;\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { combineLatest, EMPTY, forkJoin, from, Observable, of } from 'rxjs';\r\nimport { AppMode, AppModeService, GeoHazard, LoggerService, uuidv4 } from '@varsom-regobs-common/core';\r\nimport { AttachmentType, AttachmentUploadEditModel } from '../../models/attachment-upload-edit.interface';\r\nimport { OfflineDbService, TABLE_NAMES } from '../offline-db/offline-db.service';\r\nimport { NewAttachmentService } from './new-attachment.service';\r\nimport { catchError, filter, map, startWith, switchMap, take } from 'rxjs/operators';\r\nimport { RxAttachmentMetaCollection, RxAttachmentMetaDocument, RxRegistrationCollection, RxRegistrationDocument } from '../../db/RxDB';\r\nimport { RegistrationTid } from '../../models/registration-tid.enum';\r\n\r\n@Injectable()\r\nexport class OfflineDbNewAttachmentService implements NewAttachmentService {\r\n  constructor(\r\n    private offlineDbService: OfflineDbService,\r\n    protected appModeService: AppModeService,\r\n    protected loggerService: LoggerService\r\n  ) {}\r\n\r\n  async addAttachment(\r\n    registrationId: string,\r\n    data: Blob,\r\n    mimeType: string,\r\n    geoHazard: GeoHazard,\r\n    registrationTid: RegistrationTid,\r\n    type?: AttachmentType,\r\n    ref?: string\r\n  ): Promise<void> {\r\n    const attachmentId = uuidv4();\r\n    this.getRegistrationOfflineDocumentById(registrationId)\r\n      .pipe(\r\n        take(1),\r\n        switchMap((doc) =>\r\n          this.saveAttachmentMeta$(registrationId, {\r\n            id: attachmentId,\r\n            AttachmentMimeType: mimeType,\r\n            GeoHazardTID: geoHazard,\r\n            RegistrationTID: registrationTid,\r\n            type,\r\n            ref,\r\n            fileSize: data.size\r\n          }).pipe(\r\n            switchMap(() =>\r\n              from(\r\n                doc.putAttachment({\r\n                  id: attachmentId,\r\n                  data,\r\n                  type: mimeType\r\n                })\r\n              )\r\n            )\r\n          )\r\n        ),\r\n        catchError((err) => {\r\n          this.loggerService.error(() => 'Could not add attachment', err);\r\n          return EMPTY;\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  getAttachments(registrationId: string): Observable<AttachmentUploadEditModel[]> {\r\n    return combineLatest([this.getRegistrationOfflineDocumentById(registrationId), this.getAnyChangesToMetaData$()]).pipe(\r\n      switchMap(([doc]) => (doc && doc.allAttachments().length > 0 ? this.getAttachmentMetaFromDocument(doc) : of([])))\r\n    );\r\n  }\r\n\r\n  private getAnyChangesToMetaData$() {\r\n    return this.getAttachmentMetaDbCollectionForAppMode().pipe(\r\n      switchMap((collection) => collection.$),\r\n      startWith({})\r\n    );\r\n  }\r\n\r\n  getAttachment(registrationId: string, attachmentId: string): Observable<AttachmentUploadEditModel> {\r\n    return this.getAttachments(registrationId).pipe(map((result) => result.find((a) => a.id === attachmentId)));\r\n  }\r\n\r\n  getBlob(registrationId: string, attachmentId: string): Observable<Blob> {\r\n    return this.getRegistrationOfflineDocumentById(registrationId).pipe(\r\n      filter((doc) => !!doc),\r\n      switchMap((doc) => of(doc.getAttachment(attachmentId))),\r\n      filter((attachment) => !!attachment),\r\n      switchMap((attachment) => from(attachment.getData() as Promise<Blob>))\r\n    );\r\n  }\r\n\r\n  removeAttachment(registrationId: string, attachmentId: string): void {\r\n    this.removeAttachment$(registrationId, attachmentId).subscribe();\r\n  }\r\n\r\n  removeAttachments$(registrationId: string): Observable<void> {\r\n    return from(this.removeAttachments(registrationId));\r\n  }\r\n\r\n  removeAttachment$(registrationId: string, attachmentId: string): Observable<boolean> {\r\n    return this.getRegistrationAttachmentDocument(registrationId, attachmentId).pipe(\r\n      take(1),\r\n      switchMap((a) => from(a.remove())),\r\n      switchMap(() =>\r\n        this.getAttachmentMetaDocument(attachmentId).pipe(\r\n          take(1),\r\n          switchMap((metaDoc) => from(metaDoc.remove()))\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  async removeAttachments(registrationId: string): Promise<void> {\r\n    const regDoc = await this.getRegistrationOfflineDocumentById(registrationId).pipe(take(1)).toPromise();\r\n    if (!regDoc) {\r\n      this.loggerService.debug('No registration document found!');\r\n      return;\r\n    }\r\n    const metaDocs = await this.getAttachmentMetaDocumentsFromRegistrationDocument(regDoc).pipe(take(1)).toPromise();\r\n    for (const metaDoc of metaDocs) {\r\n      try {\r\n        await metaDoc.remove();\r\n      } catch (err) {\r\n        this.loggerService.debug('Could not remove attachment meta document from registration document', metaDoc, err);\r\n      }\r\n    }\r\n    const collection = await this.getRegistrationDbCollectionForAppMode().pipe(take(1)).toPromise();\r\n    await collection.atomicUpsert(regDoc.toJSON()); // Removes attachments\r\n  }\r\n\r\n  private getRegistrationAttachmentDocument(registrationId: string, attachmentId: string) {\r\n    return this.getRegistrationOfflineDocumentById(registrationId).pipe(\r\n      filter((doc) => !!doc),\r\n      map((doc) => doc.getAttachment(attachmentId))\r\n    );\r\n  }\r\n\r\n  private getAttachmentMetaFromDocument(doc: RxRegistrationDocument) {\r\n    return this.getAttachmentMetaDocumentsFromRegistrationDocument(doc).pipe(\r\n      map((attachmentMetaDocs: RxAttachmentMetaDocument[]) => attachmentMetaDocs.filter((doc) => !!doc).map((mdoc) => mdoc.toJSON()))\r\n    );\r\n  }\r\n\r\n  private getAttachmentMetaDocumentsFromRegistrationDocument(doc: RxRegistrationDocument): Observable<RxAttachmentMetaDocument[]> {\r\n    const attachments = doc.allAttachments();\r\n    if (attachments.length <= 0) {\r\n      return of([]);\r\n    }\r\n    return forkJoin(doc.allAttachments().map((attachment) => this.getAttachmentMetaDocument(attachment.id).pipe(take(1))));\r\n  }\r\n\r\n  private getAttachmentMetaDocument(id: string): Observable<RxAttachmentMetaDocument> {\r\n    return this.getAttachmentMetaDbCollectionForAppMode().pipe(\r\n      switchMap((collection) => collection.findByIds$([id]).pipe(map((result) => result.get(id))))\r\n    );\r\n  }\r\n\r\n  public saveAttachmentMeta$(registrationId: string, attachmentMetaData: AttachmentUploadEditModel): Observable<RxAttachmentMetaDocument> {\r\n    return this.getAttachmentMetaDbCollectionForAppMode().pipe(\r\n      take(1),\r\n      switchMap((dbCollection) => from(dbCollection.atomicUpsert(attachmentMetaData)))\r\n    );\r\n  }\r\n\r\n  private getAttachmentMetaDbCollectionForAppMode(): Observable<RxAttachmentMetaCollection> {\r\n    return this.appModeService.appMode$.pipe(map((appMode) => this.getAttachmentMetaDbCollection(appMode)));\r\n  }\r\n\r\n  private getAttachmentMetaDbCollection(appMode: AppMode): RxAttachmentMetaCollection {\r\n    return this.offlineDbService.getDbCollection<RxAttachmentMetaCollection>(appMode, TABLE_NAMES.ATTACHMENT_META);\r\n  }\r\n\r\n  protected getRegistrationOfflineDocumentById(id: string): Observable<RxRegistrationDocument> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      switchMap((dbCollection) => dbCollection.findByIds$([id])),\r\n      map((result) => result.get(id))\r\n    );\r\n  }\r\n\r\n  private getRegistrationDbCollectionForAppMode(): Observable<RxRegistrationCollection> {\r\n    return this.appModeService.appMode$.pipe(map((appMode) => this.getRegistrationsDbCollection(appMode)));\r\n  }\r\n\r\n  private getRegistrationsDbCollection(appMode: AppMode): RxRegistrationCollection {\r\n    return this.offlineDbService.getDbCollection<RxRegistrationCollection>(appMode, TABLE_NAMES.REGISTRATION);\r\n  }\r\n}\r\n","import { Injectable, Inject, InjectionToken } from '@angular/core';\r\nimport { Observable, combineLatest, from, of, BehaviorSubject } from 'rxjs';\r\nimport { LanguageService, LoggerService, AppMode, LangKey, AppModeService } from '@varsom-regobs-common/core';\r\nimport { map, switchMap, shareReplay, catchError, concatMap, take } from 'rxjs/operators';\r\nimport { OfflineSyncMeta } from '../../models/offline-sync-meta.interface';\r\nimport moment from 'moment';\r\nimport { OfflineDbService } from '../offline-db/offline-db.service';\r\nimport { RxKdvCollection } from '../../db/RxDB';\r\nimport { RxDocument } from 'rxdb';\r\n\r\nexport const API_SYNCE_OFFLINE_BASE_SERVICE_OPTIONS_CONFIG = new InjectionToken<ApiSyncOfflineBaseServiceOptions>('ApiSyncOfflineBaseServiceOptions.config');\r\nexport interface ApiSyncOfflineBaseServiceOptions {\r\n  useLangKeyAsDbKey: boolean;\r\n  validSeconds: number;\r\n  offlineTableKey?: string | number;\r\n}\r\n\r\n@Injectable()\r\nexport abstract class ApiSyncOfflineBaseService<T>  {\r\n\r\n  public readonly data$: Observable<T>;\r\n  private isUpdatingSubject = new BehaviorSubject<boolean>(false);\r\n\r\n  get isUpdating$(): Observable<boolean> {\r\n    return this.isUpdatingSubject.asObservable();\r\n  }\r\n\r\n  constructor(\r\n    @Inject(API_SYNCE_OFFLINE_BASE_SERVICE_OPTIONS_CONFIG) protected options: ApiSyncOfflineBaseServiceOptions,\r\n    protected offlineDbService: OfflineDbService,\r\n    protected languageService: LanguageService,\r\n    protected appModeService: AppModeService,\r\n    protected logger: LoggerService) {\r\n    this.data$ = this.getDataObservable().pipe(shareReplay(1));\r\n  }\r\n\r\n  public abstract getUpdatedData(appMode: AppMode, langKey: LangKey): Observable<T>;\r\n  public abstract getFallbackData(appMode: AppMode, langKey: LangKey): Observable<T>;\r\n  public abstract getTableName(appMode: AppMode): string;\r\n\r\n  /** Force update offline data */\r\n  public update(): void {\r\n    this.isUpdatingSubject.next(true);\r\n    combineLatest([this.languageService.language$, this.appModeService.appMode$]).pipe(\r\n      switchMap(([langKey, appMode]) => this.getUpdatedDataAndSaveResultIfSuccess(appMode, langKey)),\r\n      take(1)).subscribe(() => {\r\n      this.isUpdatingSubject.next(false);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check if data is to old to use (cache time has expired)\r\n   * @param metaData cached offline data\r\n   */\r\n  protected isValid(metaData: RxDocument<OfflineSyncMeta<T>>): boolean {\r\n    const valid = metaData && (metaData.lastUpdated > this.getInvalidTime().unix());\r\n    this.logger.debug(`Offline data is ${valid ? 'valid -> returning offline data' : 'not valid -> Fetch new data'}`, metaData);\r\n    return valid;\r\n  }\r\n\r\n  /**\r\n   * Get limit for when data is invalid (cache time)\r\n   */\r\n  protected getInvalidTime(): moment.Moment {\r\n    return moment().subtract(this.options.validSeconds, 'seconds');\r\n  }\r\n\r\n  /**\r\n   * Get data observable\r\n   */\r\n  private getDataObservable(): Observable<T> {\r\n    return combineLatest([this.languageService.language$, this.appModeService.appMode$]).pipe(\r\n      switchMap(([langKey, appMode]) =>\r\n        this.getOfflineDataAndReturnIfDataIsUpToDate(appMode, langKey)\r\n          .pipe(take(1), switchMap((updatedData) =>\r\n            updatedData != null ? of(updatedData) : this.getUpdatedDataAndSaveResultIfSuccessOrFallbackToAssetsFolder(appMode, langKey)))));\r\n  }\r\n\r\n  /**\r\n   * Get data from offline storage and return if valid. If not, return null\r\n   * @param appMode App mode\r\n   * @param langKey Language\r\n   */\r\n  private getOfflineDataAndReturnIfDataIsUpToDate(appMode: AppMode, langKey: LangKey): Observable<T> {\r\n    return this.getOfflineData(appMode, langKey).pipe(map((offlineMeta) => {\r\n      // Check if offline data is newer than 24 hours\r\n      if(this.isValid(offlineMeta)) {\r\n        return offlineMeta.data;\r\n      }\r\n      return null;\r\n    }));\r\n  }\r\n\r\n  /**\r\n   * Get new data and save to offline storage if success. If update of data fails, fall back to old offline storage data or assets in worst case\r\n   * @param appMode App Mode\r\n   * @param langKey Language\r\n   */\r\n  private getUpdatedDataAndSaveResultIfSuccessOrFallbackToAssetsFolder(appMode: AppMode, langKey: LangKey) {\r\n    return this.getUpdatedDataAndSaveResultIfSuccess(appMode, langKey).pipe(\r\n      catchError((err) => {\r\n        this.logger.warn('Could not get kvd elements from API. Fallback to offline storage', err);\r\n        return this.getOfflineDataOrFallbackToAssets(appMode, langKey);\r\n      }));\r\n  }\r\n\r\n  /**\r\n   * Get updated data and save result to offline storage if successful\r\n   */\r\n  private getUpdatedDataAndSaveResultIfSuccess(appMode: AppMode, langKey: LangKey) {\r\n    return this.getUpdatedData(appMode, langKey).pipe(\r\n      switchMap((data) => this.saveDataToOfflineDb(appMode, langKey, data).pipe(catchError((err) => {\r\n        this.logger.error('Could not save data to offline storage', err);\r\n        return of(data);\r\n      }), map(() => data))));\r\n  }\r\n\r\n  /**\r\n   * Save data to offline db\r\n   * @param appMode App mode\r\n   * @param langKey Language\r\n   * @param data Data to save\r\n   */\r\n  private saveDataToOfflineDb(appMode: AppMode, langKey: LangKey, data: T) {\r\n    const meta: OfflineSyncMeta<T> = {\r\n      id: this.getOfflineStorageDbKey(langKey),\r\n      lastUpdated: moment().unix(),\r\n      data\r\n    };\r\n    return from(this.getDbCollection(appMode).atomicUpsert(meta));\r\n  }\r\n\r\n  /**\r\n   * Get offline db collection\r\n   * @param appMode App mode\r\n   */\r\n  private getDbCollection(appMode: AppMode): RxKdvCollection {\r\n    const collection = this.offlineDbService.db[this.getTableName(appMode)];\r\n    return collection as RxKdvCollection;\r\n  }\r\n\r\n  /**\r\n   * Get data from offline db\r\n   * @param appMode App mode\r\n   * @param langKey Language\r\n   */\r\n  private getOfflineData(appMode: AppMode, langKey: LangKey): Observable<RxDocument<OfflineSyncMeta<T>>> {\r\n    const collection =  this.getDbCollection(appMode);\r\n    const key = this.getOfflineStorageDbKey(langKey);\r\n    return collection.findByIds$([key]).pipe(map((val) => val.has(key) ? val.get(key) : null)) as Observable<RxDocument<OfflineSyncMeta<T>>>;\r\n  }\r\n\r\n  /**\r\n   * Get primary key for storing offline data\r\n   * @param langKey Language\r\n   */\r\n  private getOfflineStorageDbKey(langKey: LangKey) {\r\n    return  this.options.useLangKeyAsDbKey ? `${langKey}` : `${this.options.offlineTableKey}`;\r\n  }\r\n\r\n  /**\r\n   * Get offline data or fallback to something if no offline data\r\n   * @param appMode App mode\r\n   * @param langKey Language\r\n   */\r\n  private getOfflineDataOrFallbackToAssets(appMode: AppMode, langKey: LangKey) {\r\n    return this.getOfflineData(appMode, langKey).pipe(\r\n      concatMap((val) => {\r\n        if(!val) {\r\n          this.logger.warn('No kdv elements found in offline storage. Get fallback data');\r\n          return this.getFallbackData(appMode, langKey);\r\n        }\r\n        return of(val.data);\r\n      }));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HelptextDto, HelptextService as HelpTextApiService } from '@varsom-regobs-common/regobs-api';\r\nimport {\r\n  AppMode,\r\n  LoggerService,\r\n  LangKey,\r\n  getLangKeyString,\r\n  LanguageService,\r\n  GeoHazard,\r\n  AppModeService } from '@varsom-regobs-common/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { catchError, map} from 'rxjs/operators';\r\nimport { Observable, of } from 'rxjs';\r\nimport { OfflineDbService } from '../offline-db/offline-db.service';\r\nimport { ApiSyncOfflineBaseService } from '../api-sync-offline-base/api-sync-offline-base.service';\r\n\r\nconst VALID_HELP_TEXT_SECONDS = 73200; // 12 hours\r\nconst HELP_TEXTS_ASSETS_FOLDER = '/assets/json';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HelpTextService extends ApiSyncOfflineBaseService<HelptextDto[]> {\r\n\r\n  constructor(protected offlineDbService: OfflineDbService,\r\n    protected languageService: LanguageService,\r\n    protected appModeService: AppModeService,\r\n    protected logger: LoggerService,\r\n    private helpTextApiService: HelpTextApiService,\r\n    private httpClient: HttpClient) {\r\n    super({\r\n      useLangKeyAsDbKey: true,\r\n      validSeconds: VALID_HELP_TEXT_SECONDS\r\n    }, offlineDbService, languageService, appModeService, logger);\r\n  }\r\n\r\n  public getTableName(appMode: AppMode): string {\r\n    return `${appMode.toLocaleLowerCase()}/helptexts`;\r\n  }\r\n\r\n  public getUpdatedData(_: AppMode, langKey: LangKey): Observable<HelptextDto[]> {\r\n    return this.helpTextApiService.HelptextGet(langKey);\r\n  }\r\n\r\n  public getFallbackData(_: AppMode, langKey: LangKey): Observable<HelptextDto[]> {\r\n    return this.httpClient.get<HelptextDto[]>\r\n    (`${HELP_TEXTS_ASSETS_FOLDER}/helptexts.${getLangKeyString(langKey)}.json`)\r\n      .pipe(catchError((err) => {\r\n        this.logger.warn(`Helptexts for language ${getLangKeyString(langKey)} not found in assets/kdvelements folder`, err);\r\n        return of([]);\r\n      }));\r\n  }\r\n\r\n  public getHelpTextObservable(geoHazard: GeoHazard, registrationTid: number): Observable<string> {\r\n    return this.data$.pipe(map((helptexts: HelptextDto[]) =>\r\n      helptexts.find((data) => data.GeoHazardTID === geoHazard && data.RegistrationTID === registrationTid)),\r\n    map((helpText) => helpText ? helpText.Text : undefined));\r\n  }\r\n\r\n  public hasHelpTextObservable(geoHazard: GeoHazard, registrationTid: number): Observable<boolean> {\r\n    return this.getHelpTextObservable(geoHazard, registrationTid).pipe(map((val) => !!val));\r\n  }\r\n}\r\n","import { ItemSyncCallbackService } from './item-sync-callback.service';\r\nimport { Injectable } from '@angular/core';\r\nimport { timer, Observable, of } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { ItemSyncCompleteStatus } from '../../models/item-sync-complete-status.interface';\r\nimport { IRegistration } from '../../models/registration.interface';\r\n@Injectable()\r\nexport class FakeItemSyncCallbackService implements ItemSyncCallbackService<IRegistration> {\r\n  deleteItem(item: IRegistration): Observable<boolean> {\r\n    if(!item) {\r\n      return of(false);\r\n    }\r\n    return this.createRandomDelay().pipe(map(() => true));\r\n  }\r\n  syncItem(item: IRegistration): Observable<ItemSyncCompleteStatus<IRegistration>> {\r\n    return this.createRandomDelay().pipe(map(() => ({ item, success: true })));\r\n  }\r\n\r\n  private createRandomDelay() {\r\n    return timer(Math.floor(Math.random() * 10) * 1000);\r\n  }\r\n}\r\n","import { ItemSyncCompleteStatus } from '../../models/item-sync-complete-status.interface';\r\nimport { Observable } from 'rxjs';\r\n\r\nexport abstract class ItemSyncCallbackService<T> {\r\n  abstract syncItem(item: T, ignoreVersionCheck: boolean): Observable<ItemSyncCompleteStatus<T>>;\r\n  abstract deleteItem(item: T): Observable<boolean>;\r\n}\r\n","import { ItemSyncCallbackService } from './item-sync-callback.service';\r\nimport { IRegistration } from '../../models/registration.interface';\r\nimport { Observable, of, forkJoin } from 'rxjs';\r\nimport { Injectable } from '@angular/core';\r\nimport { ItemSyncCompleteStatus } from '../../models/item-sync-complete-status.interface';\r\nimport { RegistrationService, AttachmentService as ApiAttachmentService, AttachmentEditModel, RegistrationViewModel } from '@varsom-regobs-common/regobs-api';\r\nimport { map, catchError, switchMap, tap, filter, take } from 'rxjs/operators';\r\nimport { LanguageService, LangKey, LoggerService } from '@varsom-regobs-common/core';\r\nimport { AttachmentUploadEditModel } from '../../models/attachment-upload-edit.interface';\r\nimport { HttpClient, HttpEventType, HttpResponse, HttpErrorResponse } from '@angular/common/http';\r\nimport { ProgressService } from '../progress/progress.service';\r\nimport { NewAttachmentService } from '../add-new-attachment/new-attachment.service';\r\nimport { WaterLevelMeasurementUploadModel } from '../../models/water-level-measurement-upload-model';\r\nimport cloneDeep from 'clone-deep';\r\n\r\n@Injectable()\r\nexport class RegobsApiSyncCallbackService implements ItemSyncCallbackService<IRegistration> {\r\n  constructor(\r\n    private regobsApiRegistrationService: RegistrationService,\r\n    private languageService: LanguageService,\r\n    private apiAttachmentService: ApiAttachmentService,\r\n    private newAttachmentService: NewAttachmentService,\r\n    private loggerService: LoggerService,\r\n    private httpClient: HttpClient,\r\n    private progressService: ProgressService\r\n  ) {}\r\n\r\n  deleteItem(item: IRegistration): Observable<boolean> {\r\n    if (!item || !item.response || !(item.response.RegId > 0)) {\r\n      return of(false);\r\n    }\r\n    return this.regobsApiRegistrationService.RegistrationDelete(item.response.RegId).pipe(map(() => true));\r\n  }\r\n\r\n  syncItem(item: IRegistration, ignoreVersionCheck: boolean): Observable<ItemSyncCompleteStatus<IRegistration>> {\r\n    return this.languageService.language$.pipe(\r\n      take(1),\r\n      switchMap((langKey) => this.insertOrUpdate(item, langKey, ignoreVersionCheck))\r\n    );\r\n  }\r\n\r\n  insertOrUpdate(item: IRegistration, langKey: LangKey, ignoreVersionCheck: boolean): Observable<ItemSyncCompleteStatus<IRegistration>> {\r\n    this.loggerService.debug('Start insertOrUpdate: ', item, langKey);\r\n    return this.uploadAttachments(item).pipe(\r\n      switchMap((uploadAttachmentResult) => {\r\n        this.loggerService.debug('Result from attachment upload: ', uploadAttachmentResult);\r\n        this.loggerService.debug('Registration is now: ', item);\r\n        const uploadSuccess = !uploadAttachmentResult.some((a) => a.error);\r\n        let attachmentStatusCode: number = undefined;\r\n        if (!uploadSuccess) {\r\n          attachmentStatusCode = uploadAttachmentResult.map((a) => (a.error as HttpErrorResponse).status || 0).reduce((pv, cv) => (cv > pv ? cv : pv), 0);\r\n        }\r\n        // Set request attachments on temporary request item, so it will not be removed / invalid if failure\r\n        const clonedItem = cloneDeep(item);\r\n        this.setRequestAttachments(clonedItem, uploadAttachmentResult);\r\n        return (\r\n          this.callInsertOrUpdate(clonedItem, langKey, ignoreVersionCheck)\r\n            // TODO: Hvorfor removeAllNewAttachments her?\r\n            .pipe(\r\n              switchMap((result) => this.removeAllNewAttachments(clonedItem).pipe(map(() => result))),\r\n              map((result) => ({\r\n                success: uploadSuccess,\r\n                item: { ...cloneDeep(item), response: result },\r\n                statusCode: attachmentStatusCode,\r\n                error: uploadSuccess ? undefined : 'Could not upload attachments'\r\n              })),\r\n              catchError((err: HttpErrorResponse) => {\r\n                const errorMsg = this.getErrorModelStateMessageOrErrorMsg(err);\r\n                return of({ success: false, item: item, statusCode: err.status, error: errorMsg });\r\n              })\r\n            )\r\n        );\r\n      })\r\n    );\r\n  }\r\n\r\n  private getErrorModelStateMessageOrErrorMsg(err: HttpErrorResponse): string {\r\n    if (err && err.error) {\r\n      return JSON.stringify(err.error);\r\n    }\r\n    if (err && err.message) {\r\n      return err.message;\r\n    }\r\n    return 'Unknown error';\r\n  }\r\n\r\n  /**\r\n   * Add uploaded attachments with uploadId to request attachments\r\n   **/\r\n  private setRequestAttachments(reg: IRegistration, uploadedAttachments: AttachmentUploadEditModel[]) {\r\n    if (uploadedAttachments && uploadedAttachments.length > 0) {\r\n      for (const uploadedAttachment of uploadedAttachments) {\r\n        if (uploadedAttachment.AttachmentUploadId) {\r\n          // Only set request attachments with uploadId\r\n          this.addUploadedAttachmentToRequest(uploadedAttachment, reg);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private callInsertOrUpdate(item: IRegistration, langKey: LangKey, ignoreVersionCheck?: boolean): Observable<RegistrationViewModel> {\r\n    // TODO: Hvorfor trenger vi både RegistrationInsertOrUpdate og RegistrationInsert?\r\n    // Kunne vi bare brukt InsertOrUpdate hver gang?\r\n    return item.response\r\n      ? // PUT\r\n        this.regobsApiRegistrationService.RegistrationInsertOrUpdate({\r\n          registration: item.request,\r\n          id: item.response.RegId,\r\n          langKey,\r\n          externalReferenceId: item.id,\r\n          ignoreVersionCheck: ignoreVersionCheck\r\n        })\r\n      : // POST\r\n        this.regobsApiRegistrationService.RegistrationInsert({\r\n          registration: item.request,\r\n          langKey,\r\n          externalReferenceId: item.id\r\n        });\r\n  }\r\n\r\n  removeAllNewAttachments(item: IRegistration): Observable<IRegistration> {\r\n    return this.newAttachmentService.removeAttachments$(item.id).pipe(map(() => item));\r\n  }\r\n\r\n  uploadAttachments(item: IRegistration): Observable<AttachmentUploadEditModel[]> {\r\n    return this.getAttachmentsToUpload(item).pipe(\r\n      take(1),\r\n      switchMap((attachmentsToUpload) => {\r\n        if (attachmentsToUpload.length > 0) {\r\n          this.loggerService.debug('Attachments to upload: ', attachmentsToUpload);\r\n          return forkJoin(attachmentsToUpload.map((a) => this.uploadAttachmentAndSetAttachmentUploadId(item, a).pipe(take(1))));\r\n        }\r\n        this.loggerService.debug('No attachments to uplaod');\r\n        return of([]);\r\n      })\r\n    );\r\n  }\r\n\r\n  uploadAttachmentAndSetAttachmentUploadId(reg: IRegistration, attachmentUpload: AttachmentUploadEditModel): Observable<AttachmentUploadEditModel> {\r\n    attachmentUpload.error = undefined;\r\n    return this.newAttachmentService.getBlob(reg.id, attachmentUpload.id).pipe(\r\n      switchMap((blob) =>\r\n        this.uploadAttachmentWithProgress(attachmentUpload.id, blob).pipe(\r\n          switchMap((uploadId) => {\r\n            this.loggerService.debug('Attachment uploaded. Setting uploadId', attachmentUpload, uploadId);\r\n            // this.addAttachmentToRequest(uploadId, attachmentUpload, reg);\r\n            attachmentUpload.AttachmentUploadId = uploadId;\r\n            return this.newAttachmentService.saveAttachmentMeta$(reg.id, attachmentUpload).pipe(map(() => attachmentUpload));\r\n          })\r\n        )\r\n      ),\r\n      catchError((err: Error) => {\r\n        this.loggerService.debug('Could not upload attachment. Setting error.', err);\r\n        attachmentUpload.error = err;\r\n        return of(attachmentUpload);\r\n      })\r\n    );\r\n  }\r\n\r\n  private addUploadedAttachmentToRequest(attachmentUploadEditModel: AttachmentUploadEditModel, reg: IRegistration) {\r\n    const attachment = {\r\n      AttachmentUploadId: attachmentUploadEditModel.AttachmentUploadId,\r\n      Photographer: attachmentUploadEditModel.Photographer,\r\n      Copyright: attachmentUploadEditModel.Copyright,\r\n      Aspect: attachmentUploadEditModel.Aspect,\r\n      GeoHazardTID: attachmentUploadEditModel.GeoHazardTID,\r\n      RegistrationTID: attachmentUploadEditModel.RegistrationTID,\r\n      Comment: attachmentUploadEditModel.Comment,\r\n      AttachmentMimeType: attachmentUploadEditModel.AttachmentMimeType,\r\n      IsMainAttachment: attachmentUploadEditModel.IsMainAttachment\r\n    };\r\n    if (attachmentUploadEditModel.type === 'WaterLevelMeasurementAttachment') {\r\n      this.addWaterLevelAttachment(attachment, reg, attachmentUploadEditModel.ref);\r\n      return;\r\n    }\r\n    if (attachmentUploadEditModel.type === 'DamageObsAttachment') {\r\n      this.addDamageObsAttachment(attachment, reg, attachmentUploadEditModel.ref);\r\n      return;\r\n    }\r\n    if (!reg.request.Attachments) {\r\n      reg.request.Attachments = [];\r\n    }\r\n    reg.request.Attachments.push(attachment);\r\n  }\r\n\r\n  private addDamageObsAttachment(attachment: AttachmentEditModel, reg: IRegistration, ref: string) {\r\n    this.loggerService.error('Uploading of damage obs attachments not implemented', attachment, reg, ref);\r\n  }\r\n\r\n  private addWaterLevelAttachment(attachment: AttachmentEditModel, reg: IRegistration, ref: string) {\r\n    const predicate = (m: WaterLevelMeasurementUploadModel) => m.ref === ref;\r\n    const measurement = reg.request.WaterLevel2.WaterLevelMeasurement.find(predicate);\r\n    if (!measurement) {\r\n      this.loggerService.error(`Did not find measurement for attachment with ref ${ref}`, attachment, reg, ref);\r\n    }\r\n    if (!measurement.Attachments) {\r\n      measurement.Attachments = [];\r\n    }\r\n    measurement.Attachments.push(attachment);\r\n  }\r\n\r\n  getAttachmentsToUpload(item: IRegistration): Observable<AttachmentUploadEditModel[]> {\r\n    return this.newAttachmentService.getAttachments(item.id);\r\n  }\r\n\r\n  uploadAttachmentWithProgress(id: string, blob: Blob): Observable<string> {\r\n    const attachmentPostPath = `${this.apiAttachmentService.rootUrl}${ApiAttachmentService.AttachmentPostPath}`;\r\n    const formData = new FormData();\r\n    formData.append('file', blob);\r\n    return this.httpClient\r\n      .post(attachmentPostPath, formData, {\r\n        responseType: 'json',\r\n        reportProgress: true,\r\n        observe: 'events',\r\n        headers: { 'ngsw-bypass': '' }\r\n      })\r\n      .pipe(\r\n        tap((event) => {\r\n          this.loggerService.debug('uploadAttachmentWithProgress got event:', event);\r\n          if (event.type === HttpEventType.UploadProgress) {\r\n            this.progressService.setAttachmentProgress(id, event.total, event.loaded);\r\n          }\r\n        }),\r\n        filter((event) => event.type === HttpEventType.Response),\r\n        map((event: HttpResponse<string>) => {\r\n          if (!event.ok) {\r\n            throw Error(`Could not upload attachment: Status: ${event.statusText}`);\r\n          }\r\n          return event.body;\r\n        }),\r\n        tap((result) => this.loggerService.debug(`Attachment uploaded with attachment id: ${result} `))\r\n      );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AppMode, LanguageService, LangKey, getLangKeyString, LoggerService, AppModeService } from '@varsom-regobs-common/core';\r\nimport { of, Observable } from 'rxjs';\r\nimport { map, catchError} from 'rxjs/operators';\r\nimport { KdvElementsResponseDto, KdvElementsService, KdvElement } from '@varsom-regobs-common/regobs-api';\r\nimport { OfflineDbService } from '../offline-db/offline-db.service';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { KdvKey } from '../../models/kdv-key.type';\r\nimport { KdvViewRepositoryKey } from '../../models/view-repository-key.type';\r\nimport { ApiSyncOfflineBaseService } from '../api-sync-offline-base/api-sync-offline-base.service';\r\n\r\nconst KDV_ASSETS_FOLDER = '/assets/json'; // TODO: Add this to module config?\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class KdvService extends ApiSyncOfflineBaseService<KdvElementsResponseDto> {\r\n\r\n  constructor(protected offlineDbService: OfflineDbService,\r\n    protected languageService: LanguageService,\r\n    protected logger: LoggerService,\r\n    protected appModeService: AppModeService,\r\n    private kdvElementsService: KdvElementsService,\r\n    private httpClient: HttpClient)  {\r\n    super({ useLangKeyAsDbKey: true, validSeconds: 12 * 60 * 60 }, offlineDbService, languageService, appModeService, logger);\r\n  }\r\n\r\n  public getKdvRepositoryByKeyObservable(key: KdvKey): Observable<KdvElement[]> {\r\n    return this.data$.pipe(map((val) => val.KdvRepositories[key]));\r\n  }\r\n\r\n  public getViewRepositoryByKeyObservable(key: KdvViewRepositoryKey): Observable<unknown> {\r\n    return this.data$.pipe(map((val) => val.ViewRepositories[key]));\r\n  }\r\n\r\n  public getUpdatedData(_: AppMode, langKey: LangKey): Observable<KdvElementsResponseDto> {\r\n    return this.kdvElementsService.KdvElementsGetKdvs({ langkey: langKey });\r\n  }\r\n\r\n  public getTableName(appMode: AppMode): string {\r\n    return `${appMode.toLocaleLowerCase()}/kdvelements`;\r\n  }\r\n\r\n  public getFallbackData(_: AppMode, langKey: LangKey): Observable<KdvElementsResponseDto> {\r\n    return this.httpClient.get<KdvElementsResponseDto>\r\n    (`${KDV_ASSETS_FOLDER}/kdvelements.${getLangKeyString(langKey)}.json`)\r\n      .pipe(catchError((err) => {\r\n        this.logger.warn(`Kdv elements for language ${getLangKeyString(langKey)} not found in assets/kdvelements folder`, err);\r\n        return of({\r\n          KdvRepositories: {},\r\n          ViewRepositories: {}\r\n        });\r\n      }));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OfflineDbServiceOptions {\r\n    public adapter = 'idb';\r\n}\r\n","import { Injectable, isDevMode } from '@angular/core';\r\nimport { AppModeService, LoggerService, AppMode } from '@varsom-regobs-common/core';\r\nimport { OfflineDbServiceOptions } from './offline-db-service.options';\r\nimport { RegistrationSchema } from '../../db/schemas/registration.schema';\r\nimport {\r\n  createRxDatabase,\r\n  addRxPlugin,\r\n  RxJsonSchema\r\n} from 'rxdb/plugins/core';\r\nimport { RxRegistrationDatabase, RxRegistrationCollections } from '../../db/RxDB';\r\nimport { GenericSchema } from '../../db/schemas/generic.schema';\r\nimport { from, Observable } from 'rxjs';\r\nimport { AttachmentMetaSchema } from '../../db/schemas/attachment-meta.schema';\r\nimport { RegistrationSyncProgressSchema } from '../../db/schemas/registration-sync-progress.schema';\r\nimport { UploadProgressSchema } from '../../db/schemas/upload-progress.schema';\r\nimport { RxDBAttachmentsPlugin } from 'rxdb/plugins/attachments';\r\nimport { RxDBLocalDocumentsPlugin } from 'rxdb/plugins/local-documents';\r\nimport { RxDBLeaderElectionPlugin } from 'rxdb/plugins/leader-election';\r\n\r\nexport const TABLE_NAMES =  {\r\n  REGISTRATION: 'registration',\r\n  KDV_ELEMENTS: 'kdvelements',\r\n  HELP_TEXTS: 'helptexts',\r\n  ATTACHMENT_META: 'attachmentmeta',\r\n  REGISTRATION_SYNC_PROGRESS: 'syncprogress',\r\n  UPLOAD_PROGRESS: 'uploadprogress'\r\n};\r\n\r\nconst collections: Array<{name: string, schema: RxJsonSchema, instancePerAppMode: boolean}> = [\r\n  {\r\n    name: TABLE_NAMES.REGISTRATION,\r\n    schema: RegistrationSchema,\r\n    instancePerAppMode: true,\r\n  },\r\n  {\r\n    name: TABLE_NAMES.KDV_ELEMENTS,\r\n    schema: GenericSchema,\r\n    instancePerAppMode: true,\r\n  },\r\n  {\r\n    name: TABLE_NAMES.HELP_TEXTS,\r\n    schema: GenericSchema,\r\n    instancePerAppMode: true,\r\n  },\r\n  {\r\n    name: TABLE_NAMES.ATTACHMENT_META,\r\n    schema: AttachmentMetaSchema,\r\n    instancePerAppMode: true,\r\n  },\r\n  {\r\n    name: TABLE_NAMES.REGISTRATION_SYNC_PROGRESS,\r\n    schema: RegistrationSyncProgressSchema,\r\n    instancePerAppMode: false,\r\n  },\r\n  {\r\n    name: TABLE_NAMES.UPLOAD_PROGRESS,\r\n    schema: UploadProgressSchema,\r\n    instancePerAppMode: false,\r\n  },\r\n];\r\n\r\nfunction loadRxDBPlugins(): void {\r\n  addRxPlugin(RxDBLocalDocumentsPlugin);\r\n  addRxPlugin(RxDBAttachmentsPlugin);\r\n  addRxPlugin(RxDBLeaderElectionPlugin);\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OfflineDbService {\r\n\r\n  // public readonly appModeInitialized$: Observable<AppMode>;\r\n  private dbInstance: RxRegistrationDatabase;\r\n\r\n  constructor(private appModeService: AppModeService, private options: OfflineDbServiceOptions, private logger: LoggerService) {\r\n  }\r\n\r\n  async initDatabase(adapter: string): Promise<void> {\r\n    this.dbInstance = await this.create(adapter);\r\n  }\r\n\r\n  get db(): RxRegistrationDatabase {\r\n    return this.dbInstance;\r\n  }\r\n\r\n  public waitForLeadership(): Observable<boolean> {\r\n    return from(this.dbInstance.waitForLeadership());\r\n  }\r\n\r\n  public getDbCollection<T extends RxRegistrationCollections>(appMode: AppMode, tableName: string): T  {\r\n    return this.db[this.getDbCollectionName(appMode, tableName)] as T;\r\n  }\r\n\r\n  public getDbCollectionName(appMode: AppMode, tableName: string): string {\r\n    const c = collections.find((c) => c.name === tableName);\r\n    if(!c) {\r\n      throw new Error(`Table ${tableName} not found in collections`);\r\n    }\r\n\r\n    if(c.instancePerAppMode) {\r\n      return `${appMode.toLocaleLowerCase()}/${c.name}`;\r\n    }else{\r\n      return c.name;\r\n    }\r\n  }\r\n\r\n  private async create(adapter: string): Promise<RxRegistrationDatabase> {\r\n\r\n    loadRxDBPlugins();\r\n\r\n    const db = await createRxDatabase<{ [key: string]: RxRegistrationCollections}>({\r\n      name: 'rxdb_regobs_registration_v2',\r\n      adapter,\r\n      pouchSettings: {\r\n        revs_limit: 10, // Max 10 revisions to keep db small\r\n      },\r\n      ignoreDuplicate: true,\r\n    });\r\n\r\n    if (isDevMode()) {\r\n      (window as unknown)['db'] = db; // write to window for debugging\r\n    }\r\n\r\n    await Promise.all(this.getCollections().map(colData => db.collection(colData)));\r\n\r\n    return db;\r\n  }\r\n\r\n  private getCollections() {\r\n    const result: Array<{name: string, schema: RxJsonSchema}> = [];\r\n    for(const c of collections) {\r\n      if(c.instancePerAppMode) {\r\n        for(const appMode of Object.keys(AppMode)) {\r\n          result.push({ name: `${appMode.toLowerCase()}/${c.name}`, schema: c.schema });\r\n        }\r\n      }else{\r\n        result.push(c);\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { LoggerService } from '@varsom-regobs-common/core';\r\nimport { debounceTime, distinctUntilChanged, map, shareReplay } from 'rxjs/operators';\r\nimport { ISyncProgress } from '../../models/sync-progress.interface';\r\nimport { OfflineDbService, TABLE_NAMES } from '../offline-db/offline-db.service';\r\nimport { RxRegistrationSyncProgressCollection, RxUploadProgressCollection } from '../../db/RxDB';\r\nimport moment from 'moment';\r\nimport { ISyncProgressRecord } from '../../models/sync-progress-record.interface';\r\nimport deepEqual from 'fast-deep-equal';\r\n\r\nconst SYNC_PROGRESS_ID = 'syncprogress';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ProgressService {\r\n  public readonly registrationSyncProgress$: Observable<ISyncProgress>;\r\n\r\n  constructor(private loggerService: LoggerService, private offlineDbService: OfflineDbService) {\r\n    this.registrationSyncProgress$ = this.getRegistrationSyncProgressCollection().find().$.pipe(\r\n      debounceTime(100),\r\n      map((records) => records[0]),\r\n      map((rec) => this.convertToSyncProgress(rec)),\r\n      distinctUntilChanged((a, b) => deepEqual(a, b)),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  async resetSyncProgress(records: Array<string> = null): Promise<void> {\r\n    await this.getRegistrationSyncProgressCollection().atomicUpsert({\r\n      id: SYNC_PROGRESS_ID,\r\n      recordsLeft: records || [],\r\n      startedTimestamp: moment().unix(),\r\n      totalRecords: (records || []).length,\r\n      errors: [],\r\n    });\r\n  }\r\n\r\n  async setSyncProgress(recordId: string, error?: string | unknown): Promise<void> {\r\n    this.loggerService.log('Sync record item complete', recordId);\r\n    const doc = await this.getSyncProgressDocument();\r\n    if(doc) {\r\n      const docJson = doc.toJSON();\r\n      const errors = [...docJson.errors];\r\n      if(error) {\r\n        errors.push({ id: recordId, error});\r\n      }\r\n      await this.getRegistrationSyncProgressCollection().atomicUpsert({\r\n        id: SYNC_PROGRESS_ID,\r\n        errors: errors,\r\n        recordsLeft: docJson.recordsLeft.filter((r) => r !== recordId)\r\n      });\r\n    }\r\n  }\r\n\r\n  getAttachmentProgress(imageId: string): Observable<{totalBytes: number; complete: number}> {\r\n    return this.getUploadProgressCollection().findByIds$([imageId]).pipe(\r\n      map((result) => result.get(imageId)), map((result) => result ? result.toJSON() : null));\r\n  }\r\n\r\n  async setAttachmentProgress(imageId: string, totalBytes: number, complete: number): Promise<void> {\r\n    this.loggerService.log(`Set attachment progress. Complete: ${complete}/${totalBytes}. ${imageId}`);\r\n    await this.getUploadProgressCollection().atomicUpsert({\r\n      id: imageId,\r\n      totalBytes,\r\n      complete\r\n    });\r\n  }\r\n\r\n  private async getSyncProgressDocument() {\r\n    const documents = await this.getRegistrationSyncProgressCollection().findByIds([SYNC_PROGRESS_ID]);\r\n    return documents?.get(SYNC_PROGRESS_ID);\r\n  }\r\n\r\n  private getRegistrationSyncProgressCollection(): RxRegistrationSyncProgressCollection {\r\n    return this.offlineDbService.db[TABLE_NAMES.REGISTRATION_SYNC_PROGRESS] as RxRegistrationSyncProgressCollection;\r\n  }\r\n\r\n  private getUploadProgressCollection(): RxUploadProgressCollection {\r\n    return this.offlineDbService.db[TABLE_NAMES.UPLOAD_PROGRESS] as RxUploadProgressCollection;\r\n  }\r\n\r\n  private getEmptySyncProgress() {\r\n    return {\r\n      errors: [],\r\n      estimatedTimeLeftMs: undefined,\r\n      hasError: false,\r\n      id: '',\r\n      inProgress: false,\r\n      isComplete: true,\r\n      itemsLeft: 0,\r\n      percentageComplete: undefined,\r\n      percentageCompleteFormatted: undefined,\r\n      recordsLeft: [],\r\n      startedTimestamp: undefined,\r\n      totalRecords: 0,\r\n    };\r\n  }\r\n\r\n  private convertToSyncProgress(rec: ISyncProgressRecord): ISyncProgress {\r\n    if(!rec) {\r\n      return this.getEmptySyncProgress();\r\n    }\r\n\r\n    const percentageComplete = this.calculatePercentageComplete(rec);\r\n    return {\r\n      ...rec,\r\n      estimatedTimeLeftMs: this.calculateTimeLeftMs(rec),\r\n      hasError: rec.errors && rec.errors.length > 0,\r\n      inProgress: rec.recordsLeft.length > 0,\r\n      isComplete: rec.recordsLeft.length === 0,\r\n      itemsLeft: rec.recordsLeft.length,\r\n      percentageComplete,\r\n      percentageCompleteFormatted: percentageComplete.toLocaleString(undefined, { style: 'percent', minimumFractionDigits: 2 })\r\n    };\r\n  }\r\n\r\n  private calculateTimeLeftMs(rec: ISyncProgressRecord): number {\r\n    const startedMoment = moment.unix(rec.startedTimestamp);\r\n    const ms = moment().diff(startedMoment, 'milliseconds');\r\n    const itemsLeft = rec.recordsLeft.length;\r\n    const completed = rec.totalRecords - itemsLeft;\r\n    if(completed > 0) {\r\n      const msPerCompleted = ms / completed;\r\n      return msPerCompleted * itemsLeft;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private calculatePercentageComplete(rec: ISyncProgressRecord) {\r\n    const itemsLeft = rec.recordsLeft.length;\r\n    if (rec.totalRecords > 0 && itemsLeft > 0) {\r\n      return (rec.totalRecords - itemsLeft) / rec.totalRecords;\r\n    }\r\n    return 1;\r\n  }\r\n}\r\n","import { Injectable, Inject } from '@angular/core';\r\nimport { Observable, from, Subscription, of, concat, forkJoin, timer, merge, combineLatest, firstValueFrom } from 'rxjs';\r\nimport { GeoHazard, AppMode, LoggerService, AppModeService, uuidv4 } from '@varsom-regobs-common/core';\r\nimport {\r\n  switchMap,\r\n  shareReplay,\r\n  map,\r\n  tap,\r\n  catchError,\r\n  mergeMap,\r\n  toArray,\r\n  take,\r\n  filter,\r\n  withLatestFrom,\r\n  distinctUntilChanged,\r\n  concatMap\r\n} from 'rxjs/operators';\r\nimport { IRegistration } from '../../models/registration.interface';\r\nimport { OfflineDbService, TABLE_NAMES } from '../offline-db/offline-db.service';\r\nimport { SyncStatus } from '../../models/sync-status.enum';\r\nimport { ItemSyncCompleteStatus } from '../../models/item-sync-complete-status.interface';\r\nimport { ItemSyncCallbackService } from '../item-sync-callback/item-sync-callback.service';\r\nimport moment from 'moment';\r\nimport { RegistrationTid } from '../../models/registration-tid.enum';\r\nimport { Summary, AttachmentViewModel, RegistrationViewModel, RegistrationEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport {\r\n  getAllAttachments,\r\n  getPropertyName,\r\n  getRegistrationTidsForGeoHazard,\r\n  hasAnyObservations,\r\n  isArrayType,\r\n  isObservationEmptyForRegistrationTid,\r\n  isObservationModelEmptyForRegistrationTid\r\n} from '../../registration.helpers';\r\nimport { ProgressService } from '../progress/progress.service';\r\nimport { InternetConnectivity } from 'ngx-connectivity';\r\nimport { KdvService } from '../kdv/kdv.service';\r\nimport cloneDeep from 'clone-deep';\r\nimport { IRegistrationType } from '../../models/registration-type.interface';\r\nimport { FallbackSummaryProvider } from '../summary-providers/fallback-provider';\r\nimport { RxRegistrationCollection, RxRegistrationDocument } from '../../db/RxDB';\r\nimport { NewAttachmentService } from '../add-new-attachment/new-attachment.service';\r\nimport deepEqual from 'fast-deep-equal';\r\nimport { AttachmentUploadEditModel, ExistingOrNewAttachment } from '../../registration.models';\r\nimport { ExistingAttachmentType, NewAttachmentType } from '../../models/attachment-upload-edit.interface';\r\nimport { FOR_ROOT_OPTIONS_TOKEN, IRegistrationModuleOptions } from '../../module.options';\r\n\r\nconst SYNC_TIMER_TRIGGER_MS = 60 * 1000; // try to trigger sync every 60 seconds if nothing has changed to network conditions\r\nconst SYNC_BUFFER_MS = 3 * 1000; // Wait at least 3 seconds before next sync attempt\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RegistrationService {\r\n  public readonly registrationStorage$: Observable<IRegistration[]>;\r\n  private _registrationSyncSubscription: Subscription;\r\n\r\n  constructor(\r\n    private offlineDbService: OfflineDbService,\r\n    private loggerService: LoggerService,\r\n    private progressService: ProgressService,\r\n    private kdvService: KdvService,\r\n    private internetConnectivity: InternetConnectivity,\r\n    private appModeService: AppModeService,\r\n    private newAttachmentService: NewAttachmentService,\r\n    @Inject('OfflineRegistrationSyncService') private offlineRegistrationSyncService: ItemSyncCallbackService<IRegistration>,\r\n    // @Inject(SUMMARY_PROVIDER_TOKEN) private summaryProviders: ISummaryProvider[],\r\n    private fallbackSummaryProvider: FallbackSummaryProvider,\r\n    @Inject(FOR_ROOT_OPTIONS_TOKEN) private options: IRegistrationModuleOptions\r\n  ) {\r\n    this.registrationStorage$ = this.getRegistrationObservable().pipe(\r\n      tap((reg) => {\r\n        this.loggerService.debug('Registrations changed', reg);\r\n      }),\r\n      shareReplay(1)\r\n    );\r\n    this.initAutoSync();\r\n  }\r\n\r\n  public saveAndSync(\r\n    reg: IRegistration,\r\n    changedRegistrationTid: RegistrationTid = undefined,\r\n    ignoreVersionCheck = false\r\n  ): Observable<boolean> {\r\n    reg.changedRegistrationTid = changedRegistrationTid;\r\n    reg.syncStatus = SyncStatus.Sync;\r\n    return this.saveRegistration(reg, ignoreVersionCheck);\r\n  }\r\n\r\n  public saveRegistration(reg: IRegistration, ignoreVersionCheck = false, updateChangedTimestamp = true): Observable<boolean> {\r\n    if (updateChangedTimestamp) {\r\n      reg.changed = moment().unix();\r\n    }\r\n    if (reg.syncStatus === SyncStatus.Sync) {\r\n      return this.saveAndSyncSingleRegistration(reg, ignoreVersionCheck);\r\n    } else {\r\n      return this.saveRegistrationToOfflineStorage(reg).pipe(map(() => true));\r\n    }\r\n  }\r\n\r\n  private saveAndSyncSingleRegistration(reg: IRegistration, ignoreVersionCheck: boolean) {\r\n    // Hvorfor kalles unsubscribe på denne?\r\n    if (this._registrationSyncSubscription) {\r\n      this._registrationSyncSubscription.unsubscribe();\r\n    }\r\n    return this.saveRegistrationToOfflineStorage(reg).pipe(\r\n      switchMap(() => this.syncSingleRegistration(reg, ignoreVersionCheck)),\r\n      tap(() => {\r\n        this.loggerService.debug('Single registration synced. Start autosync.');\r\n        this.initAutoSync();\r\n      })\r\n    );\r\n  }\r\n\r\n  private saveRegistrationToOfflineStorage(reg: IRegistration): Observable<RxRegistrationDocument> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      take(1),\r\n      switchMap((collection) => from(collection.atomicUpsert(reg)))\r\n    );\r\n  }\r\n\r\n  public deleteRegistration(id: string): Observable<boolean> {\r\n    return this.getRegistrationOfflineDocumentById(id).pipe(\r\n      take(1),\r\n      switchMap((doc) => (doc ? this.offlineRegistrationSyncService.deleteItem(doc.toJSON()).pipe(map(() => doc)) : of(undefined))),\r\n      switchMap((doc: RxRegistrationDocument) => (doc ? from(doc.remove()) : of(false)))\r\n    );\r\n  }\r\n\r\n  public deleteRegistrationFromOfflineStorage(id: string): Observable<unknown> {\r\n    return this.getRegistrationOfflineDocumentById(id).pipe(\r\n      take(1),\r\n      switchMap((doc) => (doc ? from(doc.remove()) : of(false)))\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Shared change feed on getRegistrationById. Might have some delay when saving.\r\n   */\r\n  public getRegistrationByIdShared$(id: string): Observable<IRegistration> {\r\n    return this.registrationStorage$.pipe(\r\n      map((registrations) => registrations.find((r) => r.id === id)),\r\n      filter((reg) => reg != null)\r\n    );\r\n  }\r\n\r\n  public async getRegistrationById(id: string): Promise<IRegistration> {\r\n    const collection = await this.getRegistrationDbCollectionForAppMode().pipe(take(1)).toPromise();\r\n    const resultMap = await collection.findByIds([id]);\r\n    return resultMap.get(id)?.toJSON();\r\n  }\r\n\r\n  public async cancelSync(): Promise<void> {\r\n    await this.progressService.resetSyncProgress();\r\n    if (this._registrationSyncSubscription) {\r\n      this._registrationSyncSubscription.unsubscribe();\r\n    }\r\n    this.initAutoSync();\r\n  }\r\n\r\n  public initAutoSync(): void {\r\n    if (this.options.autoSync) {\r\n      this._registrationSyncSubscription = this.getAutoSyncObservable().subscribe();\r\n    }\r\n  }\r\n\r\n  public getFirstDraftForGeoHazard(geoHazard: GeoHazard, draftsOnly = true): Promise<IRegistration> {\r\n    return this.getDraftsForGeoHazardObservable(geoHazard, draftsOnly)\r\n      .pipe(\r\n        map((rows) => rows.sort((a, b) => b.changed - a.changed)[0]),\r\n        take(1)\r\n      )\r\n      .toPromise();\r\n  }\r\n\r\n  public getDraftsForGeoHazardObservable(geoHazard: GeoHazard, draftsOnly = true): Observable<IRegistration[]> {\r\n    return this.registrationStorage$.pipe(\r\n      map((records) =>\r\n        records.filter(\r\n          (reg) => reg.request.GeoHazardTID === geoHazard && (draftsOnly ? reg.syncStatus === SyncStatus.Draft : true)\r\n          //All items in registration storage is \"drafts\"/not complete until deleted from storage (when done)\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  public getAllRegistrations$(geoHazard?: GeoHazard): Observable<IRegistration[]> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      switchMap((collection) => collection.find().$),\r\n      map((docs) => docs.map((d) => d.toJSON())),\r\n      map((regs) => regs.filter((r) => (geoHazard ? r.geoHazard === geoHazard : true)))\r\n    );\r\n  }\r\n\r\n  public deleteAllRegistrationsFromOfflineStorage$(geoHazard?: GeoHazard): Observable<unknown> {\r\n    return this.getAllRegistrations$(geoHazard).pipe(\r\n      switchMap((regs) => (regs.length > 0 ? forkJoin(regs.map((reg) => this.deleteRegistrationFromOfflineStorage(reg.id))) : of({})))\r\n    );\r\n  }\r\n\r\n  public deleteAllRegistrationsFromOfflineStorage(geoHazard?: GeoHazard): void {\r\n    this.deleteAllRegistrationsFromOfflineStorage$(geoHazard).pipe(take(1)).subscribe();\r\n  }\r\n\r\n  public deleteForm(regId: string, registrationTid: RegistrationTid, index: number): Observable<unknown> {\r\n    return this.getRegistrationByIdShared$(regId).pipe(\r\n      take(1),\r\n      map((reg) => {\r\n        const regToEdit = cloneDeep(reg);\r\n        this.makeExistingRegistrationEditable(regToEdit);\r\n        if (isArrayType(registrationTid) && regToEdit.request[getPropertyName(registrationTid)].length > index) {\r\n          (regToEdit.request[getPropertyName(registrationTid)] as Array<unknown>).splice(index, 1);\r\n          // Deletes images if no forms left in array\r\n          if ((regToEdit.request[getPropertyName(registrationTid)] as Array<unknown>).length === 0) {\r\n            this.deleteExistingAttachmentsForRegistrationType(regToEdit, registrationTid);\r\n          }\r\n        } else if (!isArrayType(registrationTid)) {\r\n          delete regToEdit.request[getPropertyName(registrationTid)];\r\n          this.deleteExistingAttachmentsForRegistrationType(regToEdit, registrationTid);\r\n        }\r\n        return regToEdit;\r\n      }),\r\n      switchMap((reg) => this.saveAndSync(reg, registrationTid))\r\n    );\r\n  }\r\n\r\n  private deleteExistingAttachmentsForRegistrationType(reg: IRegistration, registrationTid: RegistrationTid): IRegistration {\r\n    if (reg && reg.request && reg.request.Attachments) {\r\n      reg.request.Attachments = reg.request.Attachments.filter((a) => a.RegistrationTID !== registrationTid);\r\n    }\r\n    return reg;\r\n  }\r\n\r\n  public createNewEmptyDraft(geoHazard: GeoHazard): IRegistration {\r\n    const id = uuidv4();\r\n    const draft: IRegistration = {\r\n      id,\r\n      geoHazard,\r\n      changed: moment().unix(),\r\n      syncStatus: SyncStatus.Draft,\r\n      request: {\r\n        GeoHazardTID: geoHazard,\r\n        DtObsTime: undefined,\r\n        ObsLocation: {},\r\n        Attachments: []\r\n      }\r\n    };\r\n    return draft;\r\n  }\r\n\r\n  public async editExistingRegistrationAndSave(registrationViewModel: RegistrationViewModel): Promise<IRegistration> {\r\n    const reg = this.createNewEmptyDraft(registrationViewModel.GeoHazardTID);\r\n    reg.id = registrationViewModel.ExternalReferenceId || reg.id; // Keep the same id as reference id\r\n    reg.request = cloneDeep(registrationViewModel);\r\n    reg.response = cloneDeep(registrationViewModel);\r\n    reg.syncStatus = SyncStatus.InSync;\r\n    await firstValueFrom(this.saveRegistration(reg));\r\n    return reg;\r\n  }\r\n\r\n  public makeExistingRegistrationEditable(reg: IRegistration): void {\r\n    if (reg && reg.syncStatus === SyncStatus.InSync) {\r\n      reg.request = cloneDeep(reg.response);\r\n    }\r\n  }\r\n\r\n  public syncRegistrations(): Observable<IRegistration[]> {\r\n    return this.getRegistrationsToSyncObservable().pipe(take(1), this.resetProgressAndSyncItems());\r\n  }\r\n\r\n  public syncSingleRegistration(reg: IRegistration, ignoreVersionCheck: boolean): Observable<boolean> {\r\n    if (!reg) {\r\n      return of(false);\r\n    }\r\n    return of([reg]).pipe(\r\n      this.resetProgressAndSyncItems(ignoreVersionCheck),\r\n      map((result) => result.length > 0 && !result[0].syncError)\r\n    );\r\n  }\r\n\r\n  private getAutoSyncObservable() {\r\n    return this.getAutosyncChangeTrigger().pipe(\r\n      tap((source) => this.loggerService.debug(`Auto sync triggered. Source: ${source}`)),\r\n      switchMap(() => this.offlineDbService.waitForLeadership()),\r\n      tap(() => this.loggerService.debug('Current tab is in leadership, so this tab is used for sync items')),\r\n      switchMap(() => this.getRegistrationsToSyncObservable()),\r\n      this.filterWhenProgressIsAllreadyRunning(),\r\n      this.resetProgressAndSyncItems()\r\n    );\r\n  }\r\n\r\n  private getAutosyncChangeTrigger() {\r\n    const networkOrTimerTrigger$ = merge(\r\n      this.getNetworkOnlineObservable().pipe(map(() => 'network status online trigger')),\r\n      timer(SYNC_TIMER_TRIGGER_MS, SYNC_TIMER_TRIGGER_MS).pipe(map(() => 'timer trigger'))\r\n    );\r\n    return this.getRegistrationsToSyncObservable(false).pipe(\r\n      map((records) => records.length > 0),\r\n      filter((hasRecords) => hasRecords),\r\n      switchMap(() => networkOrTimerTrigger$)\r\n    );\r\n  }\r\n\r\n  private resetProgressAndSyncItems(ignoreVersionCheck = false): (src: Observable<IRegistration[]>) => Observable<IRegistration[]> {\r\n    return (src: Observable<IRegistration[]>) =>\r\n      src.pipe(\r\n        // Reset sync status\r\n        concatMap((records) => from(this.progressService.resetSyncProgress(records.map((r) => r.id))).pipe(map(() => records))),\r\n\r\n        // Innsending skjer langt inni her\r\n        this.flattenRegistrationsToSync(ignoreVersionCheck),\r\n\r\n        tap((row) => this.progressService.setSyncProgress(row.item.id, row.error)),\r\n        this.updateRowAndReturnItem(),\r\n        toArray(),\r\n        catchError((error) => {\r\n          this.loggerService.warn('Could not sync registrations', error);\r\n          return of([]);\r\n        }),\r\n        tap(() => this.progressService.resetSyncProgress())\r\n      );\r\n  }\r\n\r\n  /***\r\n   * Check if registration has any data or attachments for registrationTid\r\n   */\r\n  public hasAnyDataToShowInRegistrationTypes(reg: IRegistration, registrationTid: RegistrationTid): Observable<boolean> {\r\n    const model = this.getRegistrationEditOrViewModel(reg);\r\n    return of(isObservationModelEmptyForRegistrationTid(model, registrationTid)).pipe(\r\n      switchMap((isEmpty) => {\r\n        if (!isEmpty) {\r\n          return of(true);\r\n        }\r\n        return this.hasAnyAttachmentsForRegistrationTid$(reg, registrationTid).pipe(take(1));\r\n      })\r\n    );\r\n  }\r\n\r\n  private getRegistrationEditOrViewModel(reg: IRegistration): RegistrationEditModel | RegistrationViewModel {\r\n    if (reg.syncStatus === SyncStatus.InSync && reg.response) {\r\n      return reg.response;\r\n    }\r\n    return reg.request;\r\n  }\r\n\r\n  hasAnyAttachmentsForRegistrationTid$(reg: IRegistration, registrationTid: RegistrationTid): Observable<boolean> {\r\n    return this.getAllAttachmentsForRegistrationTid$(reg.id, registrationTid).pipe(map((attachments) => attachments.length > 0));\r\n  }\r\n\r\n  hasAnyAttachmentsForRegistrationTid(reg: IRegistration, registrationTid: RegistrationTid): Promise<boolean> {\r\n    return this.hasAnyAttachmentsForRegistrationTid$(reg, registrationTid).pipe(take(1)).toPromise();\r\n  }\r\n\r\n  getRegistrationTypesWithAnyData(reg: IRegistration): Observable<IRegistrationType[]> {\r\n    return this.getRegistrationTypesForGeoHazard(reg.geoHazard).pipe(\r\n      switchMap((regTypes) =>\r\n        regTypes.length > 0\r\n          ? forkJoin(\r\n              regTypes.map((regType) =>\r\n                this.hasAnyDataToShowInRegistrationTypes(reg, regType.registrationTid).pipe(map((anyData) => ({ anyData, regType })))\r\n              )\r\n            )\r\n          : of([])\r\n      ),\r\n      map((result) => result.filter((r) => r.anyData).map((r) => r.regType))\r\n    );\r\n  }\r\n\r\n  public getSummaryForRegistrationTidById$(id: string, registrationTid: RegistrationTid): Observable<Summary[]> {\r\n    return this.getRegistrationByIdShared$(id).pipe(switchMap((reg) => this.getSummaryForRegistrationTid(reg, registrationTid)));\r\n  }\r\n\r\n  /**\r\n   * Converts a registration draft to summary as the same model as generated from the API\r\n   * @param reg Registration draft\r\n   * @param registrationTid Registration tid\r\n   */\r\n  public getDraftSummary(reg: IRegistration, registrationTid: RegistrationTid, addIfEmpty = true): Observable<Summary[]> {\r\n    if (!isObservationEmptyForRegistrationTid(reg, registrationTid)) {\r\n      // const provider = this.summaryProviders.find((p) => p.registrationTid === registrationTid);\r\n      // if (provider) {\r\n      //   return provider.generateSummary(reg);\r\n      // }\r\n      // TODO: Implement all providers to get summaries generated client side before synchronized to API...\r\n      return this.fallbackSummaryProvider\r\n        .generateSummary(reg, registrationTid)\r\n        .pipe(tap((genericSummary) => this.loggerService.debug('Generic fallback summary', genericSummary)));\r\n    }\r\n    return addIfEmpty ? this.generateEmptySummary(registrationTid).pipe(map((s) => [s])) : of([]);\r\n  }\r\n\r\n  public getSummaryForRegistrationTid(reg: IRegistration, registrationTid: RegistrationTid, addIfEmpty = true): Observable<Summary[]> {\r\n    if (reg.changedRegistrationTid === registrationTid && reg.syncStatus !== SyncStatus.InSync) {\r\n      return this.getDraftSummary(reg, registrationTid, addIfEmpty);\r\n    }\r\n    return this.getResponseSummaryForRegistrationTid(reg, registrationTid, addIfEmpty);\r\n  }\r\n\r\n  public getRegistrationName(registrationTid: RegistrationTid): Observable<string> {\r\n    return this.kdvService.getKdvRepositoryByKeyObservable('RegistrationKDV').pipe(\r\n      map((kdvElements) => kdvElements.find((kdv) => kdv.Id === registrationTid)),\r\n      map((val) => (val ? val.Name : ''))\r\n    );\r\n  }\r\n\r\n  private getResponseSummaryForRegistrationTid(\r\n    reg: IRegistration,\r\n    registrationTid: RegistrationTid,\r\n    addIfEmpty = true\r\n  ): Observable<Summary[]> {\r\n    if (reg && reg.response && reg.response.Summaries && reg.response.Summaries.length > 0) {\r\n      const summary = reg.response.Summaries.filter((x) => x.RegistrationTID === registrationTid);\r\n      if (summary) {\r\n        return of(summary);\r\n      }\r\n    }\r\n    return addIfEmpty ? this.generateEmptySummary(registrationTid).pipe(map((s) => [s])) : of([]);\r\n  }\r\n\r\n  private generateEmptySummary(registrationTid: RegistrationTid): Observable<Summary> {\r\n    return this.getRegistrationName(registrationTid).pipe(\r\n      map((registrationName) => ({\r\n        RegistrationTID: registrationTid,\r\n        RegistrationName: registrationName,\r\n        Summaries: []\r\n      }))\r\n    );\r\n  }\r\n\r\n  public getRegistrationTypesForGeoHazard(geoHazard: GeoHazard): Observable<IRegistrationType[]> {\r\n    const registrationTidsForGeoHazard = getRegistrationTidsForGeoHazard(geoHazard);\r\n\r\n    const flatViewrepository$ = this.kdvService.getViewRepositoryByKeyObservable('RegistrationTypesV').pipe(\r\n      map((val) => this.parseViewRepositoryType(val[`${geoHazard}`])),\r\n      map((result) => this.flattenRegistrationTypes(result)),\r\n      map((result) => result.filter((val) => registrationTidsForGeoHazard.indexOf(val.registrationTid) >= 0))\r\n    );\r\n\r\n    return of(registrationTidsForGeoHazard).pipe(\r\n      switchMap((registrationTids) =>\r\n        flatViewrepository$.pipe(\r\n          map(\r\n            (vr) => registrationTids.map((registrationTid) => vr.find((v) => v.registrationTid === registrationTid)),\r\n            filter((result) => !!result)\r\n          )\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private flattenRegistrationTypes(types: IRegistrationType[]) {\r\n    const arr = types.map((t) => (t.subTypes && t.subTypes.length > 0 ? t.subTypes : [t]));\r\n    return arr.reduce((a, b) => a.concat(b), []);\r\n  }\r\n\r\n  private parseViewRepositoryType(val: unknown[]): IRegistrationType[] {\r\n    if (!val) {\r\n      return [];\r\n    }\r\n    return val.map((v) => {\r\n      const result: IRegistrationType = {\r\n        registrationTid: v['Id'],\r\n        name: v['Name'],\r\n        sortOrder: v['SortOrder'],\r\n        subTypes: this.parseViewRepositoryType(v['SubTypes'])\r\n      };\r\n      return result;\r\n    });\r\n  }\r\n\r\n  public saveRollbackState$(id: string): Observable<unknown> {\r\n    return combineLatest([this.getRegistrationDbCollectionForAppMode(), this.getRegistrationById(id)]).pipe(\r\n      take(1),\r\n      tap(([collection, reg]) => {\r\n        if (!collection) {\r\n          this.loggerService.warn('No db collection found for appMode when saveRollbackState');\r\n        }\r\n        if (!reg) {\r\n          this.loggerService.warn('No registration found by id when saveRollbackState: ', id);\r\n        }\r\n      }),\r\n      switchMap(([collection, reg]) => (reg && collection ? from(collection.upsertLocal(`undo_state_${id}`, { reg })) : of({})))\r\n    );\r\n  }\r\n\r\n  public saveRollbackState(id: string): void {\r\n    this.saveRollbackState$(id).subscribe(\r\n      () => null,\r\n      (err) => {\r\n        this.loggerService.warn('Could not save rollback state', err);\r\n      }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Rollback registration to last known undo state (as observable)\r\n   */\r\n  public rollbackChanges$(id: string): Observable<boolean> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      tap((collection) => {\r\n        if (!collection) {\r\n          this.loggerService.warn('No db collection found for appMode when saveRollbackState');\r\n        }\r\n      }),\r\n      switchMap((collection) =>\r\n        collection ? from(collection.getLocal(`undo_state_${id}`)).pipe(map((doc) => (doc ? doc.get('reg') : undefined))) : of(undefined)\r\n      ),\r\n      switchMap((reg: IRegistration) =>\r\n        reg\r\n          ? this.saveRegistrationToOfflineStorage(reg).pipe(\r\n              switchMap(() => this.newAttachmentService.removeAttachments$(id)),\r\n              map(() => true)\r\n            )\r\n          : of(false)\r\n      )\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Rollback registration to last known undo state\r\n   */\r\n  public rollbackChanges(id: string): void {\r\n    this.rollbackChanges$(id).subscribe();\r\n  }\r\n\r\n  public hasRegistrationAnyAttachment$(id: string): Observable<boolean> {\r\n    return this.getAllAttachmentsForRegistration$(id).pipe(map((result) => result.length > 0));\r\n  }\r\n\r\n  public getAllAttachmentsForRegistration$(id: string): Observable<ExistingOrNewAttachment[]> {\r\n    return combineLatest([\r\n      this.getRegistrationByIdShared$(id).pipe(map((reg) => getAllAttachments(reg))),\r\n      this.newAttachmentService.getAttachments(id)\r\n    ]).pipe(\r\n      map(([existingAttachments, newAttachments]) => [\r\n        ...existingAttachments.map((a) => ({ type: 'existing' as ExistingAttachmentType, attachment: a })),\r\n        ...newAttachments.map((a) => ({ type: 'new' as NewAttachmentType, attachment: a }))\r\n      ])\r\n    );\r\n  }\r\n\r\n  public getExistingAttachmentsForRegistrationTid$(id: string, registrationTid: RegistrationTid): Observable<AttachmentViewModel[]> {\r\n    return this.getRegistrationByIdShared$(id).pipe(map((reg) => getAllAttachments(reg, registrationTid)));\r\n  }\r\n\r\n  public getNewAttachmentsForRegistrationTid$(id: string, registrationTid: RegistrationTid): Observable<AttachmentUploadEditModel[]> {\r\n    return this.newAttachmentService\r\n      .getAttachments(id)\r\n      .pipe(map((attachments: AttachmentUploadEditModel[]) => attachments.filter((a) => a.RegistrationTID === registrationTid)));\r\n  }\r\n\r\n  public getAllAttachmentsForRegistrationTid$(id: string, registrationTid: RegistrationTid): Observable<ExistingOrNewAttachment[]> {\r\n    return combineLatest([\r\n      this.getExistingAttachmentsForRegistrationTid$(id, registrationTid),\r\n      this.getNewAttachmentsForRegistrationTid$(id, registrationTid)\r\n    ]).pipe(\r\n      map(([existingAttachments, newAttachments]) => [\r\n        ...existingAttachments.map((a) => ({ type: 'existing' as ExistingAttachmentType, attachment: a })),\r\n        ...newAttachments.map((a) => ({ type: 'new' as NewAttachmentType, attachment: a }))\r\n      ])\r\n    );\r\n  }\r\n\r\n  private getRegistrationOfflineDocumentById(id: string): Observable<RxRegistrationDocument> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      switchMap((dbCollection) => dbCollection.findByIds$([id])),\r\n      map((result) => result.get(id))\r\n    );\r\n  }\r\n\r\n  private getRegistrationObservable(): Observable<IRegistration[]> {\r\n    return this.getRegistrationDbCollectionForAppMode().pipe(\r\n      switchMap((dbCollection) => dbCollection.find().$.pipe(map((docs) => docs.map((doc) => doc.toJSON())))),\r\n      distinctUntilChanged((a, b) => deepEqual(a, b))\r\n    );\r\n  }\r\n\r\n  private getRegistrationsDbCollection(appMode: AppMode): RxRegistrationCollection {\r\n    return this.offlineDbService.getDbCollection<RxRegistrationCollection>(appMode, TABLE_NAMES.REGISTRATION);\r\n  }\r\n\r\n  private getRegistrationDbCollectionForAppMode(): Observable<RxRegistrationCollection> {\r\n    return this.appModeService.appMode$.pipe(map((appMode) => this.getRegistrationsDbCollection(appMode)));\r\n  }\r\n\r\n  private getNetworkOnlineObservable(): Observable<boolean> {\r\n    return this.internetConnectivity.isOnline$.pipe(\r\n      distinctUntilChanged(),\r\n      filter((online) => online),\r\n      tap(() => this.loggerService.debug('App is now online!'))\r\n    );\r\n  }\r\n\r\n  private filterWhenProgressIsAllreadyRunning() {\r\n    return (src: Observable<IRegistration[]>) =>\r\n      src.pipe(\r\n        withLatestFrom(this.progressService.registrationSyncProgress$),\r\n        filter(([, syncProgress]) => !syncProgress.inProgress),\r\n        map(([records]) => records)\r\n      );\r\n  }\r\n\r\n  private getRegistrationsToSyncObservable(includeThrottle = false) {\r\n    return this.registrationStorage$.pipe(\r\n      switchMap((records) =>\r\n        records.length > 0\r\n          ? from(Promise.all(records.map((reg) => this.shouldSync(reg, includeThrottle).then((shouldSync) => ({ reg, shouldSync })))))\r\n          : // forkJoin(records.map((reg) => this.shouldSync(reg, includeThrottle).pipe(map((shouldSync) => ({ reg, shouldSync })))))\r\n            of([])\r\n      ),\r\n      map((result) => result.filter((result) => result.shouldSync).map((result) => result.reg))\r\n    );\r\n  }\r\n\r\n  public async isEmpty(reg: IRegistration): Promise<boolean> {\r\n    const isNotEmpty = await this.isNotEmpty(reg);\r\n    return !isNotEmpty;\r\n  }\r\n\r\n  private isNotEmpty(reg: IRegistration): Promise<boolean> {\r\n    const notEmpty = hasAnyObservations(reg);\r\n    if (notEmpty) {\r\n      return Promise.resolve(true);\r\n    }\r\n    return this.hasRegistrationAnyAttachment$(reg.id).pipe(take(1)).toPromise();\r\n  }\r\n\r\n  private async shouldSync(reg: IRegistration, includeThrottle = false): Promise<boolean> {\r\n    if (reg.syncStatus === SyncStatus.Sync) {\r\n      if (includeThrottle && this.shouldThrottle(reg)) {\r\n        return false;\r\n      }\r\n      if (reg.response && reg.response.RegId > 0) {\r\n        return true; // Edit existing registration should sync even if empty (deleted observation)\r\n      }\r\n      return await this.isNotEmpty(reg);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private shouldThrottle(reg: IRegistration) {\r\n    if (!reg.lastSync) {\r\n      return false;\r\n    }\r\n    if (reg.changed > reg.lastSync) {\r\n      return false;\r\n    }\r\n    const msToNextSync = this.getMsUntilNextSync(reg.lastSync, SYNC_BUFFER_MS);\r\n    if (msToNextSync > 0) {\r\n      this.loggerService.debug(`Should throttle: ${msToNextSync / 1000}`, reg);\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private getMsUntilNextSync(lastSyncTimeUnixTimestamp: number, timeout: number) {\r\n    const msSinceLastSync = (moment().unix() - lastSyncTimeUnixTimestamp) * 1000;\r\n    return timeout - msSinceLastSync;\r\n  }\r\n\r\n  private flattenRegistrationsToSync(ignoreVersionCheck: boolean) {\r\n    return (src: Observable<IRegistration[]>) =>\r\n      src.pipe(\r\n        mergeMap((rows) => concat(rows.map((row) => this.syncRecord(row, ignoreVersionCheck)))),\r\n        mergeMap((r) => r)\r\n      );\r\n  }\r\n\r\n  private syncRecord(item: IRegistration, ignoreVersionCheck: boolean): Observable<ItemSyncCompleteStatus<IRegistration>> {\r\n    return this.offlineRegistrationSyncService.syncItem(item, ignoreVersionCheck).pipe(\r\n      catchError((err) => of({ item, success: false, error: err })),\r\n      tap((result) => this.loggerService.log('Record sync complete', result))\r\n    );\r\n  }\r\n\r\n  private mapItemSyncCompleteStatusToRegistration(): (src: Observable<ItemSyncCompleteStatus<IRegistration>>) => Observable<IRegistration> {\r\n    return (src: Observable<ItemSyncCompleteStatus<IRegistration>>) =>\r\n      src.pipe(\r\n        map((r: ItemSyncCompleteStatus<IRegistration>) => ({\r\n          ...r.item,\r\n          lastSync: moment().unix(),\r\n          syncStatus: r.success ? SyncStatus.InSync : r.statusCode === 0 ? SyncStatus.Sync : SyncStatus.Draft,\r\n          request: r.success ? cloneDeep(r.item.response) : cloneDeep(r.item.request),\r\n          syncStatusCode: r.statusCode,\r\n          syncError: r.error\r\n        }))\r\n      );\r\n  }\r\n\r\n  private updateRowAndReturnItem(): (src: Observable<ItemSyncCompleteStatus<IRegistration>>) => Observable<IRegistration> {\r\n    return (src: Observable<ItemSyncCompleteStatus<IRegistration>>) =>\r\n      src.pipe(\r\n        this.mapItemSyncCompleteStatusToRegistration(),\r\n        switchMap((item: IRegistration) =>\r\n          this.saveRegistrationToOfflineStorage(item).pipe(\r\n            catchError((err) => {\r\n              this.loggerService.error('Could not update record in offline storage', err);\r\n              return of([]);\r\n            }),\r\n            map(() => item)\r\n          )\r\n        )\r\n      );\r\n  }\r\n}\r\n","import { Summary, UrlViewModel, RegObsGenericValue, KdvElement } from '@varsom-regobs-common/regobs-api';\r\nimport { RegistrationTid, IRegistration, KdvKey } from '../../registration.models';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { UrlSummary } from '../../models/summary/url-summary';\r\nimport { Observable, combineLatest, } from 'rxjs';\r\nimport { map, take, switchMap } from 'rxjs/operators';\r\nimport { SummaryKind } from '../../models/summary/summary-kind.enum';\r\nimport { KdvService } from '../kdv/kdv.service';\r\nimport { TextSummary } from '../../models/summary/text-summary';\r\nimport { ISummaryProvider } from './summary-provider.interface';\r\nimport { isArrayType } from '../../registration.helpers';\r\nimport { getRegistationProperty } from '../../helpers/registration.helper';\r\nimport { isEmpty } from '@varsom-regobs-common/core';\r\n\r\nexport abstract class BaseSummaryProvider<EditModel> implements ISummaryProvider {\r\n  abstract registrationTid: RegistrationTid;\r\n  abstract generateTypeSpesificSummaries(reg: IRegistration, registrationTid: RegistrationTid, registrationName: string, model: EditModel, summary: Summary): Observable<Summary>;\r\n\r\n  constructor(public translateService: TranslateService, public kdvService: KdvService) {\r\n  }\r\n\r\n  generateSummary(reg: IRegistration, registrationTid: RegistrationTid = this.registrationTid): Observable<Summary[]> {\r\n    return this.getRegistrationName(registrationTid).pipe(switchMap((registrationName) => combineLatest(this.generateSummaryForType(reg, registrationTid, registrationName))));\r\n  }\r\n\r\n  private generateSummaryForType(reg: IRegistration, registrationTid: RegistrationTid, registrationName: string): Observable<Summary>[] {\r\n    const registrationProp = getRegistationProperty(reg, registrationTid) as EditModel | Array<EditModel>;\r\n    if (isArrayType(registrationTid)) {\r\n      return ((registrationProp as Array<EditModel>) || []).map((registrationItem) =>\r\n        this.generateTypeSpesificSummaries(reg, registrationTid, registrationName, registrationItem, this.createSummary(registrationTid, registrationName)));\r\n    }\r\n    return [this.generateTypeSpesificSummaries(reg, registrationTid, registrationName, registrationProp as EditModel, this.createSummary(registrationTid, registrationName))];\r\n  }\r\n\r\n  private createSummary(registrationTid: RegistrationTid, registrationName: string): Summary {\r\n    return {\r\n      RegistrationTID: registrationTid,\r\n      RegistrationName: registrationName,\r\n      Summaries: [],\r\n    };\r\n  }\r\n\r\n  public getRegistrationName(registrationTid: RegistrationTid) {\r\n    return this.kdvService.getKdvRepositoryByKeyObservable('RegistrationKDV').pipe(take(1), map((registrationKdvs) => {\r\n      const registrationName = (registrationKdvs || [])\r\n        .find((x) => x.Id === registrationTid);\r\n      return registrationName ? registrationName.Name : '';\r\n    }));\r\n  }\r\n\r\n  getUrlSummary(urls: Array<UrlViewModel>): Observable<RegObsGenericValue> {\r\n    const translationKey = 'Observations.GeneralObservation.Urls';\r\n    return this.translateService.get([translationKey]).pipe(map((translations) => ({\r\n      Kind: SummaryKind.List,\r\n      KindType: 'List',\r\n      Header: translations[translationKey],\r\n      Value: urls.map((url) => new UrlSummary(url.UrlDescription || url.UrlLine, url.UrlLine)),\r\n    })));\r\n  }\r\n\r\n  getTextSummary(headerTranslationKey: string, value: string): Observable<TextSummary> {\r\n    return this.translateService.get([headerTranslationKey]).pipe(\r\n      map((translations) => new TextSummary(\r\n        translations[headerTranslationKey], value\r\n      )));\r\n  }\r\n\r\n  hasTID(tid: number) {\r\n    return !isEmpty(tid) && tid > 0;\r\n  }\r\n\r\n  getKdvSummary(headerTranslationKey: string, kdvKey: KdvKey, tid: number): Observable<TextSummary> {\r\n    return this.translateService.get(headerTranslationKey).pipe(\r\n      switchMap((translation) => this.kdvService.getKdvRepositoryByKeyObservable(kdvKey)\r\n        .pipe(\r\n          take(1),\r\n          map((kdvElements: KdvElement[]) => kdvElements.find((kdvElement: KdvElement) => kdvElement.Id === tid)),\r\n          map((kdvElement) => new TextSummary(\r\n            translation, kdvElement ? kdvElement.Name : ''\r\n          ))\r\n        )));\r\n  }\r\n}\r\n","import { IRegistration, RegistrationTid } from '../../registration.models';\r\nimport { RegObsGenericValue, Summary } from '@varsom-regobs-common/regobs-api';\r\nimport { BaseSummaryProvider } from './base.summary-provider';\r\nimport { Observable } from 'rxjs';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { KdvService } from '../kdv/kdv.service';\r\nimport { Injectable } from '@angular/core';\r\nimport { map, switchMap } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FallbackSummaryProvider extends BaseSummaryProvider<unknown> {\r\n  registrationTid = undefined;\r\n\r\n  constructor(public translateService: TranslateService, public kdvService: KdvService) {\r\n    super(translateService, kdvService);\r\n  }\r\n\r\n  generateTypeSpesificSummaries(_reg: IRegistration,\r\n    _registrationTid: RegistrationTid,\r\n    _registrationName: string,\r\n    model: unknown,\r\n    summary: Summary): Observable<Summary> {\r\n    return this.generateGenericSummaries().pipe(map((result) => ({ ...summary, Summaries: result })));\r\n  }\r\n\r\n  generateGenericSummaries(): Observable<RegObsGenericValue[]> {\r\n    return this.translateService.get('Observations.Shared.UnsentDescription')\r\n      .pipe(switchMap((translation) => this.getTextSummary('Observations.Shared.UnsentSummaryTitle', translation)\r\n        .pipe(map((result) => [result]))));\r\n  }\r\n}\r\n","import { IRegistration, RegistrationTid } from '../../../registration.models';\r\nimport { RegObsGenericValue, GeneralObservationEditModel, Summary } from '@varsom-regobs-common/regobs-api';\r\nimport { BaseSummaryProvider } from '../base.summary-provider';\r\nimport { Observable, combineLatest } from 'rxjs';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { KdvService } from '../../kdv/kdv.service';\r\nimport { Injectable } from '@angular/core';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GeneralObservationSummaryProvider extends BaseSummaryProvider<GeneralObservationEditModel> {\r\n  readonly registrationTid = RegistrationTid.GeneralObservation;\r\n\r\n  constructor(public translateService: TranslateService, public kdvService: KdvService) {\r\n    super(translateService, kdvService);\r\n  }\r\n\r\n  generateTypeSpesificSummaries(_reg: IRegistration,\r\n    _registrationTid: RegistrationTid,\r\n    _registrationName: string,\r\n    model: GeneralObservationEditModel,\r\n    summary: Summary): Observable<Summary> {\r\n    return this.generateGeneralObservationSummaries(model).pipe(map((result) => ({ ...summary, Summaries: result })));\r\n  }\r\n\r\n  generateGeneralObservationSummaries(model: GeneralObservationEditModel): Observable<RegObsGenericValue[]> {\r\n    const summaries: Observable<RegObsGenericValue>[] = [];\r\n    if(model) {\r\n      if (model.ObsComment) {\r\n        summaries.push(this.getTextSummary('Observations.GeneralObservation.Comment', model.ObsComment));\r\n      }\r\n      if (model.Comment) {\r\n        summaries.push(this.getTextSummary('Observations.GeneralObservation.Comment', model.Comment));\r\n      }\r\n      if (model.ObsHeader) {\r\n        summaries.push(this.getTextSummary('Observations.GeneralObservation.ObsHeader', model.ObsHeader));\r\n      }\r\n      if (model.Urls && model.Urls.length > 0) {\r\n        summaries.push(this.getUrlSummary(model.Urls));\r\n      }\r\n    }\r\n    return combineLatest(summaries);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { RegistrationTid, IRegistration } from '../../../../registration.models';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { BaseSummaryProvider } from '../../base.summary-provider';\r\nimport { Observable, forkJoin, of } from 'rxjs';\r\nimport { Summary, RegObsGenericValue, WeatherEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport { KdvService } from '../../../kdv/kdv.service';\r\nimport { map, switchMap } from 'rxjs/operators';\r\nimport { isEmpty } from '@varsom-regobs-common/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class WeatherSummaryProvider extends BaseSummaryProvider<WeatherEditModel> {\r\n\r\n  readonly registrationTid = RegistrationTid.WeatherObservation;\r\n\r\n  constructor(public translateService: TranslateService, public kdvService: KdvService) {\r\n    super(translateService, kdvService);\r\n  }\r\n\r\n  generateTypeSpesificSummaries(\r\n    _reg: IRegistration,\r\n    _registrationTid: RegistrationTid,\r\n    _registrationName: string,\r\n    model: WeatherEditModel,\r\n    summary: Summary): Observable<Summary> {\r\n    return this.generateWeatherObservationSummaries(model).pipe(map((result) => ({ ...summary, Summaries: result })));\r\n  }\r\n\r\n  generateWeatherObservationSummaries(model: WeatherEditModel): Observable<RegObsGenericValue[]> {\r\n    const summaries: Observable<RegObsGenericValue>[] = [];\r\n    if (model) {\r\n      if(this.hasTID(model.PrecipitationTID)) {\r\n        summaries.push(this.getKdvSummary('Observations.WeatherObservation.PrecipitationTID', 'Snow_PrecipitationKDV', model.PrecipitationTID));\r\n      }\r\n\r\n      if (!isEmpty(model.AirTemperature)) {\r\n        summaries.push(this.getTextSummary('Observations.WeatherObservation.AirTemperature', `${model.AirTemperature.toFixed(0)} °C`));\r\n      }\r\n\r\n      if(!isEmpty(model.WindDirection) || !isEmpty(model.WindSpeed)){\r\n        summaries.push(this.getWindDirectionValue(model).pipe(\r\n          switchMap((val) => this.getTextSummary('Observations.WeatherObservation.Wind', val))));\r\n      }\r\n\r\n      if (model.Comment) {\r\n        summaries.push(this.getTextSummary('Observations.GeneralObservation.Comment', model.Comment));\r\n      }\r\n\r\n      if(!isEmpty(model.CloudCover)) {\r\n        summaries.push(this.getTextSummary('Observations.WeatherObservation.CloudCover', `${model.CloudCover}%`));\r\n      }\r\n    }\r\n    return summaries.length > 0 ? forkJoin(summaries) : of([]);\r\n  }\r\n\r\n  private getWindDirectionValue(model: WeatherEditModel): Observable<string> {\r\n    const wdString$ = !isEmpty(model.WindDirection) ? this.translateService.get(this.getWindDirectionTranslationKey(model.WindDirection)) : of(null);\r\n    return wdString$.pipe(map((wdString) => {\r\n      const val = [];\r\n      if(!isEmpty(model.WindSpeed)) {\r\n        val.push(`${model.WindSpeed} m/s`);\r\n      }\r\n      if(wdString !== null && wdString !== undefined) {\r\n        val.push(wdString);\r\n      }\r\n      return val.join(' - ');\r\n    }));\r\n  }\r\n\r\n  private getWindDirectionTranslationKey(windDirection: number) {\r\n    if (windDirection >= 0 && windDirection < 45 || windDirection == 360)\r\n    {\r\n      return 'Observations.WeatherObservation.FromNorth';\r\n    }\r\n    else if (windDirection >= 45 && windDirection < 90)\r\n    {\r\n      return 'Observations.WeatherObservation.FromNorthEast';\r\n    }\r\n    else if (windDirection >= 90 && windDirection < 135)\r\n    {\r\n      return 'Observations.WeatherObservation.FromEast';\r\n    }\r\n    else if (windDirection >= 135 && windDirection < 180)\r\n    {\r\n      return 'Observations.WeatherObservation.FromSouthEast';\r\n    }\r\n    else if (windDirection >= 180 && windDirection < 225)\r\n    {\r\n      return 'Observations.WeatherObservation.FromSouth';\r\n    }\r\n    else if (windDirection >= 225 && windDirection < 270)\r\n    {\r\n      return 'Observations.WeatherObservation.FromSouthWest';\r\n    }\r\n    else if (windDirection >= 270 && windDirection < 315)\r\n    {\r\n      return 'Observations.WeatherObservation.FromWest';\r\n    }\r\n    else if (windDirection >= 315 && windDirection < 360)\r\n    {\r\n      return 'Observations.WeatherObservation.FromNorthWest';\r\n    }\r\n    return '';\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { Observable } from 'rxjs';\r\nimport { IDataLoad } from '../models/data-load.interface';\r\nimport { map, take } from 'rxjs/operators';\r\nimport moment from 'moment';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { NSqlFullUpdateObservable } from '../../../core/helpers/nano-sql/NSqlFullUpdateObservable';\r\n\r\n/**\r\n * Håndterer spinnere og status på når sist oppdatering har skjedd.\r\n * Trenger nye data og hentes? osv.\r\n */\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DataLoadService {\r\n  constructor() {}\r\n\r\n  async startLoading(id: string, totalItems?: number) {\r\n    const existingItem = await this.getState(id);\r\n    existingItem.startedDate = moment().toISOString();\r\n    existingItem.isLoading = true;\r\n    existingItem.completedDate = null;\r\n    existingItem.progress = 0;\r\n    existingItem.itemsComplete = 0;\r\n    existingItem.totalItems = totalItems;\r\n    existingItem.error = null;\r\n    existingItem.errorMessage = null;\r\n    existingItem.status = '';\r\n    return this.saveDataLoadItem(existingItem);\r\n  }\r\n\r\n  async updateProgress(\r\n    id: string,\r\n    itemsComplete: number,\r\n    totalItems: number,\r\n    status?: string\r\n  ) {\r\n    const existingItem = await this.getState(id);\r\n    existingItem.itemsComplete = itemsComplete;\r\n    existingItem.totalItems = totalItems;\r\n    existingItem.status = status;\r\n    existingItem.progress = itemsComplete / totalItems;\r\n    return this.saveDataLoadItem(existingItem);\r\n  }\r\n\r\n  async loadingCompleted(\r\n    id: string,\r\n    totalItems?: number,\r\n    itemsFromDate?: Date,\r\n    itemsToDate?: Date\r\n  ) {\r\n    const existingItem = await this.getState(id);\r\n    existingItem.isLoading = false;\r\n    existingItem.completedDate = moment().toISOString();\r\n    existingItem.lastUpdated = moment().toISOString();\r\n    existingItem.progress = 1.0;\r\n    existingItem.totalItems = totalItems;\r\n    existingItem.itemsComplete = totalItems;\r\n    existingItem.itemsFromDate = moment(itemsFromDate).toISOString();\r\n    existingItem.itemsToDate = moment(itemsToDate).toISOString();\r\n    return this.saveDataLoadItem(existingItem);\r\n  }\r\n\r\n  async loadingError(id: string, errorMessage: string) {\r\n    const existingItem = await this.getState(id);\r\n    existingItem.isLoading = false;\r\n    existingItem.completedDate = moment().toISOString();\r\n    existingItem.progress = 1.0;\r\n    existingItem.status = 'Error';\r\n    existingItem.error = true;\r\n    existingItem.errorMessage = errorMessage;\r\n    return this.saveDataLoadItem(existingItem);\r\n  }\r\n\r\n  private async saveDataLoadItem(item: IDataLoad) {\r\n    return nSQL(NanoSql.TABLES.DATA_LOAD.name).query('upsert', item).exec();\r\n  }\r\n\r\n  getState(id: string): Promise<IDataLoad> {\r\n    return this.getStateAsObservable(id).pipe(take(1)).toPromise();\r\n  }\r\n\r\n  getStateAsObservable(id: string): Observable<IDataLoad> {\r\n    return new NSqlFullUpdateObservable<IDataLoad[]>(\r\n      nSQL(NanoSql.TABLES.DATA_LOAD.name)\r\n        .query('select')\r\n        .where((x) => x.id === id)\r\n        .listen()\r\n    ).pipe(\r\n      map((val: IDataLoad[]) =>\r\n        val.length > 0\r\n          ? val[0]\r\n          : {\r\n            id,\r\n            completed: null,\r\n            lastUpdated: null,\r\n            isLoading: false,\r\n            started: null\r\n          }\r\n      )\r\n    );\r\n  }\r\n}\r\n","import { Component, OnInit, NgZone, ViewChild, OnDestroy } from '@angular/core';\r\nimport { Observable, Subject, of } from 'rxjs';\r\nimport {\r\n  map,\r\n  distinctUntilChanged,\r\n  scan,\r\n  filter,\r\n  throttleTime,\r\n  takeUntil,\r\n  switchMap\r\n} from 'rxjs/operators';\r\nimport { GeoPositionService } from '../../../../core/services/geo-position/geo-position.service';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { enterZone } from '../../../../core/helpers/observable-helper';\r\nimport { IonContent } from '@ionic/angular';\r\nimport moment from 'moment';\r\nimport { GeoPositionLog, PositionError } from '../../../../core/services/geo-position/geo-position-log.interface';\r\nimport { GeoPositionErrorCode } from '../../../../core/services/geo-position/geo-position-error.enum';\r\n\r\n@Component({\r\n  selector: 'app-gps-debug',\r\n  templateUrl: './gps-debug.component.html',\r\n  styleUrls: ['./gps-debug.component.scss']\r\n})\r\nexport class GpsDebugComponent implements OnInit, OnDestroy {\r\n  showLog$: Observable<boolean>;\r\n  geoPositionLog: GeoPositionLog[];\r\n  isOpen: boolean;\r\n  isTracking: boolean;\r\n  private ngDestroy$ = new Subject<void>();\r\n\r\n  @ViewChild('GpsLogPanel') panel: IonContent;\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private geoPositionService: GeoPositionService,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.isOpen = false;\r\n    this.isTracking = false;\r\n    this.showLog$ = this.userSettingService.userSetting$.pipe(\r\n      map((us) => us.featureToggeGpsDebug),\r\n      distinctUntilChanged(),\r\n      enterZone(this.ngZone)\r\n    );\r\n    this.showLog$\r\n      .pipe(\r\n        switchMap((show) =>\r\n          show\r\n            ? this.geoPositionService.log$.pipe(\r\n              scan((acc: GeoPositionLog[], val) => {\r\n                acc.push(val);\r\n                return acc.slice(-50);\r\n              }, []),\r\n              throttleTime(100)\r\n            )\r\n            : of([])\r\n        ),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe((val) => {\r\n        this.ngZone.run(() => {\r\n          this.geoPositionLog = val;\r\n        });\r\n        this.ngZone.run(() => {\r\n          this.scrollToBottom();\r\n        });\r\n      });\r\n    this.geoPositionService.log$\r\n      .pipe(\r\n        filter(\r\n          (log) =>\r\n            log.status === 'StartGpsTracking' ||\r\n            log.status === 'StopGpsTracking'\r\n        ),\r\n        map((log) => (log.status === 'StartGpsTracking' ? true : false)),\r\n        distinctUntilChanged(),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe((val) => {\r\n        setTimeout(() => {\r\n          this.isTracking = val;\r\n        });\r\n      });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n\r\n  toggle() {\r\n    this.isOpen = !this.isOpen;\r\n  }\r\n\r\n  scrollToBottom() {\r\n    if (this.panel) {\r\n      this.panel.scrollToBottom();\r\n    }\r\n  }\r\n\r\n  timestampToString(timestamp: number) {\r\n    return moment.unix(timestamp).local().format('dd.MM HH:mm:ss.SSS');\r\n  }\r\n\r\n  getErrorCodeOrMessage(err: PositionError) {\r\n    if (!err) {\r\n      return 'Empty error';\r\n    }\r\n    switch (err.code) {\r\n    case GeoPositionErrorCode.PermissionDenied:\r\n      return 'Permission denied';\r\n    case GeoPositionErrorCode.PositionUnavailable:\r\n      return 'Position unavailable';\r\n    case GeoPositionErrorCode.Timeout:\r\n      return 'Timeout';\r\n    default:\r\n      return err.message;\r\n    }\r\n  }\r\n}\r\n","<div *ngIf=\"showLog$ | async\">\r\n  <ion-fab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\" [ngClass]=\"{'open': isOpen }\">\r\n    <ion-fab-button (click)=\" toggle()\">\r\n      <ion-icon [name]=\"isOpen ? 'arrow-down-circle' : 'arrow-up-circle'\"></ion-icon>\r\n    </ion-fab-button>\r\n  </ion-fab>\r\n  <ion-content #GpsLogPanel class=\"gpsLogPanel\" [ngClass]=\"{'open': isOpen, 'tracking': isTracking }\">\r\n    <div *ngFor=\"let item of geoPositionLog\">\r\n      {{ timestampToString(item.timestamp) }} -\r\n      <span *ngIf=\"item.status !== 'PositionUpdate'\">&nbsp;{{item.status}}</span>\r\n      <span *ngIf=\"item.status === 'PositionUpdate'\">\r\n        <span *ngIf=\"item.pos else NoPosition\">&nbsp;\r\n          {{ item.pos.coords.latitude | number:'.5' }}&deg;{{'MAP_CENTER_INFO.NORTH_SHORT'|translate}},\r\n          {{ item.pos.coords.longitude | number:'.5' }}&deg;{{'MAP_CENTER_INFO.EAST_SHORT'|translate}},\r\n          {{ item.pos.coords.accuracy }}\r\n        </span>\r\n      </span>\r\n      <span *ngIf=\"item.status === 'PositionError'\">\r\n        &nbsp;{{getErrorCodeOrMessage(item.err)}}\r\n      </span>\r\n      <span *ngIf=\"item.highAccuracyEnabled\">&nbsp;(H)</span>\r\n    </div>\r\n  </ion-content>\r\n</div>\r\n<ng-template #NoPosition>\r\n  Empty\r\n</ng-template>","import { NgModule } from '@angular/core';\r\nimport { GpsDebugComponent } from './components/gps-debug/gps-debug.component';\r\nimport { SharedModule } from '../shared/shared.module';\r\n\r\n@NgModule({\r\n  imports: [SharedModule],\r\n  declarations: [GpsDebugComponent],\r\n  exports: [GpsDebugComponent]\r\n})\r\nexport class GpsDebugModule {}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  ChangeDetectionStrategy,\r\n  OnDestroy,\r\n  OnChanges,\r\n  SimpleChanges,\r\n  ChangeDetectorRef\r\n} from '@angular/core';\r\nimport * as L from 'leaflet';\r\nimport { BehaviorSubject, Subject, timer } from 'rxjs';\r\nimport { takeUntil, takeWhile, tap } from 'rxjs/operators';\r\nimport { ImageLocation } from '../../components/img-swiper/image-location.model';\r\nimport { settings } from '../../../settings';\r\nimport { SmartChanges } from '../../core/helpers/simple-changes.helper';\r\nimport { BorderHelper } from '../../core/helpers/leaflet/border-helper';\r\nimport { RegobsGeoHazardMarker } from '../map/core/classes/regobs-geohazard-marker';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\n\r\nconst START_ICON = '/assets/icon/map/GPS_start.svg';\r\nconst END_ICON = '/assets/icon/map/GPS_stop.svg';\r\nconst DAMAGE_ICON = '/assets/icon/map/damage-location.svg';\r\n\r\n@Component({\r\n  selector: 'app-map-image',\r\n  templateUrl: './map-image.component.html',\r\n  styleUrls: ['./map-image.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class MapImageComponent implements OnInit, OnDestroy, OnChanges {\r\n  @Input() location: ImageLocation;\r\n  @Input() allowZoom: boolean;\r\n\r\n  private map: L.Map;\r\n  private mapCenterSubject: BehaviorSubject<ImageLocation>;\r\n  private ngDestroy$: Subject<void>;\r\n\r\n  constructor(private cdr: ChangeDetectorRef) {}\r\n\r\n  options: L.MapOptions = {\r\n    zoom: settings.map.tiles.zoomLevelObservationList,\r\n    maxZoom: settings.map.tiles.maxZoom,\r\n    minZoom: 8,\r\n    bounceAtZoomLimits: false,\r\n    attributionControl: false,\r\n    zoomControl: false,\r\n    scrollWheelZoom: 'center', // zoom to center regardless where mouse is\r\n    touchZoom: 'center',\r\n    trackResize: false,\r\n    center: L.latLng(settings.map.unknownMapCenter as L.LatLngTuple)\r\n  };\r\n\r\n  private getStartStopIcon(start = false) {\r\n    return L.icon({\r\n      iconUrl: start ? START_ICON : END_ICON,\r\n      iconSize: [27, 42],\r\n      iconAnchor: [13.5, 41],\r\n      shadowUrl: 'leaflet/marker-shadow.png',\r\n      shadowSize: [41, 41]\r\n    });\r\n  }\r\n\r\n  private getDamageIcon() {\r\n    return L.icon({\r\n      iconUrl: DAMAGE_ICON,\r\n      iconSize: [25, 41],\r\n      iconAnchor: [12, 41],\r\n      shadowUrl: 'leaflet/marker-shadow.png',\r\n      shadowSize: [41, 41]\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.mapCenterSubject = new BehaviorSubject(this.location);\r\n    this.ngDestroy$ = new Subject();\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges & SmartChanges<this>): void {\r\n    if (!this.mapCenterSubject) {\r\n      this.mapCenterSubject = new BehaviorSubject(this.location);\r\n    }\r\n    this.mapCenterSubject.next(changes.location.currentValue);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n  onLeafletMapReady(map: L.Map) {\r\n    this.map = map;\r\n    this.mapCenterSubject.pipe(takeUntil(this.ngDestroy$)).subscribe((val) => {\r\n      if (this.map) {\r\n        this.map.eachLayer((layer) => layer.remove());\r\n      }\r\n      this.addTileLayers();\r\n      if (val && val.latLng) {\r\n        this.map.setView(val.latLng, this.options.zoom);\r\n        this.setMarker(val.latLng, val.geoHazard);\r\n      }\r\n      if (val && val.startStopLocation) {\r\n        this.setStartStopLocation(\r\n          val.startStopLocation.start,\r\n          val.startStopLocation.stop\r\n        );\r\n      }\r\n      if (val && val.damageLocations && val.damageLocations.length > 0) {\r\n        this.setDamageLocations(val.damageLocations);\r\n      }\r\n    });\r\n    if (!this.allowZoom) {\r\n      if (this.map.tap) {\r\n        this.map.tap.disable();\r\n      }\r\n      this.map.doubleClickZoom.disable();\r\n      this.map.dragging.disable();\r\n      this.map.keyboard.disable();\r\n      this.map.touchZoom.disable();\r\n      this.map.scrollWheelZoom.disable();\r\n      this.map.boxZoom.disable();\r\n    }\r\n    this.redrawMap();\r\n  }\r\n\r\n  redrawMap() {\r\n    let counter = 3;\r\n    timer(500, 50)\r\n      .pipe(\r\n        takeUntil(this.ngDestroy$),\r\n        takeWhile(() => counter > 0),\r\n        tap(() => counter--)\r\n      )\r\n      .subscribe(() => {\r\n        if (this.map) {\r\n          this.map.invalidateSize();\r\n        }\r\n      });\r\n  }\r\n\r\n  private isInNorway() {\r\n    if (this.location && this.location.latLng) {\r\n      return (\r\n        BorderHelper.isInNorway(this.location.latLng) ||\r\n        BorderHelper.isInSvalbard(this.location.latLng)\r\n      );\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private addTileLayers() {\r\n    const url = this.isInNorway()\r\n      ? settings.map.tiles.statensKartverkMapUrl\r\n      : settings.map.tiles.arcGisOnlineTopoMapUrl;\r\n    L.tileLayer(url, {\r\n      updateWhenIdle: true,\r\n      keepBuffer: 0\r\n    }).addTo(this.map);\r\n  }\r\n\r\n  private setMarker(latLng: L.LatLng, geoHazard: GeoHazard) {\r\n    L.marker(latLng, {\r\n      icon: new RegobsGeoHazardMarker(geoHazard),\r\n      interactive: false\r\n    }).addTo(this.map);\r\n  }\r\n\r\n  private setStartStopLocation(start: L.LatLng, stop: L.LatLng) {\r\n    if (start) {\r\n      L.marker(start, {\r\n        icon: this.getStartStopIcon(true),\r\n        interactive: false\r\n      }).addTo(this.map);\r\n    }\r\n    if (stop) {\r\n      L.marker(stop, {\r\n        icon: this.getStartStopIcon(false),\r\n        interactive: false\r\n      }).addTo(this.map);\r\n    }\r\n    if (start && stop) {\r\n      L.polyline([start, stop], {\r\n        color: 'red',\r\n        weight: 6,\r\n        opacity: 0.9\r\n      }).addTo(this.map);\r\n    }\r\n  }\r\n\r\n  private setDamageLocations(locations: L.LatLng[]) {\r\n    if (locations && locations.length > 0) {\r\n      for (const location of locations) {\r\n        L.marker(location, {\r\n          icon: this.getDamageIcon(),\r\n          interactive: false\r\n        }).addTo(this.map);\r\n      }\r\n    }\r\n  }\r\n}\r\n","<div leaflet [leafletOptions]=\"options\" (leafletMapReady)=\"onLeafletMapReady($event)\">\r\n</div>","import { MapImageComponent } from './map-image.component';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { LeafletModule } from '@asymmetrik/ngx-leaflet';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    LeafletModule\r\n  ],\r\n  declarations: [MapImageComponent],\r\n  exports: [MapImageComponent]\r\n})\r\nexport class MapImageModule {}\r\n","import { Component, ChangeDetectionStrategy, ChangeDetectorRef, ViewChild, ElementRef } from '@angular/core';\r\nimport { ToastController, Platform } from '@ionic/angular';\r\nimport { Clipboard } from '@ionic-native/clipboard/ngx';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { combineLatest, firstValueFrom, of } from 'rxjs';\r\nimport { catchError, takeUntil, timeout } from 'rxjs/operators';\r\nimport { MapSearchService } from '../../services/map-search/map-search.service';\r\nimport { MapService } from '../../services/map/map.service';\r\nimport { GeoPositionService } from 'src/app/core/services/geo-position/geo-position.service';\r\nimport { HelperService } from 'src/app/core/services/helpers/helper.service';\r\nimport { NgDestoryBase } from 'src/app/core/helpers/observable-helper';\r\nimport { Position } from '@capacitor/geolocation';\r\nimport { LocationName } from '../../services/map-search/location-name.model';\r\nimport * as L from 'leaflet';\r\nimport { ViewInfo } from '../../services/map-search/view-info.model';\r\nimport { IMapView } from '../../services/map/map-view.interface';\r\n\r\nconst LOCATION_INFO_REQUEST_TIMEOUT = 10_000;\r\nlet requestCounter = 0;\r\n\r\n@Component({\r\n  selector: 'app-map-center-info',\r\n  templateUrl: './map-center-info.component.html',\r\n  styleUrls: ['./map-center-info.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class MapCenterInfoComponent extends NgDestoryBase {\r\n  private userPos: Position;  // Caches the gps position for distance and height diff computation\r\n\r\n  // For accessing the info box element from parent views\r\n  @ViewChild('infoBoxElement') private infoBoxElement: ElementRef;\r\n\r\n  get nativeElement(): HTMLElement | null {\r\n    return this.infoBoxElement?.nativeElement;\r\n  }\r\n\r\n  // Public props we can see in the map center info box\r\n  mapCenter: L.LatLng;\r\n  elevation: number;\r\n  location: LocationName;\r\n  steepness: number;\r\n  loading = false;\r\n\r\n  get distance(): number {\r\n    if (this.userPos?.coords && this.mapCenter != null) {\r\n      return this.mapCenter.distanceTo({\r\n        lat: this.userPos.coords.latitude,\r\n        lng: this.userPos.coords.longitude\r\n      });\r\n    }\r\n  }\r\n\r\n  get heightDifference(): number {\r\n    if (this.userPos?.coords?.altitude != null && this.elevation) {\r\n      return this.elevation - this.userPos.coords.altitude;\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    mapService: MapService,\r\n    private mapSearchService: MapSearchService,\r\n    private clipboard: Clipboard,\r\n    private toastController: ToastController,\r\n    private translateService: TranslateService,\r\n    private platform: Platform,\r\n    geoPositionService: GeoPositionService,\r\n    private helperService: HelperService,\r\n    private cdr: ChangeDetectorRef,\r\n  ) {\r\n    super();\r\n\r\n    // When we get a new gps position, update cached position.\r\n    // If followMode is on, we do not need to show distance and relative height.\r\n    combineLatest([\r\n      geoPositionService.currentPosition$,\r\n      mapService.followMode$\r\n    ])\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe(([newPos, followMode]) => {\r\n        this.userPos = followMode ? null : newPos;\r\n        this.cdr.markForCheck();\r\n      });\r\n\r\n    mapService.relevantMapChangeWithInitialView$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((newMapView) => {\r\n        this.mapCenter = newMapView.center;\r\n        this.location = null;\r\n        this.elevation = null;\r\n        this.steepness = null;\r\n        this.fetchNewLocationInfo(newMapView);\r\n        this.cdr.markForCheck();\r\n      });\r\n  }\r\n\r\n  getHorizontalDifferenceText(value: number): string {\r\n    return this.helperService.getDistanceText(value);\r\n  }\r\n\r\n  private fetchNewLocationInfo(mapView: IMapView) {\r\n    this.loading = true;\r\n\r\n    const locationInfoRequest = this.mapSearchService\r\n      .getViewInfo(mapView)\r\n      .pipe(\r\n        timeout(LOCATION_INFO_REQUEST_TIMEOUT),\r\n        catchError(() => of({} as ViewInfo)),\r\n      );\r\n\r\n    // Track request number, so we only update the view\r\n    // after the last observable completes.\r\n    requestCounter++;\r\n    const requestIndex = requestCounter;\r\n\r\n    firstValueFrom(locationInfoRequest)\r\n      .then(viewInfo => {\r\n        if (requestIndex < requestCounter) return;\r\n\r\n        this.location = viewInfo.location;\r\n        this.elevation = viewInfo.elevation;\r\n        this.steepness = viewInfo.steepness;\r\n        this.loading = false;\r\n        this.cdr.markForCheck();\r\n      });\r\n  }\r\n\r\n  private useNativeClipboardPlugin() {\r\n    return (\r\n      this.platform.is('hybrid') &&\r\n      (this.platform.is('android') || this.platform.is('ios'))\r\n    );\r\n  }\r\n\r\n  async copyToClipboard(): Promise<void> {\r\n    const textToCopy = `${this.mapCenter.lat}, ${this.mapCenter.lng}`;\r\n    if (this.useNativeClipboardPlugin()) {\r\n      await this.clipboard.copy(textToCopy);\r\n    } else {\r\n      this.copyToClipBoardWeb(textToCopy);\r\n    }\r\n    const toastText = await firstValueFrom(this.translateService.get('MAP_CENTER_INFO.COPIED_TO_CLIPBOARD'));\r\n    const toast = await this.toastController.create({\r\n      message: toastText,\r\n      mode: 'md',\r\n      duration: 2000\r\n    });\r\n    toast.present();\r\n  }\r\n\r\n  private copyToClipBoardWeb(val: string) {\r\n    const selBox = document.createElement('textarea');\r\n    selBox.style.position = 'fixed';\r\n    selBox.style.left = '0';\r\n    selBox.style.top = '0';\r\n    selBox.style.opacity = '0';\r\n    selBox.value = val;\r\n    document.body.appendChild(selBox);\r\n    selBox.focus();\r\n    selBox.select();\r\n    document.execCommand('copy');\r\n    document.body.removeChild(selBox);\r\n  }\r\n}\r\n","<!-- \r\n  NB! Root elements in this view has positon: absolute..\r\n -->\r\n\r\n<!-- Crosshair displayed in map center -->\r\n<img class=\"center-icon\" src=\"../../../assets/icon/center.png\">\r\n\r\n<!-- Map center info box displayed in bottom left corner -->\r\n<div\r\n  #infoBoxElement\r\n  class=\"map-center-info ion-text-nowrap\"\r\n  (click)=\"copyToClipboard()\"\r\n>\r\n  <ion-grid class=\"ion-no-padding\">\r\n\r\n    <ng-container *ngIf=\"!loading; else loadingSpinner\">\r\n\r\n      <!-- Location name -->\r\n      <ion-row name=\"map-center-info-row\" *ngIf=\"location\">\r\n        <span\r\n          *ngIf=\"location.name !== location.adminName\">{{ location.name }},&nbsp;</span>{{location.adminName}}\r\n      </ion-row>\r\n\r\n      <!-- Height (masl) and steepness -->\r\n      <ion-row name=\"map-center-info-row\" *ngIf=\"elevation != null || steepness != null\">\r\n        <ng-container *ngIf=\"elevation != null\">\r\n          {{ elevation }} {{'MAP_CENTER_INFO.ABOVE_SEA_LEVEL'|translate}}\r\n        </ng-container>\r\n        <ng-container *ngIf=\"steepness != null\">\r\n          <span *ngIf=\"elevation !== null\">,&nbsp;</span>\r\n          <span class=\"steepness-triangle\">\r\n            <span class=\"steepness-value\" [ngStyle]=\"{ 'transform': 'rotate(' +steepness +'deg)'}\">\r\n            </span>\r\n          </span>\r\n          {{ steepness }}&deg;\r\n        </ng-container>\r\n      </ion-row>\r\n\r\n    </ng-container>\r\n\r\n    <!-- Coordinates -->\r\n    <ion-row name=\"map-center-info-row\" *ngIf=\"mapCenter\">\r\n      {{ mapCenter.lat | number:'.3' }}&deg;{{ 'MAP_CENTER_INFO.NORTH_SHORT' | translate }}, \r\n      {{ mapCenter.lng | number:'.3' }}&deg;{{ 'MAP_CENTER_INFO.EAST_SHORT' | translate }}\r\n    </ion-row>\r\n\r\n    <!-- Distance and height difference to gps position -->\r\n    <ion-row name=\"map-center-info-row\" *ngIf=\"distance != null && distance > 0\">\r\n        {{ getHorizontalDifferenceText(distance) }} {{ 'MAP_CENTER_INFO.AWAY_FROM' | translate }}\r\n        <ng-container *ngIf=\"!loading && heightDifference != null\">\r\n          <ion-icon *ngIf=\"heightDifference > 0\" name=\"arrow-up\" class=\"height-difference-icon\"></ion-icon>\r\n          <ion-icon *ngIf=\"heightDifference < 0\" name=\"arrow-down\" class=\"height-difference-icon\"></ion-icon>\r\n          {{ heightDifference | abs | number: '1.0-0' }} m\r\n        </ng-container>\r\n    </ion-row>\r\n\r\n  </ion-grid>\r\n</div>\r\n\r\n<ng-template #loadingSpinner>\r\n  <ion-spinner name=\"map-center-info-spinner\" color=\"light\" name=\"dots\"></ion-spinner>\r\n</ng-template>","import { Component, OnInit, OnDestroy } from '@angular/core';\r\nimport { FullscreenService } from '../../../../../core/services/fullscreen/fullscreen.service';\r\nimport { Observable } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-fullscreen-toggle',\r\n  templateUrl: './fullscreen-toggle.component.html',\r\n  styleUrls: ['./fullscreen-toggle.component.scss']\r\n})\r\nexport class FullscreenToggleComponent {\r\n  isFullscreen$: Observable<boolean>;\r\n\r\n  constructor(private fullscreenService: FullscreenService) {\r\n    this.isFullscreen$ = this.fullscreenService.isFullscreen$;\r\n  }\r\n\r\n  toggleFullscreen() {\r\n    this.fullscreenService.toggleFullscreen();\r\n  }\r\n\r\n  getSrc(isFullscreen: boolean) {\r\n    return `/assets/icon/${isFullscreen ? 'collapse' : 'expand'}.svg`;\r\n  }\r\n}\r\n","<ion-fab>\r\n  <ion-fab-button color=\"varsom-dark-blue\" class=\"map-control-fab\" (click)=\"toggleFullscreen()\">\r\n    <svg-icon [src]=\"getSrc(isFullscreen$ | async)\"></svg-icon>\r\n  </ion-fab-button>\r\n</ion-fab>","import {\r\n  Component,\r\n  OnInit,\r\n  OnDestroy,\r\n  AfterContentInit,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef\r\n} from '@angular/core';\r\nimport { MapService } from '../../../services/map/map.service';\r\nimport { Subscription } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-gps-center',\r\n  templateUrl: './gps-center.component.html',\r\n  styleUrls: ['./gps-center.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class GpsCenterComponent implements OnInit, OnDestroy, AfterContentInit {\r\n  followMode: boolean;\r\n\r\n  private subscription: Subscription;\r\n\r\n  constructor(\r\n    private mapService: MapService,\r\n    private cdRef: ChangeDetectorRef\r\n  ) {}\r\n\r\n  ngAfterContentInit(): void {\r\n    this.subscription = this.mapService.followMode$.subscribe((val) => {\r\n      this.followMode = val;\r\n      this.cdRef.detectChanges();\r\n    });\r\n    this.cdRef.detectChanges();\r\n  }\r\n\r\n  ngOnInit() {}\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  centerMapToUser() {\r\n    this.mapService.centerMapToUser();\r\n  }\r\n}\r\n","<ion-fab>\r\n  <ion-fab-button color=\"varsom-dark-blue\" class=\"map-control-fab\" [ngClass]=\"{'active': followMode}\"\r\n    (click)=\"centerMapToUser()\">\r\n    <ion-icon name=\"locate\"></ion-icon>\r\n  </ion-fab-button>\r\n</ion-fab>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { Observable } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'app-map-controls',\r\n  templateUrl: './map-controls.component.html',\r\n  styleUrls: ['./map-controls.component.scss']\r\n})\r\nexport class MapControlsComponent implements OnInit {\r\n  @Input() showMapSearch = true;\r\n  @Input() showFullscreenToggle = true;\r\n  @Input() showGpsCenter = true;\r\n  fullscreen$: Observable<boolean>;\r\n\r\n  constructor(private fullscreenService: FullscreenService) {\r\n    this.fullscreen$ = fullscreenService.isFullscreen$;\r\n  }\r\n\r\n  ngOnInit() {}\r\n}\r\n","<div class=\"map-controls\" [ngClass]=\"{'fullscreen': (fullscreen$ | async) }\">\r\n  <app-map-search *ngIf=\"showMapSearch\"></app-map-search>\r\n  <app-fullscreen-toggle *ngIf=\"showFullscreenToggle\"></app-fullscreen-toggle>\r\n  <app-gps-center *ngIf=\"showGpsCenter\"></app-gps-center>\r\n</div>","import { Component, OnInit } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { CustomAnimation } from '../../../../../core/animations/custom.animation';\r\nimport { ModalSearchPage } from '../../../pages/modal-search/modal-search.page';\r\n\r\n@Component({\r\n  selector: 'app-map-search',\r\n  templateUrl: './map-search.component.html',\r\n  styleUrls: ['./map-search.component.scss']\r\n})\r\nexport class MapSearchComponent implements OnInit {\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  async presentModal() {\r\n    const modal = await this.modalController.create({\r\n      component: ModalSearchPage,\r\n      keyboardClose: true,\r\n      enterAnimation: CustomAnimation.slideInFromRight,\r\n      leaveAnimation: CustomAnimation.slideOutToRight\r\n    });\r\n    return await modal.present();\r\n  }\r\n}\r\n","<ion-fab>\r\n  <ion-fab-button color=\"varsom-dark-blue\" class=\"map-control-fab\" (click)=\"presentModal()\">\r\n    <ion-icon name=\"search\"></ion-icon>\r\n  </ion-fab-button>\r\n</ion-fab>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  NgZone,\r\n  OnDestroy,\r\n  AfterViewInit,\r\n  Output,\r\n  EventEmitter,\r\n  Injector\r\n} from '@angular/core';\r\nimport * as L from 'leaflet';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { timer, Subject, from, BehaviorSubject, combineLatest } from 'rxjs';\r\nimport { UserSetting } from '../../../../core/models/user-settings.model';\r\nimport { settings } from '../../../../../settings';\r\nimport { Position } from '@capacitor/geolocation';\r\nimport { UserMarker } from '../../../../core/helpers/leaflet/user-marker/user-marker';\r\nimport { MapService } from '../../services/map/map.service';\r\nimport {\r\n  take,\r\n  takeUntil,\r\n  switchMap,\r\n  distinctUntilChanged,\r\n  withLatestFrom,\r\n  filter\r\n} from 'rxjs/operators';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { LoggingService } from '../../../shared/services/logging/logging.service';\r\nimport { MapSearchService } from '../../services/map-search/map-search.service';\r\nimport { TopoMap } from '../../../../core/models/topo-map.enum';\r\nimport {\r\n  RegObsTileLayer,\r\n  IRegObsTileLayerOptions,\r\n  RegObsOfflineAwareTileLayer,\r\n} from '../../core/classes/regobs-tile-layer';\r\nimport { NORWEGIAN_BOUNDS } from '../../../../core/helpers/leaflet/border-helper';\r\nimport { OfflineMapService } from '../../../../core/services/offline-map/offline-map.service';\r\nimport { GeoPositionService } from '../../../../core/services/geo-position/geo-position.service';\r\nimport { LangKey } from '@varsom-regobs-common/core';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { isAndroidOrIos } from 'src/app/core/helpers/ionic/platform-helper';\r\nimport { Platform } from '@ionic/angular';\r\nimport { OfflineMapPackage, OfflineTilesMetadata } from 'src/app/core/services/offline-map/offline-map.model';\r\nimport { BBox } from 'geojson';\r\n\r\nconst DEBUG_TAG = 'MapComponent';\r\n\r\ntype CreateTileLayer = (options: IRegObsTileLayerOptions) => L.TileLayer;\r\n\r\nconst isTopoLayer = (mapId: string) => (<string[]>Object.values(TopoMap)).includes(mapId);\r\nconst redrawLayersInLayerGroup = (layerGroup: L.LayerGroup) => {\r\n  layerGroup.eachLayer((layer) => {\r\n    if (layer instanceof L.TileLayer) {\r\n      layer.redraw();\r\n    }\r\n  });\r\n};\r\n\r\n// Bug in leaflet? When using detectRetina, we need to offset native zooms.\r\nconst getNativeZoomOptions = (map: OfflineTilesMetadata, detectRetina: boolean): L.TileLayerOptions => {\r\n  if (detectRetina) {\r\n    return {\r\n      minNativeZoom: Math.max(0, map.rootTile.z - 1),\r\n      maxNativeZoom: Math.max(0, map.zMax - 1)\r\n    };\r\n  } else {\r\n    return {\r\n      minNativeZoom: map.rootTile.z,\r\n      maxNativeZoom: map.zMax\r\n    };\r\n  }\r\n};\r\n\r\nenum MapLayerZIndex {\r\n  OnlineMixedBackgroundLayer = 0,\r\n  OfflineBackgroundLayer = 10,\r\n  OnlineBackgroundLayer = 20,\r\n  OfflineSupportLayer = 30,\r\n  OnlineSupportLayer = 40,\r\n  Top = 50\r\n}\r\n\r\n@Component({\r\n  selector: 'app-map',\r\n  templateUrl: './map.component.html',\r\n  styleUrls: ['./map.component.scss']\r\n})\r\nexport class MapComponent implements OnInit, OnDestroy, AfterViewInit {\r\n  @Input() showMapSearch = true;\r\n  @Input() showFullscreenToggle = true;\r\n  @Input() showGpsCenter = true;\r\n  @Input() showUserLocation = true;\r\n  @Input() showScale = true;\r\n  @Input() showSupportMaps = true;\r\n  @Input() center: L.LatLng;\r\n  @Input() zoom: number;\r\n  @Output() mapReady: EventEmitter<L.Map> = new EventEmitter();\r\n  @Input() autoActivate = true;\r\n  @Input() geoTag = DEBUG_TAG;\r\n  @Input() offlinePackageMode = false;\r\n\r\n  loaded = false;\r\n  private map: L.Map;\r\n  private layerGroup = L.layerGroup();\r\n  private offlineTopoLayerGroup = L.layerGroup();\r\n  private offlineSupportMapLayerGroup = L.layerGroup();\r\n  private userMarker: UserMarker;\r\n  private firstPositionUpdate = true;\r\n  private ngDestroy$ = new Subject<void>();\r\n  private followMode = true;\r\n  private isDoingMoveAction = false;\r\n  private firstClickOnZoomToUser = true;\r\n  private isActive: BehaviorSubject<boolean>;\r\n  private offlineMapService: OfflineMapService;\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private mapService: MapService,\r\n    private mapSearchService: MapSearchService,\r\n    private zone: NgZone,\r\n    private fullscreenService: FullscreenService,\r\n    private loggingService: LoggingService,\r\n    private geoPositionService: GeoPositionService,\r\n    private file: File,\r\n    private platform: Platform,\r\n    injector: Injector\r\n  ) {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.offlineMapService = injector.get(OfflineMapService);\r\n    }\r\n\r\n    // Hack to make sure map pane is set before getPosition\r\n    L.Map.include({\r\n      _getMapPanePos: function () {\r\n        if (this._mapPane === undefined) {\r\n          return new L.Point(0, 0);\r\n        }\r\n        return L.DomUtil.getPosition(this._mapPane) || new L.Point(0, 0);\r\n      },\r\n      _rawPanBy: function (offset) {\r\n        if (this._mapPane) {\r\n          L.DomUtil.setPosition(\r\n            this._mapPane,\r\n            this._getMapPanePos().subtract(offset)\r\n          );\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  options: L.MapOptions;\r\n\r\n  async ngOnInit() {\r\n    this.options = {\r\n      zoom:\r\n        this.zoom !== undefined ? this.zoom : settings.map.tiles.defaultZoom,\r\n      maxZoom: settings.map.tiles.maxZoom,\r\n      minZoom: settings.map.tiles.minZoom,\r\n      center:\r\n        this.center || L.latLng(settings.map.unknownMapCenter as L.LatLngTuple),\r\n      bounceAtZoomLimits: false,\r\n      attributionControl: false,\r\n      zoomControl: false,\r\n      maxBounds: new L.LatLngBounds(\r\n        new L.LatLng(90.0, -180.0),\r\n        new L.LatLng(-90, 180.0)\r\n      ),\r\n      maxBoundsViscosity: 1.0\r\n    };\r\n    this.isActive = new BehaviorSubject(this.autoActivate);\r\n    try {\r\n      if (this.center === undefined || this.zoom === undefined) {\r\n        const currentView = await this.mapService.mapView$\r\n          .pipe(take(1))\r\n          .toPromise();\r\n        if (currentView && currentView.center) {\r\n          this.firstPositionUpdate = false;\r\n          if (this.center === undefined) {\r\n            this.options.center = currentView.center;\r\n          }\r\n          if (this.zoom === undefined) {\r\n            this.options.zoom = currentView.zoom;\r\n          }\r\n        }\r\n      }\r\n    } finally {\r\n      this.loaded = true;\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.geoPositionService.stopTrackingComponent(DEBUG_TAG);\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n\r\n  componentIsActive(isActive: boolean) {\r\n    this.isActive.next(isActive);\r\n  }\r\n\r\n  onLeafletMapReady(map: L.Map) {\r\n    //TODO: Denne metoden er altfor lang, splitte opp i flere funksjoner!\r\n    this.map = map;\r\n    if (this.showScale) {\r\n      L.control.scale({ imperial: false }).addTo(map);\r\n    }\r\n\r\n    this.offlineTopoLayerGroup.addTo(this.map);\r\n    this.layerGroup.addTo(this.map);\r\n    this.offlineSupportMapLayerGroup.addTo(this.map);\r\n\r\n    if (this.offlinePackageMode) {\r\n      // Style all online maps grayscale.\r\n      // We need the dom element that contains the layer to use css and add a grayscale filter.\r\n      // After the load event, getContainer returns the container, earlier, it may return null or undefined.\r\n      this.map.on('load layeradd', () => {\r\n        this.layerGroup.eachLayer((l: L.TileLayer) => {\r\n          if (l instanceof L.TileLayer) {\r\n            l.getContainer().style.filter = 'grayscale(100%)';\r\n          }\r\n        });\r\n      });\r\n    }\r\n\r\n    this.userSettingService.userSetting$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((userSetting) => {\r\n        this.configureTileLayers(userSetting);\r\n        if (userSetting.showMapCenter) {\r\n          this.updateMapView();\r\n        }\r\n      });\r\n\r\n    this.mapService.followMode$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((val) => {\r\n        this.followMode = val;\r\n        this.loggingService.debug(\r\n          `Follow mode changed to: ${this.followMode}`,\r\n          DEBUG_TAG\r\n        );\r\n      });\r\n\r\n    this.mapService.centerMapToUser$\r\n      .pipe(\r\n        takeUntil(this.ngDestroy$),\r\n        switchMap(() =>\r\n          from(this.geoPositionService.startTrackingComponent(DEBUG_TAG, true))\r\n        )\r\n      )\r\n      .subscribe();\r\n\r\n    this.mapSearchService.mapSearchClick$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((item) => {\r\n        this.disableFollowMode();\r\n        this.zone.runOutsideAngular(() => {\r\n          const latLng = item instanceof L.LatLng ? item : item.latlng;\r\n          this.flyTo(latLng, settings.map.mapSearchZoomToLevel);\r\n        });\r\n      });\r\n\r\n    this.mapService.centerMapToUser$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe(() => {\r\n        this.zone.runOutsideAngular(() => {\r\n          if (this.userMarker) {\r\n            const currentPosition = this.userMarker.getPosition();\r\n            const latLng = L.latLng(\r\n              currentPosition.coords.latitude,\r\n              currentPosition.coords.longitude\r\n            );\r\n            if (this.followMode || this.firstClickOnZoomToUser) {\r\n              // Follow mode is allready true or first click, zoom in\r\n              this.flyToMaxZoom(latLng);\r\n            } else {\r\n              // Use existing zoom\r\n              this.flyTo(latLng, this.map.getZoom(), true);\r\n            }\r\n            this.firstClickOnZoomToUser = false;\r\n          }\r\n        });\r\n      });\r\n\r\n    this.zone.runOutsideAngular(() => {\r\n      this.map.on('movestart', () => this.onMapMove());\r\n      this.map.on('zoomstart', () => this.onMapMove());\r\n    });\r\n\r\n    this.zone.runOutsideAngular(() => {\r\n      this.map.on('moveend', () => this.onMapMoveEnd());\r\n    });\r\n\r\n    this.fullscreenService.isFullscreen$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe(() => {\r\n        this.redrawMap();\r\n      });\r\n\r\n    if (this.showUserLocation) {\r\n      this.geoPositionService.currentPosition$\r\n        .pipe(takeUntil(this.ngDestroy$))\r\n        .subscribe((pos) => this.onPositionUpdate(pos));\r\n\r\n      this.geoPositionService.currentHeading$\r\n        .pipe(takeUntil(this.ngDestroy$))\r\n        .subscribe((heading) => {\r\n          if (this.userMarker) {\r\n            this.userMarker.setHeading(heading);\r\n          }\r\n        });\r\n\r\n      this.startActiveSubscriptions();\r\n    }\r\n\r\n    this.startInvalidateSizeMapTimer();\r\n\r\n    this.map.on('resize', () => this.updateMapView());\r\n\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.initOfflineMaps();\r\n    }\r\n\r\n    this.mapReady.emit(this.map);\r\n  }\r\n\r\n  private async initOfflineMaps() {\r\n    this.loggingService.debug('initOfflineMaps()... ', DEBUG_TAG);\r\n\r\n    combineLatest([\r\n      this.offlineMapService.packages$,\r\n      this.userSettingService.userSetting$\r\n    ])\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe(([packages, userSettings]) => {\r\n        this.zone.runOutsideAngular(() => {\r\n          this.createOfflineLayers(packages, userSettings);\r\n\r\n          // When starting offline, offline map packages are\r\n          // registered after the map initially loads.\r\n          // By redrawing here, we can see offline tiles without\r\n          // zooming in/out etc.\r\n          redrawLayersInLayerGroup(this.offlineTopoLayerGroup);\r\n          redrawLayersInLayerGroup(this.offlineSupportMapLayerGroup);\r\n        });\r\n      });\r\n  }\r\n\r\n  private tileCoordsToBounds({ x, y, z }: { x: number, y: number, z: number }): L.LatLngBounds {\r\n    const tileSize = new L.Point(256, 256);\r\n    const coords = new L.Point(x, y);\r\n\r\n    const nwPoint = coords.scaleBy(tileSize);\r\n    const sePoint = nwPoint.add(tileSize);\r\n    const nw = this.map.unproject(nwPoint, z);\r\n    const se = this.map.unproject(sePoint, z);\r\n    return new L.LatLngBounds(nw, se);\r\n  }\r\n\r\n  private createOfflineLayers(packages: OfflineMapPackage[], userSettings: UserSetting) {\r\n    this.offlineTopoLayerGroup.clearLayers();\r\n    this.offlineSupportMapLayerGroup.clearLayers();\r\n\r\n    // Create a map of enabled support tiles\r\n    const enabledSupportMaps = this.userSettingService\r\n      .getSupportTilesOptions(userSettings)\r\n      .filter(supportMap => supportMap.enabled)\r\n      .reduce((map, supportMap) => {\r\n        map.set(supportMap.name, supportMap);\r\n        return map;\r\n      }, new Map());\r\n\r\n    // Create offline tile map layers\r\n    for (const offlinePackage of packages) {\r\n      for (const map of Object.values(offlinePackage.maps)) {\r\n        if (isTopoLayer(map.mapId)) {\r\n          this.createTopoMapOfflineLayer(map, userSettings.useRetinaMap);\r\n        } else if (enabledSupportMaps.has(map.mapId)) {\r\n          const { opacity } = enabledSupportMaps.get(map.mapId);\r\n          this.createSupportMapOfflineLayer(map, opacity, userSettings.useRetinaMap);\r\n        } else {\r\n          this.loggingService.debug(`'${map.mapId}' is currently disabled or undefined in map config, no layer created for ${map.url}`, DEBUG_TAG);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private createTopoMapOfflineLayer(map: OfflineTilesMetadata, detectRetina: boolean) {\r\n    const bounds = this.tileCoordsToBounds(map.rootTile);\r\n    const url = `${map.url}/{z}/{x}/{y}.png`;\r\n    const nativeZoomOptions = getNativeZoomOptions(map, detectRetina);\r\n\r\n    const layer = new L.TileLayer(url, {\r\n      ...nativeZoomOptions,\r\n      bounds,\r\n      // When in offlinePackageMode / on offline-map.page.ts,\r\n      // always put offline packages on top so they display above\r\n      // the grayscale background-map\r\n      zIndex: this.offlinePackageMode ? MapLayerZIndex.Top : MapLayerZIndex.OfflineBackgroundLayer,\r\n      detectRetina\r\n    });\r\n    this.offlineTopoLayerGroup.addLayer(layer);\r\n  }\r\n\r\n  private createSupportMapOfflineLayer(map: OfflineTilesMetadata, opacity: number, detectRetina: boolean) {\r\n    const bounds = this.tileCoordsToBounds(map.rootTile);\r\n    const url = `${map.url}/{z}/{x}/{y}.png`;\r\n    const nativeZoomOptions = getNativeZoomOptions(map, detectRetina);\r\n    const layer = new L.TileLayer(url, {\r\n      ...nativeZoomOptions,\r\n      bounds,\r\n      opacity,\r\n      // When in offlinePackageMode / on offline-map.page.ts,\r\n      // always put offline packages on top so they display above\r\n      // the grayscale background-map\r\n      zIndex: this.offlinePackageMode ? MapLayerZIndex.Top + 1 : MapLayerZIndex.OfflineSupportLayer,\r\n      detectRetina\r\n    });\r\n    this.offlineSupportMapLayerGroup.addLayer(layer);\r\n  }\r\n\r\n\r\n  private startActiveSubscriptions() {\r\n    this.isActive\r\n      .pipe(distinctUntilChanged(), takeUntil(this.ngDestroy$))\r\n      .subscribe((active) => {\r\n        if (active) {\r\n          this.geoPositionService.startTrackingComponent(this.geoTag);\r\n          this.redrawMap();\r\n        } else {\r\n          this.geoPositionService.stopTrackingComponent(this.geoTag);\r\n        }\r\n      });\r\n  }\r\n\r\n  private onMapMove() {\r\n    this.disableFollowMode();\r\n    this.mapService.sendMapMoveStart();\r\n  }\r\n\r\n  private onMapMoveEnd() {\r\n    this.updateMapView();\r\n  }\r\n\r\n  private disableFollowMode() {\r\n    if (!this.isDoingMoveAction) {\r\n      this.loggingService.debug('Disable follow mode!', DEBUG_TAG);\r\n      this.mapService.followMode = false;\r\n    } else {\r\n      this.loggingService.debug(\r\n        'Did not disable follow mode, because isDoingMoveAction',\r\n        DEBUG_TAG\r\n      );\r\n    }\r\n  }\r\n\r\n  private updateMapView() {\r\n    if (this.map) {\r\n      this.mapService.updateMapView({\r\n        bounds: this.map.getBounds(),\r\n        center: this.map.getCenter(),\r\n        zoom: this.map.getZoom()\r\n      });\r\n    }\r\n  }\r\n\r\n  private getTileLayerDefaultOptions(\r\n    useRetinaMap = false\r\n  ): IRegObsTileLayerOptions {\r\n    return {\r\n      minZoom: settings.map.tiles.minZoom,\r\n      maxZoom: this.getMaxZoom(useRetinaMap),\r\n      maxNativeZoom: settings.map.tiles.maxZoom,\r\n      detectRetina: useRetinaMap,\r\n      updateWhenIdle: settings.map.tiles.updateWhenIdle,\r\n      edgeBufferTiles: settings.map.tiles.edgeBufferTiles,\r\n    };\r\n  }\r\n\r\n  private configureTileLayers(userSetting: UserSetting) {\r\n    this.zone.runOutsideAngular(() => {\r\n      this.layerGroup.clearLayers();\r\n      this.map.setMaxZoom(this.getMaxZoom(userSetting.useRetinaMap));\r\n\r\n      const createTileLayerFactory = this.getTileLayerFactory(\r\n        userSetting.topoMap\r\n      );\r\n\r\n      for (const createTileLayer of createTileLayerFactory) {\r\n        const options = {\r\n          ...this.getTileLayerDefaultOptions(userSetting.useRetinaMap),\r\n          zIndex: MapLayerZIndex.OnlineBackgroundLayer\r\n        };\r\n        const layer = createTileLayer(options);\r\n        layer.addTo(this.layerGroup);\r\n      }\r\n\r\n      for (const supportMaps of this.userSettingService.getSupportTilesOptions(\r\n        userSetting\r\n      )) {\r\n        if (!supportMaps.enabled) {\r\n          continue;\r\n        }\r\n\r\n        const options = {\r\n          ...this.getTileLayerDefaultOptions(userSetting.useRetinaMap),\r\n          zIndex: MapLayerZIndex.OnlineSupportLayer,\r\n          updateInterval: 600,\r\n          keepBuffer: 0,\r\n          updateWhenIdle: true,\r\n          minZoom: settings.map.tiles.minZoomSupportMaps,\r\n          bounds: <any>settings.map.tiles.supportTilesBounds\r\n        };\r\n\r\n        const layer = this.createSupportMapTileLayer(supportMaps.name, supportMaps.url, options);\r\n        layer.setOpacity(supportMaps.opacity);\r\n        layer.addTo(this.layerGroup);\r\n      }\r\n    });\r\n  }\r\n\r\n  private createSupportMapTileLayer(name: string, url: string, options: L.TileLayerOptions): RegObsTileLayer {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      return new RegObsOfflineAwareTileLayer(\r\n        name,\r\n        url,\r\n        options,\r\n        this.offlineMapService.offlineTilesRegistry,\r\n        this.loggingService\r\n      );\r\n    } else {\r\n      return new RegObsTileLayer(url, options);\r\n    }\r\n  }\r\n\r\n  private getMaxZoom(detectRetina: boolean) {\r\n    return detectRetina && L.Browser.retina\r\n      ? settings.map.tiles.maxZoom + 2\r\n      : settings.map.tiles.maxZoom;\r\n  }\r\n\r\n  private getTileLayerFactory(topoMap: TopoMap): CreateTileLayer[] {\r\n    let createNorwegianMixedMap: CreateTileLayer;\r\n    let createStatensKartverk: CreateTileLayer;\r\n\r\n    if (isAndroidOrIos(this.platform)) {\r\n      createNorwegianMixedMap = (options) => new RegObsOfflineAwareTileLayer(\r\n        TopoMap.statensKartverk,\r\n        settings.map.tiles.statensKartverkMapUrl,\r\n        {\r\n          ...options,\r\n          bounds: settings.map.tiles.supportTilesBounds as L.LatLngBoundsLiteral\r\n        },\r\n        this.offlineMapService.offlineTilesRegistry,\r\n        this.loggingService,\r\n      );\r\n\r\n      createStatensKartverk = (options) => new RegObsOfflineAwareTileLayer(\r\n        TopoMap.statensKartverk,\r\n        settings.map.tiles.statensKartverkMapUrl,\r\n        options,\r\n        this.offlineMapService.offlineTilesRegistry,\r\n        this.loggingService,\r\n      );\r\n    } else {\r\n      createNorwegianMixedMap = (options) => new RegObsTileLayer(\r\n        settings.map.tiles.statensKartverkMapUrl,\r\n        {\r\n          ...options,\r\n          bounds: settings.map.tiles.supportTilesBounds as L.LatLngBoundsLiteral\r\n        }\r\n      );\r\n\r\n      createStatensKartverk = (options) => new RegObsTileLayer(\r\n        settings.map.tiles.statensKartverkMapUrl,\r\n        options\r\n      );\r\n    }\r\n\r\n\r\n    const createOpenTopoMap: CreateTileLayer = (options) => new L.TileLayer(settings.map.tiles.openTopoMapUrl, options);\r\n    const createArcGisOnlineMap: CreateTileLayer = (options) => new L.TileLayer(settings.map.tiles.arcGisOnlineTopoMapUrl, options);\r\n    const createGeoDataLandskapMap: CreateTileLayer = (options) => new L.TileLayer(settings.map.tiles.geoDataLandskapMapUrl, options);\r\n    const createArGisOnlineMixMap: CreateTileLayer[] = [\r\n      (options) => new RegObsTileLayer(\r\n        settings.map.tiles.arcGisOnlineTopoMapUrl,\r\n        {\r\n          ...options,\r\n          zIndex: MapLayerZIndex.OnlineMixedBackgroundLayer,\r\n          excludeBounds: NORWEGIAN_BOUNDS\r\n        },\r\n      ),\r\n      createNorwegianMixedMap\r\n    ];\r\n\r\n    switch (topoMap) {\r\n    case TopoMap.statensKartverk:\r\n      return [createStatensKartverk];\r\n    case TopoMap.openTopo:\r\n      return [createOpenTopoMap];\r\n    case TopoMap.arcGisOnline:\r\n      return [createArcGisOnlineMap];\r\n    case TopoMap.geoDataLandskap:\r\n      return [createGeoDataLandskapMap];\r\n    case TopoMap.mixOpenTopo:\r\n      return [\r\n        (options) => new RegObsTileLayer(settings.map.tiles.openTopoMapUrl, {\r\n          ...options,\r\n          zIndex: MapLayerZIndex.OnlineMixedBackgroundLayer,\r\n          excludeBounds: NORWEGIAN_BOUNDS\r\n        }),\r\n        createNorwegianMixedMap\r\n      ];\r\n    case TopoMap.mixArcGisOnline:\r\n    default:\r\n      return createArGisOnlineMixMap;\r\n    }\r\n  }\r\n\r\n  // Force redraw map size on interval to make sure tiles are displayed\r\n  private startInvalidateSizeMapTimer() {\r\n    timer(2000, 5000)\r\n      .pipe(\r\n        withLatestFrom(this.isActive),\r\n        filter(([timer, active]) => active),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe(() => this.redrawMap());\r\n  }\r\n\r\n  redrawMap() {\r\n    if (this.map) {\r\n      this.map.invalidateSize();\r\n    }\r\n    window.dispatchEvent(new Event('resize'));\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.redrawMap();\r\n  }\r\n\r\n  private onPositionUpdate(data: Position) {\r\n    this.zone.runOutsideAngular(() => {\r\n      if (this.map) {\r\n        const latLng = L.latLng({\r\n          lat: data.coords.latitude,\r\n          lng: data.coords.longitude\r\n        });\r\n        if (!this.userMarker) {\r\n          this.userMarker = new UserMarker(this.map, data);\r\n        } else {\r\n          this.userMarker.updatePosition(data);\r\n        }\r\n        if (this.followMode && !this.isDoingMoveAction) {\r\n          this.flyToMaxZoom(latLng, !this.firstPositionUpdate);\r\n          this.firstPositionUpdate = false;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  private flyToMaxZoom(latLng: L.LatLng, usePan = false) {\r\n    this.flyTo(\r\n      latLng,\r\n      Math.max(settings.map.flyToOnGpsZoom, this.map.getZoom()),\r\n      usePan\r\n    );\r\n  }\r\n\r\n  private flyTo(latLng: L.LatLng, zoom: number, usePan = false) {\r\n    this.isDoingMoveAction = true;\r\n    // if (usePan) {\r\n    //   this.map.panTo(latLng);\r\n    // } else {\r\n    //   this.map.flyTo(latLng, zoom);\r\n    // }\r\n    // Note: Poor performance on flyTo effect, so using setView without animate instead.\r\n    this.map.setView(latLng, zoom, { animate: false });\r\n    this.isDoingMoveAction = false;\r\n  }\r\n}\r\n","<div *ngIf=\"loaded\" leaflet [leafletOptions]=\"options\" (leafletMapReady)=\"onLeafletMapReady($event)\">\r\n</div>\r\n<app-map-controls\r\n  [showMapSearch]=\"showMapSearch\"\r\n  [showFullscreenToggle]=\"showFullscreenToggle\"\r\n  [showGpsCenter]=\"showGpsCenter\"\r\n></app-map-controls>","import * as L from 'leaflet';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\n\r\nexport class RegobsGeoHazardMarker extends L.DivIcon {\r\n  private _selected: boolean;\r\n  private _geoHazard: GeoHazard;\r\n\r\n  constructor(geoHazard: GeoHazard, isSelected = false) {\r\n    super({\r\n      html: RegobsGeoHazardMarker.getIconSvg(geoHazard, isSelected),\r\n      className: 'obs-marker',\r\n      iconSize: [30, 40],\r\n      iconAnchor: [15, 40]\r\n    });\r\n    this._selected = isSelected;\r\n    this._geoHazard = geoHazard;\r\n  }\r\n\r\n  static getIconSvg(geoHazard: GeoHazard, isSelected: boolean) {\r\n    switch (geoHazard) {\r\n    case GeoHazard.Snow:\r\n      return this.getSnowSvg(isSelected);\r\n    case GeoHazard.Water:\r\n      return this.getWaterSvg(isSelected);\r\n    case GeoHazard.Soil:\r\n      return this.getDirtSvg(isSelected);\r\n    case GeoHazard.Ice:\r\n      return this.getIceSvg(isSelected);\r\n    default:\r\n      return '';\r\n    }\r\n  }\r\n\r\n  static getDirtSvg(isSelected: boolean) {\r\n    return `<svg width=\"44\" height=\"49\" viewBox=\"0 0 44 49\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <g filter=\"url(#filter0_f)\">\r\n        <ellipse cx=\"22.6509\" cy=\"30.7147\" rx=\"11.7128\" ry=\"5.55783\" transform=\"rotate(-22 22.6509 30.7147)\"\r\n        fill=\"#222222\" fill-opacity=\"0.5\"/>\r\n        </g>\r\n        <path d=\"M16.2064 36.6548L16.2167 36.6438L16.2264 36.6322C17.0774 35.6109 18.1068 34.2426 19.313 32.5314C20.5211\r\n        30.8176 21.7424 28.9786 22.977 27.0144C24.2251 25.0289 25.2879 22.9028 26.1659 20.637C27.0471 18.3628 27.5 16.3143\r\n        27.5 14.5C27.5 10.901 26.2317 7.82326 23.7042 5.29578C21.1767 2.76829 18.099 1.5 14.5 1.5C10.901 1.5 7.82326 2.76829\r\n        5.29578 5.29578C2.76829 7.82326 1.5 10.901 1.5 14.5C1.5 16.3162 1.96777 18.3934 2.87649 20.722C3.77997 23.0372 4.78458\r\n        25.1184 5.89172 26.9636C6.99252 28.7983 8.27499 30.6864 9.73828 32.6281C11.1911 34.5559 12.2079 35.8559 12.7804\r\n        36.5143C13.3394 37.1571 13.7859 37.6734 14.1204 38.0636L14.4826 38.4863L14.8641 38.0809L16.2064 36.6548Z\"\r\n        fill=\"white\" stroke=\"#6996A3\" ${isSelected ? 'stroke-width=\"2\"' : ''}/>\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M14.4393 8.97889L13.2781 8.36161V7.60109L13.5285 7.14778C13.5285\r\n        7.14778 13.3626 6.7814 13.6667 6.47276C13.9707 6.16412 14.4393 6.2233 14.4393 6.2233L15.5811 6.59498L16.0331\r\n        7.60109L15.5811 8.36161L14.4393 8.97889ZM9.21558 18.0642L11.7039 16.6533V14.915L11.1672 13.8789C11.1672 13.8789\r\n        11.5227 13.0414 10.8712 12.3359C10.2196 11.6305 9.21558 11.7657 9.21558 11.7657L6.76875 12.6153L5.80029\r\n        14.915L6.76875 16.6533L9.21558 18.0642ZM15.4051 13.4481L13.6964 14.114L12.2349 13.142C12.2349 13.142 11.9599\r\n        12.35 12.2349 11.5708C12.51 10.7917 13.2123 10.5891 13.6964 10.5891C13.8491 10.5891 13.9824 10.5799 14.1016\r\n        10.5716H14.1016C14.4851 10.545 14.7226 10.5285 14.9923 10.8625C15.3459 11.3003 15.6396 11.9625 15.6396\r\n        12.3516C15.6396 12.6999 15.4051 13.4481 15.4051 13.4481ZM18.9523 7.79359L21.2305 8.75553C21.2305 8.75553 21.5432\r\n        9.83629 21.5432 10.3394C21.5432 10.9014 21.1516 11.8578 20.6802 12.4902C20.3206 12.9726 20.0039 12.9488 19.4926\r\n        12.9104C19.3337 12.8985 19.1559 12.8851 18.9523 12.8851C18.3068 12.8851 17.3704 12.5926 17.0037 11.4671C16.637\r\n        10.3417 17.0037 9.19758 17.0037 9.19758L18.9523 7.79359ZM19.4509 21.8207L15.9016 23.1995L12.8284 21.8207L11.7039\r\n        18.52L13.409 17.3211C13.409 17.3211 13.8988 16.0489 14.5026 15.5251C15.1064 15.0014 16.6509 14.5091 16.6509\r\n        14.5091L19.7238 15.7208L21.1496 18.8961L19.9429 20.2002L19.4509 21.8207Z\" fill=\"#735E2F\"/>\r\n        <defs>\r\n        <filter id=\"filter0_f\" x=\"1.70898\" y=\"13.1738\" width=\"41.8838\" height=\"35.0816\" filterUnits=\"userSpaceOnUse\"\r\n        color-interpolation-filters=\"sRGB\">\r\n        <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\r\n        <feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"BackgroundImageFix\" result=\"shape\"/>\r\n        <feGaussianBlur stdDeviation=\"4\" result=\"effect1_foregroundBlur\"/>\r\n        </filter>\r\n        </defs>\r\n        </svg>\r\n        `;\r\n  }\r\n\r\n  static getIceSvg(isSelected: boolean) {\r\n    return `<svg width=\"44\" height=\"49\" viewBox=\"0 0 44 49\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <g filter=\"url(#filter0_f)\">\r\n        <ellipse cx=\"22.6509\" cy=\"30.7147\" rx=\"11.7128\" ry=\"5.55783\" transform=\"rotate(-22 22.6509 30.7147)\"\r\n        fill=\"#222222\" fill-opacity=\"0.5\"/>\r\n        </g>\r\n        <path d=\"M16.2064 36.6548L16.2167 36.6438L16.2264 36.6322C17.0774 35.6109 18.1068 34.2426 19.313 32.5314C20.5211\r\n        30.8176 21.7424 28.9786 22.977 27.0144C24.2251 25.0289 25.2879 22.9028 26.1659 20.637C27.0471 18.3628 27.5 16.3143\r\n        27.5 14.5C27.5 10.901 26.2317 7.82326 23.7042 5.29578C21.1767 2.76829 18.099 1.5 14.5 1.5C10.901 1.5 7.82326 2.76829\r\n        5.29578 5.29578C2.76829 7.82326 1.5 10.901 1.5 14.5C1.5 16.3162 1.96777 18.3934 2.87649 20.722C3.77997 23.0372\r\n        4.78458 25.1184 5.89172 26.9636C6.99252 28.7983 8.27499 30.6864 9.73828 32.6281C11.1911 34.5559 12.2079 35.8559\r\n        12.7804 36.5143C13.3394 37.1571 13.7859 37.6734 14.1204 38.0636L14.4826 38.4863L14.8641 38.0809L16.2064 36.6548Z\"\r\n        fill=\"white\" stroke=\"#6996A3\" ${isSelected ? 'stroke-width=\"2\"' : ''}/>\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M9.47844 15.9942L10.6624 10.906L12.3033 22.1253L13.8669\r\n        11.4343L16.0693 27.0301L18.3694 10.7425L19.8358 15.9942L21.7189\r\n        9.25H18.5801H17.9526H14.1864H13.5585H11.0477H10.4202H7.90918L9.47844 15.9942Z\" fill=\"#009FD4\"/>\r\n        <defs>\r\n        <filter id=\"filter0_f\" x=\"1.70898\" y=\"13.1738\" width=\"41.8838\" height=\"35.0816\" filterUnits=\"userSpaceOnUse\"\r\n        color-interpolation-filters=\"sRGB\">\r\n        <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\r\n        <feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"BackgroundImageFix\" result=\"shape\"/>\r\n        <feGaussianBlur stdDeviation=\"4\" result=\"effect1_foregroundBlur\"/>\r\n        </filter>\r\n        </defs>\r\n        </svg>\r\n        `;\r\n  }\r\n\r\n  static getWaterSvg(isSelected: boolean) {\r\n    return `<svg width=\"44\" height=\"49\" viewBox=\"0 0 44 49\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <g filter=\"url(#filter0_f)\">\r\n        <ellipse cx=\"22.6509\" cy=\"30.7147\" rx=\"11.7128\" ry=\"5.55783\" transform=\"rotate(-22 22.6509 30.7147)\"\r\n         fill=\"#222222\" fill-opacity=\"0.5\"/>\r\n        </g>\r\n        <path d=\"M16.2064 36.6548L16.2167 36.6438L16.2264 36.6322C17.0774 35.6109 18.1068 34.2426 19.313\r\n        32.5314C20.5211 30.8176 21.7424 28.9786 22.977 27.0144C24.2251 25.0289 25.2879 22.9028 26.1659 20.637C27.0471\r\n        18.3628 27.5 16.3143 27.5 14.5C27.5 10.901 26.2317 7.82326 23.7042 5.29578C21.1767 2.76829 18.099 1.5 14.5 1.5C10.901\r\n        1.5 7.82326 2.76829 5.29578 5.29578C2.76829 7.82326 1.5 10.901 1.5 14.5C1.5 16.3162 1.96777 18.3934 2.87649\r\n        20.722C3.77997 23.0372 4.78458 25.1184 5.89172 26.9636C6.99252 28.7983 8.27499 30.6864 9.73828 32.6281C11.1911\r\n        34.5559 12.2079 35.8559 12.7804 36.5143C13.3394 37.1571 13.7859 37.6734 14.1204 38.0636L14.4826 38.4863L14.8641\r\n        38.0809L16.2064 36.6548Z\" fill=\"white\" stroke=\"#6996A3\" ${\r\n  isSelected ? 'stroke-width=\"2\"' : ''\r\n}/>\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M21.8746 12.8977C21.8901 12.9116 21.9057 12.9257 21.9216\r\n        12.94C22.4737 13.435 23.2353 14.0483 24.4158 14.0483V12.1652C23.8256 12.1652 23.4353 11.8854 22.9688\r\n        11.4658C22.9505 11.4493 22.932 11.4328 22.9135 11.4161C22.3736 10.9307 21.7358 10.3574 20.4841 10.3574C19.1894\r\n        10.3574 18.5039 10.9708 17.9613 11.4658C17.5043 11.8854 17.1902 12.1652 16.4857 12.1652C15.7874 12.1652 15.482\r\n        11.8904 15.0225 11.4769L15.0101 11.4658C14.4674 10.9708 13.7915 10.3574 12.4968 10.3574C11.2116 10.3574 10.5262\r\n        10.9708 9.98352 11.4658C9.52656 11.8854 9.22192 12.1652 8.51744 12.1652C7.82826 12.1652 7.53085 11.8975 7.08151\r\n        11.4929C7.07154 11.4839 7.06149 11.4749 7.05137 11.4658C6.50873 10.9708 5.72809 10.3574 4.55713\r\n        10.3574V12.2405C5.13785 12.2405 5.54721 12.5203 6.01369 12.94C6.02002 12.9458 6.02638 12.9516 6.03275\r\n        12.9574C6.57176 13.4492 7.22833 14.0483 8.50792 14.0483C9.79312 14.0483 10.4786 13.435 11.0212 12.94L11.0336\r\n        12.9288C11.4931 12.5154 11.7986 12.2405 12.4968 12.2405C13.195 12.2405 13.5005 12.5154 13.96 12.9288L13.9724\r\n        12.94C14.515 13.435 15.191 14.0483 16.4857 14.0483C17.7627 14.0483 18.4382 13.4427 18.9884 12.9494L18.999\r\n        12.94C19.4559 12.5203 19.7606 12.2405 20.465 12.2405C21.1456 12.2405 21.4352 12.5016 21.8746 12.8977ZM21.9216\r\n        17.2901C22.4737 17.7851 23.2353 18.3985 24.4063 18.3985H24.4158V16.5153C23.8256 16.5153 23.4353 16.2356\r\n        22.9688 15.8159C22.9505 15.7995 22.932 15.7829 22.9135 15.7662C22.3736 15.2809 21.7358 14.7076 20.4841\r\n        14.7076C19.1894 14.7076 18.5039 15.3209 17.9613 15.8159C17.5043 16.2356 17.1902 16.5153 16.4857 16.5153C15.7874\r\n        16.5153 15.482 16.2405 15.0225 15.827L15.0101 15.8159C14.4674 15.3209 13.7915 14.7076 12.4968 14.7076C11.2116\r\n        14.7076 10.5262 15.3209 9.98352 15.8159C9.52656 16.2356 9.22192 16.5153 8.51744 16.5153C7.82826 16.5153 7.53085\r\n        16.2476 7.08151 15.843C7.07154 15.8341 7.06149 15.825 7.05137 15.8159C6.50873 15.3209 5.72809 14.7076 4.55713\r\n        14.7076V16.5907C5.13785 16.5907 5.54721 16.8704 6.01369 17.2901C6.02002 17.2959 6.02638 17.3017 6.03274\r\n        17.3075C6.57175 17.7993 7.22832 18.3985 8.50792 18.3985C9.79312 18.3985 10.4786 17.7851 11.0212 17.2901L11.0336\r\n        17.279C11.4931 16.8655 11.7986 16.5907 12.4968 16.5907C13.195 16.5907 13.5005 16.8655 13.96 17.279L13.9724\r\n        17.2901C14.515 17.7851 15.191 18.3985 16.4857 18.3985C17.7627 18.3985 18.4382 17.7929 18.9884 17.2996L18.999\r\n        17.2901C19.4559 16.8704 19.7606 16.5907 20.465 16.5907C21.1455 16.5907 21.4352 16.8517 21.8746 17.2478C21.8901\r\n        17.2617 21.9057 17.2758 21.9216 17.2901Z\" fill=\"#009FD4\"/>\r\n        <defs>\r\n        <filter id=\"filter0_f\" x=\"1.70898\" y=\"13.1738\" width=\"41.8838\" height=\"35.0816\" filterUnits=\"userSpaceOnUse\"\r\n        color-interpolation-filters=\"sRGB\">\r\n        <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\r\n        <feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"BackgroundImageFix\" result=\"shape\"/>\r\n        <feGaussianBlur stdDeviation=\"4\" result=\"effect1_foregroundBlur\"/>\r\n        </filter>\r\n        </defs>\r\n        </svg>\r\n        `;\r\n  }\r\n\r\n  static getSnowSvg(isSelected: boolean) {\r\n    return `<svg width=\"44\" height=\"49\" viewBox=\"0 0 44 49\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\r\n        <g filter=\"url(#filter0_f)\">\r\n        <ellipse cx=\"22.6509\" cy=\"30.7147\" rx=\"11.7128\" ry=\"5.55783\" transform=\"rotate(-22 22.6509 30.7147)\"\r\n        fill=\"#222222\" fill-opacity=\"0.5\"/>\r\n        </g>\r\n        <path d=\"M16.2064 36.6548L16.2167 36.6438L16.2264 36.6322C17.0774 35.6109 18.1068 34.2426 19.313 32.5314C20.5211\r\n        30.8176 21.7424 28.9786 22.977 27.0144C24.2251 25.0289 25.2879 22.9028 26.1659 20.637C27.0471 18.3628 27.5 16.3143\r\n        27.5 14.5C27.5 10.901 26.2317 7.82326 23.7042 5.29578C21.1767 2.76829 18.099 1.5 14.5 1.5C10.901 1.5 7.82326 2.76829\r\n        5.29578 5.29578C2.76829 7.82326 1.5 10.901 1.5 14.5C1.5 16.3162 1.96777 18.3934 2.87649 20.722C3.77997 23.0372\r\n        4.78458 25.1184 5.89172 26.9636C6.99252 28.7983 8.27499 30.6864 9.73828 32.6281C11.1911 34.5559 12.2079 35.8559\r\n        12.7804 36.5143C13.3394 37.1571 13.7859 37.6734 14.1204 38.0636L14.4826 38.4863L14.8641 38.0809L16.2064 36.6548Z\"\r\n        fill=\"white\" stroke=\"#6996A3\" ${isSelected ? 'stroke-width=\"2\"' : ''}/>\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M21.2733 16.4665L19.7322 16.7602L21.4486 17.7126C21.5901 17.7897\r\n        21.6809 17.9039 21.7209 18.0552C21.7609 18.2065 21.7409 18.3504 21.6609 18.4869C21.5748 18.6234 21.4548 18.7109\r\n        21.301 18.7495C21.1472 18.7881 20.9996 18.7688 20.8581 18.6916L19.1417 17.7482L19.6492 19.1723C19.7292 19.3978\r\n        19.6923 19.5861 19.5385 19.7375C19.3847 19.8888 19.1986 19.9496 18.9802 19.9199C18.7618 19.8903 18.6126 19.7656\r\n        18.5326 19.5461L17.5914 16.8759L15.0906 15.4874V18.2733L17.01 20.3917C17.1084 20.4985 17.1607 20.6142 17.1669\r\n        20.7388C17.173 20.8634 17.1392 20.9717 17.0654 21.0637C16.9915 21.1556 16.9039 21.2298 16.8024 21.2862C16.7009\r\n        21.3425 16.5871 21.3589 16.4609 21.3351C16.3348 21.3114 16.2226 21.2461 16.1241 21.1393L15.0906 20V21.9048C15.0906\r\n        22.0591 15.0321 22.1926 14.9153 22.3053C14.7984 22.418 14.66 22.4744 14.5 22.4744C14.34 22.4744 14.2016 22.418\r\n        14.0847 22.3053C13.9679 22.1926 13.9094 22.0591 13.9094 21.9048V20L12.8759 21.1393C12.7775 21.2461 12.6652 21.3114\r\n        12.5391 21.3351C12.4129 21.3589 12.2991 21.3425 12.1976 21.2862C12.0961 21.2298 12.0085 21.1556 11.9346\r\n        21.0637C11.8608 20.9717 11.827 20.8634 11.8331 20.7388C11.8393 20.6142 11.8916 20.4985 11.99 20.3917L13.9094\r\n        18.2733V15.4874L11.4086 16.8759L10.4674 19.5461C10.3874 19.7656 10.2382 19.8903 10.0198 19.9199C9.80144 19.9496\r\n        9.61534 19.8888 9.46154 19.7375C9.30774 19.5861 9.27083 19.3978 9.35081 19.1723L9.85835 17.7482L8.14195\r\n        18.6916C8.00045 18.7688 7.85281 18.7881 7.69901 18.7495C7.54521 18.7109 7.42524 18.6234 7.33912 18.4869C7.25914\r\n        18.3504 7.23915 18.2065 7.27913 18.0552C7.31912 17.9039 7.40986 17.7897 7.55136 17.7126L9.26776 16.7602L7.72669\r\n        16.4665C7.54828 16.4309 7.41909 16.3448 7.33912 16.2083C7.25914 16.0719 7.23299 15.9339 7.26068 15.7945C7.28836\r\n        15.655 7.3668 15.5363 7.49599 15.4384C7.62518 15.3405 7.77898 15.3094 7.95739 15.345L10.8181 15.8968L13.3188\r\n        14.4994L10.8181 13.102L7.95739 13.6539C7.93278 13.6598 7.89279 13.6628 7.83742 13.6628C7.67132 13.6628 7.53598\r\n        13.6093 7.4314 13.5025C7.32681 13.3957 7.26837 13.2771 7.25606 13.1465C7.24376 13.016 7.2776 12.8884 7.35757\r\n        12.7638C7.43755 12.6392 7.56059 12.562 7.72669 12.5324L9.26776 12.2386L7.55136 11.2863C7.40986 11.2091 7.31912\r\n        11.0949 7.27913 10.9436C7.23915 10.7923 7.25914 10.6484 7.33912 10.5119C7.41909 10.3754 7.53905 10.2864 7.69901\r\n        10.2449C7.85896 10.2034 8.0066 10.2241 8.14195 10.3072L9.85835 11.2507L9.35081 9.82656C9.27083 9.60108 9.30774\r\n        9.41268 9.46154 9.26137C9.61534 9.11006 9.80144 9.04924 10.0198 9.07891C10.2382 9.10858 10.3874 9.23318 10.4674\r\n        9.45273L11.4086 12.1229L13.9094 13.5114V10.7255L11.99 8.60717C11.8916 8.50036 11.8393 8.38465 11.8331\r\n        8.26005C11.827 8.13543 11.8608 8.02714 11.9346 7.93517C12.0085 7.8432 12.0961 7.76902 12.1976 7.71265C12.2991\r\n        7.65628 12.4129 7.63997 12.5391 7.6637C12.6652 7.68743 12.7775 7.75271 12.8759 7.85951L13.9094 8.9988V7.09406C13.9094\r\n        6.93978 13.9679 6.80627 14.0847 6.69353C14.2016 6.58079 14.34 6.52441 14.5 6.52441C14.66 6.52441 14.7984 6.58079\r\n        14.9153 6.69353C15.0321 6.80627 15.0906 6.93978 15.0906 7.09406V8.9988L16.1241 7.85951C16.2226 7.75271\r\n        16.3348 7.68743 16.4609 7.6637C16.5871 7.63997 16.7009 7.65628 16.8024 7.71265C16.9039 7.76902 16.9915\r\n        7.8432 17.0654 7.93517C17.1392 8.02714 17.173 8.13543 17.1669 8.26005C17.1607 8.38465 17.1084 8.50036\r\n        17.01 8.60717L15.0906 10.7255V13.5114L17.5914 12.1229L18.5326 9.45273C18.6126 9.23318 18.7618 9.10858\r\n        18.9802 9.07891C19.1986 9.04924 19.3847 9.11006 19.5385 9.26137C19.6923 9.41268 19.7292 9.60108 19.6492\r\n        9.82656L19.1417 11.2507L20.8581 10.3072C20.9996 10.2301 21.1472 10.2108 21.301 10.2493C21.4548 10.2879\r\n        21.5748 10.3754 21.6609 10.5119C21.7409 10.6484 21.7609 10.7923 21.7209 10.9436C21.6809 11.0949 21.5901\r\n        11.2091 21.4486 11.2863L19.7322 12.2386L21.2733 12.5324C21.4394 12.562 21.5625 12.6392 21.6424 12.7638C21.7224\r\n        12.8884 21.7562 13.016 21.7439 13.1465C21.7316 13.2771 21.6732 13.3957 21.5686 13.5025C21.464 13.6093 21.3287\r\n        13.6628 21.1626 13.6628C21.1072 13.6628 21.0672 13.6598 21.0426 13.6539L18.1819 13.102L15.6812 14.4994L18.1819\r\n        15.8968L21.0426 15.345C21.221 15.3094 21.3748 15.3405 21.504 15.4384C21.6332 15.5363 21.7116 15.655 21.7393\r\n        15.7945C21.767 15.9339 21.7409 16.0719 21.6609 16.2083C21.5809 16.3448 21.4517 16.4309 21.2733 16.4665Z\"\r\n        fill=\"#009FD4\"/>\r\n        <defs>\r\n        <filter id=\"filter0_f\" x=\"1.70898\" y=\"13.1738\" width=\"41.8838\" height=\"35.0816\" filterUnits=\"userSpaceOnUse\"\r\n        color-interpolation-filters=\"sRGB\">\r\n        <feFlood flood-opacity=\"0\" result=\"BackgroundImageFix\"/>\r\n        <feBlend mode=\"normal\" in=\"SourceGraphic\" in2=\"BackgroundImageFix\" result=\"shape\"/>\r\n        <feGaussianBlur stdDeviation=\"4\" result=\"effect1_foregroundBlur\"/>\r\n        </filter>\r\n        </defs>\r\n        </svg>\r\n        `;\r\n  }\r\n\r\n  redraw() {\r\n    this.options.html = RegobsGeoHazardMarker.getIconSvg(\r\n      this._geoHazard,\r\n      this._selected\r\n    );\r\n  }\r\n\r\n  setGeoHazard(geoHazard: GeoHazard) {\r\n    this._geoHazard = geoHazard;\r\n    this.redraw();\r\n  }\r\n\r\n  setSelected(selected: boolean) {\r\n    this._selected = selected;\r\n    this.redraw();\r\n  }\r\n}\r\n","import * as L from 'leaflet';\r\nimport { BorderHelper } from '../../../../core/helpers/leaflet/border-helper';\r\nimport { Feature, GeometryObject } from '@turf/turf';\r\nimport { OfflineTilesRegistry } from 'src/app/core/services/offline-map/offline-tiles-registry';\r\nimport { LoggingService } from 'src/app/modules/shared/services/logging/logging.service';\r\n\r\nconst DEBUG_TAG = 'RegObsOfflineAwareTileLayer';\r\n\r\nexport interface IRegObsTileLayerOptions extends L.TileLayerOptions {\r\n  edgeBufferTiles?: number;\r\n  excludeBounds?: Feature<GeometryObject>;\r\n}\r\n\r\nexport class RegObsTileLayer extends L.TileLayer {\r\n\r\n  constructor(\r\n    url: string,\r\n    options: IRegObsTileLayerOptions\r\n  ) {\r\n    super(url, options);\r\n  }\r\n\r\n  _isValidTile(coords: L.Coords) {\r\n    const valid = (<any>L.GridLayer.prototype)._isValidTile.call(this, coords);\r\n    if (!valid) {\r\n      return false;\r\n    }\r\n    if ((<IRegObsTileLayerOptions>this.options).excludeBounds) {\r\n      const tileBounds = (<any>L.GridLayer.prototype)._tileCoordsToBounds.call(\r\n        this,\r\n        coords\r\n      );\r\n      return !BorderHelper.isInside(\r\n        tileBounds,\r\n        (<IRegObsTileLayerOptions>this.options).excludeBounds\r\n      );\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\nexport class RegObsOfflineAwareTileLayer extends RegObsTileLayer {\r\n  constructor(\r\n    private mapType: string,\r\n    url: string,\r\n    options: IRegObsTileLayerOptions,\r\n    private offlineTilesRegistry: OfflineTilesRegistry,\r\n    private loggingService: LoggingService\r\n  ) {\r\n    super(url, options);\r\n  }\r\n\r\n  canUseOfflineTiles(coords: L.Coords) {\r\n    const offlineTiles = this.offlineTilesRegistry.findRegisteredPackage(this.mapType, coords.x, coords.y, coords.z);\r\n    if (offlineTiles != null) {\r\n      if (offlineTiles.zMin <= coords.z && coords.z <= offlineTiles.zMax) {\r\n        return true;\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n  _isValidTile(coords: L.Coords) {\r\n    const valid = super._isValidTile(coords);\r\n    if (valid && this.canUseOfflineTiles(coords)) {\r\n      this.loggingService.debug(`Using offline tiles for ${this.mapType} - ${coords.x},${coords.y},${coords.z}`, DEBUG_TAG);\r\n      return false;\r\n    }\r\n    return valid;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { MapComponent } from './components/map/map.component';\r\nimport { LeafletModule } from '@asymmetrik/ngx-leaflet';\r\nimport { MapControlsComponent } from './components/map-controls/map-controls.component';\r\nimport { MapSearchComponent } from './components/map-controls/map-search/map-search.component';\r\nimport { FullscreenToggleComponent } from './components/map-controls/fullscreen-toggle/fullscreen-toggle.component';\r\nimport { GpsCenterComponent } from './components/map-controls/gps-center/gps-center.component';\r\nimport { MapCenterInfoComponent } from './components/map-center-info/map-center-info.component';\r\nimport { ModalSearchPageModule } from './pages/modal-search/modal-search.module';\r\nimport { LeafletEdgeBufferModule } from 'ngx-leaflet-edgebuffer';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { AngularSvgIconModule } from 'angular-svg-icon';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { RouterModule } from '@angular/router';\r\nimport { ModalMapImagePageModule } from './pages/modal-map-image/modal-map-image.module';\r\nimport { SupportMapInfoPageModule } from './pages/support-map-info/support-map-info.module';\r\nimport { MapImageModule } from '../map-image/map-image.module';\r\nimport { SharedModule } from '../shared/shared.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    AngularSvgIconModule,\r\n    TranslateModule,\r\n    RouterModule,\r\n    LeafletModule,\r\n    LeafletEdgeBufferModule,\r\n    ModalSearchPageModule,\r\n    ModalMapImagePageModule,\r\n    SupportMapInfoPageModule,\r\n    MapImageModule,\r\n    SharedModule\r\n  ],\r\n  declarations: [\r\n    MapComponent,\r\n    MapControlsComponent,\r\n    MapSearchComponent,\r\n    FullscreenToggleComponent,\r\n    GpsCenterComponent,\r\n    MapCenterInfoComponent\r\n  ],\r\n  exports: [\r\n    MapComponent,\r\n    MapControlsComponent,\r\n    MapSearchComponent,\r\n    FullscreenToggleComponent,\r\n    GpsCenterComponent,\r\n    MapCenterInfoComponent,\r\n    ModalSearchPageModule,\r\n    ModalMapImagePageModule,\r\n    SupportMapInfoPageModule\r\n  ]\r\n})\r\nexport class MapModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { ModalMapImagePage } from './modal-map-image.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { LeafletModule } from '@asymmetrik/ngx-leaflet';\r\nimport { MapImageModule } from '../../../map-image/map-image.module';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    LeafletModule,\r\n    MapImageModule\r\n  ],\r\n  declarations: [ModalMapImagePage],\r\n  entryComponents: [ModalMapImagePage]\r\n})\r\nexport class ModalMapImagePageModule {}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-modal-map-image',\r\n  templateUrl: './modal-map-image.page.html',\r\n  styleUrls: ['./modal-map-image.page.scss']\r\n})\r\nexport class ModalMapImagePage implements OnInit {\r\n  @Input() location: { latLng: L.LatLng; geoHazard: GeoHazard };\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  close() {\r\n    this.modalController.dismiss();\r\n  }\r\n}\r\n","<ion-content (click)=\"close()\">\r\n  <app-map-image [location]=\"location\" [allowZoom]=\"true\"></app-map-image>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { ModalSearchPage } from './modal-search.page';\r\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { StartsWithHighlightPipe } from '../../pipes/starts-with-highlight.pipe';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    TranslateModule\r\n  ],\r\n  declarations: [ModalSearchPage, StartsWithHighlightPipe],\r\n  entryComponents: [ModalSearchPage]\r\n})\r\nexport class ModalSearchPageModule {}\r\n","import { Component, OnInit, NgZone, Renderer2, OnDestroy } from '@angular/core';\r\nimport { ModalController, IonInput, DomController } from '@ionic/angular';\r\nimport { MapSearchService } from '../../services/map-search/map-search.service';\r\nimport { Observable } from 'rxjs';\r\nimport { MapSearchResponse } from '../../services/map-search/map-search-response.model';\r\nimport { FormControl } from '@angular/forms';\r\nimport {\r\n  debounceTime,\r\n  distinctUntilChanged,\r\n  switchMap,\r\n  tap\r\n} from 'rxjs/operators';\r\nimport * as L from 'leaflet';\r\nimport { NumberHelper } from '../../../../core/helpers/number-helper';\r\nimport { createGesture, GestureDetail, Gesture } from '@ionic/core';\r\n\r\nconst SWIPE_BOUNDRY = 0.3; // More than 30% swipe to right will close modal\r\n\r\n@Component({\r\n  selector: 'app-modal-search',\r\n  templateUrl: './modal-search.page.html',\r\n  styleUrls: ['./modal-search.page.scss']\r\n})\r\nexport class ModalSearchPage implements OnInit, OnDestroy {\r\n  searchText: string;\r\n  searchResult$: Observable<MapSearchResponse[]>;\r\n  searchField: FormControl;\r\n  loading: boolean;\r\n  hasResults: boolean;\r\n  searchHistory$: Observable<MapSearchResponse[]>;\r\n\r\n  private modalPageWrapper: Element;\r\n  private modalTop: HTMLIonModalElement;\r\n  private swipeOffset = 0;\r\n  private swipePercentage = 0;\r\n  private gesture: Gesture;\r\n\r\n  constructor(\r\n    private modalController: ModalController,\r\n    private mapSearchService: MapSearchService,\r\n    private ngZone: NgZone,\r\n    private renderer: Renderer2,\r\n    private domCtrl: DomController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.searchField = new FormControl();\r\n    this.searchHistory$ = this.mapSearchService.getSearchHistoryAsObservable();\r\n    const searchTextObservable = this.searchField.valueChanges.pipe(\r\n      debounceTime(400),\r\n      distinctUntilChanged()\r\n    );\r\n\r\n    this.searchResult$ = searchTextObservable.pipe(\r\n      tap((val) => {\r\n        this.ngZone.run(() => {\r\n          this.loading = true;\r\n          this.hasResults = false;\r\n          this.searchText = val;\r\n        });\r\n      }),\r\n      switchMap((searchValue: string) =>\r\n        this.mapSearchService.searchAll(searchValue)\r\n      ),\r\n      tap((values) => {\r\n        this.ngZone.run(() => {\r\n          this.hasResults = values.length > 0;\r\n          this.loading = false;\r\n        });\r\n      })\r\n    );\r\n\r\n    this.createGesture();\r\n  }\r\n\r\n  doSearch() {\r\n    const validLatLng = this.isValidLatLng(this.searchText);\r\n    if (validLatLng) {\r\n      this.mapSearchService.mapSearchItemSelected = validLatLng;\r\n      this.closeModal();\r\n    }\r\n  }\r\n\r\n  private async createGesture() {\r\n    this.modalTop = await this.modalController.getTop();\r\n    this.gesture = createGesture({\r\n      el: this.modalTop,\r\n      gestureName: 'swipe-to-close',\r\n      direction: 'x',\r\n      disableScroll: true,\r\n      onMove: (ev) => this.onMoveHandler(ev),\r\n      onEnd: (ev) => this.onPanend()\r\n    });\r\n\r\n    this.gesture.enable();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.gesture.destroy();\r\n  }\r\n\r\n  isValidLatLng(searchValue: string) {\r\n    if (searchValue && searchValue.length > 0) {\r\n      const separators = [',', ' '];\r\n      for (const sep of separators) {\r\n        const isValidLatLng = this.isValidLatLngArray(searchValue.split(sep));\r\n        if (isValidLatLng) {\r\n          return isValidLatLng;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  isValidLatLngArray(searchValue: string[]) {\r\n    if (searchValue && searchValue.length === 2) {\r\n      const trimmedLatString = this.trimAndReplaceString(searchValue[0]);\r\n      const trimmedLngString = this.trimAndReplaceString(searchValue[1]);\r\n      if (\r\n        trimmedLatString &&\r\n        trimmedLatString.length > 0 &&\r\n        trimmedLngString &&\r\n        trimmedLngString.length > 0 &&\r\n        NumberHelper.isNumeric(trimmedLatString) &&\r\n        NumberHelper.isNumeric(trimmedLngString)\r\n      ) {\r\n        const lat = parseFloat(trimmedLatString);\r\n        const lng = parseFloat(trimmedLngString);\r\n        if (lat > -90 && lat < 90 && lng > -180 && lng < 180) {\r\n          return L.latLng(lat, lng);\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  private trimAndReplaceString(input: string) {\r\n    if (input === undefined || input === null) {\r\n      return input;\r\n    }\r\n    return input.trim().replace(/,/g, '.');\r\n  }\r\n\r\n  focusInput(event: Event) {\r\n    const input: IonInput = <any>event.target;\r\n    setTimeout(() => {\r\n      (<any>input).setFocus();\r\n    }, 1000);\r\n  }\r\n\r\n  closeModal() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  searchItemClicked(item: MapSearchResponse) {\r\n    this.mapSearchService.mapSearchItemSelected = item;\r\n    this.closeModal();\r\n  }\r\n\r\n  onMoveHandler(ev: GestureDetail): boolean | void {\r\n    const width = this.modalTop.offsetWidth;\r\n    if (width > 0) {\r\n      this.swipeOffset = Math.max(ev.deltaX, 0);\r\n      this.swipePercentage = this.swipeOffset / width;\r\n      if (this.swipePercentage < SWIPE_BOUNDRY) {\r\n        this.setPageSwipeAttributes();\r\n      } else {\r\n        this.closeModal();\r\n      }\r\n    }\r\n  }\r\n\r\n  setPageSwipeAttributes() {\r\n    if (this.modalTop) {\r\n      this.domCtrl.write(() => {\r\n        const opacity = 1.0 - this.swipePercentage;\r\n        this.renderer.setAttribute(\r\n          this.modalTop,\r\n          'data-offset-x',\r\n          this.swipeOffset.toString()\r\n        );\r\n        this.renderer.setAttribute(this.modalTop, 'data-opacity', `${opacity}`);\r\n        this.renderer.setStyle(\r\n          this.modalTop,\r\n          'transform',\r\n          `translateX(${this.swipeOffset}px)`\r\n        );\r\n        this.renderer.setStyle(this.modalTop, 'opacity', `${opacity}`);\r\n      });\r\n    }\r\n  }\r\n\r\n  onPanend() {\r\n    if (this.swipePercentage < SWIPE_BOUNDRY) {\r\n      this.swipeOffset = 0;\r\n      this.swipePercentage = 0;\r\n      this.setPageSwipeAttributes();\r\n    }\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar mode=\"ios\">\r\n    <form (ngSubmit)=\"doSearch()\">\r\n      <ion-list lines=\"none\" class=\"ion-no-padding ion-no-margin\">\r\n        <ion-item>\r\n          <ion-icon slot=\"start\" name=\"search\"></ion-icon>\r\n          <ion-input placeholder=\"{{'MAP_SEARCH.SEARCH_TEXT'|translate}}\" [formControl]=\"searchField\"\r\n            (ionInputDidLoad)=\"focusInput($event)\" (ionBlur)=\"doSearch()\"></ion-input>\r\n          <ion-icon slot=\"end\" name=\"close\" (click)=\"closeModal()\"></ion-icon>\r\n        </ion-item>\r\n      </ion-list>\r\n    </form>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <ion-list *ngIf=\"searchResult$ | async as searchResults\" lines=\"full\" class=\"search-result\">\r\n    <ion-item *ngFor=\"let item of searchResults\" (click)=\"searchItemClicked(item)\">\r\n      <ion-label>\r\n        <ion-text class=\"search-result-name\" [innerHTML]=\"item.name | startsWithHighlight:searchText\"></ion-text>\r\n        <ion-text color=\"medium\" class=\"search-description\">{{item.description}}</ion-text>\r\n      </ion-label>\r\n    </ion-item>\r\n  </ion-list>\r\n  <ng-container *ngIf=\"searchHistory$ | async as searchHistory\">\r\n    <ion-list *ngIf=\"!hasResults && !loading && searchHistory.length > 0\" lines=\"full\" class=\"search-result\">\r\n      <ion-list-header class=\"ion-text-uppercase\">\r\n        <ion-label>{{'MAP_SEARCH.SEARCH_HISTORY_HEADER' | translate}}</ion-label>\r\n      </ion-list-header>\r\n      <ion-item *ngFor=\"let item of searchHistory\" (click)=\"searchItemClicked(item)\">\r\n        <ion-icon slot=\"start\" mode=\"md\" name=\"time\"></ion-icon>\r\n        <ion-label>\r\n          <ion-text class=\"search-result-name\">{{item.name}}</ion-text>\r\n          <ion-text color=\"medium\" class=\"search-description\">{{item.description}}</ion-text>\r\n        </ion-label>\r\n      </ion-item>\r\n    </ion-list>\r\n  </ng-container>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { SupportMapInfoPage } from './support-map-info.page';\r\nimport { SharedModule } from '../../../shared/shared.module';\r\n\r\n@NgModule({\r\n  imports: [SharedModule],\r\n  declarations: [SupportMapInfoPage],\r\n  entryComponents: [SupportMapInfoPage],\r\n  exports: [SupportMapInfoPage]\r\n})\r\nexport class SupportMapInfoPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-support-map-info',\r\n  templateUrl: './support-map-info.page.html',\r\n  styleUrls: ['./support-map-info.page.scss']\r\n})\r\nexport class SupportMapInfoPage implements OnInit {\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  close() {\r\n    this.modalController.dismiss();\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"close()\">{{ 'DIALOGS.OK' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ 'SUPPORT_MAP.ABOUT' | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content class=\"ion-padding\" [innerHTML]=\"'SUPPORT_MAP.INFO_PAGE' | translate\">\r\n\r\n</ion-content>","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer, SafeHtml } from '@angular/platform-browser';\r\n\r\n@Pipe({\r\n  name: 'startsWithHighlight'\r\n})\r\nexport class StartsWithHighlightPipe implements PipeTransform {\r\n  constructor(private sanitizer: DomSanitizer) {}\r\n\r\n  transform(value: string, args?: string): SafeHtml {\r\n    const result = args\r\n      ? value.replace(new RegExp('(' + args + ')', 'gi'), '<strong>$1</strong>')\r\n      : value;\r\n    return this.sanitizer.bypassSecurityTrustHtml(result);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { settings } from '../../../../../settings';\r\nimport { MapSearchResponse } from './map-search-response.model';\r\nimport * as L from 'leaflet';\r\nimport { map, switchMap, catchError, take } from 'rxjs/operators';\r\nimport { Observable, forkJoin, of, Subject } from 'rxjs';\r\nimport { ViewInfo } from './view-info.model';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { LangKey, GeoHazard } from '@varsom-regobs-common/core';\r\nimport { GeoCodeService } from '@varsom-regobs-common/regobs-api';\r\nimport { NanoSql } from '../../../../../nanosql';\r\nimport { MapSearchHistory } from './map-search-history.model';\r\nimport moment from 'moment';\r\nimport { IMapView } from '../map/map-view.interface';\r\nimport { Navn, ReturSkrivemate } from './norwegian-search-result.model';\r\nimport { WorldSearchResultModel } from './world-search-result.model';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { NSqlFullUpdateObservable } from '../../../../core/helpers/nano-sql/NSqlFullUpdateObservable';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MapSearchService {\r\n  private _mapSearchItemClickSubject: Subject<MapSearchResponse | L.LatLng>;\r\n  private _mapSearchItemClickObservable: Observable<MapSearchResponse | L.LatLng>;\r\n\r\n  get mapSearchClick$(): Observable<MapSearchResponse | L.LatLng> {\r\n    return this._mapSearchItemClickObservable;\r\n  }\r\n\r\n  set mapSearchItemSelected(item: MapSearchResponse | L.LatLng) {\r\n    this._mapSearchItemClickSubject.next(item);\r\n  }\r\n\r\n  constructor(\r\n    private httpClient: HttpClient,\r\n    private userSettingService: UserSettingService,\r\n    private geoCodeService: GeoCodeService\r\n  ) {\r\n    this._mapSearchItemClickSubject = new Subject<\r\n      MapSearchResponse | L.LatLng\r\n    >();\r\n    this._mapSearchItemClickObservable = this._mapSearchItemClickSubject.asObservable();\r\n    this._mapSearchItemClickObservable.subscribe((item) => {\r\n      if (!(item instanceof L.LatLng)) {\r\n        this.saveSearchHistoryToDb(item as MapSearchResponse);\r\n      }\r\n    });\r\n  }\r\n\r\n  searchAll(text: string): Observable<MapSearchResponse[]> {\r\n    return this.userSettingService.language$.pipe(\r\n      switchMap((language) =>\r\n        forkJoin([\r\n          this.searchNorwegianPlaces(text, language),\r\n          this.searchWorld(text, language)\r\n        ]).pipe(map(([s1, s2]) => [...s1, ...s2]))\r\n      )\r\n    );\r\n  }\r\n\r\n  searchNorwegianPlaces(\r\n    text: string,\r\n    lang: LangKey\r\n  ): Observable<MapSearchResponse[]> {\r\n    return this.httpClient\r\n      .get(\r\n        `${settings.map.search.no.url}?sok=${text.trim()}*&treffPerSide=${settings.map.search.no.maxResults}`\r\n        + `&utkoordsys=${settings.map.search.no.coordinateSystem}&filtrer=${settings.map.search.no.resultFields}`\r\n      )\r\n      .pipe(\r\n        map((returSted: ReturSkrivemate) => {\r\n          const hits = returSted.metadata.totaltAntallTreff;\r\n          const resultList =\r\n            hits === 0\r\n              ? []\r\n              : hits === 1\r\n                ? [returSted.navn[0] as Navn]\r\n                : (returSted.navn as Array<Navn>);\r\n\r\n          return this.removeDuplicates(resultList).map((item) => {\r\n            const resp: MapSearchResponse = {\r\n              name: item.skrivemåte,\r\n              description: this.formatLocationDescription(item, lang),\r\n              type: item.navneobjekttype,\r\n              latlng: L.latLng(item.representasjonspunkt.nord, item.representasjonspunkt.øst)\r\n            };\r\n            return resp;\r\n          });\r\n        }),\r\n        catchError(() => of([]))\r\n      );\r\n  }\r\n\r\n  formatLocationDescription(item: Navn, lang: LangKey): string {\r\n    const nameType = item.navneobjekttype;\r\n    const norwegian = lang === LangKey.nb || lang === LangKey.nn;\r\n    const county = item.fylker[0]?.fylkesnavn;\r\n    if (item.kommuner.length !== 1 || nameType === 'Kommune') {\r\n      if (norwegian) {\r\n        return `${nameType}, ${county}`;\r\n      }\r\n      return county;\r\n    }\r\n    if (item.fylker.length !== 1 || nameType === 'Fylke') {\r\n      if (norwegian) {\r\n        return `${nameType}`;\r\n      }\r\n      return '';\r\n    }\r\n    const municipality = item.kommuner[0]?.kommunenavn;\r\n    if (norwegian) {\r\n      return `${nameType}, ${municipality} (${county})`;\r\n    }\r\n    return `${municipality} (${county})`;\r\n  }\r\n\r\n  private removeDuplicates(data: Navn[]): Navn[] {\r\n    return (data || []).reduce((acc, currentValue) => {\r\n      if (\r\n        acc.filter((item) => item.stedsnummer === currentValue.stedsnummer)\r\n          .length === 0\r\n      ) {\r\n        acc.push(currentValue);\r\n      }\r\n      return acc;\r\n    }, []);\r\n  }\r\n\r\n  searchWorld(text: string, lang: LangKey): Observable<MapSearchResponse[]> {\r\n    return this.httpClient\r\n      .get(\r\n        `${settings.map.search.geonames.url}/searchJSON?` +\r\n          `name_startsWith=${text}&maxRows=${settings.map.search.geonames.maxResults}` +\r\n          `&lang=${LangKey[lang]}` +\r\n          `&username=${settings.map.search.geonames.username}`\r\n      )\r\n      .pipe(\r\n        map((data: WorldSearchResultModel) => {\r\n          const geoData = data.geonames || [];\r\n          return geoData\r\n            .filter((item) => item.countryCode !== 'NO')\r\n            .map((item) => {\r\n              const resp: MapSearchResponse = {\r\n                name: item.name,\r\n                description:\r\n                  (item.fcodeName ? item.fcodeName + ', ' : '') +\r\n                  (item.adminName1 || '') +\r\n                  (item.countryName ? ' (' + item.countryName + ')' : ''),\r\n                type: '',\r\n                latlng: L.latLng(parseFloat(item.lat), parseFloat(item.lng))\r\n              };\r\n              return resp;\r\n            });\r\n        }),\r\n        catchError(() => of([]))\r\n      );\r\n  }\r\n\r\n  getViewInfo(\r\n    mapView: IMapView,\r\n    geoHazard = GeoHazard.Soil\r\n  ): Observable<ViewInfo> {\r\n    const latLng = mapView.center;\r\n    return this.geoCodeService\r\n      .GeoCodeLocationInfo({\r\n        latitude: latLng.lat,\r\n        longitude: latLng.lng,\r\n        geoHazardId: geoHazard\r\n      })\r\n      .pipe(\r\n        map((result) => ({\r\n          location: {\r\n            name: result.Name,\r\n            adminName: result.WarningRegionName || result.AdminAreaName\r\n          },\r\n          elevation: result.Masl,\r\n          steepness: result.Steepness,\r\n          latLng: latLng\r\n        })),\r\n        catchError(() => of(null))\r\n      );\r\n  }\r\n\r\n  private async saveSearchHistoryToDb(searchResult: MapSearchResponse) {\r\n    const existingHistory = (\r\n      await this.getSearchHistoryAsObservable().pipe(take(1)).toPromise()\r\n    ).filter(\r\n      (item) =>\r\n        !(\r\n          item.latlng.lat === searchResult.latlng.lat &&\r\n          item.latlng.lng === searchResult.latlng.lng\r\n        )\r\n    );\r\n    existingHistory.splice(0, 0, {\r\n      timestamp: moment().unix(),\r\n      ...searchResult\r\n    }); // Insert new search item at index 0\r\n    const items = existingHistory.slice(\r\n      0,\r\n      settings.map.search.searchHistorySize\r\n    ); // Keep only last 5 items\r\n    await nSQL(NanoSql.TABLES.MAP_SEARCH_HISTORY.name)\r\n      .query('upsert', { id: 'searchresults', items })\r\n      .exec();\r\n  }\r\n\r\n  getSearchHistoryAsObservable(): Observable<MapSearchHistory[]> {\r\n    return new NSqlFullUpdateObservable<\r\n      { id: string; items: MapSearchHistory[] }[]\r\n    >(\r\n      nSQL(NanoSql.TABLES.MAP_SEARCH_HISTORY.name).query('select').listen()\r\n    ).pipe(map((val) => (val.length > 0 ? val[0].items : [])));\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { IMapView } from './map-view.interface';\r\nimport { Observable, combineLatest, BehaviorSubject, Subject, of, concat } from 'rxjs';\r\nimport {\r\n  switchMap,\r\n  shareReplay,\r\n  debounceTime,\r\n  distinctUntilChanged,\r\n  tap,\r\n  pairwise,\r\n  map,\r\n  bufferWhen,\r\n  scan,\r\n  skipWhile,\r\n  take,\r\n  filter\r\n} from 'rxjs/operators';\r\nimport { IMapViewAndArea } from './map-view-and-area.interface';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { LoggingService } from '../../../shared/services/logging/logging.service';\r\nimport { fromWorker } from 'observable-webworker';\r\nimport {\r\n  IRegionInViewInput,\r\n  IRegionInViewOutput\r\n} from '../../web-workers/region-in-view-models';\r\n\r\nconst DEBUG_TAG = 'MapService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class MapService {\r\n  private _mapViewAndAreaObservable: Observable<IMapViewAndArea>;\r\n  private _followModeSubject: BehaviorSubject<boolean>;\r\n  private _followModeObservable: Observable<boolean>;\r\n  private _centerMapToUserSubject: Subject<void>;\r\n  private _centerMapToUserObservable: Observable<void>;\r\n  private _mapViewSubject: Subject<IMapView>;\r\n  private _mapView$: Observable<IMapView>;\r\n  private _mapMoveStartSubject: any;\r\n  private _mapMoveStart$: Observable<IMapView>;\r\n  private _relevantMapChange$: Observable<IMapView>;\r\n\r\n  get mapView$(): Observable<IMapView> {\r\n    return this._mapView$;\r\n  }\r\n\r\n  get mapViewAndAreaObservable$(): Observable<IMapViewAndArea> {\r\n    return this._mapViewAndAreaObservable;\r\n  }\r\n\r\n  get relevantMapChange$(): Observable<IMapView> {\r\n    return this._relevantMapChange$;\r\n  }\r\n\r\n  get mapMoveStart$(): Observable<IMapView> {\r\n    return this._mapMoveStart$;\r\n  }\r\n\r\n  /**\r\n   * @return as relevantMapChange$, but starts with current mapView\r\n   */\r\n  get relevantMapChangeWithInitialView$(): Observable<IMapView> {\r\n    return concat(\r\n      this._mapView$.pipe(\r\n        filter((mapView) => mapView !== null),\r\n        take(1)\r\n      ),\r\n      this._relevantMapChange$\r\n    );\r\n  }\r\n\r\n  get followMode$(): Observable<boolean> {\r\n    return this._followModeObservable;\r\n  }\r\n\r\n  get centerMapToUser$(): Observable<void> {\r\n    return this._centerMapToUserObservable;\r\n  }\r\n\r\n  set followMode(val: boolean) {\r\n    this._followModeSubject.next(val);\r\n  }\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private loggingService: LoggingService\r\n  ) {\r\n    this._followModeSubject = new BehaviorSubject<boolean>(true);\r\n    this._followModeObservable = this._followModeSubject\r\n      .asObservable()\r\n      .pipe(distinctUntilChanged(), shareReplay(1));\r\n    this._centerMapToUserSubject = new Subject<void>();\r\n    this._centerMapToUserObservable = this._centerMapToUserSubject\r\n      .asObservable()\r\n      .pipe(shareReplay(1));\r\n    this._mapViewSubject = new BehaviorSubject<IMapView>(null);\r\n    this._mapView$ = this._mapViewSubject.asObservable().pipe(\r\n      debounceTime(200),\r\n      tap((val) =>\r\n        this.loggingService.debug('MapView updated', DEBUG_TAG, val)\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n    this._relevantMapChange$ = this.getMapViewThatHasRelevantChange();\r\n    this._mapMoveStartSubject = new BehaviorSubject<void>(null);\r\n    this._mapMoveStart$ = this._mapMoveStartSubject.asObservable();\r\n    this._mapViewAndAreaObservable = this.getMapViewAreaObservable();\r\n  }\r\n\r\n  centerMapToUser(): void {\r\n    this.followMode = true;\r\n    this._centerMapToUserSubject.next();\r\n  }\r\n\r\n  updateMapView(mapView: IMapView): void {\r\n    if (mapView) {\r\n      this._mapViewSubject.next(mapView);\r\n    }\r\n  }\r\n\r\n  sendMapMoveStart(): void {\r\n    this._mapMoveStartSubject.next(null);\r\n  }\r\n\r\n  private getMapMetersChanged() {\r\n    return this.mapView$.pipe(\r\n      debounceTime(500),\r\n      pairwise(),\r\n      map(([prev, next]) => {\r\n        if (!prev) {\r\n          return 9999;\r\n        }\r\n        return prev.center.distanceTo(next.center);\r\n      }),\r\n      scan((acc, val) => acc + val, 0)\r\n    );\r\n  }\r\n\r\n  private triggerWhenMetersReached(metersBuffer = 10) {\r\n    return this.getMapMetersChanged().pipe(\r\n      skipWhile((val) => {\r\n        return val < metersBuffer;\r\n      })\r\n    );\r\n  }\r\n\r\n  private getMapViewThatHasRelevantChange(metersBuffer = 10) {\r\n    return this.mapView$.pipe(\r\n      bufferWhen(() => this.triggerWhenMetersReached(metersBuffer)),\r\n      switchMap((buffer) =>\r\n        buffer.length > 0 && !!buffer[buffer.length - 1]\r\n          ? of(buffer[buffer.length - 1])\r\n          : this.mapView$.pipe(take(1))\r\n      ),\r\n      tap((val) =>\r\n        this.loggingService.debug(\r\n          'MapView has relevant change!',\r\n          DEBUG_TAG,\r\n          val\r\n        )\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n\r\n  private getMapViewAreaObservable(): Observable<IMapViewAndArea> {\r\n    const currenteMapViewAndGeoHazards = combineLatest([\r\n      this.relevantMapChange$,\r\n      this.userSettingService.currentGeoHazard$\r\n    ]).pipe(\r\n      map(([mapView, geoHazards]) => ({\r\n        mapView,\r\n        bounds: [\r\n          mapView.bounds.getSouthWest().lng, // minx\r\n          mapView.bounds.getSouthWest().lat, // miny\r\n          mapView.bounds.getNorthEast().lng, // maxx\r\n          mapView.bounds.getNorthEast().lat // maxy\r\n        ],\r\n        center: { lat: mapView.center.lat, lng: mapView.center.lng },\r\n        geoHazards\r\n      }))\r\n    );\r\n\r\n    return currenteMapViewAndGeoHazards.pipe(\r\n      switchMap((cvg) =>\r\n        fromWorker<IRegionInViewInput, IRegionInViewOutput>(\r\n          () =>\r\n            new Worker(new URL('../../web-workers/region-in-view.worker', import.meta.url), {\r\n              type: 'module'\r\n            }),\r\n          currenteMapViewAndGeoHazards\r\n        ).pipe(\r\n          map((result) => ({\r\n            ...cvg.mapView,\r\n            ...result\r\n          }))\r\n        )\r\n      ),\r\n      tap((val) =>\r\n        this.loggingService.debug('MapViewArea changed', DEBUG_TAG, val)\r\n      ),\r\n      shareReplay(1)\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { CanDeactivate } from '@angular/router';\r\nimport { BasePage } from './base.page';\r\n\r\n@Injectable()\r\nexport class CanDeactivateRouteGuard implements CanDeactivate<BasePage> {\r\n  async canDeactivate(component: BasePage): Promise<boolean> {\r\n    return component.canLeave();\r\n  }\r\n}\r\n","import {\r\n  CanDeactivate,\r\n  ActivatedRouteSnapshot,\r\n  RouterStateSnapshot\r\n} from '@angular/router';\r\nimport { Injectable } from '@angular/core';\r\nimport { OverviewPage } from './overview/overview.page';\r\nimport { AlertController } from '@ionic/angular';\r\n// import { RegistrationService } from '../services/registration.service';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport { ObsLocationPage } from './obs-location/obs-location.page';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { take } from 'rxjs/operators';\r\nimport { SyncStatus } from 'src/app/modules/common-registration/registration.models';\r\nimport { RegistrationService as CommonRegistrationService } from 'src/app/modules/common-registration/registration.services';\r\n\r\n@Injectable()\r\nexport class SaveAsDraftRouteGuard\r\nimplements CanDeactivate<OverviewPage | ObsLocationPage> {\r\n  constructor(\r\n    private alertController: AlertController,\r\n    private registrationService: CommonRegistrationService,\r\n    private userSettingService: UserSettingService,\r\n    private translateService: TranslateService\r\n  ) {}\r\n\r\n  async canDeactivate(\r\n    component: OverviewPage,\r\n    _: ActivatedRouteSnapshot,\r\n    __: RouterStateSnapshot,\r\n    nextState?: RouterStateSnapshot\r\n  ) {\r\n    if (\r\n      nextState &&\r\n      !this.isInWhitelist(nextState.url) &&\r\n      component.registration\r\n    ) {\r\n      const reg = await this.registrationService.getRegistrationById(\r\n        component.registration.id\r\n      );\r\n      if (reg && reg.syncStatus === SyncStatus.Draft) {\r\n        const save = await this.createAlert();\r\n        if (!save) {\r\n          await this.registrationService.deleteRegistrationFromOfflineStorage(\r\n            component.registration.id\r\n          );\r\n        }\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  isInWhitelist(url: string) {\r\n    const whiteList = ['registration/', 'my-observations'];\r\n    return whiteList.some((w) => url.indexOf(w) >= 0);\r\n  }\r\n\r\n  async createAlert() {\r\n    const translations = await this.translateService\r\n      .get([\r\n        'REGISTRATION.SAVE_ALERT.HEADER',\r\n        'REGISTRATION.SAVE_ALERT.MESSAGE',\r\n        'REGISTRATION.SAVE_ALERT.NO',\r\n        'REGISTRATION.SAVE_ALERT.YES'\r\n      ])\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations['REGISTRATION.SAVE_ALERT.HEADER'],\r\n      message: translations['REGISTRATION.SAVE_ALERT.MESSAGE'],\r\n      buttons: [\r\n        {\r\n          text: translations['REGISTRATION.SAVE_ALERT.NO'],\r\n          role: 'cancel'\r\n        },\r\n        {\r\n          text: translations['REGISTRATION.SAVE_ALERT.YES']\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n    const result = await alert.onDidDismiss();\r\n    return result.role !== 'cancel';\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: 'registration/edit/:id',\r\n    loadChildren: () =>\r\n      import('./pages/overview/overview.module').then(\r\n        (m) => m.OverviewPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/set-time/:id',\r\n    loadChildren: () =>\r\n      import('./pages/set-time/set-time.module').then(\r\n        (m) => m.SetTimePageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/new/:geoHazard',\r\n    loadChildren: () =>\r\n      import('./pages/obs-location/obs-location.module').then(\r\n        (m) => m.ObsLocationPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/obs-location/:id',\r\n    loadChildren: () =>\r\n      import('./pages/obs-location/obs-location.module').then(\r\n        (m) => m.ObsLocationPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/group/:id',\r\n    loadChildren: () =>\r\n      import('./pages/group/group.module').then((m) => m.GroupPageModule)\r\n  },\r\n  {\r\n    path: 'registration/general-comment/:id',\r\n    loadChildren: () =>\r\n      import('./pages/general-comment/general-comment.module').then(\r\n        (m) => m.GeneralCommentPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/water/water-level/:id',\r\n    loadChildren: () =>\r\n      import('./pages/water/water-level/water-level.module').then(\r\n        (m) => m.WaterLevelPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/water/damage/:id',\r\n    loadChildren: () =>\r\n      import('./pages/water/damage/damage.module').then(\r\n        (m) => m.DamagePageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/ice/ice-cover/:id',\r\n    loadChildren: () =>\r\n      import('./pages/ice/ice-cover/ice-cover.module').then(\r\n        (m) => m.IceCoverPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/ice/ice-thickness/:id',\r\n    loadChildren: () =>\r\n      import('./pages/ice/ice-thickness/ice-thickness.module').then(\r\n        (m) => m.IceThicknessPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/dirt/landslide-obs/:id',\r\n    loadChildren: () =>\r\n      import('./pages/dirt/landslide-obs/landslide-obs.module').then(\r\n        (m) => m.LandslideObsPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/danger-obs/:id',\r\n    loadChildren: () =>\r\n      import('./pages/danger-obs/danger-obs.module').then(\r\n        (m) => m.DangerObsPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/incident/:id',\r\n    loadChildren: () =>\r\n      import('./pages/incident/incident.module').then(\r\n        (m) => m.IncidentPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/avalanche-obs/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/avalanche-obs/avalanche-obs.module').then(\r\n        (m) => m.AvalancheObsPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/avalanche-activity/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/avalanche-activity/avalanche-activity.module').then(\r\n        (m) => m.AvalancheActivityPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/weather/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/weather/weather.module').then(\r\n        (m) => m.WeatherPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/snow-surface/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/snow-surface/snow-surface.module').then(\r\n        (m) => m.SnowSurfacePageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/snow-profile/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/snow-profile/snow-profile.module').then(\r\n        (m) => m.SnowProfilePageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/compression-test/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/compression-test/compression-test.module').then(\r\n        (m) => m.CompressionTestPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/avalanche-problem/:id',\r\n    loadChildren: () =>\r\n      import('./pages/snow/avalanche-problem/avalanche-problem.module').then(\r\n        (m) => m.AvalancheProblemPageModule\r\n      )\r\n  },\r\n  {\r\n    path: 'registration/snow/avalanche-evaluation/:id',\r\n    loadChildren: () =>\r\n      import(\r\n        './pages/snow/avalanche-evaluation/avalanche-evaluation.module'\r\n      ).then((m) => m.AvalancheEvaluationPageModule)\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class RegistrationRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { RegistrationRoutingModule } from './registration-routing.module';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { CanDeactivateRouteGuard } from './pages/can-deactivate-route.guard';\r\nimport { SaveAsDraftRouteGuard } from './pages/save-as-draft.guard';\r\nimport { RegobsApiModule } from '@varsom-regobs-common/regobs-api';\r\n\r\n@NgModule({\r\n  imports: [RegistrationRoutingModule, RegobsApiModule, SharedModule],\r\n  exports: [],\r\n  declarations: [],\r\n  providers: [CanDeactivateRouteGuard, SaveAsDraftRouteGuard]\r\n})\r\nexport class RegistrationModule {}\r\n","import { Injectable } from '@angular/core';\r\nimport moment from 'moment';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { DataLoadService } from '../../../data-load/services/data-load.service';\r\nimport { NanoSql } from '../../../../../nanosql';\r\nimport { toPromiseWithCancel } from '../../../../core/helpers/observable-helper';\r\nimport { GeoHazard, LangKey, AppMode } from '@varsom-regobs-common/core';\r\nimport { settings } from '../../../../../settings';\r\nimport { HelptextService, HelptextDto } from '@varsom-regobs-common/regobs-api';\r\nimport { LoggingService } from '../../../shared/services/logging/logging.service';\r\nimport { take } from 'rxjs/operators';\r\n\r\nconst DEBUG_TAG = 'HelpTextService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class HelpTextService {\r\n  constructor(\r\n    private helptextApiService: HelptextService,\r\n    private userSettingService: UserSettingService,\r\n    private dataLoadService: DataLoadService,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  async updateHelpTexts(cancel?: Promise<void>) {\r\n    const userSetting = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    await this.checkLastUpdatedAndUpdateDataIfNeeded(\r\n      userSetting.appMode,\r\n      userSetting.language,\r\n      cancel\r\n    );\r\n  }\r\n\r\n  private getDataLoadId(appMode: AppMode, language: LangKey) {\r\n    return `${NanoSql.TABLES.HELP_TEXTS.name}_${appMode}_${language}`;\r\n  }\r\n\r\n  private async checkLastUpdatedAndUpdateDataIfNeeded(\r\n    appMode: AppMode,\r\n    language: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoad = await this.dataLoadService.getState(\r\n      this.getDataLoadId(appMode, language)\r\n    );\r\n    const isLoadingTimeout = moment().subtract(\r\n      settings.foregroundUpdateIntervalMs,\r\n      'milliseconds'\r\n    );\r\n    if (\r\n      dataLoad.isLoading &&\r\n      moment(dataLoad.startedDate).isAfter(isLoadingTimeout)\r\n    ) {\r\n      this.loggingService.debug(\r\n        'Kdv elements is allready being updated.',\r\n        DEBUG_TAG\r\n      );\r\n    } else {\r\n      const lastUpdateLimit = moment().subtract(\r\n        settings.helpTexts.daysBeforeUpdate,\r\n        'day'\r\n      );\r\n      if (\r\n        !dataLoad.lastUpdated ||\r\n        moment(dataLoad.lastUpdated).isBefore(lastUpdateLimit)\r\n      ) {\r\n        await this.updateHelpTextsForLanguage(appMode, language, cancel);\r\n      }\r\n    }\r\n  }\r\n\r\n  async updateHelpTextsForLanguage(\r\n    appMode: AppMode,\r\n    language: LangKey,\r\n    cancel?: Promise<void>\r\n  ) {\r\n    const dataLoadId = this.getDataLoadId(appMode, language);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    try {\r\n      const helpTexts = await toPromiseWithCancel(\r\n        this.helptextApiService.HelptextGet(language),\r\n        cancel,\r\n        20000\r\n      );\r\n      await NanoSql.getInstance(NanoSql.TABLES.HELP_TEXTS.name, appMode)\r\n        .query('upsert', { langKey: language, helpTexts: helpTexts })\r\n        .exec();\r\n      await this.dataLoadService.loadingCompleted(dataLoadId);\r\n    } catch (err) {\r\n      await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n    }\r\n  }\r\n\r\n  async getHelpTextByKey(\r\n    langKey: LangKey,\r\n    appMode: AppMode,\r\n    geoHazard: GeoHazard,\r\n    registrationTid: number\r\n  ) {\r\n    const helpTexts = await this.getHelpTexts(langKey, appMode);\r\n    return helpTexts.find(\r\n      (x) =>\r\n        !!x &&\r\n        x.GeoHazardTID === geoHazard &&\r\n        x.RegistrationTID === registrationTid\r\n    );\r\n  }\r\n\r\n  async getHelpTexts(langKey: LangKey, appMode: AppMode) {\r\n    const resultFromDb = await this.getHelpTextsFromDb(langKey, appMode);\r\n    if (resultFromDb) {\r\n      return resultFromDb;\r\n    } else {\r\n      const langKeyName = LangKey[langKey];\r\n      const defaultHelptexts: HelptextDto[] = require(`../../../../../assets/json/helptexts.${langKeyName}.json`);\r\n      return defaultHelptexts;\r\n    }\r\n  }\r\n\r\n  private async getHelpTextsFromDb(\r\n    langKey: LangKey,\r\n    appMode: AppMode\r\n  ): Promise<HelptextDto[]> {\r\n    const result = await NanoSql.getInstance(\r\n      NanoSql.TABLES.HELP_TEXTS.name,\r\n      appMode\r\n    )\r\n      .query('select')\r\n      .where(['langKey', '=', langKey])\r\n      .exec();\r\n    if (result.length > 0) {\r\n      return result[0].helpTexts as HelptextDto[];\r\n    } else {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map, take } from 'rxjs/operators';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport moment from 'moment';\r\nimport { DataLoadService } from '../../data-load/services/data-load.service';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { toPromiseWithCancel } from '../../../core/helpers/observable-helper';\r\nimport { NavController } from '@ionic/angular';\r\nimport { ObservationService } from '../../../core/services/observation/observation.service';\r\nimport * as utils from '@nano-sql/core/lib/utilities';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { LoggingService } from '../../shared/services/logging/logging.service';\r\nimport { RegobsAuthService } from '../../auth/services/regobs-auth.service';\r\nimport { IRegistration, SyncStatus } from 'src/app/modules/common-registration/registration.models';\r\nimport { RegistrationService as CommonRegistrationService } from 'src/app/modules/common-registration/registration.services';\r\nimport { GeoHazard, AppMode } from '@varsom-regobs-common/core';\r\n\r\nconst DEBUG_TAG = 'RegistrationService';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RegistrationService {\r\n  public readonly drafts$: Observable<IRegistration[]>;\r\n  public readonly registrations$: Observable<IRegistration[]>;\r\n\r\n  constructor(\r\n    private regobsAuthService: RegobsAuthService,\r\n    private userSettingService: UserSettingService,\r\n    // private registrationApiService: RegobsApi.RegistrationService,\r\n    private navController: NavController,\r\n    private dataLoadService: DataLoadService,\r\n    private loggingService: LoggingService,\r\n    private observationService: ObservationService,\r\n    // private registrationRepositoryService: RegistrationRepositoryService,\r\n    private commonRegistrationService: CommonRegistrationService,\r\n    private httpClient: HttpClient,\r\n    private file: File\r\n  ) {\r\n    // this.registrations$ = this.registrationRepositoryService.registrations$;\r\n    this.registrations$ = this.commonRegistrationService.registrationStorage$;\r\n    this.drafts$ = this.registrations$.pipe(map((val) => val.filter((item) => item.syncStatus === SyncStatus.Draft)));\r\n  }\r\n\r\n  // saveRegistration(appMode: AppMode, registration: IRegistration) {\r\n  //   this.loggingService.debug('Save registration', DEBUG_TAG, registration);\r\n  //   if (!registration) {\r\n  //     return;\r\n  //   }\r\n  //   registration.changed = moment().unix();\r\n  //   this.registrationRepositoryService.saveRegistration(appMode, registration);\r\n  //   this.commonRegistrationService.saveRegistration(registration);\r\n  // }\r\n\r\n  async saveRegistrationAsync(registration: IRegistration, clean = false) {\r\n    // const appMode = await this.userSettingService.appMode$\r\n    //   .pipe(take(1))\r\n    //   .toPromise();\r\n    // if (clean) {\r\n    //   await this.cleanupRegistration(registration);\r\n    // }\r\n    // this.saveRegistration(appMode, registration);\r\n    await this.commonRegistrationService.saveRegistration(registration).pipe(take(1)).toPromise();\r\n  }\r\n\r\n  createNewRegistration(geoHazard: GeoHazard) {\r\n    const newId = utils.uuid();\r\n    const reg: IRegistration = {\r\n      id: newId,\r\n      geoHazard,\r\n      changed: moment().unix(),\r\n      syncStatus: SyncStatus.Draft,\r\n      request: {\r\n        DtObsTime: null,\r\n        GeoHazardTID: geoHazard\r\n      }\r\n    };\r\n    return reg;\r\n  }\r\n\r\n  // private getRegistrationTids(): RegistrationTid[] {\r\n  //   return Object.keys(RegistrationTid)\r\n  //     .map((key) => RegistrationTid[key])\r\n  //     .filter((val: RegistrationTid) => typeof val !== 'string');\r\n  // }\r\n\r\n  // private async cleanupRegistration(reg: IRegistration) {\r\n  //   if (reg && reg.request) {\r\n  //     const registrationTids = this.getRegistrationTids();\r\n  //     for (const registrationTid of registrationTids) {\r\n  //       const key = RegistrationTid[registrationTid];\r\n  //       if (reg.request[key] && this.isEmpty(reg, registrationTid)) {\r\n  //         reg.request[key] = undefined;\r\n  //       }\r\n  //       if (\r\n  //         reg.request[key] !== undefined &&\r\n  //         registrationTid === RegistrationTid.WaterLevel2\r\n  //       ) {\r\n  //         this.cleanupWaterLevelMeasurements(reg);\r\n  //       }\r\n  //     }\r\n  //     if (!reg.request.DtObsTime) {\r\n  //       reg.request.DtObsTime = moment().toISOString(true);\r\n  //     }\r\n  //     await this.cleanupImages(reg.request);\r\n  //   }\r\n  //   return reg;\r\n  // }\r\n\r\n  // private cleanupWaterLevelMeasurements(reg: IRegistration) {\r\n  //   if (\r\n  //     reg &&\r\n  //     reg.request &&\r\n  //     reg.request.WaterLevel2 &&\r\n  //     reg.request.WaterLevel2.WaterLevelMeasurement\r\n  //   ) {\r\n  //     for (const measurement of reg.request.WaterLevel2.WaterLevelMeasurement) {\r\n  //       if (\r\n  //         !IsEmptyHelper.isEmpty(measurement) &&\r\n  //         !measurement.DtMeasurementTime\r\n  //       ) {\r\n  //         // Setting to now if DtMeasurementTime is empty\r\n  //         measurement.DtMeasurementTime = moment().toISOString(true);\r\n  //       }\r\n  //     }\r\n  //     // Remove array if no elements\r\n  //     if (\r\n  //       IsEmptyHelper.isEmpty(reg.request.WaterLevel2.WaterLevelMeasurement)\r\n  //     ) {\r\n  //       reg.request.WaterLevel2.WaterLevelMeasurement = undefined;\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // private async cleanupImages(\r\n  //   request: RegistrationEditModel\r\n  // ) {\r\n  //   try {\r\n  //     if (!request) {\r\n  //       return;\r\n  //     }\r\n  //     if (request.Attachments && request.Attachments.length > 0) {\r\n  //       request.Attachments = await asyncFilter(request.Attachments, (p) =>\r\n  //         this.isValidPicture(p)\r\n  //       );\r\n  //     }\r\n  //     if (request.DamageObs && request.DamageObs.length > 0) {\r\n  //       request.DamageObs = await Promise.all(\r\n  //         request.DamageObs.map(async (dto) => ({\r\n  //           ...dto,\r\n  //           Pictures: await asyncFilter(dto.Attachments, (p) =>\r\n  //             this.isValidPicture(p)\r\n  //           )\r\n  //         }))\r\n  //       );\r\n  //     }\r\n  //     if (\r\n  //       request.WaterLevel2 &&\r\n  //       request.WaterLevel2.WaterLevelMeasurement &&\r\n  //       request.WaterLevel2.WaterLevelMeasurement.length > 0\r\n  //     ) {\r\n  //       request.WaterLevel2.WaterLevelMeasurement = await Promise.all(\r\n  //         request.WaterLevel2.WaterLevelMeasurement.map(async (dto) => ({\r\n  //           ...dto,\r\n  //           Pictures: await asyncFilter(dto.Attachments, (p) =>\r\n  //             this.isValidPicture(p)\r\n  //           )\r\n  //         }))\r\n  //       );\r\n  //     }\r\n  //   } catch (err) {\r\n  //     this.loggingService.error(err, DEBUG_TAG, 'Could not cleanup images');\r\n  //   }\r\n  // }\r\n\r\n  // isEmpty(reg: IRegistration, registrationTid: RegistrationTid) {\r\n  //   if (reg && registrationTid) {\r\n  //     const isRegistrationEmpty = IsEmptyHelper.isEmpty(\r\n  //       this.getRegistationProperty(reg, registrationTid)\r\n  //     );\r\n  //     const hasImages = this.hasImages(reg, registrationTid);\r\n  //     if (isRegistrationEmpty && !hasImages) {\r\n  //       return true;\r\n  //     } else {\r\n  //       return false;\r\n  //     }\r\n  //   }\r\n  //   return true;\r\n  // }\r\n\r\n  // isRegistrationEmpty(reg: IRegistration) {\r\n  //   const registrationTids = this.getRegistrationTids();\r\n  //   const hasAnyValues = registrationTids.some((x) => !this.isEmpty(reg, x));\r\n  //   return !hasAnyValues;\r\n  // }\r\n\r\n  // hasImages(reg: IRegistration, registrationTid: RegistrationTid) {\r\n  //   return this.getImages(reg, registrationTid).length > 0;\r\n  // }\r\n\r\n  // getImages(reg: IRegistration, registrationTid: RegistrationTid) {\r\n  //   if (!reg) {\r\n  //     return [];\r\n  //   }\r\n  //   return this.getAllPictures(reg.request).filter(\r\n  //     (p) => p.RegistrationTID === registrationTid\r\n  //   );\r\n  // }\r\n\r\n  // getRegistationProperty(reg: IRegistration, registrationTid: RegistrationTid) {\r\n  //   if (reg && reg.request && registrationTid) {\r\n  //     return reg.request[this.getPropertyName(registrationTid)];\r\n  //   }\r\n  //   return null;\r\n  // }\r\n\r\n  // getPropertyName(registrationTid: RegistrationTid) {\r\n  //   return RegistrationTid[registrationTid];\r\n  // }\r\n\r\n  // getType(registrationTid: RegistrationTid): 'array' | 'object' {\r\n  //   const arrays = [\r\n  //     RegistrationTid.DangerObs,\r\n  //     RegistrationTid.AvalancheActivityObs,\r\n  //     RegistrationTid.AvalancheActivityObs2,\r\n  //     RegistrationTid.AvalancheDangerObs,\r\n  //     RegistrationTid.AvalancheEvalProblem2,\r\n  //     RegistrationTid.CompressionTest,\r\n  //     RegistrationTid.Picture,\r\n  //     RegistrationTid.DamageObs\r\n  //   ];\r\n  //   return arrays.indexOf(registrationTid) >= 0 ? 'array' : 'object';\r\n  // }\r\n\r\n  async sendRegistration(appMode: AppMode, reg: IRegistration) {\r\n    const loggedInUser = await this.regobsAuthService.getLoggedInUserAsPromise();\r\n    if (!loggedInUser.isLoggedIn) {\r\n      this.regobsAuthService.signIn();\r\n      return;\r\n    }\r\n    reg.syncStatus = SyncStatus.Sync;\r\n    this.commonRegistrationService.saveAndSync(reg, null, true).subscribe();\r\n    // TODO: Ignore version check is set to true for now\r\n    this.navController.navigateRoot('my-observations');\r\n  }\r\n\r\n  // private getDataLoadId(appMode: AppMode) {\r\n  //   return `registration_${appMode}`;\r\n  // }\r\n\r\n  // getDataLoadState() {\r\n  //   return this.userSettingService.userSetting$.pipe(\r\n  //     switchMap((userSetting) =>\r\n  //       this.dataLoadService.getStateAsObservable(\r\n  //         this.getDataLoadId(userSetting.appMode)\r\n  //       )\r\n  //     )\r\n  //   );\r\n  // }\r\n\r\n  async syncRegistrations(cancel?: Promise<any>): Promise<IRegistration[]> {\r\n    return toPromiseWithCancel(this.commonRegistrationService.syncRegistrations(), cancel);\r\n  }\r\n\r\n  // async syncRegistrations(cancel?: Promise<any>) {\r\n  //   let cancelled = false;\r\n  //   if (cancel) {\r\n  //     cancel.then(() => {\r\n  //       cancelled = true;\r\n  //     });\r\n  //   }\r\n  //   const userSettings = await this.userSettingService.userSetting$\r\n  //     .pipe(take(1))\r\n  //     .toPromise();\r\n  //   const dataLoadId = this.getDataLoadId(userSettings.appMode);\r\n  //   const dataLoad = await this.dataLoadService.getState(dataLoadId);\r\n  //   const isLoadingTimeout = moment().subtract(30, 'seconds');\r\n  //   if (\r\n  //     dataLoad.isLoading &&\r\n  //     moment(dataLoad.startedDate).isAfter(isLoadingTimeout)\r\n  //   ) {\r\n  //     // Is allready syncing, return\r\n  //     return;\r\n  //   }\r\n\r\n  //   const registrationsToSync = await this.getRegistrationsToSync()\r\n  //     .pipe(take(1))\r\n  //     .toPromise();\r\n  //   if (registrationsToSync.length > 0) {\r\n  //     try {\r\n  //       await this.dataLoadService.startLoading(\r\n  //         dataLoadId,\r\n  //         registrationsToSync.length\r\n  //       );\r\n  //       let itemCompleted = 0;\r\n  //       for (const registration of registrationsToSync) {\r\n  //         if (!cancelled) {\r\n  //           await this.syncRegistration(registration, userSettings, cancel);\r\n  //           itemCompleted++;\r\n  //           await this.dataLoadService.updateProgress(\r\n  //             dataLoadId,\r\n  //             itemCompleted,\r\n  //             registrationsToSync.length\r\n  //           );\r\n  //         } else {\r\n  //           throw Error('Operation cancelled');\r\n  //         }\r\n  //       }\r\n  //       await this.dataLoadService.loadingCompleted(dataLoadId);\r\n  //     } catch (err) {\r\n  //       await this.dataLoadService.loadingError(dataLoadId, err.message);\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // private async syncRegistration(\r\n  //   registration: IRegistration,\r\n  //   userSetting: UserSetting,\r\n  //   cancel?: Promise<void>\r\n  // ) {\r\n  //   try {\r\n  //     if (registration.request) {\r\n  //       await this.cleanupRegistration(registration);\r\n  //       registration.request.Email = userSetting.emailReceipt;\r\n  //       const createRegistrationResult = await this.postRegistration(\r\n  //         userSetting.appMode,\r\n  //         registration,\r\n  //         cancel\r\n  //       );\r\n  //       await this.observationService.updateObservationById(\r\n  //         createRegistrationResult.RegId,\r\n  //         userSetting.appMode,\r\n  //         userSetting.language,\r\n  //         userSetting.currentGeoHazard\r\n  //       );\r\n  //     }\r\n  //     await this.deleteRegistrationById(userSetting.appMode, registration.id);\r\n  //   } catch (ex) {\r\n  //     if (ex instanceof HttpErrorResponse) {\r\n  //       const httpError: HttpErrorResponse = ex;\r\n  //       this.loggingService.debug(\r\n  //         'Could not sync registration',\r\n  //         DEBUG_TAG,\r\n  //         registration,\r\n  //         ex\r\n  //       );\r\n  //       if (httpError.status === 409) {\r\n  //         // Duplicate, remove\r\n  //         await this.deleteRegistrationById(\r\n  //           userSetting.appMode,\r\n  //           registration.id\r\n  //         );\r\n  //         // Updating latest user registration since we don't have an ID for the duplicate\r\n  //         // await this.updateLatestUserRegistrations(cancel);\r\n  //       } else if (httpError.status === 400) {\r\n  //         // Model error, something is not correct from app. Please review ModelState error!\r\n  //         this.loggingService.error(\r\n  //           ex,\r\n  //           'Got 400 BadRequest when sending registration',\r\n  //           DEBUG_TAG,\r\n  //           registration\r\n  //         );\r\n  //         registration.error = {\r\n  //           status: httpError.status,\r\n  //           message: this.getErrorsFromBadRequest(httpError)\r\n  //         };\r\n  //         this.saveRegistration(userSetting.appMode, registration);\r\n  //       } else {\r\n  //         this.loggingService.error(\r\n  //           ex,\r\n  //           'Got ${httpError.status} when sending registration',\r\n  //           DEBUG_TAG,\r\n  //           registration\r\n  //         );\r\n  //         registration.error = {\r\n  //           status: httpError.status,\r\n  //           message: httpError.statusText\r\n  //         };\r\n  //         this.saveRegistration(userSetting.appMode, registration);\r\n  //       }\r\n  //     } else {\r\n  //       // Another unknown error\r\n  //       this.loggingService.error(\r\n  //         ex,\r\n  //         'Error when sending registration',\r\n  //         DEBUG_TAG,\r\n  //         registration\r\n  //       );\r\n  //       registration.error = { status: 500, message: ex.message || '' };\r\n  //       this.saveRegistration(userSetting.appMode, registration);\r\n  //     }\r\n  //   }\r\n  // }\r\n\r\n  // private getErrorsFromBadRequest(httpError: HttpErrorResponse) {\r\n  //   const errors: Array<string> = [];\r\n  //   if (httpError && httpError.error && httpError.error.ModelState) {\r\n  //     Object.keys(httpError.error.ModelState).forEach((key) => {\r\n  //       const err: Array<string> = httpError.error.ModelState[key];\r\n  //       errors.push(...err);\r\n  //     });\r\n  //   } else if (\r\n  //     httpError &&\r\n  //     httpError.error &&\r\n  //     httpError.error.ExceptionMessage\r\n  //   ) {\r\n  //     errors.push(httpError.error.ExceptionMessage);\r\n  //   }\r\n  //   return errors.join(', ');\r\n  // }\r\n\r\n  // deleteRegistrationById(appMode: AppMode, id: string) {\r\n  //   return this.registrationRepositoryService.deleteRegistrationById(\r\n  //     appMode,\r\n  //     id\r\n  //   );\r\n  // }\r\n\r\n  getRegistrationsToSync() {\r\n    return this.registrations$.pipe(\r\n      // TODO: Why drafts?\r\n      map((items) => items.filter((x) => x.syncStatus === SyncStatus.Draft))\r\n    );\r\n  }\r\n\r\n  getSavedRegistrationById(id: string): Promise<IRegistration> {\r\n    return this.commonRegistrationService.getRegistrationById(id);\r\n  }\r\n\r\n  // getSavedRegistrationByIdObservable(id: string) {\r\n  //   return this.registrations$.pipe(\r\n  //     map((items) => items.find((x) => x.id === id))\r\n  //   );\r\n  // }\r\n\r\n  // private postRegistration(\r\n  //   appMode: AppMode,\r\n  //   registration: IRegistration,\r\n  //   cancel?: Promise<void>\r\n  // ) {\r\n  //   const uploadProcess$ = this.uploadAttachments(registration.request).pipe(\r\n  //     tap(() =>\r\n  //       this.loggingService.debug(\r\n  //         'Upload attachments complete. Registration is:',\r\n  //         DEBUG_TAG,\r\n  //         registration\r\n  //       )\r\n  //     ),\r\n  //     concatMap(() => of(this.saveRegistration(appMode, registration))), // Save updated picture dtos with attachment id\r\n  //     concatMap(() =>\r\n  //       this.registrationApiService.RegistrationInsert(registration.request)\r\n  //     )\r\n  //   );\r\n  //   return toPromiseWithCancel(uploadProcess$, cancel);\r\n  // }\r\n\r\n  // private uploadAttachments(\r\n  //   registration: RegobsApiModels.CreateRegistrationRequestDto\r\n  // ): Observable<RegobsApiModels.PictureRequestDto[]> {\r\n  //   this.loggingService.debug(\r\n  //     'Start upload attachments',\r\n  //     DEBUG_TAG,\r\n  //     registration\r\n  //   );\r\n  //   const attachments = this.getAllPictures(registration);\r\n  //   if (attachments.length === 0) {\r\n  //     return of([]);\r\n  //   }\r\n  //   return combineLatest(attachments.map((p) => this.uploadAttachment(p)));\r\n  // }\r\n\r\n  // getAllPictures(registration: RegobsApiModels.CreateRegistrationRequestDto) {\r\n  //   let pictures = registration.Picture || [];\r\n  //   if (registration.DamageObs && registration.DamageObs.length > 0) {\r\n  //     const damageObsPictures = registration.DamageObs.map(\r\n  //       (val) => val.Pictures || []\r\n  //     );\r\n  //     pictures = pictures.concat(...damageObsPictures);\r\n  //   }\r\n  //   if (\r\n  //     registration.WaterLevel2 &&\r\n  //     registration.WaterLevel2.WaterLevelMeasurement &&\r\n  //     registration.WaterLevel2.WaterLevelMeasurement.length > 0\r\n  //   ) {\r\n  //     const waterLevelPictures = registration.WaterLevel2.WaterLevelMeasurement.map(\r\n  //       (val) => val.Pictures || []\r\n  //     );\r\n  //     pictures = pictures.concat(...waterLevelPictures);\r\n  //   }\r\n  //   return pictures;\r\n  // }\r\n\r\n  // private async getFile(fileUrl: string): Promise<IFile> {\r\n  //   const entry = await this.file.resolveLocalFilesystemUrl(fileUrl);\r\n  //   if (!entry.isFile) {\r\n  //     throw Error(`${fileUrl} is not a file!`);\r\n  //   }\r\n  //   const fileEntry: FileEntry = entry as FileEntry;\r\n  //   return new Promise((resolve, reject) =>\r\n  //     fileEntry.file(\r\n  //       (success) => resolve(success),\r\n  //       (error) => reject(error)\r\n  //     )\r\n  //   );\r\n  // }\r\n\r\n  // private isBase64Picture(pictureRequest: RegobsApiModels.PictureRequestDto) {\r\n  //   return (\r\n  //     pictureRequest &&\r\n  //     pictureRequest.PictureImageBase64 &&\r\n  //     pictureRequest.PictureImageBase64.startsWith('data:')\r\n  //   );\r\n  // }\r\n\r\n  // private async isValidPicture(\r\n  //   pictureRequest: AttachmentEditModel\r\n  // ): Promise<boolean> {\r\n  //   if (pictureRequest) {\r\n  //     if (\r\n  //       pictureRequest.AttachmentUploadId ||\r\n  //       this.isBase64Picture(pictureRequest)\r\n  //     ) {\r\n  //       return true;\r\n  //     }\r\n  //     try {\r\n  //       const file = await this.getFile(pictureRequest.);\r\n  //       return !!file;\r\n  //     } catch (err) {\r\n  //       this.loggingService.log(\r\n  //         'Picture request has a file that is missing. Skip this picture.',\r\n  //         err,\r\n  //         LogLevel.Error,\r\n  //         DEBUG_TAG\r\n  //       );\r\n  //     }\r\n  //   }\r\n  //   return false;\r\n  // }\r\n\r\n  // private uploadAttachment(\r\n  //   pictureRequest: RegobsApiModels.PictureRequestDto\r\n  // ): Observable<RegobsApiModels.PictureRequestDto> {\r\n  //   const shouldUploadAttachment =\r\n  //     !pictureRequest.AttachmentUploadId &&\r\n  //     pictureRequest.PictureImageBase64 &&\r\n  //     !this.isBase64Picture(pictureRequest);\r\n\r\n  //   if (shouldUploadAttachment) {\r\n  //     const file$ = from(this.getFile(pictureRequest.PictureImageBase64));\r\n  //     return file$.pipe(\r\n  //       tap((file) =>\r\n  //         this.loggingService.debug('Found image file blob', DEBUG_TAG, file)\r\n  //       ),\r\n  //       concatMap((file) => this.getFormDataAndUploadToApi(file)),\r\n  //       map((attachmentId) => {\r\n  //         this.loggingService.debug(\r\n  //           `Result from upload attachment: ${attachmentId}`,\r\n  //           DEBUG_TAG\r\n  //         );\r\n  //         pictureRequest.AttachmentUploadId = attachmentId;\r\n  //         this.loggingService.debug(\r\n  //           `Updated attachment id ${attachmentId} for picture request`,\r\n  //           DEBUG_TAG,\r\n  //           pictureRequest\r\n  //         );\r\n  //         return pictureRequest;\r\n  //       }),\r\n  //       concatMap(() =>\r\n  //         from(this.deleteFile(pictureRequest.PictureImageBase64))\r\n  //       ),\r\n  //       map(() => {\r\n  //         pictureRequest.PictureImageBase64 = undefined; // Attachment upload ok. Clear local file.\r\n  //         return pictureRequest;\r\n  //       })\r\n  //     );\r\n  //   }\r\n  //   return of(pictureRequest);\r\n  // }\r\n\r\n  // private async deleteFile(src: string) {\r\n  //   try {\r\n  //     const entry = await this.file.resolveLocalFilesystemUrl(src);\r\n  //     await new Promise<void>((resolve, reject) =>\r\n  //       entry.remove(resolve, reject)\r\n  //     );\r\n  //     this.loggingService.debug(\r\n  //       `Observation image deleted from presistant app storage: ${src}`,\r\n  //       DEBUG_TAG\r\n  //     );\r\n  //   } catch (err) {\r\n  //     this.loggingService.log(\r\n  //       'Could not delete image',\r\n  //       err,\r\n  //       LogLevel.Warning,\r\n  //       DEBUG_TAG\r\n  //     );\r\n  //   }\r\n  // }\r\n\r\n  // private getFormDataFromFile(file: IFile) {\r\n  //   return from(this.fileToBlob(file)).pipe(\r\n  //     map((blob) => {\r\n  //       const formData = new FormData();\r\n  //       formData.append('file', blob, file.name);\r\n  //       return formData;\r\n  //     })\r\n  //   );\r\n  // }\r\n\r\n  // private fileToBlob(file: IFile): Promise<Blob> {\r\n  //   return new Promise<Blob>((resolve, reject) => {\r\n  //     const reader = new FileReader();\r\n  //     reader.onloadend = () =>\r\n  //       resolve(new Blob([reader.result], { type: file.type }));\r\n  //     reader.onerror = (e) => reject(e);\r\n  //     reader.readAsArrayBuffer(file);\r\n  //   });\r\n  // }\r\n\r\n  // private getFormDataAndUploadToApi(file: IFile): Observable<string> {\r\n  //   const formData$ = this.getFormDataFromFile(file);\r\n  //   return combineLatest([this.userSettingService.appMode$, formData$]).pipe(\r\n  //     tap(([appMode, formData]) =>\r\n  //       this.loggingService.debug('Got form data', DEBUG_TAG, appMode, formData)\r\n  //     ),\r\n  //     concatMap(([appMode, formData]) =>\r\n  //       this.uploadAttachmentToApi(appMode, formData)\r\n  //     )\r\n  //   );\r\n  // }\r\n\r\n  // private uploadAttachmentToApi(appMode: AppMode, data: FormData) {\r\n  //   const rootUrl = settings.services.regObs.apiUrl[appMode];\r\n  //   return this.httpClient.post<string>(`${rootUrl}/Attachment/Upload`, data);\r\n  // }\r\n}\r\n","import { Component, OnInit, ViewChild } from '@angular/core';\r\nimport { IonFab, NavController } from '@ionic/angular';\r\nimport { Observable, from, combineLatest, of } from 'rxjs';\r\nimport moment from 'moment';\r\nimport { DateHelperService } from '../../services/date-helper/date-helper.service';\r\nimport { TripLoggerService } from '../../../../core/services/trip-logger/trip-logger.service';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { GeoHelperService } from '../../services/geo-helper/geo-helper.service';\r\nimport { IRegistration } from 'src/app/modules/common-registration/registration.models';\r\nimport { GeoHazard, LangKey } from '@varsom-regobs-common/core';\r\nimport { RegistrationService } from '../../../registration/services/registration.service';\r\nimport { map, tap, switchMap } from 'rxjs/operators';\r\nimport { setObservableTimeout } from '../../../../core/helpers/observable-helper';\r\nimport { LoggingService } from '../../services/logging/logging.service';\r\n\r\nconst DEBUG_TAG = 'AddMenuComponent';\r\n\r\n@Component({\r\n  selector: 'app-add-menu',\r\n  templateUrl: './add-menu.component.html',\r\n  styleUrls: ['./add-menu.component.scss']\r\n})\r\nexport class AddMenuComponent implements OnInit {\r\n  @ViewChild('menuFab') menuFab: IonFab;\r\n\r\n  drafts$: Observable<{ id: string; geoHazard: GeoHazard; date: string }[]>;\r\n  geoHazardInfo$: Observable<{\r\n    geoHazards: GeoHazard[];\r\n    showTrip: boolean;\r\n  }>;\r\n  tripStarted$: Observable<boolean>;\r\n  showSpace$: Observable<boolean>;\r\n\r\n  constructor(\r\n    private registrationService: RegistrationService,\r\n    private navController: NavController,\r\n    private dateHelperService: DateHelperService,\r\n    private tripLoggerService: TripLoggerService,\r\n    private userSettingService: UserSettingService,\r\n    private geoHelperService: GeoHelperService,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.geoHazardInfo$ = this.userSettingService.userSetting$.pipe(\r\n      map((us) => ({\r\n        geoHazards: us.currentGeoHazard,\r\n        showTrip: us.currentGeoHazard.indexOf(GeoHazard.Snow) >= 0\r\n      })),\r\n      setObservableTimeout()\r\n    );\r\n    this.drafts$ = this.registrationService.drafts$.pipe(\r\n      tap((drafts) =>\r\n        this.loggingService.debug('Drafts has changed to', DEBUG_TAG, drafts)\r\n      ),\r\n      switchMap((drafts) =>\r\n        drafts.length > 0\r\n          ? combineLatest(drafts.map((draft) => this.convertDraftToDate(draft)))\r\n          : of([])\r\n      ),\r\n      tap((drafts) =>\r\n        this.loggingService.debug(\r\n          'Converted drafts has changed to',\r\n          DEBUG_TAG,\r\n          drafts\r\n        )\r\n      ),\r\n      setObservableTimeout()\r\n    );\r\n    this.tripStarted$ = this.tripLoggerService.isTripRunning$;\r\n  }\r\n\r\n  private convertDraftToDate(\r\n    draft: IRegistration\r\n  ): Observable<{ id: string; geoHazard: GeoHazard; date: string }> {\r\n    return from(this.getDate(draft.changed)).pipe(\r\n      map((date) => ({ id: draft.id, geoHazard: draft.geoHazard, date }))\r\n    );\r\n  }\r\n\r\n  getName(geoHazard: GeoHazard): string {\r\n    return GeoHazard[geoHazard];\r\n  }\r\n\r\n  getDate(timestamp: number): Promise<string> {\r\n    return this.dateHelperService.formatDate(moment.unix(timestamp));\r\n  }\r\n\r\n  closeAndNavigate(url: string): void {\r\n    setTimeout(() => {\r\n      if (this.menuFab) {\r\n        this.menuFab.close();\r\n      }\r\n    }, 0);\r\n    this.navController.navigateForward(url);\r\n  }\r\n\r\n  createRegistration(geoHazard: GeoHazard): void {\r\n    this.closeAndNavigate(`registration/new/${geoHazard}`);\r\n  }\r\n\r\n  editRegistration(id: string): void {\r\n    this.closeAndNavigate(`registration/edit/${id}`);\r\n  }\r\n\r\n  closeMenu(): void {\r\n    this.menuFab.close();\r\n  }\r\n\r\n  startOrStopTrip(tripStarted: boolean): void {\r\n    return tripStarted\r\n      ? this.tripLoggerService.stopLegacyTrip()\r\n      : this.closeAndNavigate('legacy-trip');\r\n  }\r\n}\r\n","<ion-fab #menuFab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\" *ngIf=\"(geoHazardInfo$ | async) as geoHazardInfo \">\r\n  <ion-fab-button>\r\n    <ion-icon name=\"add\"></ion-icon>\r\n  </ion-fab-button>\r\n  <ion-fab-list side=\"top\">\r\n    <ion-list lines=\"full\" class=\"ion-no-padding ion-no-margin\">\r\n\r\n      <!-- New observation button -->\r\n      <ion-item (click)=\"createRegistration(geoHazard)\" *ngFor=\"let geoHazard of geoHazardInfo.geoHazards\">\r\n        <app-geo-icon slot=\"start\" [useGeoColors]=\"false\" [geoHazards]=\"[geoHazard]\"></app-geo-icon>\r\n        <ion-label>{{ 'ADD_MENU.NEW_' + getName(geoHazard) + '_OBSERVATION' | uppercase | translate }}</ion-label>\r\n      </ion-item>\r\n\r\n      <!-- Drafts -->\r\n      <ion-item *ngFor=\"let draft of drafts$ | async\" (click)=\"editRegistration(draft.id)\">\r\n        <ion-icon slot=\"start\" name=\"create\"></ion-icon>\r\n        <ion-label>\r\n          {{'ADD_MENU.DRAFT_TITLE_' + getName(draft.geoHazard) | uppercase | translate}}\r\n          <p>{{ draft.date }}</p>\r\n        </ion-label>\r\n      </ion-item>\r\n\r\n      <!-- Start / stop trip -->\r\n      <ng-container *ngIf=\"geoHazardInfo.showTrip\">\r\n        <ion-item *ngIf=\"tripStarted$ | async else startTrip\" (click)=\"startOrStopTrip(true)\">\r\n          <ion-icon slot=\"start\" src=\"/assets/icon/man.svg\"></ion-icon>\r\n          <ion-label>{{'TRIP.STOP_TRIP' | translate }}</ion-label>\r\n        </ion-item>\r\n      </ng-container>\r\n\r\n    </ion-list>\r\n    <div class=\"backdrop\" click=\"closeMenu()\"></div>\r\n  </ion-fab-list>\r\n</ion-fab>\r\n\r\n<ng-template #startTrip>\r\n  <ion-item (click)=\"startOrStopTrip(false)\">\r\n    <ion-icon slot=\"start\" src=\"/assets/icon/man.svg\"></ion-icon>\r\n    <ion-label>{{'TRIP.START_TRIP' | translate }}</ion-label>\r\n  </ion-item>\r\n</ng-template>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { ExternalLinkService } from '../../../../core/services/external-link/external-link.service';\r\n\r\n@Component({\r\n  selector: 'app-external-link',\r\n  templateUrl: './external-link.component.html',\r\n  styleUrls: ['./external-link.component.scss']\r\n})\r\nexport class ExternalLinkComponent implements OnInit {\r\n  @Input() src: string;\r\n\r\n  constructor(private externalLinkService: ExternalLinkService) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  openLink(event: Event) {\r\n    event.preventDefault();\r\n    this.externalLinkService.openExternalLink(this.src);\r\n  }\r\n}\r\n","<a href=\"#\" (click)=\"openLink($event)\">\r\n  <ng-content></ng-content>\r\n</a>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  OnDestroy,\r\n  NgZone\r\n} from '@angular/core';\r\nimport {\r\n  state,\r\n  trigger,\r\n  style,\r\n  transition,\r\n  animate,\r\n  stagger,\r\n  query\r\n} from '@angular/animations';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport {\r\n  CustomAnimation,\r\n  EASE_IN_OUT_BACK,\r\n  EASE_IN_OUT\r\n} from '../../../../core/animations/custom.animation';\r\nimport { map, take } from 'rxjs/operators';\r\n\r\nconst GEOHAZARD_TYPES = [\r\n  [GeoHazard.Snow],\r\n  [GeoHazard.Ice],\r\n  [GeoHazard.Water, GeoHazard.Soil]\r\n];\r\n@Component({\r\n  selector: 'app-geo-fab',\r\n  templateUrl: './geo-fab.component.html',\r\n  styleUrls: ['./geo-fab.component.scss'],\r\n  animations: [\r\n    trigger('enterAnimationFab', [\r\n      state('x', style({ transform: 'scale3d(0,0,1)', opacity: 0 })),\r\n      state('visible', style({ transform: 'scale3d(1,1,1)', opacity: 1 })),\r\n      transition(\r\n        'x => startAnimated',\r\n        CustomAnimation.createScaleInTransition(200, 500, EASE_IN_OUT_BACK)\r\n      )\r\n    ]),\r\n    trigger(\r\n      'enterAnimation',\r\n      CustomAnimation.createEnterScaleInAnimation(0, 200, EASE_IN_OUT)\r\n    ),\r\n    trigger('listAnimate', [\r\n      transition('* => *', [\r\n        query(\r\n          ':enter',\r\n          [\r\n            style({\r\n              transform: 'translate3d(0, -30px, 0) scale3d(0, 0, 1)',\r\n              opacity: 0\r\n            }), // initial\r\n            stagger(\r\n              100,\r\n              animate(\r\n                `200ms 0ms ${EASE_IN_OUT}`,\r\n                style({\r\n                  transform: 'translate3d(0, 0, 0) scale3d(1,1,1)',\r\n                  opacity: 1\r\n                })\r\n              )\r\n            )\r\n          ],\r\n          { optional: true }\r\n        )\r\n      ])\r\n    ])\r\n  ]\r\n})\r\nexport class GeoFabComponent implements OnInit, OnDestroy {\r\n  fullscreen$: Observable<boolean>;\r\n  currentGeoHazard$: Observable<GeoHazard[]>;\r\n  selectableGeoHazards$: Observable<GeoHazard[][]>;\r\n\r\n  @Input() color = 'light';\r\n  @Input() isOpen = false;\r\n  @Input() showLabels = true;\r\n  @Output() isOpenChange = new EventEmitter();\r\n  @Input() animateOnEnter = false;\r\n\r\n  private ngDestroy$ = new Subject<void>();\r\n  private animationTimout: NodeJS.Timeout;\r\n\r\n  animateOnEnterState = 'x';\r\n\r\n  // get selectableGeoHazards() {\r\n  //   return this.geoHazardTypes.filter((x) => !(this.currentGeoHazard && this.currentGeoHazard.some((c) => x.some((z) => z === c))));\r\n  // }\r\n\r\n  constructor(\r\n    private fullscreenService: FullscreenService,\r\n    private userSettingService: UserSettingService,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.currentGeoHazard$ = this.userSettingService.currentGeoHazard$;\r\n    this.selectableGeoHazards$ = this.currentGeoHazard$.pipe(\r\n      map((currentGeoHazard) =>\r\n        GEOHAZARD_TYPES.filter(\r\n          (t) => !currentGeoHazard.some((c) => t.some((z) => z === c))\r\n        )\r\n      )\r\n    );\r\n    this.fullscreen$ = this.fullscreenService.isFullscreen$;\r\n    if (this.animateOnEnter) {\r\n      this.animationTimout = setTimeout(() => {\r\n        this.animateOnEnterState = 'startAnimated';\r\n      }, 500);\r\n    } else {\r\n      this.animateOnEnterState = 'visible';\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.animationTimout) {\r\n      clearTimeout(this.animationTimout);\r\n    }\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n\r\n  toggle() {\r\n    this.triggerOpenClose(!this.isOpen);\r\n  }\r\n\r\n  open() {\r\n    this.triggerOpenClose(true);\r\n  }\r\n\r\n  close() {\r\n    this.triggerOpenClose(false);\r\n  }\r\n\r\n  triggerOpenClose(open: boolean) {\r\n    const changed = this.isOpen !== open;\r\n    if (changed) {\r\n      this.isOpen = open;\r\n      this.isOpenChange.emit(this.isOpen);\r\n    }\r\n  }\r\n\r\n  async setCurrentGeoHazard(geoHazards: GeoHazard[]) {\r\n    this.close();\r\n    const currentSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    this.userSettingService.saveUserSettings({\r\n      ...currentSettings,\r\n      currentGeoHazard: geoHazards\r\n    });\r\n  }\r\n}\r\n","<ion-fab mode=\"ios\" *ngIf=\"(currentGeoHazard$ | async) as currentGeoHazard\" vertical=\"top\" horizontal=\"start\"\r\n  slot=\"fixed\" [ngClass]=\"{ 'fullscreen': fullscreen$ | async }\" [@enterAnimationFab]=\"animateOnEnterState\">\r\n  <ion-item (click)=\"toggle()\">\r\n    <ion-fab-button class=\"ion-margin-end\" slot=\"start\" [color]=\"color\">\r\n      <app-geo-icon [geoHazards]=\"currentGeoHazard\"></app-geo-icon>\r\n    </ion-fab-button>\r\n    <ion-label *ngIf=\"isOpen && showLabels\" @enterAnimation>\r\n      <app-geo-name [geoHazards]=\"currentGeoHazard\"></app-geo-name>\r\n    </ion-label>\r\n  </ion-item>\r\n  <ng-container *ngIf=\"(selectableGeoHazards$ | async) as selectableGeoHazards\">\r\n    <ion-list [@listAnimate]=\"selectableGeoHazards.length\" *ngIf=\"isOpen\" lines=\"none\">\r\n      <ion-item class=\"list-item\" *ngFor=\"let geoHazards of selectableGeoHazards\"\r\n        (click)=\"setCurrentGeoHazard(geoHazards)\">\r\n        <ion-fab-button class=\"ion-margin-end\" slot=\"start\" [color]=\"color\">\r\n          <app-geo-icon [geoHazards]=\"geoHazards\"></app-geo-icon>\r\n        </ion-fab-button>\r\n        <ion-label *ngIf=\"showLabels\">\r\n          <app-geo-name [geoHazards]=\"geoHazards\"></app-geo-name>\r\n        </ion-label>\r\n      </ion-item>\r\n    </ion-list>\r\n  </ng-container>\r\n</ion-fab>\r\n<div *ngIf=\"isOpen\" class=\"wrapper\" (click)=\"toggle()\"></div>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\n\r\n@Component({\r\n  selector: 'app-geo-icon',\r\n  templateUrl: './geo-icon.component.html',\r\n  styleUrls: ['./geo-icon.component.scss']\r\n})\r\nexport class GeoIconComponent implements OnInit {\r\n  constructor() {}\r\n\r\n  @Input() geoHazards: GeoHazard[];\r\n  @Input() useGeoColors = true;\r\n\r\n  get geoClass() {\r\n    if (this.geoHazards && this.geoHazards.length > 0) {\r\n      return this.geoHazards\r\n        .map((geoHazard) => geoHazard !== GeoHazard.Soil ? (<string>GeoHazard[geoHazard]).toLowerCase() : 'dirt')\r\n        .join('-');\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get iconSrc() {\r\n    return `/assets/icon/${this.geoClass.replace(/-/, '_')}.svg`;\r\n  }\r\n\r\n  ngOnInit() {}\r\n}\r\n","<ion-icon [src]=\"iconSrc\" [ngClass]=\"[useGeoColors ? 'geo-color' : '', geoClass]\"></ion-icon>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { Observable } from 'rxjs';\r\nimport { GeoHelperService } from '../../services/geo-helper/geo-helper.service';\r\n\r\n@Component({\r\n  selector: 'app-geo-name',\r\n  templateUrl: './geo-name.component.html',\r\n  styleUrls: ['./geo-name.component.scss']\r\n})\r\nexport class GeoNameComponent implements OnInit {\r\n  @Input() geoHazards: GeoHazard[];\r\n\r\n  name$: Observable<string>;\r\n\r\n  constructor(private geoHelperService: GeoHelperService) {}\r\n\r\n  ngOnInit() {\r\n    this.name$ = this.geoHelperService.getName(this.geoHazards);\r\n  }\r\n}\r\n","{{ name$ | async }}","import { Component, OnInit } from '@angular/core';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { UserSetting } from '../../../../core/models/user-settings.model';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { Observable } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-geo-select',\r\n  templateUrl: './geo-select.component.html',\r\n  styleUrls: ['./geo-select.component.scss']\r\n})\r\nexport class GeoSelectComponent implements OnInit {\r\n  geoHazardTypes: Array<GeoHazard[]>;\r\n  isOpen = false;\r\n  userSettings$: Observable<UserSetting>;\r\n\r\n  constructor(private userSettingService: UserSettingService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.geoHazardTypes = [\r\n      [GeoHazard.Snow],\r\n      [GeoHazard.Ice],\r\n      [GeoHazard.Water, GeoHazard.Soil]\r\n    ];\r\n    this.userSettings$ = this.userSettingService.userSetting$;\r\n  }\r\n\r\n  toggle(): void {\r\n    this.isOpen = !this.isOpen;\r\n  }\r\n\r\n  async changeGeoHazard(geoHazards: GeoHazard[]): Promise<void> {\r\n    this.isOpen = false;\r\n    const currentSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    this.userSettingService.saveUserSettings({\r\n      ...currentSettings,\r\n      currentGeoHazard: geoHazards\r\n    });\r\n  }\r\n}\r\n","<ion-fab *ngIf=\"(userSettings$ | async) as userSettings\" #geoSelectorFab vertical=\"top\" horizontal=\"start\" slot=\"fixed\">\r\n  <ion-fab-button class=\"toggle-button\" *ngIf=\"!isOpen\" color=\"light\" (click)=\"toggle()\">\r\n    <app-geo-icon [geoHazards]=\"userSettings.currentGeoHazard\"></app-geo-icon>\r\n  </ion-fab-button>\r\n  <div class=\"geo-selector-items\" *ngIf=\"isOpen\">\r\n    <div class=\"geo-selector-wrapper\" (click)=\"toggle()\"></div>\r\n    <ion-list lines=\"none\" class=\"ion-no-margin\">\r\n      <ion-item (click)=\"toggle()\">\r\n        <ion-fab-button slot=\"start\" color=\"light\">\r\n          <app-geo-icon [geoHazards]=\"userSettings.currentGeoHazard\"></app-geo-icon>\r\n        </ion-fab-button>\r\n        <ion-label>\r\n          <app-geo-name [geoHazards]=\"userSettings.currentGeoHazard\"></app-geo-name>\r\n        </ion-label>\r\n      </ion-item>\r\n      <ng-container *ngFor=\"let geoHazards of geoHazardTypes\">\r\n        <ion-item *ngIf=\"(geoHazards.join('-') !== userSettings.currentGeoHazard.join('-'))\"\r\n          (click)=\"changeGeoHazard(geoHazards)\">\r\n          <ion-fab-button slot=\"start\" color=\"light\">\r\n            <app-geo-icon [geoHazards]=\"geoHazards\"></app-geo-icon>\r\n          </ion-fab-button>\r\n          <ion-label>\r\n            <app-geo-name [geoHazards]=\"geoHazards\"></app-geo-name>\r\n          </ion-label>\r\n        </ion-item>\r\n      </ng-container>\r\n    </ion-list>\r\n  </div>\r\n</ion-fab>","import { Component, OnInit, Input, NgZone, OnDestroy } from '@angular/core';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { TripLoggerService } from '../../../../core/services/trip-logger/trip-logger.service';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\n\r\n@Component({\r\n  selector: 'app-header',\r\n  templateUrl: './header.component.html',\r\n  styleUrls: ['./header.component.scss']\r\n})\r\nexport class HeaderComponent implements OnInit, OnDestroy {\r\n  @Input() showMenuButton = true;\r\n  @Input() fullscreenSupport = false;\r\n  @Input() title: string;\r\n  @Input() defaultHref = '/';\r\n\r\n  tripRunning = false;\r\n  private appMode = AppMode.Prod;\r\n\r\n  isFullscreen$: Observable<boolean>;\r\n  private subscriptions: Subscription[] = [];\r\n\r\n  get tripRunning$() {\r\n    return this.tripLoggerService.getLegacyTripAsObservable();\r\n  }\r\n\r\n  get headerColor() {\r\n    if (this.tripRunning) {\r\n      return 'trip-running';\r\n    } else {\r\n      return this.appMode.toLowerCase();\r\n    }\r\n  }\r\n\r\n  constructor(\r\n    private fullscreenService: FullscreenService,\r\n    private tripLoggerService: TripLoggerService,\r\n    private userSettingService: UserSettingService,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.isFullscreen$ = this.fullscreenService.isFullscreen$;\r\n    this.subscriptions.push(\r\n      this.tripLoggerService.isTripRunning$.subscribe((val) => {\r\n        this.ngZone.run(() => {\r\n          this.tripRunning = val;\r\n        });\r\n      })\r\n    );\r\n    this.subscriptions.push(\r\n      this.userSettingService.appMode$.subscribe((appMode) => {\r\n        this.ngZone.run(() => {\r\n          this.appMode = appMode;\r\n        });\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  endTrip() {\r\n    this.tripLoggerService.stopLegacyTrip();\r\n  }\r\n}\r\n","<ion-header mode=\"ios\" *ngIf=\"!fullscreenSupport || !(isFullscreen$ | async)\">\r\n  <ion-toolbar class=\"app-header-color\" [ngClass]=\"headerColor\" mode=\"ios\">\r\n    <ion-buttons slot=\"start\" *ngIf=\"!showMenuButton\">\r\n      <ion-back-button text=\"\" [defaultHref]=\"defaultHref\"></ion-back-button>\r\n    </ion-buttons>\r\n    <ion-buttons slot=\"end\" *ngIf=\"showMenuButton\">\r\n      <ion-menu-button color=\"light\" mode=\"ios\"></ion-menu-button>\r\n    </ion-buttons>\r\n    <ion-title *ngIf=\"!tripRunning\">\r\n      {{ title | translate }}\r\n    </ion-title>\r\n    <ion-title *ngIf=\"tripRunning\">\r\n      <ion-button class=\"stop-trip\" size=\"small\" color=\"success\" (click)=\"endTrip()\">\r\n        {{ 'TRIP.STOP_TRIP' | translate }}\r\n      </ion-button>\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>","import { Component, OnInit, Input, EventEmitter, Output } from '@angular/core';\r\nimport { ActionSheetController } from '@ionic/angular';\r\nimport { ActionSheetButton } from '@ionic/core';\r\nimport { SelectOption } from './select-option.model';\r\nimport { TranslateService } from '@ngx-translate/core';\r\n\r\nconst TRANSLATION_KEY_CANCEL = 'DIALOGS.CANCEL';\r\nconst TRANSLATION_KEY_RESET = 'DIALOGS.RESET';\r\n\r\n@Component({\r\n  selector: 'app-select',\r\n  templateUrl: './select.component.html',\r\n  styleUrls: ['./select.component.scss']\r\n})\r\nexport class SelectComponent implements OnInit {\r\n  @Input() title: string;\r\n  @Input() subTitle: string;\r\n  @Input() selectedValue: number | string;\r\n  @Output() selectedValueChange = new EventEmitter();\r\n  @Input() options: Array<SelectOption> = [];\r\n  @Input() showReset = true;\r\n  @Input() disabled = false;\r\n\r\n  get valueText() {\r\n    const item = (this.options || []).find((x) => x.id === this.selectedValue);\r\n    if (item) {\r\n      return item.text;\r\n    }\r\n    return '';\r\n  }\r\n\r\n  get valueIcon() {\r\n    const item = (this.options || []).find((x) => x.id === this.selectedValue);\r\n    if (item) {\r\n      return item.icon;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  constructor(\r\n    private actionSheetController: ActionSheetController,\r\n    private translateService: TranslateService\r\n  ) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  private async getActionSheetButtons() {\r\n    const buttons: ActionSheetButton[] = [];\r\n    for (const option of (this.options || []).filter((x) => !x.disabled)) {\r\n      const translatedText = await this.translateService\r\n        .get(option.text)\r\n        .toPromise();\r\n      buttons.push({\r\n        text: translatedText,\r\n        icon: option.icon,\r\n        role: option.id === this.selectedValue ? 'selected' : undefined,\r\n        handler: () => this.setSelectedValue(option.id)\r\n      });\r\n    }\r\n    if (this.selectedValue !== undefined && this.showReset) {\r\n      const resetTextTranslated = await this.translateService\r\n        .get(TRANSLATION_KEY_RESET)\r\n        .toPromise();\r\n      buttons.splice(0, 0, {\r\n        text: resetTextTranslated,\r\n        handler: () => this.setSelectedValue(undefined),\r\n        role: 'destructive'\r\n      });\r\n    }\r\n    const cancelTextTranslated = await this.translateService\r\n      .get(TRANSLATION_KEY_CANCEL)\r\n      .toPromise();\r\n    buttons.push({\r\n      text: cancelTextTranslated,\r\n      role: 'cancel'\r\n    });\r\n    return buttons;\r\n  }\r\n\r\n  async getTitleTranslations() {\r\n    let titleTextTranslated: string;\r\n    if (this.title) {\r\n      titleTextTranslated = await this.translateService\r\n        .get(this.title)\r\n        .toPromise();\r\n    }\r\n    let subTitleTextTranslated: string;\r\n    if (this.subTitle) {\r\n      subTitleTextTranslated = await this.translateService\r\n        .get(this.subTitle)\r\n        .toPromise();\r\n    }\r\n    return {\r\n      titleTextTranslated,\r\n      subTitleTextTranslated\r\n    };\r\n  }\r\n\r\n  async openSelect() {\r\n    if (!this.disabled) {\r\n      const translations = await this.getTitleTranslations();\r\n      const buttons = await this.getActionSheetButtons();\r\n      const actionSheet = await this.actionSheetController.create({\r\n        header: translations.titleTextTranslated,\r\n        subHeader: translations.subTitleTextTranslated,\r\n        buttons\r\n      });\r\n      await actionSheet.present();\r\n    }\r\n  }\r\n\r\n  private setSelectedValue(id: number | string) {\r\n    this.selectedValue = id;\r\n    this.selectedValueChange.emit(id);\r\n  }\r\n}\r\n","<ion-button role=\"combobox\" aria-expanded=\"false\" aria-haspopup=\"dialog\" expand=\"full\" type=\"button\" fill=\"clear\"\r\n  (click)=\"openSelect()\">\r\n</ion-button>\r\n<ion-icon class=\"value-icon\" *ngIf=\"valueIcon\" [name]=\"valueIcon\"></ion-icon>\r\n<ion-text>\r\n  {{ valueText | translate }}\r\n</ion-text>\r\n<ion-icon class=\"select-icon\" slot=\"end\" name=\"caret-down-sharp\"></ion-icon>","import { Component, OnInit, Input } from '@angular/core';\r\n@Component({\r\n  selector: 'app-offline-image',\r\n  templateUrl: './offline-image.component.html',\r\n  styleUrls: ['./offline-image.component.scss']\r\n})\r\nexport class OfflineImageComponent implements OnInit {\r\n  @Input() src: string;\r\n\r\n  loaded = false;\r\n  hasError = false;\r\n  _srcInternal: string;\r\n  private hasTriedFallback = false;\r\n\r\n  ngOnInit(): void {\r\n    this._srcInternal = this.src;\r\n  }\r\n\r\n  onLoaded(): void {\r\n    this.loaded = true;\r\n  }\r\n\r\n  onError(): void {\r\n    if (this.hasTriedFallback) {\r\n      this.loaded = true;\r\n      this.hasError = true;\r\n    } else {\r\n      this.tryFallbackImage();\r\n    }\r\n  }\r\n\r\n  private tryFallbackImage() {\r\n    if (this.src && this.src.indexOf('regobs.no/Attachment') > 0) {\r\n      this._srcInternal = this.src\r\n        .replace(/large/g, 'raw')\r\n        .replace(/medium/g, 'raw');\r\n    } else {\r\n      this.loaded = true;\r\n      this.hasError = true;\r\n    }\r\n    this.hasTriedFallback = true;\r\n  }\r\n}\r\n","<div class=\"offline-image-wrapper\">\r\n  <ion-img class=\"real-image\" [ngClass]=\"{ 'loaded': loaded, 'error': hasError }\" [src]=\"_srcInternal\"\r\n    (ionImgDidLoad)=\"onLoaded()\" (ionError)=\"onError()\"></ion-img>\r\n  <div class=\"animated-background\" [ngClass]=\"{ 'loaded': loaded, 'error': hasError }\">\r\n    <ion-icon name=\"flash-off\"></ion-icon>\r\n  </div>\r\n</div>","import { Component, OnInit, NgZone, ViewChild, Input } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\nimport { IonRefresher, Platform } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-refresh-with-cancel',\r\n  templateUrl: './refresh-with-cancel.component.html',\r\n  styleUrls: ['./refresh-with-cancel.component.scss']\r\n})\r\nexport class RefreshWithCancelComponent implements OnInit {\r\n  showCancel = false;\r\n\r\n  // @Output() refresh: EventEmitter<Promise<boolean>> = new EventEmitter();\r\n  @ViewChild(IonRefresher) refresher: IonRefresher;\r\n  @Input() refreshFunc: (cancelPromise: Promise<boolean>) => Promise<any>;\r\n  @Input() cancelSubject: Subject<any>;\r\n  @Input() disabled = false;\r\n\r\n  spinner: string;\r\n\r\n  constructor(private ngZone: NgZone, private platform: Platform) {}\r\n\r\n  ngOnInit(): void {\r\n    this.spinner = this.platform.is('android') ? 'crescent' : 'lines';\r\n    if (!this.cancelSubject) {\r\n      this.cancelSubject = new Subject<boolean>();\r\n    }\r\n  }\r\n\r\n  cancel(): void {\r\n    this.cancelSubject.next(true);\r\n  }\r\n\r\n  private getCancelPromise() {\r\n    return this.cancelSubject.asObservable().pipe(take(1)).toPromise();\r\n  }\r\n\r\n  async doRefresh(): Promise<void> {\r\n    if (this.refreshFunc) {\r\n      const cancelPromise = this.getCancelPromise();\r\n      cancelPromise.then(() => this.complete());\r\n      // It takes to long to wait for function to complete (even when cancelled), so hide refresher on cancel.\r\n      this.ngZone.run(() => {\r\n        this.showCancel = true;\r\n      });\r\n      try {\r\n        await this.refreshFunc(cancelPromise);\r\n      } finally {\r\n        this.complete();\r\n      }\r\n    }\r\n  }\r\n\r\n  private complete() {\r\n    this.ngZone.run(() => {\r\n      this.refresher.complete();\r\n    });\r\n    this.ngZone.run(() => {\r\n      this.showCancel = false;\r\n    });\r\n  }\r\n}\r\n","<ion-refresher slot=\"fixed\" (ionRefresh)=\"doRefresh()\" [disabled]=\"disabled\">\r\n  <ion-refresher-content pullingIcon=\"arrow-down-circle\" [refreshingSpinner]=\"spinner\" pullingText=\"\">\r\n  </ion-refresher-content>\r\n  <ion-grid *ngIf=\"showCancel\">\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\">\r\n        <ion-button fill=\"clear\" size=\"small\" (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n</ion-refresher>","import {\r\n  Directive,\r\n  OnInit,\r\n  OnDestroy,\r\n  HostBinding,\r\n  NgZone\r\n} from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\n\r\n@Directive({\r\n  selector: '[appHeaderColor]'\r\n})\r\nexport class HeaderColorDirective implements OnInit, OnDestroy {\r\n  private appMode: AppMode;\r\n  private subscription: Subscription;\r\n\r\n  @HostBinding('class')\r\n  get elementClass(): string {\r\n    return `hydrated app-header-color ${\r\n      this.appMode ? this.appMode.toLowerCase() : ''\r\n    }`;\r\n  }\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.subscription = this.userSettingService.appMode$.subscribe(\r\n      (appMode) => {\r\n        this.ngZone.run(() => {\r\n          this.appMode = appMode;\r\n        });\r\n      }\r\n    );\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n    }\r\n  }\r\n}\r\n","import { Directive, ElementRef, Input, OnChanges } from '@angular/core';\r\n@Directive({\r\n  selector: '[appShadowCss]'\r\n})\r\nexport class ShadowCssDirective implements OnChanges {\r\n  @Input() shadowCustomCss: string;\r\n\r\n  ngOnChanges(): void {\r\n    const shadow =\r\n      this.el.nativeElement.shadowRoot ||\r\n      this.el.nativeElement.attachShadow({ mode: 'open' });\r\n    if (shadow) {\r\n      let innerHTML = '';\r\n      innerHTML += '<style>';\r\n      innerHTML += this.shadowCustomCss;\r\n      innerHTML += '</style>';\r\n      shadow.innerHTML += innerHTML;\r\n    }\r\n  }\r\n  constructor(private el: ElementRef) {}\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\n\r\n@Pipe({\r\n  name: 'abs'\r\n})\r\nexport class AbsPipe implements PipeTransform {\r\n  transform(value: unknown): number | null {\r\n    try {\r\n      return Math.abs(value as number);\r\n    } catch (error) {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport moment from 'moment';\r\nimport { DateHelperService } from '../../services/date-helper/date-helper.service';\r\n\r\n@Pipe({\r\n  name: 'formatDate'\r\n})\r\nexport class FormatDatePipe implements PipeTransform {\r\n  constructor(private dateHelperService: DateHelperService) {}\r\n\r\n  transform(\r\n    value: string | Date,\r\n    showMonthNames = true,\r\n    showYear = true,\r\n    showTime = true\r\n  ) {\r\n    return this.dateHelperService.formatDateString(\r\n      typeof value === 'string' ? value : value ? value.toISOString() : '',\r\n      showMonthNames,\r\n      showYear,\r\n      showTime\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport moment from 'moment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class DateHelperService {\r\n  constructor(private translateService: TranslateService) {}\r\n\r\n  formatDateString(\r\n    dateString: string,\r\n    showMonthNames = true,\r\n    showYear = true,\r\n    showTime = true,\r\n    currentTimeZone: string = null\r\n  ) {\r\n    return this.formatDate(\r\n      moment.parseZone(dateString),\r\n      showMonthNames,\r\n      showYear,\r\n      showTime,\r\n      currentTimeZone\r\n    );\r\n  }\r\n\r\n  async formatDate(\r\n    date: moment.Moment,\r\n    showMonthNames = true,\r\n    showYear = true,\r\n    showTime = true,\r\n    currentTimeZone: string = null\r\n  ) {\r\n    const timezone = currentTimeZone || moment().format('Z');\r\n    if (!date.isValid()) {\r\n      return '';\r\n    }\r\n    const parts = [];\r\n    let dateAndMonth = date.format('DD/MM');\r\n    if (showMonthNames) {\r\n      const monthNames = await this.translateService\r\n        .get('MONTHS.SHORT_LIST')\r\n        .toPromise();\r\n      const monthName = monthNames.split(',')[date.month()].trim();\r\n      dateAndMonth = `${date.format('D')}. ${monthName}`;\r\n    }\r\n    parts.push(dateAndMonth);\r\n    if (showYear) {\r\n      parts.push(date.format('YYYY'));\r\n    }\r\n    if (showTime) {\r\n      parts.push(date.format('HH:mm'));\r\n      if (date.format('Z') !== timezone) {\r\n        parts.push(`(${date.format('Z')})`);\r\n      }\r\n    }\r\n    return parts.join(' ');\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GeoHelperService {\r\n  constructor(private translateService: TranslateService) {}\r\n\r\n  getTranslationKey(geoHazard: GeoHazard) {\r\n    const geoHazardKey = geoHazard !== GeoHazard.Soil ? GeoHazard[geoHazard] : 'Dirt';\r\n    return `GEO_HAZARDS.${geoHazardKey}`.toUpperCase();\r\n  }\r\n\r\n  getTranslationKeys(geoHazards: GeoHazard[]) {\r\n    if (geoHazards && geoHazards.length > 0) {\r\n      return geoHazards.map((geoHazard) => this.getTranslationKey(geoHazard));\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getName(geoHazards: GeoHazard[]): Observable<string> {\r\n    const keys = this.getTranslationKeys(geoHazards);\r\n    return this.translateService\r\n      .get(keys)\r\n      .pipe(map((val) => keys.map((k) => val[k]).join(' / ')));\r\n  }\r\n\r\n  getAllGeoHazards(): GeoHazard[] {\r\n    return Object.keys(GeoHazard)\r\n      .filter((key) => typeof GeoHazard[key] === 'number')\r\n      .map((key) => GeoHazard[key]);\r\n  }\r\n}\r\n","/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\r\n/* eslint-disable @typescript-eslint/no-empty-function */\r\n/* eslint-disable @typescript-eslint/no-unused-vars */\r\n/* eslint-disable no-console */\r\nimport { Injectable, Optional } from '@angular/core';\r\nimport { LogLevel } from './log-level.model';\r\nimport { LoggingService } from './logging.service';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { LoggedInUser } from '../../../login/models/logged-in-user.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ConsoleLoggingService implements LoggingService {\r\n\r\n  constructor() {}\r\n\r\n  enable(): void {}\r\n\r\n  disable(): void {}\r\n\r\n  configureLogging(appMode: AppMode): void {}\r\n\r\n  setUser(user: LoggedInUser): void {}\r\n\r\n  error(\r\n    error: Error,\r\n    tag?: string,\r\n    message?: string,\r\n    ...optionalParams: any[]\r\n  ) {\r\n    this.log(message, error, LogLevel.Error, tag, ...optionalParams);\r\n  }\r\n\r\n  debug(message: string, tag?: string, ...optionalParams: any[]) {\r\n    this.log(message, null, LogLevel.Debug, tag, ...optionalParams);\r\n  }\r\n\r\n  log(\r\n    message?: string,\r\n    error?: Error,\r\n    level?: LogLevel,\r\n    tag?: string,\r\n    ...optionalParams: any[]\r\n  ) {\r\n    const msg = `[${level.toUpperCase()}]${\r\n      tag ? '[' + tag + ']' : ''\r\n    } ${message}`;\r\n    optionalParams.length > 0\r\n      ? console.log(msg, optionalParams)\r\n      : console.log(msg);\r\n    if (error) {\r\n      console.error(error);\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Based on https://github.com/SmartMoveSystems/ionicLogFileAppender\r\n * SmartMove Ionic rolling log file appender\r\n * CellTrack Systems Pty Ltd 2018\r\n *\r\n * MIT License\r\n *\r\n * Copyright (c) 2019 SmartMove Systems\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in all\r\n * copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\r\n * SOFTWARE.\r\n *\r\n */\r\n\r\nimport {formatDate} from '@angular/common';\r\nimport {Entry, File} from '@ionic-native/file/ngx';\r\nimport {Injectable} from '@angular/core';\r\nimport {Platform} from '@ionic/angular';\r\nimport * as _ from 'lodash';\r\nimport {ILogProviderConfig} from './file-logging.config';\r\nimport { EmailComposer, EmailComposerOptions } from '@ionic-native/email-composer/ngx';\r\nimport { settings } from 'src/settings';\r\nimport { LogLevel } from './log-level.model';\r\n\r\n @Injectable({\r\n   providedIn: 'root'\r\n })\r\nexport class FileLoggingService {\r\n\r\n    private fileLoggerReady = false;\r\n    private initFailed = false;\r\n    private currentFile: Entry;\r\n    private lines: 0;\r\n    private queue: string[] = [];\r\n    private processing = false;\r\n\r\n    private readonly defaultConfig: LogProviderConfig;\r\n\r\n    private config: LogProviderConfig;\r\n\r\n    constructor(private file: File,\r\n                private platform: Platform,\r\n                private emailComposer: EmailComposer\r\n    ) {\r\n      this.defaultConfig = new LogProviderConfig({\r\n        enableMetaLogging: false,\r\n        logToConsole: false,\r\n        logDateFormat: 'yyyy-MM-dd HH:mm:ss.SSS',\r\n        fileDateFormat: 'yyyy-MM-dd_HH-mm-ss',\r\n        fileMaxLines: 2000,\r\n        fileMaxSize: 1000000,\r\n        totalLogSize: 5000000,\r\n        baseDir: file.cacheDirectory,\r\n        logDir: 'logs',\r\n        logPrefix: 'regobs',\r\n        devMode: false\r\n      });\r\n      this.config = this.defaultConfig;\r\n    }\r\n\r\n    /**\r\n     * Initializes the file logger\r\n     */\r\n    init(configuration: ILogProviderConfig): Promise<any> {\r\n      return this.platform.ready()\r\n        .then(() => {\r\n          this.config = new LogProviderConfig(configuration);\r\n          // Any configuration not specified will take the defaults\r\n          this.config.merge(this.defaultConfig);\r\n          if (!this.config.baseDir) {\r\n            if (this.platform.is('hybrid')) {\r\n              // Can only initialize this after platform is ready\r\n              this.config.baseDir = this.file.dataDirectory;\r\n            } else {\r\n              this.debug_metaLog('FileLoggingService: No baseDirectory set');\r\n            }\r\n          }\r\n          this.debug_metaLog('LogProvider initialized with configuration: ' + JSON.stringify(this.config));\r\n          this.fileLoggerReady = false;\r\n          this.debug_metaLog('Initializing file logger');\r\n          this.log('Initializing file logger');\r\n          if (!this.platform.is('hybrid'))\r\n          {\r\n            this.debug_metaLog('Not initialising file logger as the it is not supported by the platform ' + this.platform.url());\r\n            this.initFailed = true;\r\n            return Promise.resolve();\r\n          }\r\n          this.debug_metaLog('Data directory: ' + this.config.baseDir);\r\n          return this.file.checkDir(this.config.baseDir, this.config.logDir)\r\n            .then(() => {\r\n              this.debug_metaLog('Found logging directory');\r\n              return this.initLogFile();\r\n            })\r\n            .catch(err => {\r\n              this.debug_metaLog('Could not find logging directory: ' + JSON.stringify(err));\r\n              return this.createLogDir();\r\n            });\r\n        });\r\n    }\r\n\r\n    isReady(): boolean {\r\n      return this.fileLoggerReady;\r\n    }\r\n\r\n    /**\r\n     * Attempts to create the logging directory\r\n     */\r\n    private createLogDir(): Promise<any> {\r\n      this.debug_metaLog('Attempting to create logging directory');\r\n      return this.file.createDir(this.config.baseDir, this.config.logDir, false)\r\n        .then(() => {\r\n          this.debug_metaLog('Successfully created logging directory');\r\n          return this.initLogFile();\r\n        })\r\n        .catch(err => {\r\n          this.initFailed = true;\r\n          this.debug_metaLog('Failed to create logging directory: ' + JSON.stringify(err));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Attempts to initialize the current log file\r\n     * @returns a promise upon completion or failure\r\n     */\r\n    private initLogFile(): Promise<any> {\r\n      this.debug_metaLog('Attempting to initialize log file');\r\n      return this.file.listDir(this.config.baseDir, this.config.logDir)\r\n        .then((entries: Entry[]) => {\r\n          if (entries && entries.length > 0) {\r\n            this.debug_metaLog(entries.length + ' existing log files found.');\r\n            return this.cleanupFiles(entries);\r\n          } else {\r\n            this.debug_metaLog('No existing log files found.');\r\n            return this.cleanupCompleted(null, 0, null);\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.debug_metaLog('Failed to get file list: ' + JSON.stringify(err, Object.getOwnPropertyNames(err)));\r\n          throw err;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Checks the total size of log files against the configured maximum size and deletes oldest if necessary\r\n     * @param entries the files found in the logging directory\r\n     */\r\n    private async cleanupFiles(entries: Entry[]): Promise<any> {\r\n      this.debug_metaLog('Starting cleanup of ' + entries.length + ' log files');\r\n      entries = _.filter(entries, (entry: Entry) => entry.isFile && entry.name && entry.name.startsWith(this.config.logPrefix));\r\n      if (entries.length === 0) {\r\n        return this.cleanupCompleted(null, 0, null)\r\n          .catch(err => {\r\n            // Now we're well and truly buggered\r\n            this.initFailed = true;\r\n            throw err;\r\n          });\r\n      }\r\n      entries = _.orderBy(entries, ['name'],['asc']);\r\n      const total = entries.length;\r\n      let calculated = 0;\r\n      let sizeTotal = 0;\r\n      try {\r\n        // Loop over entries\r\n        for (const entry of entries) {\r\n          const size = await this.getFileSize(entry);\r\n          // Calculate total size of log files\r\n          calculated++;\r\n          sizeTotal += size;\r\n          this.debug_metaLog('After ' + calculated + ' files, total size is ' + sizeTotal);\r\n          if (sizeTotal > this.config.totalLogSize) {\r\n            this.debug_metaLog('Total log file size exceeds limit: ' + sizeTotal);\r\n            return this.maxSizeExceeded(entries, size)\r\n              .catch(err => {\r\n                // Now we're well and truly buggered\r\n                this.initFailed = true;\r\n                throw err;\r\n              });\r\n          } else if (calculated === total) {\r\n            this.debug_metaLog('Total log file size is ok: ' + sizeTotal);\r\n            // Below max size, so we're ready to go\r\n            const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n            return this.cleanupCompleted(lastEntry, size, null)\r\n              .catch(err => {\r\n                // Now we're well and truly buggered\r\n                this.initFailed = true;\r\n                throw err;\r\n              });\r\n          }\r\n        }\r\n      } catch(failure) {\r\n        const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n        // Not much we can do except try to continue\r\n        return this.cleanupCompleted(lastEntry, 0, failure)\r\n          .catch(err => {\r\n            // Now we're in real trouble\r\n            this.initFailed = true;\r\n            throw err;\r\n          });\r\n      }\r\n    }\r\n\r\n    /**\r\n   * Wraps getMetadata in a Promise\r\n   * @param entry\r\n   * @returns a promise\r\n   */\r\n    private async getFileSize(entry: Entry): Promise<number> {\r\n      return new Promise((resolve: ((number) => void), reject) => {\r\n        entry.getMetadata(metadata => {\r\n          resolve(metadata.size);\r\n        }, failure => {\r\n          reject('SEVERE ERROR: could not retrieve metadata. ' + JSON.stringify(failure));\r\n        });\r\n      });\r\n    }\r\n\r\n    /**\r\n     * Attempts to remove one file and recursively check total size again\r\n     * @param entries\r\n     * @param lastEntrySize\r\n     * @param resolve\r\n     * @param reject\r\n     */\r\n    private maxSizeExceeded(entries: Entry[], lastEntrySize: number): Promise<any> {\r\n      return this.removeFile(entries[0])\r\n        .then(() => {\r\n          this.debug_metaLog('Entry successfully removed');\r\n          // Remove oldest entry\r\n          entries.shift();\r\n          // Check again\r\n          return this.cleanupFiles(entries);\r\n        })\r\n        .catch(err => {\r\n          const lastEntry = entries.length > 0 ? entries[entries.length - 1] : null;\r\n          // Not much we can do except try to continue\r\n          return this.cleanupCompleted(lastEntry, lastEntrySize, 'SEVERE ERROR: could not clean up old files. ' + err);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * When file cleanup is completed, attempts to initialize config to point to current log file\r\n     * @param lastEntry The most recent existing log file\r\n     * @param lastEntrySize The size of the most recent existing log file\r\n     * @param error Any error to be logged after initialization\r\n     */\r\n    private cleanupCompleted(lastEntry: Entry, lastEntrySize: number, error: string): Promise<any> {\r\n      this.debug_metaLog('Log file cleanup done');\r\n      if (lastEntry && lastEntrySize < this.config.fileMaxSize) {\r\n        this.currentFile = lastEntry;\r\n        this.fileLoggerReady = true;\r\n        if (error) {\r\n          this.log(error);\r\n        }\r\n        this.debug_metaLog('File logger initialized at existing file: ' + this.currentFile.fullPath);\r\n        this.log('File logger initialized at existing file: ' + this.currentFile.name);\r\n        return Promise.resolve();\r\n      } else {\r\n        this.debug_metaLog('Last file nonexistent or too large. Creating new log file');\r\n        return this.createNextFile()\r\n          .then(() => {\r\n            this.fileLoggerReady = true;\r\n            if (error) {\r\n              this.log(error);\r\n            }\r\n            this.debug_metaLog('File logger initialized at new file: ' + this.currentFile.fullPath);\r\n            this.log('File logger initialized at new file: ' + this.currentFile.name);\r\n            return Promise.resolve();\r\n          });\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Attempts to remove a file\r\n     * @param entry\r\n     */\r\n    private removeFile(entry: Entry): Promise<any> {\r\n      this.debug_metaLog('Removing file: ' + entry.fullPath);\r\n      const fullPath = entry.fullPath;\r\n      const path = fullPath.replace(entry.name, '');\r\n      return this.file.removeFile(this.config.baseDir + path, entry.name);\r\n    }\r\n\r\n    /**\r\n     * Puts the message on the queue for writing to file\r\n     * @param message\r\n     * @param err. If true, logging is at error level\r\n     */\r\n    private logInternal(message: string, err?: boolean): void {\r\n      const date = new Date();\r\n      const dateString = formatDate(date, this.config.logDateFormat, 'en-US');\r\n      const logMessage = '[' + dateString + '] ' + message + '\\r\\n';\r\n      if (this.config.logToConsole) {\r\n        if (err) {\r\n          console.error(logMessage);\r\n        } else {\r\n          console.log(logMessage);\r\n        }\r\n      }\r\n      if (this.initFailed) {\r\n        this.debug_metaLog('File logger init has failed! Message discarded');\r\n        return;\r\n      } else {\r\n        // Put the message on the queue\r\n        this.queue.push(logMessage);\r\n        if (this.fileLoggerReady) {\r\n          if (this.queue.length > 0 && !this.processing) {\r\n            this.processing = true;\r\n            this.doProcess();\r\n          }\r\n        } else {\r\n          this.debug_metaLog('File logger is not ready! Message left on queue');\r\n        }\r\n      }\r\n    }\r\n\r\n    log(\r\n      message?: string,\r\n      error?: Error,\r\n      level?: LogLevel,\r\n      tag?: string,\r\n      ...optionalParams: any[]\r\n    ): void {\r\n      let msg = `[${level?.toUpperCase()}]${\r\n        tag ? '[' + tag + ']' : ''\r\n      } ${message}`;\r\n      if (optionalParams) {\r\n        msg += `. Params: ${this.stringify(optionalParams)}`;\r\n      }\r\n      if (error || (level && level == LogLevel.Error)) {\r\n        this.err(msg, error);\r\n      } else {\r\n        this.logInternal(msg, false);\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Developer-level logging\r\n     * @param message\r\n     */\r\n    logDev(message: string): void {\r\n      if (this.config.devMode) {\r\n        this.log('*DEBUG* ' + message);\r\n      }\r\n    }\r\n\r\n    /**\r\n   * Error-level logging with optional error object\r\n   * @param message\r\n   * @param error\r\n   */\r\n    err(message: string, error?: any): void {\r\n      let logMessage = 'ERROR! ' + message;\r\n      if (error) {\r\n        logMessage += ': ' + this.stringify(error);\r\n      }\r\n      this.logInternal(logMessage, true);\r\n    }\r\n\r\n    private stringify(objects: any[]): string {\r\n      if (objects && objects.length > 0) {\r\n        return JSON.stringify(objects);\r\n      }\r\n      return '';\r\n    }\r\n\r\n    /**\r\n     * Writes the current logging queue to file\r\n     */\r\n    private doProcess(): void {\r\n      this.debug_metaLog('Beginning processing loop');\r\n      this.processQueue()\r\n        .then(() => {\r\n          if (this.queue.length > 0) {\r\n            this.doProcess();\r\n          } else {\r\n            this.checkFileLength()\r\n              .then(() => {\r\n                this.processing = false;\r\n              })\r\n              .catch(err => {\r\n                this.debug_metaLog('Error checking file length: ' + JSON.stringify(err));\r\n                this.processing = false;\r\n              });\r\n          }\r\n        })\r\n        .catch(err => {\r\n          this.debug_metaLog('Error processing queue: ' + err);\r\n          this.processing = false;\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Writes the oldest entry in the queue to file, then checks if file rollover is required\r\n     */\r\n    private processQueue(): Promise<any> {\r\n      this.debug_metaLog('Processing queue of length ' + this.queue.length);\r\n      if (this.queue.length > 0) {\r\n        const message = this.queue.shift();\r\n        return this.file.writeFile(this.config.baseDir + '/' + this.config.logDir, this.currentFile.name, message, {\r\n          append: true,\r\n          replace: false\r\n        })\r\n          .then(() => {\r\n            this.lines++;\r\n            return this.checkFileLength();\r\n          })\r\n          .catch(err => {\r\n            this.debug_metaLog('Error writing to file: ' + err);\r\n          });\r\n      } else {\r\n        return Promise.resolve();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Checks the file length and creates a new file if required\r\n     */\r\n    private checkFileLength(): Promise<any> {\r\n      if (this.lines >= this.config.fileMaxLines) {\r\n        this.debug_metaLog('Creating new file as max number of log entries exceeded');\r\n        return this.createNextFile();\r\n      } else {\r\n        return Promise.resolve();\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Generates a log file name from the current time\r\n     */\r\n    private createLogFileName(): string {\r\n      const date = new Date();\r\n      const dateString = formatDate(date, this.config.fileDateFormat, 'en-US');\r\n      return this.config.logPrefix + '.' + dateString + '.log';\r\n    }\r\n\r\n    /**\r\n     * Creates the next log file and updates the local reference\r\n     */\r\n    private createNextFile(): Promise<any> {\r\n      const fileName = this.createLogFileName();\r\n      this.debug_metaLog('Attempting to create file at: ' + this.config.baseDir + this.config.logDir + '/' + fileName);\r\n      return this.file.createFile(this.config.baseDir + '/' + this.config.logDir, fileName, false)\r\n        .then(newFile => {\r\n          this.lines = 0;\r\n          this.currentFile = newFile;\r\n          this.debug_metaLog('Created new file: ' + this.currentFile.fullPath);\r\n        })\r\n        .catch(err => {\r\n          this.debug_metaLog('Failed to create new file: ' + JSON.stringify(err));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Retrieves the current list of log files in the logging directory\r\n     */\r\n    getLogFiles(): Promise<Entry[]> {\r\n      this.debug_metaLog('Attempting to retrieve log files');\r\n      if (this.initFailed) {\r\n        this.debug_metaLog('Log never initialized so can\\'t retrieve files');\r\n        return Promise.resolve([]);\r\n      } else {\r\n        return this.file.listDir(this.config.baseDir, this.config.logDir);\r\n      }\r\n    }\r\n\r\n    private debug_metaLog(message: string): void {\r\n      if (this.config.enableMetaLogging) {\r\n        console.log('**LOGGER_META**: ' + message);\r\n      }\r\n    }\r\n\r\n    async sendLogsByEmail(): Promise<void> {\r\n      const fileEntries = await this.getLogFiles();\r\n      const filePaths: string[] = fileEntries.map(entry => entry.toURL());\r\n      const attachments = filePaths;\r\n      const email: EmailComposerOptions = {\r\n        to: settings.errorEmailAddress,\r\n        attachments,\r\n        subject: 'Regobs-app-logger',\r\n        body: '',\r\n        isHtml: true\r\n      };\r\n      this.emailComposer.open(email);\r\n    }\r\n}\r\n\r\nclass LogProviderConfig implements ILogProviderConfig {\r\n    // If true, logs verbose details of file logging operations to console\r\n    enableMetaLogging: boolean;\r\n\r\n    // If true, all file log messages also appear in the console\r\n    logToConsole: boolean;\r\n\r\n    // Date format used in log statements\r\n    logDateFormat: string;\r\n\r\n    // Date format used in log file names.\r\n    // NOTE: be careful with special characters like ':' as this can cause file system issues\r\n    fileDateFormat: string;\r\n\r\n    // Maximum number of log statements before file rollover\r\n    fileMaxLines: number;\r\n\r\n    // If the last log file exceeds this size on initialization, a new log file will be created\r\n    fileMaxSize: number;\r\n\r\n    // If the total size of all log files exceeds this size on initialisation, oldest files will be removed\r\n    totalLogSize: number;\r\n\r\n    // Name of directory to create for logs, within the baseDir\r\n    logDir: string;\r\n\r\n    // Name of directory in which to create log directory\r\n    baseDir: string;\r\n\r\n    // Prefix for log files\r\n    logPrefix: string;\r\n\r\n    // Developer-level logging will appear in log files if true\r\n    devMode: boolean;\r\n\r\n    constructor(fields: any) {\r\n      // Quick and dirty extend/assign fields to this model\r\n      for (const f in fields) {\r\n        // @ts-ignore\r\n        this[f] = fields[f];\r\n      }\r\n    }\r\n\r\n    /**\r\n     * Overrides this object's uninitialized fields with the passed parameter's fields\r\n     * @param config\r\n     */\r\n    merge(config: any) {\r\n      for (const k in config) {\r\n        if (!(k in this)) {\r\n          this[k] = config[k];\r\n        }\r\n      }\r\n    }\r\n}","export enum LogLevel {\r\n  Error = 'error',\r\n  Warning = 'warning',\r\n  Log = 'log',\r\n  Info = 'info',\r\n  Debug = 'debug'\r\n}\r\n","import { LogLevel } from './log-level.model';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { LoggedInUser } from '../../../login/models/logged-in-user.model';\r\n\r\nexport abstract class LoggingService {\r\n  abstract configureLogging(appMode: AppMode);\r\n  abstract setUser(user: LoggedInUser);\r\n  abstract error(\r\n    error: Error,\r\n    tag?: string,\r\n    message?: string,\r\n    ...optionalParams: any[]\r\n  );\r\n  abstract debug(message: string, tag?: string, ...optionalParams: any[]);\r\n  abstract log(\r\n    message?: string,\r\n    error?: Error,\r\n    level?: LogLevel,\r\n    tag?: string,\r\n    ...optionalParams: any[]\r\n  );\r\n  abstract enable();\r\n  abstract disable();\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport * as Sentry from '@sentry/browser';\r\nimport { AppVersionService } from '../../../../core/services/app-version/app-version.service';\r\nimport { settings } from '../../../../../settings';\r\nimport { environment } from '../../../../../environments/environment';\r\nimport { LoggedInUser } from '../../../login/models/logged-in-user.model';\r\nimport { LoggingService } from './logging.service';\r\nimport { LogLevel } from './log-level.model';\r\nimport { FileLoggingService } from './file-logging.service';\r\nimport { AppVersion } from 'src/app/core/models/app-version.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SentryService implements LoggingService {\r\n\r\n  private versionInfo: AppVersion;\r\n\r\n  constructor(\r\n    appVersionService: AppVersionService,\r\n    private fileLoggingService: FileLoggingService\r\n  ) {\r\n    this.versionInfo = appVersionService.getAppVersion();\r\n    this.log(\r\n      `Version = ${this.versionInfo.version}, build = ${this.versionInfo.buildNumber}`,\r\n      null,\r\n      LogLevel.Info\r\n    );\r\n  }\r\n\r\n  error(\r\n    error: Error,\r\n    tag?: string,\r\n    message?: string,\r\n    ...optionalParams: any[]\r\n  ) {\r\n    this.log(message, error, LogLevel.Error, tag, ...optionalParams);\r\n  }\r\n\r\n  debug(message: string, tag?: string, ...optionalParams: any[]) {\r\n    this.log(message, null, LogLevel.Debug, tag, ...optionalParams);\r\n  }\r\n\r\n  configureLogging(appMode: AppMode) {\r\n    Sentry.init({\r\n      dsn: environment.production ? settings.sentryDsn : null,\r\n      transport: Sentry.Transports.FetchTransport,\r\n      environment:\r\n        appMode === AppMode.Prod\r\n          ? 'regObs'\r\n          : appMode === AppMode.Demo\r\n            ? 'demo regObs'\r\n            : 'test regObs',\r\n      enabled: environment.production,\r\n      release: this.versionInfo.version,\r\n      dist: this.versionInfo.revision\r\n    });\r\n  }\r\n\r\n  enable() {\r\n    Sentry.init({\r\n      dsn: environment.production ? settings.sentryDsn : null,\r\n      enabled: environment.production\r\n    });\r\n  }\r\n\r\n  disable() {\r\n    Sentry.init({\r\n      dsn: null,\r\n      enabled: false\r\n    });\r\n  }\r\n\r\n  setUser(user: LoggedInUser) {\r\n    if (user && user.email) {\r\n      Sentry.configureScope((scope) => {\r\n        scope.setUser({ email: user.email });\r\n      });\r\n    }\r\n  }\r\n\r\n  log(\r\n    message?: string,\r\n    error?: Error,\r\n    level?: LogLevel,\r\n    tag?: string,\r\n    ...optionalParams: any[]\r\n  ) {\r\n    this.fileLoggingService.log(message, error, level, tag, optionalParams, error);\r\n    if (\r\n      message &&\r\n      (level === LogLevel.Warning ||\r\n        level === LogLevel.Info ||\r\n        level === LogLevel.Error)\r\n    ) {\r\n      Sentry.addBreadcrumb({\r\n        category: tag,\r\n        data: optionalParams,\r\n        message,\r\n        level: (level as unknown) as Sentry.Severity\r\n      });\r\n    }\r\n    if (error && level === LogLevel.Error) {\r\n      if (error) {\r\n        Sentry.captureException(error);\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { AUTH_CALLBACK_PATH } from 'src/app/modules/auth/factories/auth-factory';\r\n\r\n/**\r\n * Removes oauth tokens from given text\r\n * @param text looks for patterns that matches 'code=<token>' in the text\r\n * @returns the same text, but with 'TOKEN_REMOVED' instead of tokens\r\n */\r\nexport function removeOauthTokenFromUrl(text: string): string {\r\n  let result = text;\r\n  if (result?.indexOf(AUTH_CALLBACK_PATH) >= 0) {\r\n    result = updateQueryStringParameter(result, 'code', 'TOKEN_REMOVED');\r\n  }\r\n  return result;\r\n}\r\n\r\n\r\n/**\r\n * Replace specific parameter value(s) in provided url.\r\n * If the parameter doesn't exist in the url, the parameter will NOT be added.\r\n * Edited version of this SO answer: https://stackoverflow.com/a/6021027\r\n * created by \"amateur\" and edited by \"Matt Ball\", \"Joshua Stewardson\" and \"Niyaz\"\r\n * License: https://creativecommons.org/licenses/by-sa/3.0/.\r\n * @returns the new url\r\n */\r\nfunction updateQueryStringParameter(url: string, paramKey: string, paramValue: string): string {\r\n  const re = new RegExp('(?<=[?&])' + paramKey + '=.*?((?=[&\\'])|$)', 'g');\r\n  if (url.match(re)) {\r\n    return url.replace(re, paramKey + '=' + paramValue);\r\n  }\r\n  return url;\r\n}\r\n\r\n","import { TranslateModule } from '@ngx-translate/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { AngularSvgIconModule } from 'angular-svg-icon';\r\nimport { ObservationListCardComponent } from '../../components/observation/observation-list-card/observation-list-card.component';\r\nimport { ImgSwiperComponent } from '../../components/img-swiper/img-swiper.component';\r\nimport { RouterModule } from '@angular/router';\r\nimport { SummaryComponent } from '../../components/observation/summary/summary.component';\r\nimport { ObservationSkeletonComponent } from '../../components/observation/observation-skeleton/observation-skeleton.component';\r\nimport { SelectComponent } from './components/input/select/select.component';\r\nimport { GeoFabComponent } from './components/geo-fab/geo-fab.component';\r\nimport { GeoNameComponent } from './components/geo-name/geo-name.component';\r\nimport { GeoSelectComponent } from './components/geo-select/geo-select.component';\r\nimport { FormatDatePipe } from './pipes/format-date/format-date.pipe';\r\nimport { HeaderColorDirective } from './directives/header-color/header-color.directive';\r\nimport { ShadowCssDirective } from './directives/shadow-css/shadow-css.directive';\r\nimport { GeoIconComponent } from './components/geo-icon/geo-icon.component';\r\nimport { AddMenuComponent } from './components/add-menu/add-menu.component';\r\nimport { ExternalLinkComponent } from './components/external-link/external-link.component';\r\nimport { RefreshWithCancelComponent } from './components/refresh-with-cancel/refresh-with-cancel.component';\r\nimport { HeaderComponent } from './components/header/header.component';\r\nimport { OfflineImageComponent } from './components/offline-image/offline-image.component';\r\nimport { CompetenceComponent } from '../../components/competence/competence.component';\r\nimport { MapImageModule } from '../map-image/map-image.module';\r\nimport { AuthModule } from './../auth/auth.module';\r\nimport { VirtualScrollerModule } from 'ngx-virtual-scroller';\r\nimport { AbsPipe } from './pipes/abs.pipe';\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    AngularSvgIconModule,\r\n    TranslateModule,\r\n    RouterModule,\r\n    MapImageModule,\r\n    AuthModule,\r\n    VirtualScrollerModule\r\n  ],\r\n  declarations: [\r\n    ShadowCssDirective,\r\n    AddMenuComponent,\r\n    OfflineImageComponent,\r\n    ExternalLinkComponent,\r\n    GeoIconComponent,\r\n    GeoSelectComponent,\r\n    FormatDatePipe,\r\n    ObservationListCardComponent,\r\n    ObservationSkeletonComponent,\r\n    ImgSwiperComponent,\r\n    HeaderComponent,\r\n    RefreshWithCancelComponent,\r\n    SummaryComponent,\r\n    HeaderColorDirective,\r\n    SelectComponent,\r\n    GeoFabComponent,\r\n    GeoNameComponent,\r\n    CompetenceComponent,\r\n    AbsPipe\r\n  ],\r\n  exports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    ReactiveFormsModule,\r\n    IonicModule,\r\n    TranslateModule,\r\n    RouterModule,\r\n    ShadowCssDirective,\r\n    AngularSvgIconModule,\r\n    MapImageModule,\r\n    AddMenuComponent,\r\n    OfflineImageComponent,\r\n    ExternalLinkComponent,\r\n    GeoIconComponent,\r\n    GeoSelectComponent,\r\n    FormatDatePipe,\r\n    ObservationListCardComponent,\r\n    ObservationSkeletonComponent,\r\n    ImgSwiperComponent,\r\n    HeaderComponent,\r\n    RefreshWithCancelComponent,\r\n    SummaryComponent,\r\n    HeaderColorDirective,\r\n    SelectComponent,\r\n    GeoFabComponent,\r\n    CompetenceComponent,\r\n    AuthModule,\r\n    VirtualScrollerModule,\r\n    AbsPipe\r\n  ]\r\n})\r\nexport class SharedModule {}\r\n","import { Component, OnInit, OnDestroy, NgZone } from '@angular/core';\r\nimport { Subscription, combineLatest } from 'rxjs';\r\nimport { take } from 'rxjs/operators';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { LoggingService } from '../../../shared/services/logging/logging.service';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { settings } from '../../../../../settings';\r\n\r\n@Component({\r\n  selector: 'app-observations-days-back',\r\n  templateUrl: './observations-days-back.component.html',\r\n  styleUrls: ['./observations-days-back.component.scss']\r\n})\r\nexport class ObservationsDaysBackComponent implements OnInit, OnDestroy {\r\n  selectedDaysBack: number;\r\n  daysBackOptions: { val: number; text: string }[];\r\n  subscription: Subscription;\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private zone: NgZone,\r\n    private loggingService: LoggingService\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.subscription = combineLatest([\r\n      this.userSettingService.daysBack$,\r\n      this.userSettingService.currentGeoHazard$\r\n    ]).subscribe(([daysBack, currentGeoHazard]) => {\r\n      const geoHazard = currentGeoHazard[0];\r\n      this.zone.run(() => {\r\n        this.daysBackOptions = this.getDaysBackArray(geoHazard);\r\n        const daysBackForCurrentGeoHazard = daysBack.find(\r\n          (x) => x.geoHazard === geoHazard\r\n        );\r\n        if (daysBackForCurrentGeoHazard) {\r\n          this.selectedDaysBack = daysBackForCurrentGeoHazard.daysBack;\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.subscription.unsubscribe();\r\n  }\r\n\r\n  getDaysBackArray(geoHazard: GeoHazard) {\r\n    return settings.observations.daysBack[GeoHazard[geoHazard]].map(\r\n      (val: number) => ({\r\n        val: val,\r\n        text: val === 0 ? 'MENU.TODAYS_OBSERVATIONS' : undefined\r\n      })\r\n    );\r\n  }\r\n\r\n  async save(): Promise<void> {\r\n    const userSetting = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    let changed = false;\r\n    for (const geoHazard of userSetting.currentGeoHazard) {\r\n      const existingValue = userSetting.observationDaysBack.find(\r\n        (x) => x.geoHazard === geoHazard\r\n      );\r\n      if (existingValue.daysBack !== this.selectedDaysBack) {\r\n        existingValue.daysBack = this.selectedDaysBack;\r\n        changed = true;\r\n      }\r\n    }\r\n    if (changed) {\r\n      this.userSettingService.saveUserSettings(userSetting);\r\n    }\r\n  }\r\n}\r\n","<ion-item class=\"no-border\">\r\n  <ion-label color=\"dark\" position=\"stacked\">{{'MENU.TIME_FRAME' | translate}}</ion-label>\r\n  <ion-select cancelText=\"{{'DIALOGS.CANCEL' | translate}}\" interface=\"action-sheet\" (ionChange)=\"save()\"\r\n    [(ngModel)]=\"selectedDaysBack\">\r\n    <ion-select-option *ngFor=\"let item of daysBackOptions\" [value]=\"item.val\">\r\n      <ng-container *ngIf=\"item.text\"> {{ item.text | translate }}</ng-container>\r\n      <ng-container *ngIf=\"!item.text && item.val < 28\">{{ item.val }} {{'MENU.DAYS_BACK' | translate | lowercase}}\r\n      </ng-container>\r\n      <ng-container *ngIf=\"!item.text && item.val >= 28\">{{ (item.val / 7) }} {{'MENU.WEEKS_BACK' | translate |\r\n        lowercase}}</ng-container>\r\n    </ion-select-option>\r\n  </ion-select>\r\n</ion-item>","import { Component, OnInit, OnDestroy, NgZone } from '@angular/core';\r\nimport { ObservationService } from '../../../core/services/observation/observation.service';\r\nimport { UserSettingService } from '../../../core/services/user-setting/user-setting.service';\r\nimport { UserSetting } from '../../../core/models/user-settings.model';\r\nimport { settings } from '../../../../settings';\r\nimport { Subscription } from 'rxjs';\r\nimport { ModalController, Platform, NavController } from '@ionic/angular';\r\nimport { LegalTermsModalPage } from '../../../pages/modal-pages/legal-terms-modal/legal-terms-modal.page';\r\nimport { TopoMap } from '../../../core/models/topo-map.enum';\r\nimport {\r\n  EmailComposer,\r\n  EmailComposerOptions\r\n} from '@ionic-native/email-composer/ngx';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { AppVersionService } from '../../../core/services/app-version/app-version.service';\r\nimport { LangKey } from '@varsom-regobs-common/core';\r\nimport { isAndroidOrIos } from 'src/app/core/helpers/ionic/platform-helper';\r\nimport { DataMarshallService } from 'src/app/core/services/data-marshall/data-marshall.service';\r\n\r\n@Component({\r\n  selector: 'app-side-menu',\r\n  templateUrl: './side-menu.component.html',\r\n  styleUrls: ['./side-menu.component.scss']\r\n})\r\nexport class SideMenuComponent implements OnInit, OnDestroy {\r\n  userSettings: UserSetting;\r\n  lastUpdated: Date;\r\n  settings = settings;\r\n  TopoMap = TopoMap;\r\n  LangKey = LangKey;\r\n  offlineMapsAvailable = false;\r\n\r\n  supportedLanguages: {\r\n    lang: string;\r\n    name: string;\r\n    langKey: LangKey;\r\n  }[] = settings.language.supportedLanguages.map((lang) => ({\r\n    ...lang,\r\n    langKey: LangKey[lang.lang]\r\n  }));\r\n\r\n  private lastUpdateSubscription: Subscription;\r\n  private userSettingSubscription: Subscription;\r\n\r\n  constructor(\r\n    private observationService: ObservationService,\r\n    private userSettingService: UserSettingService,\r\n    private modalController: ModalController,\r\n    private emailComposer: EmailComposer,\r\n    private translateService: TranslateService,\r\n    private appVersionService: AppVersionService,\r\n    private platform: Platform,\r\n    private navController: NavController,\r\n    private ngZone: NgZone,\r\n    private dataMarshallService: DataMarshallService\r\n  ) {}\r\n\r\n  async ngOnInit() {\r\n    this.lastUpdateSubscription = this.observationService\r\n      .getLastUpdatedForCurrentGeoHazardAsObservable()\r\n      .subscribe((val) => {\r\n        this.ngZone.run(() => {\r\n          this.lastUpdated = val;\r\n        });\r\n      });\r\n    this.userSettingSubscription = this.userSettingService.userSetting$.subscribe(\r\n      (val) => {\r\n        this.ngZone.run(() => {\r\n          this.userSettings = val;\r\n        });\r\n      }\r\n    );\r\n    this.offlineMapsAvailable = isAndroidOrIos(this.platform);\r\n  }\r\n\r\n  saveUserSettings() {\r\n    this.userSettingService.saveUserSettings(this.userSettings);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.lastUpdateSubscription) {\r\n      this.lastUpdateSubscription.unsubscribe();\r\n    }\r\n    if (this.userSettingSubscription) {\r\n      this.userSettingSubscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  updateObservations() {\r\n    this.observationService.forceUpdateObservationsForCurrentGeoHazard();\r\n  }\r\n\r\n  async showLegalTerms() {\r\n    const modal = await this.modalController.create({\r\n      component: LegalTermsModalPage\r\n    });\r\n    modal.present();\r\n  }\r\n\r\n  openStartWizard() {\r\n    this.userSettings.showGeoSelectInfo = true;\r\n    this.saveUserSettings();\r\n    this.navController.navigateRoot('start-wizard');\r\n  }\r\n\r\n  async contactUs() {\r\n    const translations = await this.translateService\r\n      .get('MENU.CONTACT_SUBJECT')\r\n      .toPromise();\r\n    const email: EmailComposerOptions = {\r\n      to: settings.errorEmailAddress,\r\n      subject: translations,\r\n      isHtml: true\r\n    };\r\n    this.emailComposer.open(email);\r\n  }\r\n\r\n  async contactError() {\r\n    const translations = await this.translateService\r\n      .get(['MENU.ERROR_REPORT_DESCRIPTION', 'MENU.CONTACT_REGOBS_ERROR'])\r\n      .toPromise();\r\n    const appVersion = await this.appVersionService.getAppVersion();\r\n    const email: EmailComposerOptions = {\r\n      to: settings.errorEmailAddress,\r\n      subject:\r\n        `${translations['MENU.CONTACT_REGOBS_ERROR']}: ${\r\n          this.platform.is('ios') ? 'ios' : ''\r\n        }` +\r\n        `${this.platform.is('android') ? 'android' : ''}` +\r\n        ` ${appVersion.version} ${appVersion.buildNumber} ${appVersion.revision}`,\r\n      body: translations['MENU.ERROR_REPORT_DESCRIPTION'],\r\n      isHtml: true\r\n    };\r\n    this.emailComposer.open(email);\r\n  }\r\n\r\n  changeLanguage() {\r\n    //save language setting\r\n    this.userSettingService.saveUserSettings(this.userSettings);\r\n\r\n    //load observations from API in new language\r\n    this.observationService.forceUpdateObservationsForCurrentGeoHazard(\r\n      this.dataMarshallService.cancelObservationsPromise\r\n    );\r\n  }\r\n}\r\n","<ion-list lines=\"full\" class=\"ion-no-margin\" *ngIf=\"userSettings\">\r\n  <ion-list-header color=\"varsom-blue\" class=\"ion-no-margin\">\r\n    <ion-label class=\"list-header-label\">\r\n      {{'MENU.USER_SETTINGS' | translate}}\r\n    </ion-label>\r\n  </ion-list-header>\r\n  <ion-menu-toggle auto-hide=\"false\">\r\n    <app-user-login></app-user-login>\r\n    <ion-item routerLink=\"/user-settings\" routerDirection=\"forward\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"settings\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">\r\n        {{'SETTINGS.TITLE' | translate}}\r\n      </ion-label>\r\n    </ion-item>\r\n    <ion-item>\r\n      <ion-icon slot=\"start\" name=\"globe-sharp\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label position=\"stacked\" color=\"medium\" class=\"ion-text-uppercase\">\r\n        {{ \"SETTINGS.LANGUAGE\" | translate }}<span *ngIf=\"userSettings.language !== LangKey.en\"> / Language</span>\r\n      </ion-label>\r\n      <ion-select cancelText=\"{{'DIALOGS.CANCEL' | translate}}\" [(ngModel)]=\"userSettings.language\"\r\n        interface=\"action-sheet\" (ngModelChange)=\"changeLanguage()\">\r\n        <ion-select-option [value]=\"lang.langKey\" *ngFor=\"let lang of supportedLanguages\">\r\n          {{ lang.name }}\r\n        </ion-select-option>\r\n      </ion-select>\r\n    </ion-item>\r\n  </ion-menu-toggle>\r\n  <ion-list-header color=\"varsom-blue\" class=\"ion-no-margin\">\r\n    <ion-label class=\"list-header-label\">\r\n      {{'MENU.MAP_SETTINGS' | translate}}\r\n    </ion-label>\r\n  </ion-list-header>\r\n  <ion-item>\r\n    <svg-icon slot=\"start\" src=\"/assets/icon/map-center-menu.svg\"></svg-icon>\r\n    <ion-label class=\"menu-label\">\r\n      {{'MENU.SHOW_MAP_CENTER' | translate}}\r\n    </ion-label>\r\n    <ion-toggle [(ngModel)]=\"userSettings.showMapCenter\" (ionChange)=\"saveUserSettings()\"></ion-toggle>\r\n  </ion-item>\r\n  <ion-item>\r\n    <ion-icon slot=\"start\" name=\"eye\" color=\"varsom-blue\"></ion-icon>\r\n    <ion-label class=\"menu-label\">\r\n      {{'MENU.SHOW_OBSERVATIONS' | translate}}\r\n    </ion-label>\r\n    <ion-toggle [(ngModel)]=\"userSettings.showObservations\" (ionChange)=\"saveUserSettings()\"></ion-toggle>\r\n  </ion-item>\r\n  <div class=\"inner-list-panel\" *ngIf=\"userSettings.showObservations\">\r\n    <app-observations-days-back></app-observations-days-back>\r\n    <app-update-observations></app-update-observations>\r\n  </div>\r\n  <ion-item>\r\n    <ion-label position=\"stacked\" color=\"dark\" class=\"stacked-label\">{{ 'MENU.MAP' | translate }}</ion-label>\r\n    <ion-select cancelText=\"{{'DIALOGS.CANCEL' | translate}}\" [(ngModel)]=\"userSettings.topoMap\"\r\n      interface=\"action-sheet\" (ngModelChange)=\"saveUserSettings()\">\r\n      <ion-select-option [value]=\"TopoMap.default\">{{ 'MENU.TILES.ARC_GIS' | translate }} + {{\r\n        'MENU.TILES.KARTVERKET' | translate }}</ion-select-option>\r\n      <ion-select-option [value]=\"TopoMap.mixOpenTopo\">{{ 'MENU.TILES.OPEN_TOPO' | translate }} + {{\r\n        'MENU.TILES.KARTVERKET' | translate }}</ion-select-option>\r\n      <ion-select-option [value]=\"TopoMap.geoDataLandskap\">{{ 'MENU.TILES.GEODATA_LANDSKAP' | translate }}\r\n      </ion-select-option>\r\n    </ion-select>\r\n  </ion-item>\r\n  <ion-menu-toggle auto-hide=\"false\">\r\n    <ion-item routerLink=\"/offline-map\" routerDirection=\"forward\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"download-outline\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">\r\n        {{ 'OFFLINE_MAP.OFFLINE_MAP_PAGE_TITLE' | translate }}\r\n      </ion-label>\r\n    </ion-item>\r\n  </ion-menu-toggle>\r\n  <app-support-tiles-menu></app-support-tiles-menu>\r\n  <ion-list-header color=\"varsom-blue\" class=\"ion-no-margin\">\r\n    <ion-label class=\"list-header-label\">\r\n      {{'MENU.OTHER' | translate}}\r\n    </ion-label>\r\n  </ion-list-header>\r\n  <ion-menu-toggle auto-hide=\"false\">\r\n    <ion-item (click)=\"showLegalTerms()\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"information-circle-outline\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">{{'MENU.ABOUT_REGOBS' | translate}}</ion-label>\r\n    </ion-item>\r\n    <ion-item (click)=\"openStartWizard()\" detail=\"true\">\r\n      <svg-icon slot=\"start\" src=\"/assets/icon/start-wizard.svg\"></svg-icon>\r\n      <ion-label class=\"menu-label\">{{'MENU.START_WIZARD' | translate}}</ion-label>\r\n    </ion-item>\r\n    <ion-item (click)=\"contactError()\" detail=\"true\">\r\n      <svg-icon slot=\"start\" src=\"/assets/icon/error.svg\"></svg-icon>\r\n      <ion-label class=\"menu-label\">{{'MENU.CONTACT_REGOBS_ERROR' | translate}}</ion-label>\r\n    </ion-item>\r\n    <ion-item (click)=\"contactUs()\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"mail\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">{{'MENU.CONTACT_REGOBS' | translate}}</ion-label>\r\n    </ion-item>\r\n  </ion-menu-toggle>\r\n  <ion-item-divider>\r\n    <ion-label class=\"ion-text-wrap\">\r\n      {{'MENU.TOPO_MAP_CREDITS' | translate}} <app-external-link src=\"https://www.kartverket.no/\">Kartverket\r\n      </app-external-link>,\r\n      <app-external-link src=\"https://www.esri.com/\">Esri</app-external-link>, <app-external-link\r\n        src=\"https://www.geodata.no/\">Geodata</app-external-link>\r\n      {{'MENU.AND' | translate}}\r\n      <app-external-link src=\"https://opentopomap.org/\">OpenTopoMap</app-external-link>.\r\n      {{'MENU.SUPPORT_MAP_CREDITS' | translate}} <app-external-link src=\"https://www.nve.no/\">NVE</app-external-link>\r\n    </ion-label>\r\n  </ion-item-divider>\r\n</ion-list>","import { Component, ChangeDetectionStrategy } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-clayzones-legend',\r\n  templateUrl: './clayzones-legend.component.html',\r\n  styleUrls: ['./clayzones-legend.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class ClayzonesLegendComponent {}\r\n","<p [innerHTML]=\"'SUPPORT_MAP.CLAY_MAP_DISCLAMER' | translate\"></p>\r\n<br />\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAPJJREFUOI1jYaAyYBk1cOgZyNkitCZa+quS7l+G398vMRzdP+ln0U6yDDRnCBPOYahdrPROxxMmpspgmCvPrtlf/NOzhmQDkxkK65UYEIZBFLNymfx0Lq1imHuqjSF5E0kGCrGLuzD8xKaBlU2NwciTgYGBNAOZfjLz4ZJjEWLhY3iHQw6Xph/s324x/GSQxib38eu7mzgtwyXx4ueTHiEGcQteBkFOZPHHDLev3/x5rI9kA4sYXLdNZjgQKcYuVcf+k0vnP8O/b5/Z3x988PNe3iSGyi8kG8jAwMCQy+CwkeEnw0a4AJZIIslAcsCogZQDADtZRA3CbXJoAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_1'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAIdJREFUOI211NENgCAMBFCaMAhDMgZDskn5kiBci7TIn+b6rMlpDJdP/BPkCx69NqyZQypEKFkz9wcKGZ437INoIBWiB5UyEPSi8XRgl1k29KLwlY2oDFpQdUMPuv1SvqJB6qEVhRtqYXOxvSgstgcVi21F1WIfohAcf1HLPYCOlzSDYhVOTgM80cZWbNLXegAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_2'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFlJREFUOI3tlMEKACAIQyf4/79spyAUSbOgg962w2NOkHF5+BlQAKnCCCDWxilsBjIrCyArOKsNUKfMavco2WRbYDaZC+wOw9oFdodh7QL/7rDyEyeYtVGdASmgOIUrOvuWAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_3'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADJJREFUOI1jYaAyYBk1cNTAwWXg//+4lTEyovKxqYWooaUL0V2BD+BWO6QiZdTAYWsgAIFsBFXO3k8bAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_4'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>\r\n<p>{{'SUPPORT_MAP.CLAY_DANGER_ZONE'|translate}}:</p>\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAHhJREFUOI210ksOwCAIBFBIuP+V6cYaItPKR2enwZcxQehw5CaoBzxeG7LRdVwwfURNiXcIfrmAMY2zA4vYjKDBKgYbdjAHdjHYsIOFwAy2BaOYEunvHmaxbcMsFlrsJIYbdjHYsINBsIM5kOc7HKOgGV7B7dJG8gD5VDVWrqAQVAAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.HIGH'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAIFJREFUOI211EEOwCAIBEBI/GPf6CvpoWgTwAJiOTab6RqJDQ5P+xOkAx7Khjj1/vwAr/ebnJHhnGqoggkMgU+owE1sTrOCu5jZsIIpsIqZDStYCMxgLhjFqAN97mEWcxtmsdBiJzG7YRUzG1YwE6xgCuSrX76LYzUWGZSgu7SRuQHuVU8J5MIeKgAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.MIDDLE'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAIBJREFUOI211MENwCAMA0BbYmTG6M7pB3iQUBJC87ZOrmpRcPnKn6Bc8Dg35NClCgCQD7G4nmk51VAFAxjRvlCBh9i4YgVPMbNhBlNgFjMbZjAXGMG2oBcTqfK5wyi2bRjFXMMOYnbDLGY2zGAmmMEU2H798l3s01hkOIPb0XruBcqZaBfEUN04AAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.LOW'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>\r\n<p>{{'SUPPORT_MAP.CAUTION_AREA'|translate}}:</p>\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADpJREFUOI1jYaAyYKGlgf+pYB4jigtLVMg3qecOhKapl0cNHDVw1MBRA7EbCCuCyASM6AYyUmQcFAAA2r4Eu4YBFUkAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_8'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAGBJREFUOI1jYaAyYKGZgSUqDP8pNaznDgMjC7oAuYbBHETQyzCFuCxD9xntwhAXIBQMMHmivUwqwDCQ2DDDJU97FxIbZkQbSCkYTYeUgyGWDpFjjFD5iC4PczELugClAAC0+S663TRkhAAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_9'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>\r\n<p>{{'SUPPORT_MAP.MARITINE_BORDER'|translate}}:</p>\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABtJREFUOI1jYaAyYBk1cNTAUQNHDRw1cKQaCAAQKwBR5g8A3AAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_5'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAGNJREFUOI3dkjEKACAMAxX8le/3XbpKMEXTomCmLh7p1ZKCU+4AW++p5hwHFGEciJkbs/kIOD9iMwU6/K2BxjoaEMEI/9ihG4jNdryZDrHZjrf3DoW17W8jrM2PIoYfxQ0MygBTsERSNt9GdAAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_6'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFRJREFUOI1jYaAyYBk1kGHfi///GRgYGJwkGBmxaSAkT3sX4rKZWHn6RwqhMCPZQFIBQQNJje3Bk7AHLh2SGqsEDaQUEJ1TcLkcXXzgYhmXy2meDgFJ/R7VSV9q1AAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.CLAY_LEGEND_TEXT_7'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-floodzones-legend',\r\n  templateUrl: './floodzones-legend.component.html',\r\n  styleUrls: ['./floodzones-legend.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FloodzonesLegendComponent {}\r\n","<p [innerHTML]=\"'SUPPORT_MAP.FLOOD_MAP_DISCLAMER' | translate\"></p>\r\n<br />\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAExJREFUOI1jYaAyYIExnjEw/KfEICkGBka4gZQaBjNDioGBkQVZEGYLOYbB2Cz4FJIDRg0cNXDUwGFoIDWKMRYGBkixRdUCFlmAUgAAtX8MUWjJcMsAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_1'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAExJREFUOI1jYaAyYIExns1k+E+JQVLpDIxwAyk1DGaGVDoDIwuyIMwWcgyDsVnwKSQHjBo4auCogcPQQGoUYywMDJBii6oFLLIApQAA9CQSUSl++5QAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_2'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAExJREFUOI1jYaAyYIExVjAw/KfEoAgGBka4gZQaBjMjgoGBkQVZEGYLOYbB2Cz4FJIDRg0cNXDUwGFoIDWKMRYGBkixRdUCFlmAUgAAQuQMUQvlxYsAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_3'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAFpJREFUOI1jYaAyYIExnjEw/MelSIqBgZGQPIaBlACYZVIMDIws6ALEuAKXgVRzITIYNXCQGIiRDvElCWIAWemQWDA4w3DUQASgRpmIkg7xaSDLhYTSITHpFAAHhBS9fDWHWwAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_4'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAEJJREFUOI1jYaAyYKGdgb4r/lNs2uYIRhQXTu/3ItuszMJtDAwMNPXyqIGjBo4aOGogLgNhRRBZYHMEI6qBUAFKAQDn3Qn5K8ZpUQAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_6'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>\r\n<p>\r\n  {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_YEAR'|translate}}:\r\n</p>\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZgfte/P9PiUFOEoyMKAZSC4waOGrgqIGjBtLZQFh5RjUDqQUAz1QEreCHgOkAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_5'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZgSXn//+nxKAeQ0ZGFAOpBUYNHDVw1MBRA+lsIKw8o5qB1AIA8aYFEC0jhBwAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_7'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAC9JREFUOI1jYaAyYKGdgdP+/6fIpCxGRlQDqQRGDRw1cNTAUQPpbSC0PKOegVQCACtHA722vKj4AAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_8'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAC9JREFUOI1jYaAyYKGdgdHP/lNk0lIpRlQDqQRGDRw1cNTAUQPpbSC0PKOegVQCAEgOBBHrbs3dAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_9'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAC9JREFUOI1jYaAyYKGdgSol/yky6U4PI6qBVAKjBo4aOGrgqIH0NhBanlHPQCoBAIG0BLocdyqFAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_10'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZga0MK/5TYlA1QwQjioHUAqMGjho4auCogXQ2EFaeUc1AagEAUCsEJep8d6kAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_11'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZgUcZ/v+nxCBrBkZGFAOpBUYNHDVw1MBRA+lsIKw8o5qB1AIAHFoDju+MrFoAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_12'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZgf/r6/9TYhBjYyMjioHUAqMGjho4auCogXQ2EFaeUc1AagEACGIFVcABtIoAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.FLOOD_LEGEND_TEXT_13'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { SteepnessLegendComponent } from './steepness-legend/steepness-legend.component';\r\nimport { FloodzonesLegendComponent } from './floodzones-legend/floodzones-legend.component';\r\nimport { ClayzonesLegendComponent } from './clayzones-legend/clayzones-legend.component';\r\nimport { WeakenediceLegendComponent } from './weakenedice-legend/weakenedice-legend.component';\r\n\r\nexport const legendsConfig = {\r\n  steepness: SteepnessLegendComponent,\r\n  floodzoones: FloodzonesLegendComponent,\r\n  clayzones: ClayzonesLegendComponent,\r\n  weakenedice: WeakenediceLegendComponent,\r\n};\r\n","import { Component, OnInit, ChangeDetectionStrategy } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { SupportMapInfoPage } from '../../../../../map/pages/support-map-info/support-map-info.page';\r\n\r\n@Component({\r\n  selector: 'app-steepness-common-legend',\r\n  templateUrl: './steepness-common-legend.component.html',\r\n  styleUrls: ['./steepness-common-legend.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SteepnessCommonLegendComponent {\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  async openAboutMapsModal() {\r\n    const modalInfoPage = await this.modalController.create({\r\n      component: SupportMapInfoPage\r\n    });\r\n    modalInfoPage.present();\r\n  }\r\n}\r\n","<p>{{'SUPPORT_MAP.STEEPNESS_COLOR_INFO'|translate}}</p>\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADpJREFUOI1jYaAyYKGlgf+pYB4jigtVSsg36U4PhKapl0cNHDVw1MBRA7EbCCuCyASM6AYyUmQcFAAA2w4Eu02XbecAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      27-30\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADhJREFUOI1jYaAyYKGlgf+pYB4jigv/U2AkIyOEpqmXRw0cNXDUwFEDsRsIK4LIBIzoBlJmHBQAAF8jA1XJU6ZXAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      30-35\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADlJREFUOI1jYaAyYKGlgf+pYB4jigv/r6TApHAITVMvjxo4auCogaMGYjcQVgSRCRjRDWSkyDgoAAB8swOrTPh0KQAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      35-40\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADlJREFUOI1jYaAyYKGlgf+pYB4jigv/h1Jg0moITVMvjxo4auCogaMGYjcQVgSRCRjRDWSkyDgoAACZkwP/r1UNTQAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      40-45\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADhJREFUOI1jYaAyYKGlgf+pYB4jigufUWCSFJSmqZdHDRw1cNTAUQOxGyiFSxVxgBHdQEbKzIMAABQxAm3yqYmFAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      45-50\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADhJREFUOI1jYaAyYKGlgf+pYB4jigtLKDCpB0rT1MujBo4aOGrgqIHYDezBpYo4wIhuICNl5kEAADvTAt94zGSEAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      > 50\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col class=\"ion-no-padding\">\r\n      <ion-button fill=\"clear\" (click)=\"openAboutMapsModal()\">{{'SUPPORT_MAP.READ_MORE' | translate}}</ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, ChangeDetectionStrategy } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { SupportTile } from 'src/app/core/models/support-tile.model';\r\nimport { UserSettingService } from 'src/app/core/services/user-setting/user-setting.service';import { SupportMapInfoPage } from 'src/app/modules/map/pages/support-map-info/support-map-info.page';\r\nimport {\r\n  setObservableTimeout\r\n} from '../../../../../../core/helpers/observable-helper';\r\n\r\n@Component({\r\n  selector: 'app-steepness-legend',\r\n  templateUrl: './steepness-legend.component.html',\r\n  styleUrls: ['./steepness-legend.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SteepnessLegendComponent {\r\n  readonly supportTilesWithSubTiles$: Observable<SupportTile[]>;\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n  ) {\r\n    this.supportTilesWithSubTiles$ = this.userSettingService.supportTilesWithSubTiles$.pipe(\r\n      setObservableTimeout()\r\n    );\r\n  }\r\n\r\n  isOutletsActive(supportTiles: SupportTile[]): boolean {\r\n    const steepness = supportTiles.find((t) => t.name == 'steepness');\r\n    if (steepness && steepness.subTile && steepness.subTile.name == 'steepness-outlet') {\r\n      return steepness.subTile.enabled;\r\n    }\r\n    return false;\r\n  }\r\n}","<p [innerHTML]=\"'SUPPORT_MAP.STEEPNESS_MAP_DISCLAMER' | translate\"></p><br>\r\n<ng-container *ngIf=\"supportTilesWithSubTiles$ | async as supportTiles\">\r\n  <ng-container *ngIf=\"isOutletsActive(supportTiles)\">\r\n    <p [innerHTML]=\"'SUPPORT_MAP.STEEPNESS_OUTLET_LEGEND_TITLE' | translate\"></p>\r\n    <div class=\"tile-legend-row\">\r\n      <img class=\"tile-legend-image\"\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADtJREFUOI1jYaAyYKGlgf+pYB4jqgt9V5Bv1OYIBgYGGnt51MBRA0cNHDUQh4HQIohMwIhuICMlpsEAALfiBF7FLHyOAAAAAElFTkSuQmCC\" />\r\n      {{'SUPPORT_MAP.STEEPNESS_OUTLET_LEGEND_TEXT_1' | translate}}\r\n    </div>\r\n    <div class=\"tile-legend-row\">\r\n      <img class=\"tile-legend-image\"\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADlJREFUOI1jYaAyYKGlgf+pYB4jqgvzKTBzIiMDAwONvTxq4KiBowaOGojDQGgRRCZgRDeQItNgAACOoQPlkCSSYAAAAABJRU5ErkJggg==\" />\r\n      {{'SUPPORT_MAP.STEEPNESS_OUTLET_LEGEND_TEXT_2' | translate}}\r\n    </div>\r\n    <div class=\"tile-legend-row\">\r\n      <img class=\"tile-legend-image\"\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADtJREFUOI1jYaAyYKGlgf+pYB4jigv3XSLfTCc9RgYGBhp7edTAUQNHDRw1ELuBsCKITMCIbiBFpsEAANfWBMRO4MAYAAAAAElFTkSuQmCC\" />\r\n      {{'SUPPORT_MAP.STEEPNESS_OUTLET_LEGEND_TEXT_3' | translate}}\r\n    </div><br>\r\n  </ng-container>\r\n  <ng-container *ngIf=\"!isOutletsActive(supportTiles)\">\r\n    <p [innerHTML]=\"'SUPPORT_MAP.STEEPNESS_OFFLINE_DISCLAMER' | translate\"></p><br>\r\n  </ng-container>\r\n</ng-container>\r\n<app-steepness-common-legend></app-steepness-common-legend>","import {\r\n  Component,\r\n  OnInit,\r\n  ChangeDetectionStrategy,\r\n  Input,\r\n  ComponentFactoryResolver,\r\n  ViewChild,\r\n  ViewContainerRef\r\n} from '@angular/core';\r\nimport { legendsConfig } from '../legends.config';\r\n\r\n@Component({\r\n  selector: 'app-support-tile-legend-loader',\r\n  templateUrl: './support-tile-legend-loader.component.html',\r\n  styleUrls: ['./support-tile-legend-loader.component.css'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SupportTileLegendLoaderComponent implements OnInit {\r\n  @Input() name: string;\r\n  @ViewChild('legend', { static: true, read: ViewContainerRef })\r\n  viewContainerRef: ViewContainerRef;\r\n\r\n  constructor(private componentFactoryResolver: ComponentFactoryResolver) {}\r\n\r\n  ngOnInit(): void {\r\n    this.loadComponent();\r\n  }\r\n\r\n  loadComponent(): void {\r\n    if (this.name && legendsConfig[this.name]) {\r\n      const componentFactory = this.componentFactoryResolver.resolveComponentFactory(\r\n        legendsConfig[this.name]\r\n      );\r\n      this.viewContainerRef.createComponent(componentFactory);\r\n    }\r\n  }\r\n}\r\n","<ng-template #legend></ng-template>","import { Component, ChangeDetectionStrategy } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-weakenedice-legend',\r\n  templateUrl: './weakenedice-legend.component.html',\r\n  styleUrls: ['./weakenedice-legend.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class WeakenediceLegendComponent {}\r\n","<p>{{'SUPPORT_MAP.ICE_MAP_DESCRIPTION'|translate}}</p>\r\n<br />\r\n<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADpJREFUOI1jYaAyYIFQ//9TxzhGRhbqGIQAaAYyMpJnDMKHtHbhqIGjBo4aODwMpLxcpJULyS0HMQEAAT8GUWkdMN8AAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_1'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADFJREFUOI1jYaAyYKGZgf8ZGP5TYhAjAwMjioHUAqMGjho4auCogXQ2EFaeUc1AagEAYH8CU17tvfIAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_2'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAGlJREFUOI3t1MsJACEMBNBZSBXbf222oaeAJAqjo4eFzc0hPD8EDYfLroEFqCr2Ao/FoF8XoMYslvf4gaZXXsH6bAjuYkNQwRKoYglUsQSqGA2yGAWy70qB/2BTPR8bbOZPnPX4RhYDtRqLLD5RMLVW9QAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_3'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADNJREFUOI1jYaAyYBk1cNTAwWTgL2P2/5QYxHb2JyOKgdQCcANhNlDNQGqBUQNHDSQDAABtxwYe2RyxLgAAAABJRU5ErkJggg==\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_4'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAD1JREFUOI1jYaAyYBk1cNRAygz8T6FZjCgGLnn/kSLTYgT5GVAMpBaAGwizgWoGMkDDgJoGUgWMGjgSDAQAY9kEzvceSB8AAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_5'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAADtJREFUOI3t0MEJADAMQlGF7L+yvbSBnPXW/AGeYCFcLbigB8q0OEDJ80higKkafAsxEPeDJBhpwR/AAy3mBFXDMuqtAAAAAElFTkSuQmCC\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_6'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col size=\"1.5\" class=\"ion-no-padding\">\r\n      <img\r\n        src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IB2cksfwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAENJREFUOI3t0LENADAIA0EisZ83omAjT5hUiUSNu/ADXPFu4nzAARsggN2BSK4CRkTHM5JWQFUPzEwteB/IQFUD/gAeu+ULeISIW6QAAAAASUVORK5CYII=\" />\r\n    </ion-col>\r\n    <ion-col size=\"auto\" class=\"ion-no-padding\">\r\n      {{'SUPPORT_MAP.ICE_LEGEND_TEXT_7'|translate}}\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, ChangeDetectionStrategy } from '@angular/core';\r\nimport { SubTile, SupportTile, SupportTileStore } from '../../../../core/models/support-tile.model';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport {\r\n  setObservableTimeout,\r\n  NgDestoryBase\r\n} from '../../../../core/helpers/observable-helper';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { PopupInfoService } from '../../../../core/services/popup-info/popup-info.service';\r\nimport { takeUntil, take } from 'rxjs/operators';\r\n\r\ninterface PopupSubscription {\r\n  subscription: Subscription,\r\n  checker: (name: string) => Observable<void>,\r\n  condition: (tile: SubTile) => boolean,\r\n}\r\n\r\n@Component({\r\n  selector: 'app-support-tiles-menu',\r\n  templateUrl: './support-tiles-menu.component.html',\r\n  styleUrls: ['./support-tiles-menu.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SupportTilesMenuComponent extends NgDestoryBase {\r\n  private checkSupportMap: PopupSubscription;\r\n  private checkOfflineSupportMaps: {[mapName: string]: PopupSubscription} = {};\r\n  private subTileInstantiation: Subscription;\r\n\r\n  opacityValues = [\r\n    { name: 'SUPPORT_MAP.NO_OPACITY', value: 1.0 },\r\n    { name: '25%', value: 0.75 },\r\n    { name: '50%', value: 0.5 },\r\n    { name: '75%', value: 0.25 }\r\n  ];\r\n\r\n  readonly supportTilesWithSubTiles$: Observable<SupportTile[]>;\r\n\r\n  constructor(\r\n    private userSettingService: UserSettingService,\r\n    private popupInfoService: PopupInfoService\r\n  ) {\r\n    super();\r\n    this.supportTilesWithSubTiles$ = this.userSettingService.supportTilesWithSubTiles$.pipe(\r\n      setObservableTimeout()\r\n    );\r\n\r\n    this.subTileInstantiation = this.supportTilesWithSubTiles$.subscribe((supportTiles) => {\r\n      supportTiles.forEach(\r\n        (supportTile) => this.onTileChanged(supportTile)\r\n      );\r\n      this.subTileInstantiation.unsubscribe();\r\n    });\r\n\r\n    this.checkSupportMap = {\r\n      subscription: undefined,\r\n      checker: popupInfoService.checkSupportMapInfoPopup,\r\n      condition: (_) => true,\r\n    };\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    for (const checkMap of Object.values(this.checkOfflineSupportMaps).concat([this.checkSupportMap])) {\r\n      if (checkMap.subscription && !checkMap.subscription.closed) {\r\n        checkMap.subscription.unsubscribe();\r\n      }\r\n    }\r\n  }\r\n\r\n  trackByMethod(index: number, el: SupportTile) {\r\n    return el.name;\r\n  }\r\n\r\n  async onTileChanged(supportTile: SupportTile) {\r\n    if (supportTile.checked) {\r\n      this.onSubTileChanged(supportTile);\r\n    } else {\r\n      if (supportTile.subTile) {\r\n        supportTile.subTile.enabled = false;\r\n      }\r\n      supportTile.enabled = false;\r\n      this.saveSettings(supportTile);\r\n    }\r\n  }\r\n\r\n  async onSubTileChanged(supportTile: SupportTile) {\r\n    if (supportTile.subTile?.enabled != supportTile.subTile?.checked) {\r\n      supportTile.subTile.enabled = supportTile.subTile.checked;\r\n      this.checkForInfoPopup(supportTile.subTile);\r\n    }\r\n    if (supportTile.enabled == this.isChildActive(supportTile)) {\r\n      supportTile.enabled = !this.isChildActive(supportTile);\r\n      this.checkForInfoPopup(supportTile);\r\n    }\r\n    this.saveSettings(supportTile);\r\n  }\r\n\r\n  async saveSettings(supportTile: SupportTile) {\r\n    const currentSettings = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    this.userSettingService.saveUserSettings({\r\n      ...currentSettings,\r\n      supportTiles: this.addOrUpdateSupportTileSettings(\r\n        supportTile,\r\n        currentSettings.supportTiles\r\n      )\r\n    });\r\n  }\r\n\r\n  isChildActive(supportTile: SupportTile): boolean {\r\n    return !!supportTile.subTile?.enabled;\r\n  }\r\n\r\n  isTileActive(supportTile: SupportTile): boolean {\r\n    return supportTile.enabled || this.isChildActive(supportTile);\r\n  }\r\n\r\n  checkForInfoPopup(tile: SubTile = null) {\r\n    if (!(tile.name in this.checkOfflineSupportMaps)) {\r\n      this.checkOfflineSupportMaps[tile.name] = {\r\n        subscription: undefined,\r\n        checker: this.popupInfoService.checkOfflineSupportMapInfoPopup,\r\n        condition: (tile) => !tile.availableOffline,\r\n      };\r\n    }\r\n    [this.checkSupportMap, this.checkOfflineSupportMaps[tile.name]].forEach((checkMap) => {\r\n      if (checkMap.subscription && !checkMap.subscription.closed) {\r\n        checkMap.subscription.unsubscribe();\r\n      }\r\n      if (tile.enabled && checkMap.condition(tile)) {\r\n        checkMap.subscription = checkMap\r\n          .checker.bind(this.popupInfoService)(tile.name)\r\n          .pipe(takeUntil(this.ngDestroy$))\r\n          .subscribe();\r\n      }\r\n    });\r\n  }\r\n\r\n  addOrUpdateSupportTileSettings(\r\n    supportTile: SupportTile,\r\n    currentSupportTileSettings: {\r\n      name: string;\r\n      enabled: boolean;\r\n      opacity: number;\r\n    }[]\r\n  ): SupportTileStore[] {\r\n    const storeTile = {\r\n      opacity: supportTile.opacity,\r\n      name: supportTile.name,\r\n      enabled: supportTile.enabled,\r\n      checked: supportTile.checked,\r\n    };\r\n    if (supportTile.subTile) {\r\n      storeTile['subTile'] = {\r\n        name: supportTile.subTile.name,\r\n        enabled: supportTile.subTile.enabled,\r\n        checked: supportTile.subTile.checked,\r\n      };\r\n    }\r\n    return [\r\n      ...currentSupportTileSettings.filter((m) => m.name !== supportTile.name) as SupportTile[],\r\n      storeTile,\r\n    ];\r\n  }\r\n}\r\n","<ng-container *ngIf=\"supportTilesWithSubTiles$ | async as supportTiles\">\r\n  <ng-container *ngFor=\"let supportTile of supportTiles; trackBy: trackByMethod\">\r\n    <ion-item>\r\n      <svg-icon slot=\"start\" src=\"/assets/icon/map.svg\"></svg-icon>\r\n      <ion-label class=\"menu-label ion-text-wrap\">\r\n        {{'SUPPORT_MAP.' +supportTile.description | translate }}\r\n      </ion-label>\r\n      <ion-toggle [(ngModel)]=\"supportTile.checked\" (ionChange)=\"onTileChanged(supportTile)\">\r\n      </ion-toggle>\r\n    </ion-item>\r\n    <div class=\"inner-list-panel\" *ngIf=\"isTileActive(supportTile)\">\r\n      <ion-item *ngIf=\"supportTile.subTile\">\r\n        <ion-label class=\"menu-label ion-text-wrap\">\r\n          {{'SUPPORT_MAP.' +supportTile.subTile.description | translate }}\r\n        </ion-label>\r\n        <ion-toggle [(ngModel)]=\"supportTile.subTile.checked\" (ionChange)=\"onSubTileChanged(supportTile)\"></ion-toggle>\r\n      </ion-item>\r\n      <ion-item>\r\n        <ion-label position=\"stacked\" color=\"dark\" class=\"stacked-label\">{{'MENU.OPACITY' | translate}}</ion-label>\r\n        <ion-select interface=\"action-sheet\" cancelText=\"{{'DIALOGS.CANCEL' | translate}}\"\r\n          [(ngModel)]=\"supportTile.opacity\" (ionChange)=\"onTileChanged(supportTile)\">\r\n          <ion-select-option *ngFor=\"let option of opacityValues\" [value]=\"option.value\">{{ option.name | translate }}\r\n          </ion-select-option>\r\n        </ion-select>\r\n      </ion-item>\r\n      <ion-item>\r\n        <ion-label class=\"ion-text-wrap\">\r\n          <app-support-tile-legend-loader [name]=\"supportTile.name\"></app-support-tile-legend-loader>\r\n        </ion-label>\r\n      </ion-item>\r\n    </div>\r\n  </ng-container>\r\n</ng-container>","import { Component, OnInit, OnDestroy, NgZone } from '@angular/core';\r\nimport { Subscription } from 'rxjs';\r\nimport { switchMap, map, distinctUntilChanged, tap } from 'rxjs/operators';\r\nimport { settings } from '../../../../../settings';\r\nimport { ObservationService } from '../../../../core/services/observation/observation.service';\r\nimport { DataMarshallService } from '../../../../core/services/data-marshall/data-marshall.service';\r\nimport { DataLoadService } from '../../../data-load/services/data-load.service';\r\n\r\n@Component({\r\n  selector: 'app-update-observations',\r\n  templateUrl: './update-observations.component.html',\r\n  styleUrls: ['./update-observations.component.scss']\r\n})\r\nexport class UpdateObservationsComponent implements OnInit, OnDestroy {\r\n  lastUpdated: Date;\r\n  settings = settings;\r\n  isLoading: boolean;\r\n  subscriptions: Subscription[] = [];\r\n\r\n  constructor(\r\n    private observationService: ObservationService,\r\n    private dataMarshallService: DataMarshallService,\r\n    private ngZone: NgZone,\r\n    private dataLoadService: DataLoadService\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.subscriptions.push(\r\n      this.observationService\r\n        .getLastUpdatedForCurrentGeoHazardAsObservable()\r\n        .subscribe((val) => {\r\n          this.ngZone.run(() => {\r\n            this.lastUpdated = val;\r\n          });\r\n        })\r\n    );\r\n    this.subscriptions.push(\r\n      this.observationService.dataLoad$\r\n        .pipe(\r\n          switchMap((id) => this.dataLoadService.getStateAsObservable(id)),\r\n          map((state) => state.isLoading),\r\n          distinctUntilChanged()\r\n        )\r\n        .subscribe((val) => {\r\n          this.ngZone.run(() => {\r\n            this.isLoading = val;\r\n          });\r\n        })\r\n    );\r\n  }\r\n  ngOnDestroy(): void {\r\n    for (const subscription of this.subscriptions) {\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  async updateOrCancelObservations() {\r\n    if (this.isLoading) {\r\n      this.dataMarshallService.cancelUpdateObservations();\r\n    } else {\r\n      this.isLoading = true;\r\n      await this.observationService.forceUpdateObservationsForCurrentGeoHazard(\r\n        this.dataMarshallService.cancelObservationsPromise\r\n      );\r\n      setTimeout(() => {\r\n        this.isLoading = false;\r\n      }, 500);\r\n    }\r\n  }\r\n}\r\n","<ion-item (click)=\"updateOrCancelObservations()\">\r\n  <ion-label color=\"dark\" position=\"stacked\">{{'MENU.UPDATE_OBSERVATIONS' | translate}}</ion-label>\r\n  <ng-container *ngIf=\"!isLoading else isLoadingTemplate\">\r\n    <ion-text class=\"ion-align-self-start\">\r\n      <ng-container *ngIf=\"lastUpdated\">\r\n        {{ lastUpdated | date:settings.dateFormats.angular.dateAndTime }}\r\n      </ng-container>\r\n    </ion-text>\r\n    <ion-button size=\"small\" fill=\"clear\" slot=\"end\">\r\n      <svg-icon src=\"/assets/icon/refresh.svg\"></svg-icon>\r\n    </ion-button>\r\n  </ng-container>\r\n</ion-item>\r\n<ng-template #isLoadingTemplate>\r\n  <ion-text class=\"ion-align-self-start\">\r\n    <ion-spinner name=\"dots\"></ion-spinner>\r\n  </ion-text>\r\n  <ion-button size=\"small\" fill=\"clear\" slot=\"end\">\r\n    {{'DIALOGS.CANCEL' | translate}}\r\n  </ion-button>\r\n</ng-template>","import { Component, NgZone, OnInit, OnDestroy } from '@angular/core';\r\nimport { Subject } from 'rxjs';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { RegobsAuthService } from '../../../auth/services/regobs-auth.service';\r\nimport { LoggedInUser } from '../../../login/models/logged-in-user.model';\r\n\r\n@Component({\r\n  selector: 'app-user-login',\r\n  templateUrl: './user-login.component.html',\r\n  styleUrls: ['./user-login.component.scss']\r\n})\r\nexport class UserLoginComponent implements OnInit, OnDestroy {\r\n  loggedInUser: LoggedInUser = { isLoggedIn: false };\r\n  private ngDestroy$ = new Subject<void>();\r\n  isLoggingIn = false;\r\n\r\n  constructor(\r\n    private regobsauthService: RegobsAuthService,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    this.regobsauthService.loggedInUser$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((val) => {\r\n        this.ngZone.run(() => {\r\n          this.loggedInUser = val;\r\n        });\r\n      });\r\n    this.regobsauthService.isLoggingIn$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((val) => {\r\n        this.ngZone.run(() => {\r\n          this.isLoggingIn = val;\r\n        });\r\n      });\r\n  }\r\n\r\n  login(): void {\r\n    this.regobsauthService.signIn();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n}\r\n","<ng-container *ngIf=\"!isLoggingIn else spinner\">\r\n  <ion-item *ngIf=\"!loggedInUser.isLoggedIn\" (click)=\"login()\" detail=\"true\">\r\n    <ion-icon slot=\"start\" name=\"person-circle\" color=\"varsom-blue\"></ion-icon>\r\n    <ion-label class=\"menu-label\">\r\n      {{'LOGIN.TITLE' | translate}}\r\n    </ion-label>\r\n  </ion-item>\r\n  <ng-container *ngIf=\"loggedInUser.isLoggedIn\">\r\n    <ion-item routerLink=\"/login\" routerDirection=\"forward\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"person-circle\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">\r\n        {{ loggedInUser.email }}\r\n      </ion-label>\r\n    </ion-item>\r\n    <ion-item routerLink=\"/my-observations\" routerDirection=\"forward\" detail=\"true\">\r\n      <ion-icon slot=\"start\" name=\"eye\" color=\"varsom-blue\"></ion-icon>\r\n      <ion-label class=\"menu-label\">\r\n        {{'MY_OBSERVATIONS.TITLE' | translate}}\r\n      </ion-label>\r\n    </ion-item>\r\n  </ng-container>\r\n</ng-container>\r\n<ng-template #spinner>\r\n  <ion-item>\r\n    <ion-text>\r\n      <ion-spinner name=\"dots\"></ion-spinner>\r\n    </ion-text>\r\n  </ion-item>\r\n</ng-template>","import { NgModule } from '@angular/core';\r\nimport { SideMenuComponent } from './components/side-menu.component';\r\nimport { SupportTilesMenuComponent } from './components/support-tiles-menu/support-tiles-menu.component';\r\nimport { UserLoginComponent } from './components/user-login/user-login.component';\r\nimport { ObservationsDaysBackComponent } from './components/observations-days-back/observations-days-back.component';\r\nimport { UpdateObservationsComponent } from './components/update-observations/update-observations.component';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { SupportTileLegendLoaderComponent } from './components/support-tiles-menu/legends/support-tile-legend-loader/support-tile-legend-loader.component';\r\nimport { SteepnessLegendComponent } from './components/support-tiles-menu/legends/steepness-legend/steepness-legend.component';\r\nimport { FloodzonesLegendComponent } from './components/support-tiles-menu/legends/floodzones-legend/floodzones-legend.component';\r\nimport { ClayzonesLegendComponent } from './components/support-tiles-menu/legends/clayzones-legend/clayzones-legend.component';\r\nimport { WeakenediceLegendComponent } from './components/support-tiles-menu/legends/weakenedice-legend/weakenedice-legend.component';\r\nimport { SteepnessCommonLegendComponent } from './components/support-tiles-menu/legends/steepness-common-legend/steepness-common-legend.component';\r\n\r\n@NgModule({\r\n  imports: [SharedModule],\r\n  declarations: [\r\n    SideMenuComponent,\r\n    SupportTilesMenuComponent,\r\n    UserLoginComponent,\r\n    ObservationsDaysBackComponent,\r\n    UpdateObservationsComponent,\r\n    SupportTileLegendLoaderComponent,\r\n    SteepnessLegendComponent,\r\n    FloodzonesLegendComponent,\r\n    ClayzonesLegendComponent,\r\n    WeakenediceLegendComponent,\r\n    SteepnessCommonLegendComponent\r\n  ],\r\n  entryComponents: [\r\n    SteepnessLegendComponent,\r\n    FloodzonesLegendComponent,\r\n    ClayzonesLegendComponent,\r\n    WeakenediceLegendComponent\r\n  ],\r\n  exports: [SideMenuComponent]\r\n})\r\nexport class SideMenuModule {}\r\n","import { Component, OnInit, Input, OnDestroy } from '@angular/core';\r\nimport { ModalController, Platform } from '@ionic/angular';\r\nimport { ScreenOrientation } from '@ionic-native/screen-orientation/ngx';\r\nimport { isAndroidOrIos } from '../../../core/helpers/ionic/platform-helper';\r\n\r\n@Component({\r\n  selector: 'app-fullscreen-image-modal',\r\n  templateUrl: './fullscreen-image-modal.page.html',\r\n  styleUrls: ['./fullscreen-image-modal.page.scss']\r\n})\r\nexport class FullscreenImageModalPage implements OnInit, OnDestroy {\r\n  @Input() imgSrc: string;\r\n  @Input() header: string;\r\n  @Input() description: string;\r\n\r\n  constructor(\r\n    private modalController: ModalController,\r\n    private screenOrientation: ScreenOrientation,\r\n    private platform: Platform\r\n  ) {}\r\n\r\n  ngOnInit(): void {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.screenOrientation.unlock();\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (isAndroidOrIos(this.platform)) {\r\n      this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.PORTRAIT);\r\n    }\r\n  }\r\n\r\n  closeModal(): void {\r\n    this.modalController.dismiss();\r\n  }\r\n}\r\n","<ion-content (click)=\"closeModal()\">\r\n  <ion-slides>\r\n    <ion-slide>\r\n      <div class=\"swiper-zoom-container\">\r\n        <img [src]=\"imgSrc\" onerror=\"this.style.display='none'\" />\r\n      </div>\r\n    </ion-slide>\r\n  </ion-slides>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { LegalTermsModalPage } from './legal-terms-modal.page';\r\nimport { SharedModule } from '../../../modules/shared/shared.module';\r\nimport { LegalTermsComponent } from '../../../components/legal-terms/legal-terms.component';\r\n\r\n@NgModule({\r\n  imports: [SharedModule],\r\n  declarations: [LegalTermsModalPage, LegalTermsComponent],\r\n  entryComponents: [LegalTermsModalPage],\r\n  exports: [LegalTermsModalPage]\r\n})\r\nexport class LegalTermsModalPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-legal-terms-modal',\r\n  templateUrl: './legal-terms-modal.page.html',\r\n  styleUrls: ['./legal-terms-modal.page.scss']\r\n})\r\nexport class LegalTermsModalPage implements OnInit {\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  close() {\r\n    this.modalController.dismiss();\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"close()\">{{ 'DIALOGS.OK' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ 'LEGAL_TERMS.HEADER' | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <ion-grid>\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\">\r\n        <app-legal-terms></app-legal-terms>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n</ion-content>","// The file contents for the current environment will overwrite these during build.\r\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\r\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\r\n// The list of which env maps to which file can be found in `.angular-cli.json`.\r\nexport const environment = {\r\n  production: false\r\n};\r\n\r\n/*\r\n * In development mode, to ignore zone related error stack frames such as\r\n * `zone.run`, `zoneDelegate.invokeTask` for easier debugging, you can\r\n * import the following file, but please comment it out in production mode\r\n * because it will have performance impact when throw error\r\n */\r\n// import 'zone.js/plugins/zone-error';  // Included with Angular CLI.\r\n","/* eslint-disable no-console */\r\nimport { enableProdMode } from '@angular/core';\r\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\r\n\r\nimport { AppModule } from './app/app.module';\r\nimport { environment } from './environments/environment';\r\nimport { NanoSql } from './nanosql';\r\nimport '@angular/compiler';\r\n\r\nif (environment.production) {\r\n  enableProdMode();\r\n}\r\n\r\nfunction startApp() {\r\n  console.log('starting app');\r\n  platformBrowserDynamic()\r\n    .bootstrapModule(AppModule)\r\n    .catch((err) => console.log(err));\r\n}\r\n\r\ndocument.addEventListener(\r\n  typeof cordova !== 'undefined' ? 'deviceready' : 'DOMContentLoaded',\r\n  async () => {\r\n    console.log('Init NanoSql database');\r\n    try {\r\n      await NanoSql.init();\r\n      startApp();\r\n    } catch (err) {\r\n      console.error('Error init NanoSql database', err);\r\n      startApp(); // Try to start app anyway\r\n    }\r\n  }\r\n);\r\n","import { settings } from './settings';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { nSQL } from '@nano-sql/core';\r\nimport { getMode } from '@nano-sql/adapter-sqlite-cordova';\r\nimport {\r\n  InanoSQLTableConfig,\r\n  InanoSQLTable,\r\n  InanoSQLQuery,\r\n  InanoSQLDataModel,\r\n  InanoSQLTableIndexConfig,\r\n  InanoSQLInstance\r\n} from '@nano-sql/core/lib/interfaces';\r\n\r\nexport class NanoSql {\r\n  public static readonly TABLES = {\r\n    OBSERVATION: {\r\n      name: 'observationV2',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'RegId:int': { pk: true },\r\n        'GeoHazardTID:int': {},\r\n        'LangKey:int': {},\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n      // indexes: {\r\n      //     'GeoHazardTID:int': {},\r\n      //     'LangKey:int': {},\r\n      // },\r\n    },\r\n    TRIP_LOG: {\r\n      name: 'triplog',\r\n      model: {\r\n        'id:uuid': { pk: true },\r\n        'latitude:number': {},\r\n        'longitude:number': {},\r\n        'timestamp:number': {},\r\n        'altitude:number': {},\r\n        'speed:number': {},\r\n        'accuracy:number': {},\r\n        'heading:number': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    TRIP_LOG_ACTIVITY: {\r\n      name: 'triplogactivity',\r\n      model: {\r\n        'id:uuid': { pk: true },\r\n        'state:string': {},\r\n        'timestamp:number': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    LEGACY_TRIP_LOG: {\r\n      name: 'legacytrip',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    WARNING: {\r\n      name: 'warning',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    WARNING_FAVOURITE: {\r\n      name: 'warning_favourite',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    OFFLINE_MAP: {\r\n      name: 'offlinemap',\r\n      model: {\r\n        'name:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    OFFLINE_MAP_TILES: {\r\n      name: 'offlinemaptiles',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        'mapName:string': {},\r\n        'lastAccess:number': {},\r\n        'size:number': {},\r\n        'dataUrl:string': {},\r\n        'mimeType:string': {}\r\n      },\r\n      indexes: {\r\n        'mapName:string': {},\r\n        'lastAccess:number': {},\r\n        'size:number': {}\r\n      }\r\n    },\r\n    OFFLINE_MAP_CACHE_SIZE: {\r\n      name: 'offlinemapcachessize',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        'count:number': {},\r\n        'size:number': {}\r\n      }\r\n    },\r\n    OFFLINE_ASSET: {\r\n      name: 'offlineasset',\r\n      model: {\r\n        'url:string': { pk: true },\r\n        'type:string': {},\r\n        'lastAccess:number': {},\r\n        'size:number': {},\r\n        'dataUrl:string': {}\r\n      },\r\n      indexes: {\r\n        'lastAccess:number': {}\r\n      }\r\n    },\r\n    MAP_SEARCH_HISTORY: {\r\n      name: 'mapsearchhistory',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    USER_SETTINGS: {\r\n      name: 'usersettings',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    USER: {\r\n      name: 'user',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    DATA_LOAD: {\r\n      name: 'dataload',\r\n      model: {\r\n        'id:string': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    REGISTRATION: {\r\n      name: 'registration',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'id:uuid': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    KDV_ELEMENTS: {\r\n      name: 'kdvelements',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'langKey:int': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    },\r\n    OBSERVER_GROUPS: {\r\n      name: 'groups',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'key:string': { pk: true },\r\n        'userId:string': {},\r\n        '*:any': {}\r\n      },\r\n      indexes: {\r\n        'userId:string': {}\r\n      }\r\n    },\r\n    HELP_TEXTS: {\r\n      name: 'helptexts',\r\n      instancePerAppMode: true,\r\n      model: {\r\n        'langKey:int': { pk: true },\r\n        '*:any': {}\r\n      },\r\n      indexes: {}\r\n    }\r\n  };\r\n\r\n  static getTables() {\r\n    const result: {\r\n      name: string;\r\n      instancePerAppMode: boolean;\r\n      model: InanoSQLDataModel;\r\n      indexes: InanoSQLTableIndexConfig;\r\n    }[] = [];\r\n    // tslint:disable-next-line:forin\r\n    for (const tableDef in NanoSql.TABLES) {\r\n      result.push(NanoSql.TABLES[tableDef]);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  static getInstanceName(name: string, appMode: AppMode): string {\r\n    return `${name}_${appMode}`;\r\n  }\r\n\r\n  static getTableModels(): InanoSQLTableConfig[] {\r\n    const tables: InanoSQLTableConfig[] = [];\r\n    for (const table of NanoSql.getTables()) {\r\n      if (table.instancePerAppMode) {\r\n        tables.push({\r\n          name: NanoSql.getInstanceName(table.name, AppMode.Prod),\r\n          model: table.model,\r\n          indexes: table.indexes\r\n        });\r\n        tables.push({\r\n          name: NanoSql.getInstanceName(table.name, AppMode.Demo),\r\n          model: table.model,\r\n          indexes: table.indexes\r\n        });\r\n        tables.push({\r\n          name: NanoSql.getInstanceName(table.name, AppMode.Test),\r\n          model: table.model,\r\n          indexes: table.indexes\r\n        });\r\n      } else {\r\n        tables.push({\r\n          name: table.name,\r\n          model: table.model,\r\n          indexes: table.indexes\r\n        });\r\n      }\r\n    }\r\n    return tables;\r\n  }\r\n\r\n  static async init(\r\n    dbName: string = settings.db.nanoSql.dbName,\r\n    dbMode?: string\r\n  ): Promise<void> {\r\n    await nSQL().createDatabase({\r\n      id: dbName,\r\n      mode: dbMode || getMode(),\r\n      version: 1.0,\r\n      tables: this.getTableModels(),\r\n      // cache: false,\r\n      // historyMode: {\r\n      //     table: 'row',\r\n      // }\r\n      plugins: [\r\n        {\r\n          name: 'Table Name Plugin', // Plugin to avoid random id on table name\r\n          version: 1.0,\r\n          dependencies: {},\r\n          filters: [\r\n            {\r\n              name: 'configTableSystem',\r\n              priority: 1000,\r\n              call: (\r\n                inputArgs: { res: InanoSQLTable; query: InanoSQLQuery },\r\n                complete\r\n              ) => {\r\n                inputArgs.res.id = inputArgs.res.name;\r\n                complete(inputArgs);\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    });\r\n    // NOTE: It is also possible to implement migrations on version updates.\r\n    // See: https://github.com/ClickSimply/Nano-SQL/issues/70\r\n  }\r\n\r\n  static getInstance(name: string, appMode: AppMode): InanoSQLInstance {\r\n    return nSQL(`${name}_${appMode}`);\r\n  }\r\n\r\n  static async resetDb(\r\n    onError?: (tableName: string, ex: Error) => void\r\n  ): Promise<void[]> {\r\n    // try {\r\n    //     await nSQL().dropDatabase(settings.db.nanoSql.dbName);\r\n    //     await this.init();\r\n    // } catch (err) {\r\n    //     console.log(err);\r\n    // }\r\n    return Promise.all(\r\n      NanoSql.getTableModels().map((tableConfig) =>\r\n        this.resetTable(tableConfig, onError)\r\n      )\r\n    );\r\n  }\r\n\r\n  static async resetTable(\r\n    tableConfig: InanoSQLTableConfig,\r\n    onError?: (tableName: string, ex: Error) => void\r\n  ): Promise<void> {\r\n    if (tableConfig.name === 'offlinemaptiles') {\r\n      await this.dropAndRecreateTable(tableConfig, onError);\r\n    } else {\r\n      await this.deleteAllRowsInTable(tableConfig, onError);\r\n    }\r\n  }\r\n\r\n  private static async deleteAllRowsInTable(\r\n    tableConfig: InanoSQLTableConfig,\r\n    onError?: (tableName: string, ex: Error) => void\r\n  ) {\r\n    try {\r\n      await nSQL(tableConfig.name).query('delete').exec();\r\n    } catch (ex) {\r\n      if (onError) {\r\n        onError(tableConfig.name, ex);\r\n      }\r\n    }\r\n  }\r\n\r\n  private static async dropAndRecreateTable(\r\n    tableConfig: InanoSQLTableConfig,\r\n    onError?: (tableName: string, ex: Error) => void\r\n  ) {\r\n    try {\r\n      await nSQL(tableConfig.name).query('drop').exec();\r\n    } catch (ex) {\r\n      if (onError) {\r\n        onError(tableConfig.name, ex);\r\n      }\r\n    }\r\n    try {\r\n      await nSQL().query('create table', tableConfig).exec();\r\n    } catch (ex) {\r\n      if (onError) {\r\n        onError(tableConfig.name, ex);\r\n      }\r\n    }\r\n  }\r\n}\r\n","/* eslint-disable max-len */\r\nexport const settings = {\r\n  authConfig: {\r\n    TEST: {\r\n      client_id: '13270815-7def-4800-8fc9-178dd517f574',\r\n      server_host: 'https://nveb2c01test.b2clogin.com/nveb2c01test.onmicrosoft.com/B2C_1A_sign_up_sign_in_nve/v2.0',\r\n      redirect_url: 'regobs://callback',\r\n      end_session_redirect_url: undefined,\r\n      scopes: 'openid offline_access',\r\n      pkce: true,\r\n      getObserverUrl: 'https://test-api.regobs.no/v5/Account/GetObserver',\r\n      myPageUrl: 'https://test-konto.nve.no/User',\r\n      updateObserverUrl: 'https://test-api.regobs.no/v5/Account/UpdateObserver'\r\n    },\r\n    DEMO: {\r\n      client_id: '7149f248-5e18-4feb-8a0c-e988dc021977',\r\n      server_host: 'https://nveb2c01staging.b2clogin.com/nveb2c01staging.onmicrosoft.com/B2C_1A_sign_up_sign_in_nve/v2.0',\r\n      redirect_url: 'regobs://callback',\r\n      end_session_redirect_url: undefined,\r\n      scopes: 'openid offline_access',\r\n      pkce: true,\r\n      getObserverUrl: 'https://demo-api.regobs.no/v5/Account/GetObserver',\r\n      myPageUrl: 'https://demo-konto.nve.no/User',\r\n      updateObserverUrl: 'https://demo-api.regobs.no/v5/Account/UpdateObserver'\r\n    },\r\n    PROD: {\r\n      client_id: 'a0b10e50-f942-4619-a9ab-cf5c900a98d5',\r\n      server_host: 'https://nveb2c01prod.b2clogin.com/nveb2c01prod.onmicrosoft.com/B2C_1A_sign_up_sign_in_nve/v2.0',\r\n      redirect_url: 'regobs://callback',\r\n      end_session_redirect_url: undefined,\r\n      scopes: 'openid offline_access',\r\n      pkce: true,\r\n      getObserverUrl: 'https://api.regobs.no/v5/Account/GetObserver',\r\n      myPageUrl: 'https://konto.nve.no/User',\r\n      updateObserverUrl: 'https://api.regobs.no/v5/Account/UpdateObserver'\r\n    }\r\n  },\r\n  observations: {\r\n    maxObservationsToFetch: 5000,\r\n    daysBack: {\r\n      Snow: [0, 1, 2, 3, 7, 7 * 2],\r\n      Ice: [0, 1, 2, 7, 7 * 4, 7 * 12],\r\n      Water: [0, 1, 2, 3, 7, 7 * 2],\r\n      Dirt: [0, 1, 2, 3, 7, 7 * 2]\r\n    },\r\n    timeZone: 'Europe/Oslo'\r\n  },\r\n  services: {\r\n    regObs: {\r\n      apiUrl: {\r\n        PROD: 'https://api.regobs.no/v5',\r\n        DEMO: 'https://demo-api.regobs.no/v5',\r\n        TEST: 'https://test-api.regobs.no/v5'\r\n        // 'TEST': 'http://localhost:40001'\r\n      },\r\n      serviceUrl: {\r\n        PROD: 'https://api.nve.no/hydrology/regobs/v3.5.0',\r\n        DEMO: 'http://stg-h-web03.nve.no/RegObsServices',\r\n        TEST: 'http://tst-h-web03.nve.no/regobsservices_test'\r\n      },\r\n      webUrl: {\r\n        PROD: 'https://www.regobs.no',\r\n        DEMO: 'https://demo.regobs.no',\r\n        TEST: 'https://test.regobs.no'\r\n      },\r\n      createUserUrl: '/Account/Register?c=Home',\r\n      passwordRecoveryUrl: '/Account/PasswordRecovery?c=Home',\r\n      changePasswordUrl: '/Account/ChangePassword?email={email}&c=Home',\r\n      viewProfileUrl: '/Account/MyPage',\r\n      apiJsonVersion: '4.0.0'\r\n    },\r\n    warning: {\r\n      defaultWarningDaysAhead: 2,\r\n      summerMonths: [5, 6, 7, 8, 9, 10],\r\n      timezone: 'Europe/Oslo',\r\n      dateFormat: 'YYYY-MM-DD',\r\n      Snow: {\r\n        apiUrl: 'https://api01.nve.no/hydrology/forecast/avalanche/v4.0.2/api',\r\n        webUrl: {\r\n          nb: 'http://www.varsom.no/snoskredvarsling/varsel/{regionName}/{day}?utm_source=regobs&utm_medium=app&utm_campaign=avalanche',\r\n          en: 'http://www.varsom.no/en/avalanche-bulletins/forecast/{regionName}/{day}?utm_source=regobs&utm_medium=app&utm_campaign=avalanche'\r\n        },\r\n        featureName: 'omradeID'\r\n      },\r\n      Dirt: {\r\n        apiUrl: 'https://api01.nve.no/hydrology/forecast/landslide/v1.0.6/api',\r\n        webUrl: {\r\n          nb: 'http://www.varsom.no/flom-og-jordskredvarsling/varsel/{regionName}/?date={day}&utm_source=regobs&utm_medium=app&utm_campaign=landslide',\r\n          en: 'http://www.varsom.no/en/flood-and-landslide-warning-service/forecast/{regionName}/?date={day}&utm_source=regobs&utm_medium=app&utm_campaign=landslide'\r\n        },\r\n        featureName: 'fylkesnummer'\r\n      },\r\n      Water: {\r\n        apiUrl: 'https://api01.nve.no/hydrology/forecast/flood/v1.0.6/api',\r\n        webUrl: {\r\n          nb: 'http://www.varsom.no/flom-og-jordskredvarsling/varsel/{regionName}/?date={day}&utm_source=regobs&utm_medium=app&utm_campaign=flood',\r\n          en: 'http://www.varsom.no/en/flood-and-landslide-warning-service/forecast/{regionName}/?date={day}&utm_source=regobs&utm_medium=app&utm_campaign=flood'\r\n        },\r\n        featureName: 'fylkesnummer'\r\n      },\r\n      Ice: {\r\n        apiUrl: 'https://www.iskart.no/json/ice_forecast_regions.json',\r\n        featureName: 'fylkesnummer'\r\n      }\r\n    }\r\n  },\r\n  db: {\r\n    simpleStorage: {\r\n      dbName: 'regobsSimpleStorage',\r\n      location: 'default'\r\n    },\r\n    nanoSql: {\r\n      dbName: 'regobs'\r\n    }\r\n  },\r\n  map: {\r\n    tiles: {\r\n      cacheFolder: 'tilescache',\r\n      cacheSize: 0,\r\n      cacheSaveBufferThrottleTimeMs: 50,\r\n      cacheSaveBufferIdleInterval: 2000,\r\n      tileImageFormat: 'image/png',\r\n      embeddedUrl: '/assets/map/{z}/tile_{x}_{y}.png',\r\n      defaultZoom: 5,\r\n      embeddedUrlMaxZoomWorld: 0,\r\n      embeddedUrlMaxZoomNorway: 0,\r\n      minZoom: 2,\r\n      minZoomSupportMaps: 5,\r\n      maxZoom: 18,\r\n      zoomInPosition: 15,\r\n      zoomLevelObservationList: 12,\r\n      edgeBufferTiles: 0,\r\n      detectRetina: false,\r\n      updateWhenIdle: false,\r\n      statensKartverkMapUrl: 'https://opencache.statkart.no/gatekeeper/gk/gk.open_gmaps?layers=norgeskart_bakgrunn&zoom={z}&x={x}&y={y}',\r\n      geoDataLandskapMapUrl: 'https://services.geodataonline.no/arcgis/rest/services/Geocache_WMAS_WGS84/GeocacheLandskap/MapServer/tile/{z}/{y}/{x}?blankTile=false',\r\n      openTopoMapUrl: 'https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png',\r\n      arcGisOnlineTopoMapUrl: 'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',\r\n      supportTiles: [\r\n        {\r\n          name: 'steepness',\r\n          description: 'STEEPNESS_MAP_DESCRIPTION',\r\n          url: 'https://gis3.nve.no/arcgis/rest/services/wmts/Bratthet/MapServer/tile/{z}/{y}/{x}',\r\n          enabled: false,\r\n          checked: true,\r\n          opacity: 0.5,\r\n          geoHazardId: 10,\r\n          availableOffline: false,\r\n          subTile: {\r\n            name: 'steepness-outlet',\r\n            description: 'STEEPNESS_OUTLET_MAP_DESCRIPTION',\r\n            url: 'https://gis3.nve.no/arcgis/rest/services/wmts/KastWMTS/MapServer/tile/{z}/{y}/{x}',\r\n            enabled: true,\r\n            checked: true,\r\n            availableOffline: true\r\n          }\r\n        },\r\n        {\r\n          name: 'clayzones',\r\n          description: 'CLAY_ZONES_MAP_DESCRIPTION',\r\n          url: 'https://gis2.nve.no/arcgis/rest/services/wmts/Kvikkleire_Jordskred/MapServer/tile/{z}/{y}/{x}',\r\n          enabled: true,\r\n          checked: true,\r\n          opacity: 0.5,\r\n          geoHazardId: 20,\r\n          availableOffline: false\r\n        },\r\n        {\r\n          name: 'floodzoones',\r\n          description: 'FLOOD_ZONES_MAP_DESCRIPTION',\r\n          url: 'https://gis3.nve.no/arcgis/rest/services/wmts/Flomsoner1/MapServer/tile/{z}/{y}/{x}',\r\n          enabled: true,\r\n          checked: true,\r\n          opacity: 0.5,\r\n          geoHazardId: 60,\r\n          availableOffline: false\r\n        },\r\n        {\r\n          name: 'weakenedice',\r\n          description: 'WEAKENED_ICE_MAP_DESCRIPTION',\r\n          url: 'https://gis3.nve.no/arcgis/rest/services/wmts/SvekketIs/MapServer/tile/{z}/{y}/{x}',\r\n          enabled: true,\r\n          checked: true,\r\n          opacity: 0.5,\r\n          geoHazardId: 70,\r\n          availableOffline: true\r\n        }\r\n      ],\r\n      supportTilesBounds: [\r\n        [57.136239319177434, -0.17578125],\r\n        [57.136239319177434, 36.03515625],\r\n        [81.36128726057069, 36.03515625],\r\n        [81.36128726057069, -0.17578125],\r\n        [57.136239319177434, -0.17578125]\r\n      ]\r\n    },\r\n    search: {\r\n      no: {\r\n        url: 'https://ws.geonorge.no/stedsnavn/v1/navn',\r\n        maxResults: 20,\r\n        exactFirst: true,\r\n        coordinateSystem: 4326,\r\n        resultFields: 'metadata.totaltAntallTreff,navn.skrivemåte,navn.navneobjekttype,navn.stedsnummer,navn.representasjonspunkt.øst,navn.representasjonspunkt.nord,navn.fylker.fylkesnavn,navn.kommuner.kommunenavn'\r\n      },\r\n      geonames: {\r\n        url: 'https://secure.geonames.org',\r\n        maxResults: 20,\r\n        username: 'regobs'\r\n      },\r\n      searchHistorySize: 5\r\n    },\r\n    bounds: {\r\n      svalbard: {\r\n        bbox: [\r\n          [80.493155, 3.157765],\r\n          [80.309405, 21.685119],\r\n          [76.337433, 18.003936],\r\n          [76.465943, 4.879966]\r\n        ]\r\n      }\r\n    },\r\n    mapSearchZoomToLevel: 14,\r\n    unknownMapCenter: [59.911197, 10.741059],\r\n    flyToOnGpsZoom: 14,\r\n    maxClusterRadius: 60 // 30,\r\n  },\r\n  snowRegionsGeoJsonName: 'omradeNavn',\r\n  cordovaNotAvailable: 'cordova_not_available',\r\n  gps: {\r\n    highAccuracyPositionOptions: {\r\n      enableHighAccuracy: true,\r\n      timeout: 20 * 1000, // 20 sec\r\n      maximumAge: Infinity // Start with latest cached value\r\n    }\r\n  },\r\n  offlineAssetsFolder: 'assets',\r\n  dateFormats: {\r\n    angular: {\r\n      date: 'dd.MM.yyyy',\r\n      dateAndTime: 'dd.MM.yyyy HH:mm'\r\n    },\r\n    moment: {\r\n      date: 'DD.MM.YYYY',\r\n      dateAndTime: 'DD.MM.YYYY HH:mm'\r\n    }\r\n  },\r\n  kdvElements: {\r\n    daysBeforeUpdate: 1\r\n  },\r\n  helpTexts: {\r\n    daysBeforeUpdate: 1\r\n  },\r\n  images: {\r\n    size: 1800,\r\n    quality: 50\r\n  },\r\n  sentryDsn: 'https://2e07df8503a34dc9973eedd05e7a0f49@sentry.io/170000',\r\n  errorEmailAddress: 'regobs@nve.no',\r\n  foregroundUpdateIntervalMs: 2 * 60 * 1000, // 2 minutes\r\n  backgroundFetchTimeout: 20 * 1000, // 20 seconds\r\n  popupDisclamerRefreshTimeMs: 1000 * 60 * 60 * 24 * 30, // 30 days\r\n  googleAnalytics: {\r\n    trackerId: 'UA-32394009-4',\r\n    anonymizeIp: true\r\n  },\r\n  language: {\r\n    fallbackLang: 'en',\r\n    supportedLanguages: [\r\n      { lang: 'nb', name: 'Norsk bokmål' },\r\n      { lang: 'nn', name: 'Norsk nynorsk' },\r\n      { lang: 'en', name: 'English' },\r\n      { lang: 'sv', name: 'Svenska' },\r\n      { lang: 'de', name: 'Deutsch' },\r\n      { lang: 'sl', name: 'Slovenski' },\r\n      { lang: 'fr', name: 'Français' },\r\n    ]\r\n  }\r\n};\r\n","var map = {\n\t\"./ion-action-sheet.entry.js\": [\n\t\t90733,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-action-sheet_entry_js\"\n\t],\n\t\"./ion-alert.entry.js\": [\n\t\t20985,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-alert_entry_js\"\n\t],\n\t\"./ion-app_8.entry.js\": [\n\t\t93899,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-app_8_entry_js\"\n\t],\n\t\"./ion-avatar_3.entry.js\": [\n\t\t5121,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-avatar_3_entry_js\"\n\t],\n\t\"./ion-back-button.entry.js\": [\n\t\t52960,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-back-button_entry_js\"\n\t],\n\t\"./ion-backdrop.entry.js\": [\n\t\t45473,\n\t\t\"node_modules_ionic_core_dist_esm_ion-backdrop_entry_js\"\n\t],\n\t\"./ion-button_2.entry.js\": [\n\t\t19787,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-button_2_entry_js\"\n\t],\n\t\"./ion-card_5.entry.js\": [\n\t\t66165,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-card_5_entry_js\"\n\t],\n\t\"./ion-checkbox.entry.js\": [\n\t\t69569,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-checkbox_entry_js\"\n\t],\n\t\"./ion-chip.entry.js\": [\n\t\t35119,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-chip_entry_js\"\n\t],\n\t\"./ion-col_3.entry.js\": [\n\t\t90799,\n\t\t\"node_modules_ionic_core_dist_esm_ion-col_3_entry_js\"\n\t],\n\t\"./ion-datetime_3.entry.js\": [\n\t\t68918,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-datetime_3_entry_js\"\n\t],\n\t\"./ion-fab_3.entry.js\": [\n\t\t94028,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-fab_3_entry_js\"\n\t],\n\t\"./ion-img.entry.js\": [\n\t\t98107,\n\t\t\"node_modules_ionic_core_dist_esm_ion-img_entry_js\"\n\t],\n\t\"./ion-infinite-scroll_2.entry.js\": [\n\t\t72178,\n\t\t\"node_modules_ionic_core_dist_esm_ion-infinite-scroll_2_entry_js\"\n\t],\n\t\"./ion-input.entry.js\": [\n\t\t42868,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-input_entry_js\"\n\t],\n\t\"./ion-item-option_3.entry.js\": [\n\t\t18706,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-item-option_3_entry_js\"\n\t],\n\t\"./ion-item_8.entry.js\": [\n\t\t12099,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-item_8_entry_js\"\n\t],\n\t\"./ion-loading.entry.js\": [\n\t\t84868,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-loading_entry_js\"\n\t],\n\t\"./ion-menu_3.entry.js\": [\n\t\t54377,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-menu_3_entry_js\"\n\t],\n\t\"./ion-modal.entry.js\": [\n\t\t15678,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-modal_entry_js\"\n\t],\n\t\"./ion-nav_2.entry.js\": [\n\t\t16735,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-nav_2_entry_js\"\n\t],\n\t\"./ion-popover.entry.js\": [\n\t\t87686,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-popover_entry_js\"\n\t],\n\t\"./ion-progress-bar.entry.js\": [\n\t\t48555,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-progress-bar_entry_js\"\n\t],\n\t\"./ion-radio_2.entry.js\": [\n\t\t30568,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-radio_2_entry_js\"\n\t],\n\t\"./ion-range.entry.js\": [\n\t\t6231,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-range_entry_js\"\n\t],\n\t\"./ion-refresher_2.entry.js\": [\n\t\t45772,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-refresher_2_entry_js\"\n\t],\n\t\"./ion-reorder_2.entry.js\": [\n\t\t14977,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-reorder_2_entry_js\"\n\t],\n\t\"./ion-ripple-effect.entry.js\": [\n\t\t42886,\n\t\t\"node_modules_ionic_core_dist_esm_ion-ripple-effect_entry_js\"\n\t],\n\t\"./ion-route_4.entry.js\": [\n\t\t54990,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-route_4_entry_js\"\n\t],\n\t\"./ion-searchbar.entry.js\": [\n\t\t13810,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-searchbar_entry_js\"\n\t],\n\t\"./ion-segment_2.entry.js\": [\n\t\t2446,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-segment_2_entry_js\"\n\t],\n\t\"./ion-select_3.entry.js\": [\n\t\t47619,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-select_3_entry_js\"\n\t],\n\t\"./ion-slide_2.entry.js\": [\n\t\t28393,\n\t\t\"node_modules_ionic_core_dist_esm_ion-slide_2_entry_js\"\n\t],\n\t\"./ion-spinner.entry.js\": [\n\t\t56281,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-spinner_entry_js\"\n\t],\n\t\"./ion-split-pane.entry.js\": [\n\t\t35932,\n\t\t\"node_modules_ionic_core_dist_esm_ion-split-pane_entry_js\"\n\t],\n\t\"./ion-tab-bar_2.entry.js\": [\n\t\t57970,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-tab-bar_2_entry_js\"\n\t],\n\t\"./ion-tab_2.entry.js\": [\n\t\t80298,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-tab_2_entry_js\"\n\t],\n\t\"./ion-text.entry.js\": [\n\t\t71006,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-text_entry_js\"\n\t],\n\t\"./ion-textarea.entry.js\": [\n\t\t74783,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-textarea_entry_js\"\n\t],\n\t\"./ion-toast.entry.js\": [\n\t\t62749,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-toast_entry_js\"\n\t],\n\t\"./ion-toggle.entry.js\": [\n\t\t55404,\n\t\t\"common\",\n\t\t\"node_modules_ionic_core_dist_esm_ion-toggle_entry_js\"\n\t],\n\t\"./ion-virtual-scroll.entry.js\": [\n\t\t39043,\n\t\t\"node_modules_ionic_core_dist_esm_ion-virtual-scroll_entry_js\"\n\t]\n};\nfunction webpackAsyncContext(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\treturn Promise.resolve().then(function() {\n\t\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\t\te.code = 'MODULE_NOT_FOUND';\n\t\t\tthrow e;\n\t\t});\n\t}\n\n\tvar ids = map[req], id = ids[0];\n\treturn Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {\n\t\treturn __webpack_require__(id);\n\t});\n}\nwebpackAsyncContext.keys = function() { return Object.keys(map); };\nwebpackAsyncContext.id = 50863;\nmodule.exports = webpackAsyncContext;","var map = {\n\t\"./af\": 62275,\n\t\"./af.js\": 62275,\n\t\"./ar\": 90857,\n\t\"./ar-dz\": 11218,\n\t\"./ar-dz.js\": 11218,\n\t\"./ar-kw\": 14754,\n\t\"./ar-kw.js\": 14754,\n\t\"./ar-ly\": 66680,\n\t\"./ar-ly.js\": 66680,\n\t\"./ar-ma\": 92178,\n\t\"./ar-ma.js\": 92178,\n\t\"./ar-sa\": 56522,\n\t\"./ar-sa.js\": 56522,\n\t\"./ar-tn\": 95682,\n\t\"./ar-tn.js\": 95682,\n\t\"./ar.js\": 90857,\n\t\"./az\": 70164,\n\t\"./az.js\": 70164,\n\t\"./be\": 79774,\n\t\"./be.js\": 79774,\n\t\"./bg\": 60947,\n\t\"./bg.js\": 60947,\n\t\"./bm\": 21832,\n\t\"./bm.js\": 21832,\n\t\"./bn\": 89650,\n\t\"./bn-bd\": 74477,\n\t\"./bn-bd.js\": 74477,\n\t\"./bn.js\": 89650,\n\t\"./bo\": 66005,\n\t\"./bo.js\": 66005,\n\t\"./br\": 98492,\n\t\"./br.js\": 98492,\n\t\"./bs\": 70534,\n\t\"./bs.js\": 70534,\n\t\"./ca\": 52061,\n\t\"./ca.js\": 52061,\n\t\"./cs\": 84737,\n\t\"./cs.js\": 84737,\n\t\"./cv\": 61167,\n\t\"./cv.js\": 61167,\n\t\"./cy\": 77996,\n\t\"./cy.js\": 77996,\n\t\"./da\": 9528,\n\t\"./da.js\": 9528,\n\t\"./de\": 14540,\n\t\"./de-at\": 49430,\n\t\"./de-at.js\": 49430,\n\t\"./de-ch\": 67978,\n\t\"./de-ch.js\": 67978,\n\t\"./de.js\": 14540,\n\t\"./dv\": 83426,\n\t\"./dv.js\": 83426,\n\t\"./el\": 6616,\n\t\"./el.js\": 6616,\n\t\"./en-au\": 63816,\n\t\"./en-au.js\": 63816,\n\t\"./en-ca\": 32162,\n\t\"./en-ca.js\": 32162,\n\t\"./en-gb\": 83305,\n\t\"./en-gb.js\": 83305,\n\t\"./en-ie\": 61954,\n\t\"./en-ie.js\": 61954,\n\t\"./en-il\": 43060,\n\t\"./en-il.js\": 43060,\n\t\"./en-in\": 59923,\n\t\"./en-in.js\": 59923,\n\t\"./en-nz\": 13540,\n\t\"./en-nz.js\": 13540,\n\t\"./en-sg\": 16505,\n\t\"./en-sg.js\": 16505,\n\t\"./eo\": 41907,\n\t\"./eo.js\": 41907,\n\t\"./es\": 86640,\n\t\"./es-do\": 41246,\n\t\"./es-do.js\": 41246,\n\t\"./es-mx\": 56131,\n\t\"./es-mx.js\": 56131,\n\t\"./es-us\": 36430,\n\t\"./es-us.js\": 36430,\n\t\"./es.js\": 86640,\n\t\"./et\": 62551,\n\t\"./et.js\": 62551,\n\t\"./eu\": 32711,\n\t\"./eu.js\": 32711,\n\t\"./fa\": 54572,\n\t\"./fa.js\": 54572,\n\t\"./fi\": 33390,\n\t\"./fi.js\": 33390,\n\t\"./fil\": 87860,\n\t\"./fil.js\": 87860,\n\t\"./fo\": 48216,\n\t\"./fo.js\": 48216,\n\t\"./fr\": 99291,\n\t\"./fr-ca\": 98527,\n\t\"./fr-ca.js\": 98527,\n\t\"./fr-ch\": 58407,\n\t\"./fr-ch.js\": 58407,\n\t\"./fr.js\": 99291,\n\t\"./fy\": 47054,\n\t\"./fy.js\": 47054,\n\t\"./ga\": 49540,\n\t\"./ga.js\": 49540,\n\t\"./gd\": 73917,\n\t\"./gd.js\": 73917,\n\t\"./gl\": 51486,\n\t\"./gl.js\": 51486,\n\t\"./gom-deva\": 56245,\n\t\"./gom-deva.js\": 56245,\n\t\"./gom-latn\": 48868,\n\t\"./gom-latn.js\": 48868,\n\t\"./gu\": 59652,\n\t\"./gu.js\": 59652,\n\t\"./he\": 89019,\n\t\"./he.js\": 89019,\n\t\"./hi\": 42040,\n\t\"./hi.js\": 42040,\n\t\"./hr\": 63402,\n\t\"./hr.js\": 63402,\n\t\"./hu\": 79322,\n\t\"./hu.js\": 79322,\n\t\"./hy-am\": 27609,\n\t\"./hy-am.js\": 27609,\n\t\"./id\": 57942,\n\t\"./id.js\": 57942,\n\t\"./is\": 98275,\n\t\"./is.js\": 98275,\n\t\"./it\": 73053,\n\t\"./it-ch\": 4378,\n\t\"./it-ch.js\": 4378,\n\t\"./it.js\": 73053,\n\t\"./ja\": 46176,\n\t\"./ja.js\": 46176,\n\t\"./jv\": 679,\n\t\"./jv.js\": 679,\n\t\"./ka\": 92726,\n\t\"./ka.js\": 92726,\n\t\"./kk\": 72953,\n\t\"./kk.js\": 72953,\n\t\"./km\": 86957,\n\t\"./km.js\": 86957,\n\t\"./kn\": 59181,\n\t\"./kn.js\": 59181,\n\t\"./ko\": 47148,\n\t\"./ko.js\": 47148,\n\t\"./ku\": 27752,\n\t\"./ku.js\": 27752,\n\t\"./ky\": 65675,\n\t\"./ky.js\": 65675,\n\t\"./lb\": 41263,\n\t\"./lb.js\": 41263,\n\t\"./lo\": 65746,\n\t\"./lo.js\": 65746,\n\t\"./lt\": 11143,\n\t\"./lt.js\": 11143,\n\t\"./lv\": 38753,\n\t\"./lv.js\": 38753,\n\t\"./me\": 44054,\n\t\"./me.js\": 44054,\n\t\"./mi\": 31573,\n\t\"./mi.js\": 31573,\n\t\"./mk\": 30202,\n\t\"./mk.js\": 30202,\n\t\"./ml\": 68523,\n\t\"./ml.js\": 68523,\n\t\"./mn\": 79794,\n\t\"./mn.js\": 79794,\n\t\"./mr\": 56681,\n\t\"./mr.js\": 56681,\n\t\"./ms\": 56975,\n\t\"./ms-my\": 39859,\n\t\"./ms-my.js\": 39859,\n\t\"./ms.js\": 56975,\n\t\"./mt\": 3691,\n\t\"./mt.js\": 3691,\n\t\"./my\": 5152,\n\t\"./my.js\": 5152,\n\t\"./nb\": 7607,\n\t\"./nb.js\": 7607,\n\t\"./ne\": 21526,\n\t\"./ne.js\": 21526,\n\t\"./nl\": 86368,\n\t\"./nl-be\": 40076,\n\t\"./nl-be.js\": 40076,\n\t\"./nl.js\": 86368,\n\t\"./nn\": 68420,\n\t\"./nn.js\": 68420,\n\t\"./oc-lnc\": 51906,\n\t\"./oc-lnc.js\": 51906,\n\t\"./pa-in\": 94504,\n\t\"./pa-in.js\": 94504,\n\t\"./pl\": 54721,\n\t\"./pl.js\": 54721,\n\t\"./pt\": 74645,\n\t\"./pt-br\": 54548,\n\t\"./pt-br.js\": 54548,\n\t\"./pt.js\": 74645,\n\t\"./ro\": 71977,\n\t\"./ro.js\": 71977,\n\t\"./ru\": 26042,\n\t\"./ru.js\": 26042,\n\t\"./sd\": 78849,\n\t\"./sd.js\": 78849,\n\t\"./se\": 27739,\n\t\"./se.js\": 27739,\n\t\"./si\": 50084,\n\t\"./si.js\": 50084,\n\t\"./sk\": 92449,\n\t\"./sk.js\": 92449,\n\t\"./sl\": 23086,\n\t\"./sl.js\": 23086,\n\t\"./sq\": 33139,\n\t\"./sq.js\": 33139,\n\t\"./sr\": 30607,\n\t\"./sr-cyrl\": 30063,\n\t\"./sr-cyrl.js\": 30063,\n\t\"./sr.js\": 30607,\n\t\"./ss\": 40131,\n\t\"./ss.js\": 40131,\n\t\"./sv\": 21665,\n\t\"./sv.js\": 21665,\n\t\"./sw\": 5642,\n\t\"./sw.js\": 5642,\n\t\"./ta\": 33622,\n\t\"./ta.js\": 33622,\n\t\"./te\": 74825,\n\t\"./te.js\": 74825,\n\t\"./tet\": 48336,\n\t\"./tet.js\": 48336,\n\t\"./tg\": 39238,\n\t\"./tg.js\": 39238,\n\t\"./th\": 99463,\n\t\"./th.js\": 99463,\n\t\"./tk\": 39986,\n\t\"./tk.js\": 39986,\n\t\"./tl-ph\": 29672,\n\t\"./tl-ph.js\": 29672,\n\t\"./tlh\": 40043,\n\t\"./tlh.js\": 40043,\n\t\"./tr\": 51212,\n\t\"./tr.js\": 51212,\n\t\"./tzl\": 50110,\n\t\"./tzl.js\": 50110,\n\t\"./tzm\": 80482,\n\t\"./tzm-latn\": 38309,\n\t\"./tzm-latn.js\": 38309,\n\t\"./tzm.js\": 80482,\n\t\"./ug-cn\": 42495,\n\t\"./ug-cn.js\": 42495,\n\t\"./uk\": 54157,\n\t\"./uk.js\": 54157,\n\t\"./ur\": 80984,\n\t\"./ur.js\": 80984,\n\t\"./uz\": 64141,\n\t\"./uz-latn\": 43662,\n\t\"./uz-latn.js\": 43662,\n\t\"./uz.js\": 64141,\n\t\"./vi\": 12607,\n\t\"./vi.js\": 12607,\n\t\"./x-pseudo\": 66460,\n\t\"./x-pseudo.js\": 66460,\n\t\"./yo\": 92948,\n\t\"./yo.js\": 92948,\n\t\"./zh-cn\": 62658,\n\t\"./zh-cn.js\": 62658,\n\t\"./zh-hk\": 39352,\n\t\"./zh-hk.js\": 39352,\n\t\"./zh-mo\": 38274,\n\t\"./zh-mo.js\": 38274,\n\t\"./zh-tw\": 98451,\n\t\"./zh-tw.js\": 98451\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;","var map = {\n\t\"./helptexts.de.json\": 42292,\n\t\"./helptexts.en.json\": 83410,\n\t\"./helptexts.nb.json\": 66783,\n\t\"./helptexts.nn.json\": 61317,\n\t\"./helptexts.sl.json\": 86026,\n\t\"./helptexts.sv.json\": 20026\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 67680;","var map = {\n\t\"./kdvelements.de.json\": 27522,\n\t\"./kdvelements.en.json\": 67287,\n\t\"./kdvelements.nb.json\": 85980,\n\t\"./kdvelements.nn.json\": 65324,\n\t\"./kdvelements.sl.json\": 43544,\n\t\"./kdvelements.sv.json\": 87285\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 20366;","/* (ignored) */","/* (ignored) */","/* (ignored) */","/* (ignored) */"],"names":[],"sourceRoot":"webpack:///"}