{"version":3,"mappings":"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","names":["SetAvalanchePositionPageModule","_shared_components_module__WEBPACK_IMPORTED_MODULE_0__","declarations","_set_avalanche_position_page__WEBPACK_IMPORTED_MODULE_1__","imports","_angular_core__WEBPACK_IMPORTED_MODULE_5__","ctx_r1","SetAvalanchePositionPage","cdr","translateService","ngZone","fullscreenService","swipeBackService","modalController","_varsom_regobs_common_core__WEBPACK_IMPORTED_MODULE_6__","leaflet__WEBPACK_IMPORTED_MODULE_0__","iconUrl","startImageUrl","iconSize","iconAnchor","shadowUrl","shadowSize","endImageUrl","fullscreen$","isFullscreen$","get","toPromise","translations","fallbackLatlng","startLatLng","start","lat","lng","endLatLng","end","locationMarker","relativeToLatLng","icon","startIcon","startMarker","getLatLng","on","startIsActive","updateMarkers","endMarker","endIcon","fromMarker","locationMarkerIcon","map","setTimeout","runOutsideAngular","updatePolyline","disableSwipeBack","enableSwipeBack","confirmLocationText","toLowerCase","locationText","locationMarkerIconUrl","remove","setIcon","setStartLocationText","setLatLng","addTo","setEndLocationText","panTo","detectChanges","path","pathLine","color","weight","opacity","setLatLngs","event","Latitude","Longitude","dismiss","setLocationInMapComponent","confirmLocation","selectors","viewQuery","_components_set_location_in_map_set_location_in_map_component__WEBPACK_IMPORTED_MODULE_1__"],"sources":["webpack:///src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.module.ts","webpack:///src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.page.html","webpack:///src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { SharedComponentsModule } from '../../shared-components.module';\r\nimport { SetAvalanchePositionPage } from './set-avalanche-position.page';\r\n\r\n@NgModule({\r\n  imports: [SharedComponentsModule],\r\n  declarations: [SetAvalanchePositionPage],\r\n  entryComponents: [SetAvalanchePositionPage]\r\n})\r\nexport class SetAvalanchePositionPageModule {}\r\n","<ion-header *ngIf=\"!(fullscreen$ | async)\">\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ (geoHazard === GeoHazard.Snow ? 'REGISTRATION.SNOW.AVALANCHE_OBS.SET_AVALANCHE_POSITION' :\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.SET_LANDSLIDE_POSITION') | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <app-set-location-in-map *ngIf=\"fromMarker\" [geoHazard]=\"geoHazard\" (mapReady)=\"onMapReady($event)\" [fromMarker]=\"fromMarker\"\r\n    [locationMarker]=\"locationMarker\" (locationSet)=\"onLocationSet($event)\" [confirmLocationText]=\"confirmLocationText\"\r\n    fromLocationText=\"REGISTRATION.OBS_LOCATION.TITLE\" [showPreviousUsedLocations]=\"false\" [locationTitle]=\"locationText\"\r\n    [showPolyline]=\"false\" [showFromMarkerInDetails]=\"false\" [locationMarkerIconUrl]=\"locationMarkerIconUrl\">\r\n  </app-set-location-in-map>\r\n</ion-content>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  NgZone,\r\n  ChangeDetectorRef,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { ObsLocationEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport * as L from 'leaflet';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { SetLocationInMapComponent } from '../../components/set-location-in-map/set-location-in-map.component';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { Observable } from 'rxjs';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { SwipeBackService } from '../../../../core/services/swipe-back/swipe-back.service';\r\n\r\n@Component({\r\n  selector: 'app-set-avalanche-position',\r\n  templateUrl: './set-avalanche-position.page.html',\r\n  styleUrls: ['./set-avalanche-position.page.scss']\r\n})\r\nexport class SetAvalanchePositionPage implements OnInit {\r\n  @Input() startLatLng?: L.LatLng;\r\n  @Input() endLatLng?: L.LatLng;\r\n  @Input() relativeToLatLng?: L.LatLng;\r\n  @Input() geoHazard: GeoHazard;\r\n  @Input() showPolyline = true;\r\n\r\n  GeoHazard = GeoHazard;\r\n\r\n  start: L.LatLng;\r\n  end: L.LatLng;\r\n  private map: L.Map;\r\n  private pathLine: L.Polyline;\r\n\r\n  fromMarker: L.Marker;\r\n  locationMarker: L.Marker;\r\n  confirmLocationText = '';\r\n  locationText = '';\r\n  startImageUrl = '/assets/icon/map/GPS_start.svg';\r\n  private startIcon = L.icon({\r\n    iconUrl: this.startImageUrl,\r\n    iconSize: [27, 42],\r\n    iconAnchor: [13.5, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  endImageUrl = '/assets/icon/map/GPS_stop.svg';\r\n  private endIcon = L.icon({\r\n    iconUrl: this.endImageUrl,\r\n    iconSize: [27, 42],\r\n    iconAnchor: [13.5, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  locationMarkerIcon = L.icon({\r\n    iconUrl: '/assets/icon/map/obs-location.svg',\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  private startMarker: L.Marker;\r\n  private endMarker: L.Marker;\r\n  private translations;\r\n  private startIsActive = true;\r\n  locationMarkerIconUrl = this.startImageUrl;\r\n\r\n  fullscreen$: Observable<boolean>;\r\n\r\n  @ViewChild(SetLocationInMapComponent)\r\n  setLocationInMapComponent: SetLocationInMapComponent;\r\n\r\n  constructor(\r\n    private cdr: ChangeDetectorRef,\r\n    private translateService: TranslateService,\r\n    private ngZone: NgZone,\r\n    private fullscreenService: FullscreenService,\r\n    private swipeBackService: SwipeBackService,\r\n    private modalController: ModalController\r\n  ) {\r\n    this.fullscreen$ = this.fullscreenService.isFullscreen$;\r\n  }\r\n\r\n  async ngOnInit() {\r\n    this.translations = await this.translateService\r\n      .get([\r\n        'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION',\r\n        'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION',\r\n        'DIALOGS.CONFIRM'\r\n      ])\r\n      .toPromise();\r\n    const fallbackLatlng = L.latLng(59.1, 10.3);\r\n    if (this.startLatLng) {\r\n      this.start = L.latLng(this.startLatLng.lat, this.startLatLng.lng);\r\n    }\r\n    if (this.endLatLng) {\r\n      this.end = L.latLng(this.endLatLng.lat, this.endLatLng.lng);\r\n    }\r\n    this.locationMarker = L.marker(this.relativeToLatLng || fallbackLatlng, {\r\n      icon: this.startIcon\r\n    });\r\n    this.startMarker = L.marker(this.locationMarker.getLatLng(), {\r\n      icon: this.startIcon\r\n    }).on('click', () => {\r\n      if (!this.startIsActive) {\r\n        this.end = this.locationMarker.getLatLng();\r\n      }\r\n      this.startIsActive = true;\r\n      this.updateMarkers();\r\n    });\r\n    this.endMarker = L.marker(this.locationMarker.getLatLng(), {\r\n      icon: this.endIcon\r\n    }).on('click', () => {\r\n      if (this.startIsActive) {\r\n        this.start = this.locationMarker.getLatLng();\r\n      }\r\n      this.startIsActive = false;\r\n      this.updateMarkers();\r\n    });\r\n    if (this.relativeToLatLng) {\r\n      this.fromMarker = L.marker(this.relativeToLatLng, {\r\n        icon: this.locationMarkerIcon\r\n      });\r\n    }\r\n  }\r\n\r\n  onMapReady(map: L.Map) {\r\n    this.map = map;\r\n    setTimeout(() => {\r\n      this.updateMarkers();\r\n    });\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.map.on('drag', () => this.updatePolyline());\r\n      this.updatePolyline();\r\n    });\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.swipeBackService.disableSwipeBack();\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.swipeBackService.enableSwipeBack();\r\n  }\r\n\r\n  private setStartLocationText() {\r\n    this.confirmLocationText = `${\r\n      this.translations['DIALOGS.CONFIRM']\r\n    } ${this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION'\r\n    ].toLowerCase()}`;\r\n    this.locationText = this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION'\r\n    ];\r\n    this.locationMarkerIconUrl = this.startImageUrl;\r\n  }\r\n\r\n  private setEndLocationText() {\r\n    this.confirmLocationText = `${\r\n      this.translations['DIALOGS.CONFIRM']\r\n    } ${this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION'\r\n    ].toLowerCase()}`;\r\n    this.locationText = this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION'\r\n    ];\r\n    this.locationMarkerIconUrl = this.endImageUrl;\r\n  }\r\n\r\n  private updateMarkers() {\r\n    this.startMarker.remove();\r\n    this.endMarker.remove();\r\n    if (!this.start) {\r\n      this.locationMarker.setIcon(this.startIcon);\r\n      this.setStartLocationText();\r\n    } else {\r\n      if (this.startIsActive) {\r\n        this.locationMarker.setIcon(this.startIcon);\r\n        this.locationMarker.setLatLng(this.start);\r\n        this.setStartLocationText();\r\n        if (this.end) {\r\n          this.endMarker.setLatLng(this.end);\r\n          this.endMarker.addTo(this.map);\r\n        }\r\n      } else {\r\n        this.locationMarker.setIcon(this.endIcon);\r\n        this.locationMarker.setLatLng(this.end || this.start);\r\n        this.setEndLocationText();\r\n        this.startMarker.setLatLng(this.start);\r\n        this.startMarker.addTo(this.map);\r\n      }\r\n    }\r\n    this.map.panTo(this.locationMarker.getLatLng());\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  updatePolyline() {\r\n    if (this.end || this.start) {\r\n      const path = [\r\n        this.locationMarker.getLatLng(),\r\n        this.startIsActive ? this.end : this.start\r\n      ];\r\n      if (!this.pathLine) {\r\n        this.pathLine = L.polyline(path, {\r\n          color: 'red',\r\n          weight: 6,\r\n          opacity: 0.9\r\n        }).addTo(this.map);\r\n      } else {\r\n        this.pathLine.setLatLngs(path);\r\n      }\r\n    }\r\n  }\r\n\r\n  async onLocationSet(event: ObsLocationEditModel) {\r\n    if (this.startIsActive) {\r\n      this.start = L.latLng(event.Latitude, event.Longitude);\r\n      if (this.end) {\r\n        this.map.panTo(this.end);\r\n      } else {\r\n        this.end = L.latLng(event.Latitude, event.Longitude);\r\n      }\r\n      this.startIsActive = false;\r\n      this.updateMarkers();\r\n    } else {\r\n      this.end = L.latLng(event.Latitude, event.Longitude);\r\n      this.modalController.dismiss({ start: this.start, end: this.end });\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  ok() {\r\n    this.setLocationInMapComponent.confirmLocation();\r\n  }\r\n}\r\n"]}