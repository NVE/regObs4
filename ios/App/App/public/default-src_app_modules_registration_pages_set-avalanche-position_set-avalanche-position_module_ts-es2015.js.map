{"version":3,"file":"default-src_app_modules_registration_pages_set-avalanche-position_set-avalanche-position_module_ts-es2015.js","mappings":"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","sources":["./src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.module.ts","./src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.page.ts","./src/app/modules/registration/pages/set-avalanche-position/set-avalanche-position.page.html"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { SharedComponentsModule } from '../../shared-components.module';\r\nimport { SetAvalanchePositionPage } from './set-avalanche-position.page';\r\n\r\n@NgModule({\r\n  imports: [SharedComponentsModule],\r\n  declarations: [SetAvalanchePositionPage],\r\n  entryComponents: [SetAvalanchePositionPage]\r\n})\r\nexport class SetAvalanchePositionPageModule {}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  NgZone,\r\n  ChangeDetectorRef,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { ObsLocationEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport * as L from 'leaflet';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { SetLocationInMapComponent } from '../../components/set-location-in-map/set-location-in-map.component';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { Observable } from 'rxjs';\r\nimport { FullscreenService } from '../../../../core/services/fullscreen/fullscreen.service';\r\nimport { SwipeBackService } from '../../../../core/services/swipe-back/swipe-back.service';\r\n\r\n@Component({\r\n  selector: 'app-set-avalanche-position',\r\n  templateUrl: './set-avalanche-position.page.html',\r\n  styleUrls: ['./set-avalanche-position.page.scss']\r\n})\r\nexport class SetAvalanchePositionPage implements OnInit {\r\n  @Input() startLatLng?: L.LatLng;\r\n  @Input() endLatLng?: L.LatLng;\r\n  @Input() relativeToLatLng?: L.LatLng;\r\n  @Input() geoHazard: GeoHazard;\r\n  @Input() showPolyline = true;\r\n\r\n  GeoHazard = GeoHazard;\r\n\r\n  start: L.LatLng;\r\n  end: L.LatLng;\r\n  private map: L.Map;\r\n  private pathLine: L.Polyline;\r\n\r\n  fromMarker: L.Marker;\r\n  locationMarker: L.Marker;\r\n  confirmLocationText = '';\r\n  locationText = '';\r\n  startImageUrl = '/assets/icon/map/GPS_start.svg';\r\n  private startIcon = L.icon({\r\n    iconUrl: this.startImageUrl,\r\n    iconSize: [27, 42],\r\n    iconAnchor: [13.5, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  endImageUrl = '/assets/icon/map/GPS_stop.svg';\r\n  private endIcon = L.icon({\r\n    iconUrl: this.endImageUrl,\r\n    iconSize: [27, 42],\r\n    iconAnchor: [13.5, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  locationMarkerIcon = L.icon({\r\n    iconUrl: '/assets/icon/map/obs-location.svg',\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    shadowUrl: 'leaflet/marker-shadow.png',\r\n    shadowSize: [41, 41]\r\n  });\r\n  private startMarker: L.Marker;\r\n  private endMarker: L.Marker;\r\n  private translations;\r\n  private startIsActive = true;\r\n  locationMarkerIconUrl = this.startImageUrl;\r\n\r\n  fullscreen$: Observable<boolean>;\r\n\r\n  @ViewChild(SetLocationInMapComponent)\r\n  setLocationInMapComponent: SetLocationInMapComponent;\r\n\r\n  constructor(\r\n    private cdr: ChangeDetectorRef,\r\n    private translateService: TranslateService,\r\n    private ngZone: NgZone,\r\n    private fullscreenService: FullscreenService,\r\n    private swipeBackService: SwipeBackService,\r\n    private modalController: ModalController\r\n  ) {\r\n    this.fullscreen$ = this.fullscreenService.isFullscreen$;\r\n  }\r\n\r\n  async ngOnInit() {\r\n    this.translations = await this.translateService\r\n      .get([\r\n        'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION',\r\n        'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION',\r\n        'DIALOGS.CONFIRM'\r\n      ])\r\n      .toPromise();\r\n    const fallbackLatlng = L.latLng(59.1, 10.3);\r\n    if (this.startLatLng) {\r\n      this.start = L.latLng(this.startLatLng.lat, this.startLatLng.lng);\r\n    }\r\n    if (this.endLatLng) {\r\n      this.end = L.latLng(this.endLatLng.lat, this.endLatLng.lng);\r\n    }\r\n    this.locationMarker = L.marker(this.relativeToLatLng || fallbackLatlng, {\r\n      icon: this.startIcon\r\n    });\r\n    this.startMarker = L.marker(this.locationMarker.getLatLng(), {\r\n      icon: this.startIcon\r\n    }).on('click', () => {\r\n      if (!this.startIsActive) {\r\n        this.end = this.locationMarker.getLatLng();\r\n      }\r\n      this.startIsActive = true;\r\n      this.updateMarkers();\r\n    });\r\n    this.endMarker = L.marker(this.locationMarker.getLatLng(), {\r\n      icon: this.endIcon\r\n    }).on('click', () => {\r\n      if (this.startIsActive) {\r\n        this.start = this.locationMarker.getLatLng();\r\n      }\r\n      this.startIsActive = false;\r\n      this.updateMarkers();\r\n    });\r\n    if (this.relativeToLatLng) {\r\n      this.fromMarker = L.marker(this.relativeToLatLng, {\r\n        icon: this.locationMarkerIcon\r\n      });\r\n    }\r\n  }\r\n\r\n  onMapReady(map: L.Map) {\r\n    this.map = map;\r\n    setTimeout(() => {\r\n      this.updateMarkers();\r\n    });\r\n    this.ngZone.runOutsideAngular(() => {\r\n      this.map.on('drag', () => this.updatePolyline());\r\n      this.updatePolyline();\r\n    });\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.swipeBackService.disableSwipeBack();\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.swipeBackService.enableSwipeBack();\r\n  }\r\n\r\n  private setStartLocationText() {\r\n    this.confirmLocationText = `${\r\n      this.translations['DIALOGS.CONFIRM']\r\n    } ${this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION'\r\n    ].toLowerCase()}`;\r\n    this.locationText = this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.START_POSITION'\r\n    ];\r\n    this.locationMarkerIconUrl = this.startImageUrl;\r\n  }\r\n\r\n  private setEndLocationText() {\r\n    this.confirmLocationText = `${\r\n      this.translations['DIALOGS.CONFIRM']\r\n    } ${this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION'\r\n    ].toLowerCase()}`;\r\n    this.locationText = this.translations[\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.END_POSITION'\r\n    ];\r\n    this.locationMarkerIconUrl = this.endImageUrl;\r\n  }\r\n\r\n  private updateMarkers() {\r\n    this.startMarker.remove();\r\n    this.endMarker.remove();\r\n    if (!this.start) {\r\n      this.locationMarker.setIcon(this.startIcon);\r\n      this.setStartLocationText();\r\n    } else {\r\n      if (this.startIsActive) {\r\n        this.locationMarker.setIcon(this.startIcon);\r\n        this.locationMarker.setLatLng(this.start);\r\n        this.setStartLocationText();\r\n        if (this.end) {\r\n          this.endMarker.setLatLng(this.end);\r\n          this.endMarker.addTo(this.map);\r\n        }\r\n      } else {\r\n        this.locationMarker.setIcon(this.endIcon);\r\n        this.locationMarker.setLatLng(this.end || this.start);\r\n        this.setEndLocationText();\r\n        this.startMarker.setLatLng(this.start);\r\n        this.startMarker.addTo(this.map);\r\n      }\r\n    }\r\n    this.map.panTo(this.locationMarker.getLatLng());\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  updatePolyline() {\r\n    if (this.end || this.start) {\r\n      const path = [\r\n        this.locationMarker.getLatLng(),\r\n        this.startIsActive ? this.end : this.start\r\n      ];\r\n      if (!this.pathLine) {\r\n        this.pathLine = L.polyline(path, {\r\n          color: 'red',\r\n          weight: 6,\r\n          opacity: 0.9\r\n        }).addTo(this.map);\r\n      } else {\r\n        this.pathLine.setLatLngs(path);\r\n      }\r\n    }\r\n  }\r\n\r\n  async onLocationSet(event: ObsLocationEditModel) {\r\n    if (this.startIsActive) {\r\n      this.start = L.latLng(event.Latitude, event.Longitude);\r\n      if (this.end) {\r\n        this.map.panTo(this.end);\r\n      } else {\r\n        this.end = L.latLng(event.Latitude, event.Longitude);\r\n      }\r\n      this.startIsActive = false;\r\n      this.updateMarkers();\r\n    } else {\r\n      this.end = L.latLng(event.Latitude, event.Longitude);\r\n      this.modalController.dismiss({ start: this.start, end: this.end });\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  ok() {\r\n    this.setLocationInMapComponent.confirmLocation();\r\n  }\r\n}\r\n","<ion-header *ngIf=\"!(fullscreen$ | async)\">\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ (geoHazard === GeoHazard.Snow ? 'REGISTRATION.SNOW.AVALANCHE_OBS.SET_AVALANCHE_POSITION' :\r\n      'REGISTRATION.DIRT.LAND_SLIDE_OBS.SET_LANDSLIDE_POSITION') | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <app-set-location-in-map *ngIf=\"fromMarker\" [geoHazard]=\"geoHazard\" (mapReady)=\"onMapReady($event)\" [fromMarker]=\"fromMarker\"\r\n    [locationMarker]=\"locationMarker\" (locationSet)=\"onLocationSet($event)\" [confirmLocationText]=\"confirmLocationText\"\r\n    fromLocationText=\"REGISTRATION.OBS_LOCATION.TITLE\" [showPreviousUsedLocations]=\"false\" [locationTitle]=\"locationText\"\r\n    [showPolyline]=\"false\" [showFromMarkerInDetails]=\"false\" [locationMarkerIconUrl]=\"locationMarkerIconUrl\">\r\n  </app-set-location-in-map>\r\n</ion-content>"],"names":[],"sourceRoot":"webpack:///"}