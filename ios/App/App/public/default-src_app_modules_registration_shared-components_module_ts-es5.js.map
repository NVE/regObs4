{"version":3,"mappings":"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","names":["stringify","__webpack_require__","IsEmptyHelper","obj","undefined","length","Array","arr","some","x","isEmpty","props","Object","getOwnPropertyNames","LocationService","regobsAuthService","apiLocationService","geoHazard","lat","lng","radius","loggedInUser$","pipe","loggedInUser","LocationWithinRadius","geoHazardTypeIds","latitude","longitude","observerGuid","returnCount","_angular_core__WEBPACK_IMPORTED_MODULE_2__","factory","providedIn","UserGroupService","userSettingService","accountApiService","dataLoadService","getLoggedInUserAsPromise","isLoggedIn","appMode$","appMode","checkLastUpdatedAndUpdateDataIfNeeded","email","dataLoadId","getDataLoadId","getState","dataLoad","lastUpdateLimit","moment__WEBPACK_IMPORTED_MODULE_3___default","subtract","lastUpdated","isBefore","updateUserGroupsForUser","startLoading","AccountGetObserverGroups","result","saveUserGroups","loadingCompleted","observerGroups","userGroups","map","val","key","Id","userId","Name","instanceName","_nanosql__WEBPACK_IMPORTED_MODULE_1__","loadJS","deleteUserGroupsNoLongerInResult","ug","ids","query","where","dbGroup","indexOf","exec","getUserGroupsFromDb","Promise","resolve","getUserGroupsAsObservable","toPromise","_angular_core__WEBPACK_IMPORTED_MODULE_13__","LeafletClusterHelper","options","defaultOptions","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","maxClusterRadius","_settings__WEBPACK_IMPORTED_MODULE_1__","iconCreateFunction","createClusterIcon","leaflet__WEBPACK_IMPORTED_MODULE_0__","cluster","getAllChildMarkers","size","html","iconSize","iconAnchor","className","_angular_core__WEBPACK_IMPORTED_MODULE_12__","DEBUG_TAG","MIME_TYPE","AddPictureItemComponent","translateService","camera","platform","file","logger","webView","toastController","domSanitizer","actionSheetController","newAttachmentService","cdr","getAttachments","registrationId","attachments","filter","a","RegistrationTID","registrationTid","type","attachmentType","ref","getBlob","id","blob","err","error","ngDestroy$","subscribe","detectChanges","onBeforeAdd","get","translations","create","header","buttons","text","handler","getPicture","PictureSourceType","CAMERA","PHOTOLIBRARY","role","actionSheet","present","sourceType","is","addDummyImage","quality","destinationType","DestinationType","FILE_URI","encodingType","EncodingType","JPEG","mediaType","MediaType","PICTURE","targetHeight","targetWidth","correctOrientation","saveToPhotoAlbum","_ionic_native_camera_ngx__WEBPACK_IMPORTED_MODULE_0__","imageUrl","validateImage","showErrorToast","debug","getArrayBuffer","arrayBuffer","addImage","Blob","log","_shared_services_logging_log_level_model__WEBPACK_IMPORTED_MODULE_8__","fileUrl","resolveLocalFilesystemUrl","entry","isFile","Error","pathSplitted","nativeURL","split","filename","pop","directory","join","readAsArrayBuffer","src","name","endsWith","messageKey","translation","message","mode","duration","toast","_core_helpers_data_url_helper__WEBPACK_IMPORTED_MODULE_4__","dummyImage","data","mimeType","addAttachment","image","removeAttachment","src_app_core_helpers_observable_helper__WEBPACK_IMPORTED_MODULE_9__","selectors","inputs","title","pictureCommentText","pictureCommentPlaceholder","icon","showIcon","iconColor","features","decls","vars","consts","template","ctx","_angular_core__WEBPACK_IMPORTED_MODULE_1__","AddWebUrlItemComponent","modalController","zone","index","weburl","weburls","component","_pages_add_web_url_modal_add_web_url_modal_page__WEBPACK_IMPORTED_MODULE_0__","componentProps","modal","onDidDismiss","removeAtIndex","setWebUrl","addWebUrl","url","run","weburlsChange","emit","push","splice","outputs","Base64ImageComponent","sanitizer","applyImageUrlTag","base64encodedImage","startsWith","imgSrc","bypassSecurityTrustUrl","dataUrlTag","_angular_core__WEBPACK_IMPORTED_MODULE_0__","BlobImageComponent","blobUrl","URL","createObjectURL","imgBlob","revokeObjectURL","_angular_core__WEBPACK_IMPORTED_MODULE_3__","HelpTextComponent","helpTextService","ngZone","userSetting$","userSetting","getHelpTextByKey","language","helpText","isVisible","_pages_modal_pages_help_modal_help_modal_page__WEBPACK_IMPORTED_MODULE_2__","Text","KdvRadiobuttonListComponent","kdvService","kdvelements$","getKdvRepositoryByKeyObservable","kdvKey","value","valueChange","item","showZeroValues","useDescription","ngContentSelectors","KdvSelectComponent","kdvelements","el","Description","disabled","getIconFunc","subscription","unsubscribe","labelColor","showResetButton","ModalSaveOrDeleteButtonsComponent","alertController","saveClicked","toTranslate","alertTitle","alertMessage","deleteClicked","alert","saveText","saveDisabled","showDelete","NavigationButtonsComponent","summaryItemService","router","currentUrl","getPreviousAndNext","registration","prevAndNext","next","previous","navigateTo","NumericInputComponent","converted","convert","toLocaleString","isOpen","readonly","_pages_modal_pages_numeric_input_modal_numeric_input_modal_page__WEBPACK_IMPORTED_MODULE_0__","cssClass","decimalPlaces","min","max","suffix","decimalSeparator","ok","direction","convertRatio","placeholder","_r2","_angular_core__WEBPACK_IMPORTED_MODULE_4__","ctx_r0","RegistrationContentWrapperComponent","reset","SaveAndGoBackButtonComponent","navContoller","commonRegistrationService","changes","isFirstChange","setHasData","hasAnyDataToShowInRegistrationTypes","hasData","markForCheck","navigateBack","_angular_core__WEBPACK_IMPORTED_MODULE_9__","_r6","_r4","ctx_r5","defaultIcon","iconUrl","shadowUrl","popupAnchor","tooltipAnchor","shadowSize","previousUsedPlaceIcon","SetLocationInMapComponent","mapService","helperService","mapSearchService","geoPositionService","locationService","rxjs__WEBPACK_IMPORTED_MODULE_10__","_map_helpers_leaflet_cluser_helper__WEBPACK_IMPORTED_MODULE_6__","allowEditLocationName","selectedLocation","locationMarkerIcon","locationMarkerIconUrl","followMode","locationMarker","fromMarker","getLatLng","mapView$","lastView","center","updateMapViewInfo","complete","mapView","bounds","getLocationWithinRadiusObservable","Math","round","getNorthWest","distanceTo","getSouthEast","loc","existing","locations","location","marker","LatLngObject","Latitude","Longitude","addTo","locationGroup","on","setToPrevouslyUsedLocation","m","setZIndexOffset","isLoading","moveLocationMarkerToCenter","showPreviousUsedLocations","getLocationsObservable","forEach","addLocationIfNotExists","followMode$","userposition","setLocationMarkerLatLng","coords","mapSearchClick$","latLng","latlng","currentPosition$","pos","positionChange","setView","mapReady","updatePathAndDistance","setLatLng","panTo","showDetails","getCenter","getViewInfo","zoom","viewInfo","_","position","from","locationMarkerLatLng","path","pathLine","color","weight","opacity","dashArray","showPolyline","setLatLngs","equals","setOpacity","setStyle","distanceToObservationText","getDistanceText","adminName","obsLocation","getLocation","locationSet","Uncertainty","UTMSourceTID","_pages_obs_location_utm_source_enum__WEBPACK_IMPORTED_MODULE_5__","editLocationName","locationName","ObsLocationID","LocationName","substring","LocationDescription","getLocationName","accuracy","canEditLocationName","setTimeout","editLocationNameInput","setFocus","_a","toString","viewQuery","CompressionTestListComponent","add","_compression_test_modal_compression_test_modal_page__WEBPACK_IMPORTED_MODULE_0__","compressionTest","tests","includeInSnowProfileAsDefault","removeTest","testsChange","_angular_core__WEBPACK_IMPORTED_MODULE_7__","CompressionTestModalPage","clone","IncludeInSnowProfile","_core_helpers_is_empty_helper__WEBPACK_IMPORTED_MODULE_0__","i","tapsArray","checkIfIncludeInSnowProfileShouldBeDisabled","isLBT","includeInSnowProfileDisabled","isCTNorECTX","isCTVorECTV","PropagationTID","dismiss","ctx_r1","ExposedHeightComponent","heightArray","exposedHight1","setExposedHeights","exposedHeightComboTID","exposedHeightTop","exposedHeightMiddle","exposedHeightBottom","applyChanges","top","middle","bottom","updateExposedHeightComboTID","sholdUseExposedHight2","exposedHight2","exposedHeightComboTIDChange","exposedHight1Change","exposedHight2Change","EMPTY_EXPOSITION","ALL_EXPOSITION","ValidExpositionComponent","validExposition","validExpositionCopy","existingValue","substr","newValue","validExpositionChange","TextCommentComponent","trim","rows","YesNoSelectComponent","AddWebUrlModalPage","urlToSave","isNew","HelpModalPageModule","_shared_shared_module__WEBPACK_IMPORTED_MODULE_1__","ngx_markdown__WEBPACK_IMPORTED_MODULE_3__","declarations","_help_modal_page__WEBPACK_IMPORTED_MODULE_0__","imports","HelpModalPage","NumericInputModalPageModule","_modules_shared_shared_module__WEBPACK_IMPORTED_MODULE_1__","_numeric_input_modal_page__WEBPACK_IMPORTED_MODULE_0__","NumericInputModalPage","numbers","textVal","replace","decimalSep","num","parseFloat","isNaN","isNegative","event","match","pushNumber","pushDecimalSeparator","keyCode","done","clear","positiveValue","_core_helpers_number_helper__WEBPACK_IMPORTED_MODULE_0__","getDecimalSeparatorForBrowser","numberVal","isDecimal","getNumberOfDecimals","hostBindings","UtmSource","KdvDescriptionPipe","returnDescription","kdvelement","find","pure","MetersToCmPipe","SummaryItemService","registrationService","dateHelperService","userGroupService","navController","getUserGroups","userGroupsToUse","href","queryParams","subTitle","request","ObsLocation","DtObsTime","formatDateString","summaryItems","getObservationGroupName","ObserverGroupID","getGeoHazardItems","getRegItem","GeneralObservation","ObsComment","src_app_modules_common_registration_registration_models__WEBPACK_IMPORTED_MODULE_1__","getSummaryItems","currentItem","nextIndex","summaryItem","navigateForward","navigateRoot","selectedGroup","_varsom_regobs_common_core__WEBPACK_IMPORTED_MODULE_5__","getWaterItems","getIceItems","getDirtItems","getSnowItems","WaterLevel2","Comment","getAllAttachmentsForRegistrationTid$","LandSlideObs","IceCoverObs","IceThickness","CompressionTest","SharedComponentsModule","_shared_shared_module__WEBPACK_IMPORTED_MODULE_0__","_map_map_module__WEBPACK_IMPORTED_MODULE_7__","_pages_modal_pages_help_modal_help_modal_module__WEBPACK_IMPORTED_MODULE_16__","_pages_modal_pages_numeric_input_modal_numeric_input_modal_module__WEBPACK_IMPORTED_MODULE_19__","_components_save_and_go_back_button_save_and_go_back_button_component__WEBPACK_IMPORTED_MODULE_1__","_components_add_picture_item_add_picture_item_component__WEBPACK_IMPORTED_MODULE_3__","_components_text_comment_text_comment_component__WEBPACK_IMPORTED_MODULE_2__","_components_kdv_radiobutton_list_kdv_radiobutton_list_component__WEBPACK_IMPORTED_MODULE_4__","_components_navigation_buttons_navigation_buttons_component__WEBPACK_IMPORTED_MODULE_5__","_components_set_location_in_map_set_location_in_map_component__WEBPACK_IMPORTED_MODULE_6__","_components_base64_image_base64_image_component__WEBPACK_IMPORTED_MODULE_8__","_pipes_kdv_description_pipe__WEBPACK_IMPORTED_MODULE_9__","_pipes_meters_to_cm_pipe__WEBPACK_IMPORTED_MODULE_20__","_components_add_web_url_item_add_web_url_item_component__WEBPACK_IMPORTED_MODULE_10__","_components_modal_save_or_delete_buttons_modal_save_or_delete_buttons_component__WEBPACK_IMPORTED_MODULE_11__","_components_snow_exposed_height_exposed_height_component__WEBPACK_IMPORTED_MODULE_12__","_components_snow_valid_exposition_valid_exposition_component__WEBPACK_IMPORTED_MODULE_13__","_components_registration_content_wrapper_registration_content_wrapper_component__WEBPACK_IMPORTED_MODULE_14__","_components_help_text_help_text_component__WEBPACK_IMPORTED_MODULE_15__","_components_yes_no_select_yes_no_select_component__WEBPACK_IMPORTED_MODULE_17__","_components_numeric_input_numeric_input_component__WEBPACK_IMPORTED_MODULE_18__","_components_snow_compression_test_list_compression_test_list_component__WEBPACK_IMPORTED_MODULE_21__","_components_kdv_select_kdv_select_component__WEBPACK_IMPORTED_MODULE_22__","_components_blob_image_blob_image_component__WEBPACK_IMPORTED_MODULE_23__","exports"],"sources":["webpack:///src/app/core/helpers/is-empty.helper.ts","webpack:///src/app/core/services/location/location.service.ts","webpack:///src/app/core/services/user-group/user-group.service.ts","webpack:///src/app/modules/map/helpers/leaflet-cluser.helper.ts","webpack:///src/app/modules/registration/components/add-picture-item/add-picture-item.component.html","webpack:///src/app/modules/registration/components/add-picture-item/add-picture-item.component.ts","webpack:///src/app/modules/registration/components/add-web-url-item/add-web-url-item.component.html","webpack:///src/app/modules/registration/components/add-web-url-item/add-web-url-item.component.ts","webpack:///src/app/modules/registration/components/base64-image/base64-image.component.ts","webpack:///src/app/modules/registration/components/base64-image/base64-image.component.html","webpack:///src/app/modules/registration/components/blob-image/blob-image.component.ts","webpack:///src/app/modules/registration/components/blob-image/blob-image.component.html","webpack:///src/app/modules/registration/components/help-text/help-text.component.html","webpack:///src/app/modules/registration/components/help-text/help-text.component.ts","webpack:///src/app/modules/registration/components/kdv-radiobutton-list/kdv-radiobutton-list.component.html","webpack:///src/app/modules/registration/components/kdv-radiobutton-list/kdv-radiobutton-list.component.ts","webpack:///src/app/modules/registration/components/kdv-select/kdv-select.component.ts","webpack:///src/app/modules/registration/components/kdv-select/kdv-select.component.html","webpack:///src/app/modules/registration/components/modal-save-or-delete-buttons/modal-save-or-delete-buttons.component.html","webpack:///src/app/modules/registration/components/modal-save-or-delete-buttons/modal-save-or-delete-buttons.component.ts","webpack:///src/app/modules/registration/components/navigation-buttons/navigation-buttons.component.html","webpack:///src/app/modules/registration/components/navigation-buttons/navigation-buttons.component.ts","webpack:///src/app/modules/registration/components/numeric-input/numeric-input.component.html","webpack:///src/app/modules/registration/components/numeric-input/numeric-input.component.ts","webpack:///src/app/modules/registration/components/registration-content-wrapper/registration-content-wrapper.component.html","webpack:///src/app/modules/registration/components/registration-content-wrapper/registration-content-wrapper.component.ts","webpack:///src/app/modules/registration/components/save-and-go-back-button/save-and-go-back-button.component.html","webpack:///src/app/modules/registration/components/save-and-go-back-button/save-and-go-back-button.component.ts","webpack:///src/app/modules/registration/components/set-location-in-map/set-location-in-map.component.html","webpack:///src/app/modules/registration/components/set-location-in-map/set-location-in-map.component.ts","webpack:///src/app/modules/registration/components/snow/compression-test-list/compression-test-list.component.html","webpack:///src/app/modules/registration/components/snow/compression-test-list/compression-test-list.component.ts","webpack:///src/app/modules/registration/components/snow/compression-test-list/compression-test-modal/compression-test-modal.page.html","webpack:///src/app/modules/registration/components/snow/compression-test-list/compression-test-modal/compression-test-modal.page.ts","webpack:///src/app/modules/registration/components/snow/exposed-height/exposed-height.component.html","webpack:///src/app/modules/registration/components/snow/exposed-height/exposed-height.component.ts","webpack:///src/app/modules/registration/components/snow/valid-exposition/valid-exposition.component.html","webpack:///src/app/modules/registration/components/snow/valid-exposition/valid-exposition.component.ts","webpack:///src/app/modules/registration/components/text-comment/text-comment.component.ts","webpack:///src/app/modules/registration/components/text-comment/text-comment.component.html","webpack:///src/app/modules/registration/components/yes-no-select/yes-no-select.component.ts","webpack:///src/app/modules/registration/components/yes-no-select/yes-no-select.component.html","webpack:///src/app/modules/registration/pages/add-web-url-modal/add-web-url-modal.page.ts","webpack:///src/app/modules/registration/pages/add-web-url-modal/add-web-url-modal.page.html","webpack:///src/app/modules/registration/pages/modal-pages/help-modal/help-modal.module.ts","webpack:///src/app/modules/registration/pages/modal-pages/help-modal/help-modal.page.ts","webpack:///src/app/modules/registration/pages/modal-pages/help-modal/help-modal.page.html","webpack:///src/app/modules/registration/pages/modal-pages/numeric-input-modal/numeric-input-modal.module.ts","webpack:///src/app/modules/registration/pages/modal-pages/numeric-input-modal/numeric-input-modal.page.html","webpack:///src/app/modules/registration/pages/modal-pages/numeric-input-modal/numeric-input-modal.page.ts","webpack:///src/app/modules/registration/pages/obs-location/utm-source.enum.ts","webpack:///src/app/modules/registration/pipes/kdv-description.pipe.ts","webpack:///src/app/modules/registration/pipes/meters-to-cm.pipe.ts","webpack:///src/app/modules/registration/services/summary-item.service.ts","webpack:///src/app/modules/registration/shared-components.module.ts"],"sourcesContent":["const stringify = require('json-stringify-safe');\r\nexport class IsEmptyHelper {\r\n  static isEmpty(obj: Object | Array<Object | Array<Object>>) {\r\n    if (obj === null || obj === undefined) {\r\n      return true;\r\n    } else if (typeof obj === 'string') {\r\n      return obj.length === 0;\r\n    } else if (typeof obj === 'number' || typeof obj === 'boolean') {\r\n      return false;\r\n    } else if (obj instanceof Array) {\r\n      const arr = <Array<Object | Array<Object>>>obj;\r\n      return arr.length === 0 || !arr.some((x) => !IsEmptyHelper.isEmpty(x));\r\n    } else {\r\n      const props = Object.getOwnPropertyNames(obj);\r\n      if (props.length === 0) {\r\n        return stringify(obj) === '{}';\r\n      } else {\r\n        return !props.some((x) => !IsEmptyHelper.isEmpty(obj[x]));\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { LocationService as RegobsApiLocationService } from '@varsom-regobs-common/regobs-api';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { switchMap } from 'rxjs/operators';\r\nimport { RegobsAuthService } from '../../../modules/auth/services/regobs-auth.service';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class LocationService {\r\n  constructor(\r\n    private regobsAuthService: RegobsAuthService,\r\n    private apiLocationService: RegobsApiLocationService\r\n  ) {}\r\n\r\n  getLocationWithinRadiusObservable(\r\n    geoHazard: GeoHazard,\r\n    lat: number,\r\n    lng: number,\r\n    radius: number\r\n  ) {\r\n    return this.regobsAuthService.loggedInUser$.pipe(\r\n      switchMap((loggedInUser) =>\r\n        this.apiLocationService.LocationWithinRadius({\r\n          geoHazardTypeIds: [geoHazard],\r\n          radius,\r\n          latitude: lat,\r\n          longitude: lng,\r\n          observerGuid: null, // loggedInUser.isLoggedIn ? loggedInUser.user.Guid : null, // TODO: Fix api to use access token if provided\r\n          returnCount: 100\r\n        })\r\n      )\r\n    );\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { UserSettingService } from '../user-setting/user-setting.service';\r\nimport { NanoSql } from '../../../../nanosql';\r\nimport { AppMode } from '@varsom-regobs-common/core';\r\nimport { DataLoadService } from '../../../modules/data-load/services/data-load.service';\r\nimport {\r\n  ObserverGroupDto,\r\n  AccountService as RegobsApiAccountService\r\n} from '@varsom-regobs-common/regobs-api';\r\nimport moment from 'moment';\r\nimport { from, combineLatest, Observable, lastValueFrom, firstValueFrom } from 'rxjs';\r\nimport { switchMap, take } from 'rxjs/operators';\r\nimport { RegobsAuthService } from '../../../modules/auth/services/regobs-auth.service';\r\nimport { nSQL } from '@nano-sql/core';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class UserGroupService {\r\n  constructor(\r\n    private regobsAuthService: RegobsAuthService,\r\n    private userSettingService: UserSettingService,\r\n    private accountApiService: RegobsApiAccountService,\r\n    private dataLoadService: DataLoadService\r\n  ) {}\r\n\r\n  async updateUserGroups() {\r\n    const loggedInUser = await this.regobsAuthService.getLoggedInUserAsPromise();\r\n    if (loggedInUser.isLoggedIn) {\r\n      const appMode = await firstValueFrom(this.userSettingService.appMode$);\r\n      await this.checkLastUpdatedAndUpdateDataIfNeeded(\r\n        appMode,\r\n        loggedInUser.email\r\n      );\r\n    }\r\n  }\r\n\r\n  private async checkLastUpdatedAndUpdateDataIfNeeded(\r\n    appMode: AppMode,\r\n    email: string\r\n  ) {\r\n    const dataLoadId = this.getDataLoadId(appMode, email);\r\n    const dataLoad = await this.dataLoadService.getState(dataLoadId);\r\n    const lastUpdateLimit = moment().subtract(1, 'hour');\r\n    if (\r\n      !dataLoad.lastUpdated ||\r\n      moment(dataLoad.lastUpdated).isBefore(lastUpdateLimit)\r\n    ) {\r\n      await this.updateUserGroupsForUser(appMode, email);\r\n    }\r\n  }\r\n\r\n  async updateUserGroupsForUser(appMode: AppMode, email: string) {\r\n    const dataLoadId = this.getDataLoadId(appMode, email);\r\n    await this.dataLoadService.startLoading(dataLoadId);\r\n    const result = await lastValueFrom(this.accountApiService\r\n      .AccountGetObserverGroups());\r\n    this.saveUserGroups(appMode, email, result);\r\n    await this.dataLoadService.loadingCompleted(dataLoadId, result.length);\r\n  }\r\n\r\n  async saveUserGroups(\r\n    appMode: AppMode,\r\n    email: string,\r\n    observerGroups: ObserverGroupDto[]\r\n  ): Promise<void> {\r\n    const userGroups = (observerGroups || []).map((val) => {\r\n      return {\r\n        key: `${email}_${val.Id}`,\r\n        userId: email,\r\n        Id: val.Id,\r\n        Name: val.Name\r\n      };\r\n    });\r\n    const instanceName = NanoSql.getInstanceName(\r\n      NanoSql.TABLES.OBSERVER_GROUPS.name,\r\n      appMode\r\n    );\r\n    await nSQL(instanceName).loadJS(userGroups);\r\n    await this.deleteUserGroupsNoLongerInResult(\r\n      appMode,\r\n      userGroups.map((ug) => ug.key)\r\n    );\r\n  }\r\n\r\n  private async deleteUserGroupsNoLongerInResult(\r\n    appMode: AppMode,\r\n    ids: string[]\r\n  ) {\r\n    await NanoSql.getInstance(NanoSql.TABLES.OBSERVER_GROUPS.name, appMode)\r\n      .query('delete')\r\n      .where(\r\n        (dbGroup: { key: string; userId: string; Id: number; Name: string }) =>\r\n          ids.indexOf(dbGroup.key) < 0\r\n      )\r\n      .exec();\r\n  }\r\n\r\n  private getDataLoadId(appMode: AppMode, email: string) {\r\n    return `${NanoSql.TABLES.OBSERVER_GROUPS.name}_${appMode}_${email}`;\r\n  }\r\n\r\n  getUserGroupsAsObservable(): Observable<ObserverGroupDto[]> {\r\n    return combineLatest([\r\n      this.regobsAuthService.loggedInUser$,\r\n      this.userSettingService.appMode$\r\n    ]).pipe(\r\n      switchMap(([loggedInUser, appMode]) =>\r\n        loggedInUser.isLoggedIn\r\n          ? from(this.getUserGroupsFromDb(appMode, loggedInUser.email))\r\n          : from(Promise.resolve([]))\r\n      )\r\n    );\r\n  }\r\n\r\n  getUserGroups(): Promise<ObserverGroupDto[]> {\r\n    return this.getUserGroupsAsObservable().pipe(take(1)).toPromise();\r\n  }\r\n\r\n  private async getUserGroupsFromDb(\r\n    appMode: AppMode,\r\n    email: string\r\n  ): Promise<ObserverGroupDto[]> {\r\n    return NanoSql.getInstance(NanoSql.TABLES.OBSERVER_GROUPS.name, appMode)\r\n      .query('select')\r\n      .where((x) => x.userId === email)\r\n      .exec();\r\n  }\r\n}\r\n","import * as L from 'leaflet';\r\nimport { settings } from '../../../../settings';\r\n\r\nexport class LeafletClusterHelper {\r\n  static createMarkerClusterGroup(options?: L.MarkerClusterGroupOptions) {\r\n    const defaultOptions = {\r\n      spiderfyOnMaxZoom: true,\r\n      showCoverageOnHover: false,\r\n      zoomToBoundsOnClick: true,\r\n      maxClusterRadius: settings.map.maxClusterRadius,\r\n      iconCreateFunction: LeafletClusterHelper.createClusterIcon\r\n    };\r\n    return L.markerClusterGroup({ ...defaultOptions, ...(options || {}) });\r\n  }\r\n\r\n  static createClusterIcon(cluster: L.MarkerCluster) {\r\n    const length = cluster.getAllChildMarkers().length;\r\n    const size = length < 100 ? 35 : length < 1000 ? 50 : 70;\r\n    return L.divIcon({\r\n      html: '<div>' + length + '</div>',\r\n      iconSize: [size, size],\r\n      iconAnchor: [size / 2.0, size / 2.0],\r\n      className: 'circle-marker-cluster'\r\n    });\r\n  }\r\n}\r\n","<div class=\"images\">\r\n  <div class=\"image-wrapper\" *ngFor=\"let attachment of attachments; let i = index\">\r\n    <!-- <img [src]=\"convertFileSrc(image.PictureImageBase64)\" /> -->\r\n    <ro-blob-image [imgBlob]=\"attachment.blob\"></ro-blob-image>\r\n    <ion-fab class=\"ion-no-margin\" slot=\"fixed\" vertical=\"top\" horizontal=\"end\">\r\n      <ion-fab-button size=\"small\" color=\"dark\" class=\"map-control-fab\" (click)=\"removeImage(attachment)\">\r\n        <ion-icon name=\"close\"></ion-icon>\r\n      </ion-fab-button>\r\n    </ion-fab>\r\n    <app-text-comment [(value)]=\"attachment.Comment\" title=\"{{ pictureCommentText | translate}}\" rows=\"2\"\r\n      placeholder=\"{{ pictureCommentPlaceholder | translate }}\"></app-text-comment>\r\n  </div>\r\n</div>\r\n<ion-item (click)=\"addClick()\">\r\n  <ion-icon [color]=\"iconColor\" [name]=\"icon\" slot=\"start\"></ion-icon>\r\n  <ion-label>{{ title | translate }}</ion-label>\r\n</ion-item>","import { Component, OnInit, Input, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { ActionSheetController, Platform, ToastController } from '@ionic/angular';\r\nimport { Camera, CameraOptions, PictureSourceType } from '@ionic-native/camera/ngx';\r\nimport { settings } from '../../../../../settings';\r\nimport { AttachmentType, AttachmentUploadEditModel, RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\nimport { NewAttachmentService } from 'src/app/modules/common-registration/registration.services';\r\nimport { DataUrlHelper } from '../../../../core/helpers/data-url.helper';\r\nimport { WebView } from '@ionic-native/ionic-webview/ngx';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { File } from '@ionic-native/file/ngx';\r\nimport { LoggingService } from '../../../shared/services/logging/logging.service';\r\nimport { LogLevel } from '../../../shared/services/logging/log-level.model';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { forkJoin, of } from 'rxjs';\r\nimport { catchError, map, switchMap, take, takeUntil } from 'rxjs/operators';\r\nimport { NgDestoryBase } from 'src/app/core/helpers/observable-helper';\r\n\r\nconst DEBUG_TAG = 'AddPictureItemComponent';\r\nconst MIME_TYPE = 'image/jpeg';\r\n\r\nexport interface AttachmentUploadEditModelWithBlob extends AttachmentUploadEditModel {\r\n  blob: Blob;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-add-picture-item',\r\n  templateUrl: './add-picture-item.component.html',\r\n  styleUrls: ['./add-picture-item.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class AddPictureItemComponent extends NgDestoryBase implements OnInit {\r\n  @Input() registrationId: string;\r\n  @Input() registrationTid: RegistrationTid;\r\n  @Input() geoHazard: GeoHazard;\r\n  @Input() title = 'REGISTRATION.ADD_IMAGES';\r\n  @Input() pictureCommentText = 'REGISTRATION.IMAGE_DESCRIPTION';\r\n  @Input() pictureCommentPlaceholder = 'REGISTRATION.IMAGE_DESCRIPTION_PLACEHOLDER';\r\n  @Input() icon = 'camera';\r\n  @Input() showIcon = true;\r\n  @Input() iconColor = 'dark';\r\n  @Input() onBeforeAdd: () => Promise<void> | void;\r\n  @Input() attachmentType: AttachmentType = 'Attachment';\r\n  @Input() ref?: string;\r\n\r\n  attachments: AttachmentUploadEditModelWithBlob[];\r\n\r\n  constructor(\r\n    private translateService: TranslateService,\r\n    private camera: Camera,\r\n    private platform: Platform,\r\n    private file: File,\r\n    private logger: LoggingService,\r\n    private webView: WebView,\r\n    private toastController: ToastController,\r\n    private domSanitizer: DomSanitizer,\r\n    private actionSheetController: ActionSheetController,\r\n    private newAttachmentService: NewAttachmentService,\r\n    private cdr: ChangeDetectorRef\r\n  ) {\r\n    super();\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.newAttachmentService\r\n      .getAttachments(this.registrationId)\r\n      .pipe(\r\n        map((attachments) =>\r\n          attachments.filter((a) => a.RegistrationTID === this.registrationTid && a.type === this.attachmentType && a.ref === this.ref)\r\n        ),\r\n        switchMap((attachments) =>\r\n          attachments.length === 0\r\n            ? of([])\r\n            : forkJoin([\r\n              ...attachments.map((a) =>\r\n                this.newAttachmentService.getBlob(this.registrationId, a.id).pipe(\r\n                  take(1),\r\n                  map((blob) => ({ ...a, blob })),\r\n                  catchError((err) => {\r\n                    this.logger.error(err, DEBUG_TAG, 'Could not get blob from attachment');\r\n                    return of({ ...a, blob: undefined });\r\n                  })\r\n                )\r\n              )\r\n            ])\r\n        ),\r\n        takeUntil(this.ngDestroy$)\r\n      )\r\n      .subscribe((result) => {\r\n        this.attachments = result;\r\n        this.cdr.detectChanges();\r\n      });\r\n  }\r\n\r\n  async addClick() {\r\n    if (this.onBeforeAdd !== undefined) {\r\n      await Promise.resolve(this.onBeforeAdd());\r\n    }\r\n    const translations = await this.translateService\r\n      .get([\r\n        'REGISTRATION.GENERAL_COMMENT.ADD_PICTURE',\r\n        'REGISTRATION.GENERAL_COMMENT.TAKE_NEW_PHOTO',\r\n        'REGISTRATION.GENERAL_COMMENT.CHOOSE_FROM_LIBRARY',\r\n        'DIALOGS.CANCEL'\r\n      ])\r\n      .toPromise();\r\n    const actionSheet = await this.actionSheetController.create({\r\n      header: translations['REGISTRATION.GENERAL_COMMENT.ADD_PICTURE'],\r\n      buttons: [\r\n        {\r\n          text: translations['REGISTRATION.GENERAL_COMMENT.TAKE_NEW_PHOTO'],\r\n          handler: () => this.getPicture(this.camera.PictureSourceType.CAMERA)\r\n        },\r\n        {\r\n          text: translations['REGISTRATION.GENERAL_COMMENT.CHOOSE_FROM_LIBRARY'],\r\n          handler: () => this.getPicture(this.camera.PictureSourceType.PHOTOLIBRARY)\r\n        },\r\n        {\r\n          text: translations['DIALOGS.CANCEL'],\r\n          role: 'cancel'\r\n        }\r\n      ]\r\n    });\r\n    actionSheet.present();\r\n  }\r\n\r\n  async getPicture(sourceType: PictureSourceType) {\r\n    if (!this.platform.is('hybrid')) {\r\n      await this.addDummyImage();\r\n      return true;\r\n    }\r\n    try {\r\n      const options: CameraOptions = {\r\n        quality: settings.images.quality,\r\n        destinationType: this.camera.DestinationType.FILE_URI,\r\n        sourceType: sourceType,\r\n        encodingType: this.camera.EncodingType.JPEG,\r\n        mediaType: this.camera.MediaType.PICTURE,\r\n        targetHeight: settings.images.size,\r\n        targetWidth: settings.images.size,\r\n        correctOrientation: true,\r\n        saveToPhotoAlbum: sourceType === PictureSourceType.CAMERA\r\n        // NOTE: saveToPhotoAlbum=true causes a bug in latest cordova cameraplugin\r\n      };\r\n      const imageUrl = await this.camera.getPicture(options);\r\n      if (!(await this.validateImage(imageUrl))) {\r\n        this.showErrorToast('REGISTRATION.INVALID_IMAGE'); //TODO: Vis bedre feilmelding\r\n        return true;\r\n      }\r\n\r\n      this.logger.debug(`Got image url from camera plugin: ${imageUrl}`, DEBUG_TAG);\r\n      const arrayBuffer = await this.getArrayBuffer(imageUrl);\r\n      await this.addImage(new Blob([arrayBuffer]), MIME_TYPE);\r\n    } catch (err) {\r\n      this.logger.log('User could not add image, most likely no access or invalid image', err, LogLevel.Warning, DEBUG_TAG);\r\n      this.showErrorToast('Could not save image. Do you have enough space?'); //TODO: Vis bedre feilmelding og p flere sprk\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private async getArrayBuffer(fileUrl: string): Promise<ArrayBuffer> {\r\n    const entry = await this.file.resolveLocalFilesystemUrl(fileUrl);\r\n    if (!entry.isFile) {\r\n      throw Error(`${fileUrl} is not a file!`);\r\n    }\r\n    const pathSplitted = entry.nativeURL.split('/');\r\n    const filename = pathSplitted.pop();\r\n    const directory = pathSplitted.join('/');\r\n    const arrayBuffer = await this.file.readAsArrayBuffer(directory, filename);\r\n    return arrayBuffer;\r\n  }\r\n\r\n  private async validateImage(src: string) {\r\n    if (src) {\r\n      const entry = await this.file.resolveLocalFilesystemUrl(src);\r\n      return entry.name.endsWith('jpg');\r\n    }\r\n    return false;\r\n  }\r\n\r\n  showErrorToast(messageKey: string) {\r\n    this.translateService.get(messageKey).subscribe(async (translation) => {\r\n      const toast = await this.toastController.create({\r\n        message: translation,\r\n        mode: 'md',\r\n        duration: 4000\r\n      });\r\n      toast.present();\r\n    });\r\n  }\r\n\r\n  private async addDummyImage() {\r\n    const dummyImage = await DataUrlHelper.getDataUrlFromSrcUrl('/assets/images/dummyregobsimage.jpeg');\r\n    const blob = DataUrlHelper.convertDataURIToBinary(dummyImage);\r\n    await this.addImage(new Blob([blob]), 'image/jpeg');\r\n  }\r\n\r\n  async addImage(data: Blob, mimeType: string) {\r\n    await this.newAttachmentService.addAttachment(\r\n      this.registrationId,\r\n      data,\r\n      mimeType,\r\n      this.geoHazard,\r\n      this.registrationTid,\r\n      this.attachmentType,\r\n      this.ref\r\n    );\r\n  }\r\n\r\n  removeImage(image: AttachmentUploadEditModel) {\r\n    this.newAttachmentService.removeAttachment(this.registrationId, image.id);\r\n  }\r\n}\r\n","<ion-item (click)=\"addOrEdit(i)\" *ngFor=\"let url of weburls; let i = index\">\r\n  <ion-label><span *ngIf=\"url.UrlDescription\">{{ url.UrlDescription }} - </span>{{ url.UrlLine }}</ion-label>\r\n</ion-item>\r\n<ion-item (click)=\"addOrEdit()\">\r\n  <ion-icon [color]=\"iconColor\" [name]=\"icon\" slot=\"start\"></ion-icon>\r\n  <ion-label>{{ title | translate }}</ion-label>\r\n</ion-item>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  NgZone,\r\n  Output,\r\n  EventEmitter\r\n} from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { AddWebUrlModalPage } from '../../pages/add-web-url-modal/add-web-url-modal.page';\r\nimport { UrlViewModel } from '@varsom-regobs-common/regobs-api';\r\n\r\n@Component({\r\n  selector: 'app-add-web-url-item',\r\n  templateUrl: './add-web-url-item.component.html',\r\n  styleUrls: ['./add-web-url-item.component.scss']\r\n})\r\nexport class AddWebUrlItemComponent implements OnInit {\r\n  @Input() title = 'REGISTRATION.ADD_WEB_URL.TITLE';\r\n  @Input() weburls: UrlViewModel[];\r\n  @Output() weburlsChange = new EventEmitter();\r\n  @Input() icon = 'add-circle-outline';\r\n  @Input() iconColor = 'dark';\r\n\r\n  constructor(private modalController: ModalController, private zone: NgZone) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  async addOrEdit(index?: number) {\r\n    const weburl = index !== undefined ? this.weburls[index] : undefined;\r\n    const modal = await this.modalController.create({\r\n      component: AddWebUrlModalPage,\r\n      componentProps: { weburl }\r\n    });\r\n    modal.present();\r\n    const result = await modal.onDidDismiss();\r\n    if (result.data) {\r\n      if (result.data.delete) {\r\n        this.removeAtIndex(index);\r\n      } else {\r\n        if (index !== undefined) {\r\n          this.setWebUrl(index, result.data);\r\n        } else {\r\n          this.addWebUrl(result.data);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setWebUrl(index: number, url: UrlViewModel) {\r\n    this.zone.run(() => {\r\n      this.weburls[index] = url;\r\n      this.weburlsChange.emit(this.weburls);\r\n    });\r\n  }\r\n\r\n  addWebUrl(url: UrlViewModel) {\r\n    this.zone.run(() => {\r\n      if (!this.weburls) {\r\n        this.weburls = [];\r\n      }\r\n      this.weburls.push(url);\r\n      this.weburlsChange.emit(this.weburls);\r\n    });\r\n  }\r\n\r\n  removeAtIndex(index: number) {\r\n    this.zone.run(() => {\r\n      if (this.weburls && this.weburls.length > 0) {\r\n        this.weburls.splice(index, 1);\r\n        this.weburlsChange.emit(this.weburls);\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { DomSanitizer, SafeUrl } from '@angular/platform-browser';\r\n@Component({\r\n  selector: 'app-base64-image',\r\n  templateUrl: './base64-image.component.html',\r\n  styleUrls: ['./base64-image.component.scss']\r\n})\r\nexport class Base64ImageComponent implements OnInit {\r\n  @Input() base64encodedImage: string;\r\n  @Input() dataUrlTag = 'data:image/jpeg;base64,';\r\n  imgSrc: SafeUrl;\r\n\r\n  constructor(private sanitizer: DomSanitizer) {}\r\n\r\n  ngOnInit() {\r\n    const applyImageUrlTag = !this.base64encodedImage.startsWith('data:image');\r\n    this.imgSrc = this.sanitizer.bypassSecurityTrustUrl(\r\n      (applyImageUrlTag ? this.dataUrlTag : '') + this.base64encodedImage\r\n    );\r\n  }\r\n}\r\n","<img [src]=\"imgSrc\" />","import {\r\n  Component,\r\n  OnInit,\r\n  ChangeDetectionStrategy,\r\n  Input,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { DomSanitizer, SafeUrl } from '@angular/platform-browser';\r\n\r\n@Component({\r\n  selector: 'ro-blob-image',\r\n  templateUrl: './blob-image.component.html',\r\n  styleUrls: ['./blob-image.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class BlobImageComponent implements OnInit, OnDestroy {\r\n  @Input() imgBlob: Blob;\r\n\r\n  imgSrc: SafeUrl;\r\n  private blobUrl: string;\r\n\r\n  constructor(private sanitizer: DomSanitizer) {}\r\n\r\n  ngOnInit(): void {\r\n    this.blobUrl = URL.createObjectURL(this.imgBlob);\r\n    this.imgSrc = this.sanitizer.bypassSecurityTrustUrl(this.blobUrl);\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.blobUrl) {\r\n      URL.revokeObjectURL(this.blobUrl);\r\n    }\r\n  }\r\n}\r\n","<img [src]=\"this.imgSrc\">\r\n","<ion-grid *ngIf=\"isVisible\">\r\n  <ion-row>\r\n    <ion-col class=\"ion-text-center\">\r\n      <ion-button (click)=\"showHelp()\" fill=\"clear\">{{'HELP.TITLE' | translate}}</ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, Input, NgZone } from '@angular/core';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { UserSettingService } from '../../../../core/services/user-setting/user-setting.service';\r\nimport { HelpTextService } from '../../services/help-text/help-text.service';\r\nimport { HelptextDto } from '@varsom-regobs-common/regobs-api';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { HelpModalPage } from '../../pages/modal-pages/help-modal/help-modal.page';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-help-text',\r\n  templateUrl: './help-text.component.html',\r\n  styleUrls: ['./help-text.component.scss']\r\n})\r\nexport class HelpTextComponent implements OnInit {\r\n  @Input() registrationTid: number;\r\n  @Input() geoHazard: GeoHazard;\r\n\r\n  isVisible = false;\r\n  helpText: HelptextDto;\r\n\r\n  constructor(\r\n    private helpTextService: HelpTextService,\r\n    private userSettingService: UserSettingService,\r\n    private modalController: ModalController,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  async ngOnInit() {\r\n    const userSetting = await this.userSettingService.userSetting$\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    this.helpText = await this.helpTextService.getHelpTextByKey(\r\n      userSetting.language,\r\n      userSetting.appMode,\r\n      this.geoHazard,\r\n      this.registrationTid\r\n    );\r\n    if (this.helpText) {\r\n      this.ngZone.run(() => {\r\n        this.isVisible = true;\r\n      });\r\n    }\r\n  }\r\n\r\n  async showHelp() {\r\n    const modal = await this.modalController.create({\r\n      component: HelpModalPage,\r\n      componentProps: {\r\n        helpText: this.helpText.Text\r\n      }\r\n    });\r\n    modal.present();\r\n  }\r\n}\r\n","<ion-list-header class=\"ion-text-uppercase\" *ngIf=\"title\">\r\n  <ion-label>\r\n    {{ title | translate}}\r\n  </ion-label>\r\n</ion-list-header>\r\n<ion-radio-group (ngModelChange)=\"onChange($event)\" [(ngModel)]=\"value\" *ngIf=\"kdvelements$ | async as kdvelements\">\r\n  <ng-container *ngFor=\"let item of kdvelements\">\r\n    <ion-item [ngClass]=\"{'selected': item.Id === value}\" [hidden]=\"!isVisible(item)\">\r\n      <ion-label>{{ useDescription ? item.Description : item.Name }}</ion-label>\r\n      <ion-radio mode=\"md\" slot=\"start\" [value]=\"item.Id\"></ion-radio>\r\n    </ion-item>\r\n    <div *ngIf=\"item.Id === value\">\r\n      <ng-content>\r\n      </ng-content>\r\n    </div>\r\n  </ng-container>\r\n</ion-radio-group>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  NgZone\r\n} from '@angular/core';\r\nimport { KdvService } from '../../../../core/services/kdv/kdv.service';\r\nimport { KdvElement } from '@varsom-regobs-common/regobs-api';\r\nimport { Subscription, Observable } from 'rxjs';\r\nimport { enterZone } from '../../../../core/helpers/observable-helper';\r\n\r\n@Component({\r\n  selector: 'app-kdv-radiobutton-list',\r\n  templateUrl: './kdv-radiobutton-list.component.html',\r\n  styleUrls: ['./kdv-radiobutton-list.component.scss']\r\n})\r\nexport class KdvRadiobuttonListComponent implements OnInit {\r\n  @Input() title: string;\r\n  @Input() kdvKey: string;\r\n  @Input() value: number;\r\n  @Input() useDescription: boolean;\r\n  @Input() showZeroValues = false;\r\n  @Output() valueChange = new EventEmitter();\r\n\r\n  kdvelements$: Observable<KdvElement[]>;\r\n\r\n  constructor(private kdvService: KdvService, private ngZone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    this.kdvelements$ = this.kdvService\r\n      .getKdvRepositoryByKeyObservable(this.kdvKey)\r\n      .pipe(enterZone(this.ngZone));\r\n  }\r\n\r\n  onChange(value: number) {\r\n    this.valueChange.emit(value);\r\n  }\r\n\r\n  isVisible(item: KdvElement) {\r\n    if (this.showZeroValues) {\r\n      return true;\r\n    } else {\r\n      return item.Id % 100 !== 0;\r\n    }\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  NgZone,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { KdvElement } from '@varsom-regobs-common/regobs-api';\r\nimport { Subscription } from 'rxjs';\r\nimport { KdvService } from '../../../../core/services/kdv/kdv.service';\r\nimport { SelectOption } from '../../../shared/components/input/select/select-option.model';\r\n\r\n@Component({\r\n  selector: 'app-kdv-select',\r\n  templateUrl: './kdv-select.component.html',\r\n  styleUrls: ['./kdv-select.component.scss']\r\n})\r\nexport class KdvSelectComponent implements OnInit, OnDestroy {\r\n  @Input() title: string;\r\n  @Input() kdvKey: string;\r\n  @Input() value: number;\r\n  @Output() valueChange = new EventEmitter();\r\n  @Input() showZeroValues = false;\r\n  @Input() disabled = false;\r\n  @Input() labelColor = 'medium';\r\n  @Input() showResetButton = true;\r\n  @Input() useDescription: boolean;\r\n  @Input() filter: (number) => boolean;\r\n  @Input() getIconFunc: (kdvElement: KdvElement) => string;\r\n\r\n  private kdvelements: KdvElement[] = [];\r\n\r\n  private subscription: Subscription;\r\n\r\n  get selectOptions(): SelectOption[] {\r\n    return this.kdvelements.map((el) => ({\r\n      id: el.Id,\r\n      text: this.useDescription ? el.Description : el.Name,\r\n      disabled: !this.isVisible(el),\r\n      icon: this.getIconFunc ? this.getIconFunc(el) : undefined\r\n    }));\r\n  }\r\n\r\n  constructor(private kdvService: KdvService, private ngZone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    this.subscription = this.kdvService\r\n      .getKdvRepositoryByKeyObservable(this.kdvKey)\r\n      .subscribe((kdvelements) => {\r\n        this.ngZone.run(() => {\r\n          this.kdvelements = kdvelements;\r\n        });\r\n      });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    if (this.subscription) {\r\n      this.subscription.unsubscribe();\r\n    }\r\n  }\r\n\r\n  isVisible(item: KdvElement) {\r\n    if (this.filter !== undefined && !this.filter(item.Id)) {\r\n      return false;\r\n    }\r\n    if (!this.showZeroValues) {\r\n      return item.Id % 100 !== 0;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n","<ion-item>\r\n  <ion-label [color]=\"labelColor\" position=\"stacked\" class=\"ion-text-uppercase\">{{ title | translate}}</ion-label>\r\n  <app-select [(selectedValue)]=\"value\" [options]=\"selectOptions\" [disabled]=\"disabled\" [title]=\"title\"\r\n    [showReset]=\"showResetButton\" (selectedValueChange)=\"valueChange.emit($event)\">\r\n  </app-select>\r\n</ion-item>","<ion-grid class=\"ion-no-padding\">\r\n  <ion-row>\r\n    <ion-col size=\"6\" offset=\"3\">\r\n      <ion-button [disabled]=\"saveDisabled\" expand=\"block\" fill=\"solid\" color=\"primary\" (click)=\"ok()\">\r\n        {{ saveText | translate }}\r\n      </ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row *ngIf=\"showDelete\">\r\n    <ion-col size=\"6\" offset=\"3\">\r\n      <ion-button (click)=\"delete()\" size=\"small\" fill=\"clear\" expand=\"block\">\r\n        <ion-icon slot=\"start\" name=\"trash\"></ion-icon>\r\n        {{ 'DIALOGS.DELETE' | translate }}\r\n      </ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { AlertController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-modal-save-or-delete-buttons',\r\n  templateUrl: './modal-save-or-delete-buttons.component.html',\r\n  styleUrls: ['./modal-save-or-delete-buttons.component.scss']\r\n})\r\nexport class ModalSaveOrDeleteButtonsComponent implements OnInit {\r\n  @Input() saveText = 'DIALOGS.OK';\r\n  @Input() saveDisabled = false;\r\n  @Output() saveClicked = new EventEmitter();\r\n  @Output() deleteClicked = new EventEmitter();\r\n  @Input() showDelete = false;\r\n  @Input() alertTitle = 'DIALOGS.ARE_YOU_SURE';\r\n  @Input() alertMessage = '';\r\n\r\n  constructor(\r\n    private translateService: TranslateService,\r\n    private alertController: AlertController\r\n  ) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  ok() {\r\n    this.saveClicked.emit();\r\n  }\r\n\r\n  async delete() {\r\n    const toTranslate = [this.alertTitle, 'DIALOGS.CANCEL', 'DIALOGS.OK'];\r\n    if (this.alertMessage) {\r\n      toTranslate.push(this.alertMessage);\r\n    }\r\n    const translations = await this.translateService\r\n      .get(toTranslate)\r\n      .toPromise();\r\n    const alert = await this.alertController.create({\r\n      header: translations[this.alertTitle],\r\n      message: this.alertMessage ? translations[this.alertMessage] : undefined,\r\n      buttons: [\r\n        {\r\n          text: translations['DIALOGS.CANCEL'],\r\n          role: 'cancel'\r\n        },\r\n        {\r\n          text: translations['DIALOGS.OK'],\r\n          handler: () => {\r\n            this.deleteClicked.emit();\r\n          }\r\n        }\r\n      ]\r\n    });\r\n    alert.present();\r\n  }\r\n}\r\n","<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"6\">\r\n      <ion-button class=\"left-button\" *ngIf=\"previous\" (click)=\"goBack()\" color=\"primary\" fill=\"outline\" expand=\"block\">\r\n        <ion-icon slot=\"start\" name=\"arrow-back\"></ion-icon>\r\n        <ion-text>{{ previous.title | translate }}</ion-text>\r\n      </ion-button>\r\n    </ion-col>\r\n    <ion-col size=\"6\">\r\n      <ion-button class=\"right-button\" *ngIf=\"next\" (click)=\"goForward()\" color=\"primary\" fill=\"outline\" expand=\"block\">\r\n        <ion-icon slot=\"end\" name=\"arrow-forward\"></ion-icon>\r\n        <ion-text>{{ next.title | translate }}</ion-text>\r\n      </ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, Input, NgZone } from '@angular/core';\r\nimport { SummaryItemService } from '../../services/summary-item.service';\r\nimport { IRegistration } from 'src/app/modules/common-registration/registration.models';\r\nimport { Router } from '@angular/router';\r\nimport { ISummaryItem } from '../summary-item/summary-item.model';\r\n\r\n@Component({\r\n  selector: 'app-navigation-buttons',\r\n  templateUrl: './navigation-buttons.component.html',\r\n  styleUrls: ['./navigation-buttons.component.scss']\r\n})\r\nexport class NavigationButtonsComponent implements OnInit {\r\n  @Input() registration: IRegistration;\r\n  next: ISummaryItem;\r\n  previous: ISummaryItem;\r\n\r\n  constructor(\r\n    private summaryItemService: SummaryItemService,\r\n    private router: Router,\r\n    private ngZone: NgZone\r\n  ) {}\r\n\r\n  async ngOnInit() {\r\n    const currentUrl = this.router.url;\r\n    const prevAndNext = await this.summaryItemService.getPreviousAndNext(\r\n      this.registration,\r\n      currentUrl\r\n    );\r\n    this.ngZone.run(() => {\r\n      if (prevAndNext.next) {\r\n        this.next = prevAndNext.next;\r\n      }\r\n      if (prevAndNext.previous) {\r\n        this.previous = prevAndNext.previous;\r\n      }\r\n    });\r\n  }\r\n\r\n  goBack() {\r\n    this.summaryItemService.navigateTo(\r\n      this.registration,\r\n      this.previous,\r\n      'back'\r\n    );\r\n  }\r\n\r\n  goForward() {\r\n    this.summaryItemService.navigateTo(this.registration, this.next, 'forward');\r\n  }\r\n}\r\n","<ion-item tabindex=\"0\" (click)=\"openPicker()\" (keyup.enter)=\"openPicker()\">\r\n  <ion-label *ngIf=\"title\" color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{ title | translate}}\r\n  </ion-label>\r\n  <ion-text class=\"ion-align-self-start\" *ngIf=\"displayValue else ph\">{{ displayValue }}</ion-text>\r\n</ion-item>\r\n<ng-template #ph>\r\n  <ion-text class=\"ion-align-self-start\" color=\"medium\">{{ placeholder | translate }}</ion-text>\r\n</ng-template>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  Output,\r\n  EventEmitter,\r\n  OnChanges\r\n} from '@angular/core';\r\nimport { NumericInputModalPage } from '../../pages/modal-pages/numeric-input-modal/numeric-input-modal.page';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-numeric-input',\r\n  templateUrl: './numeric-input.component.html',\r\n  styleUrls: ['./numeric-input.component.scss']\r\n})\r\nexport class NumericInputComponent implements OnInit {\r\n  @Input() decimalPlaces = 0;\r\n  @Input() min = -100000;\r\n  @Input() max = 100000;\r\n  @Input() suffix: string;\r\n  @Input() decimalSeparator;\r\n  @Input() value: number;\r\n  @Output() valueChange = new EventEmitter();\r\n  @Input() title: string;\r\n  @Input() placeholder: string;\r\n  @Input() convertRatio: number;\r\n  @Input() readonly = false;\r\n\r\n  private isOpen = false;\r\n\r\n  get displayValue() {\r\n    const converted = this.convert(this.value, 'from');\r\n    if (converted !== undefined) {\r\n      return converted.toLocaleString();\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  async openPicker() {\r\n    if (!this.isOpen && !this.readonly) {\r\n      this.isOpen = true;\r\n      const modal = await this.modalController.create({\r\n        component: NumericInputModalPage,\r\n        cssClass: 'numeric-input-modal',\r\n        componentProps: {\r\n          value: this.convert(this.value, 'from'),\r\n          decimalPlaces: this.decimalPlaces,\r\n          min: this.min,\r\n          max: this.max,\r\n          suffix: this.suffix,\r\n          decimalSeparator: this.decimalSeparator,\r\n          title: this.title\r\n        }\r\n      });\r\n      modal.present();\r\n      const result = await modal.onDidDismiss();\r\n      if (result.data && result.data.ok) {\r\n        this.value = this.convert(result.data.value, 'to');\r\n        this.valueChange.emit(this.value);\r\n      }\r\n      this.isOpen = false;\r\n    }\r\n  }\r\n\r\n  private convert(val: number, direction: 'from' | 'to') {\r\n    if (\r\n      val === undefined ||\r\n      val === null ||\r\n      val === 0 ||\r\n      this.convertRatio === undefined\r\n    ) {\r\n      return val;\r\n    }\r\n    return direction === 'from'\r\n      ? val * this.convertRatio\r\n      : val / this.convertRatio;\r\n  }\r\n}\r\n","<ion-grid *ngIf=\"registration\" class=\"pull-last-bottom ion-no-padding ion-no-margin\">\r\n  <ion-row>\r\n    <ion-col class=\"ion-no-padding\">\r\n      <ng-content></ng-content>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row>\r\n    <ion-col class=\"ion-no-padding\">\r\n      <app-help-text [registrationTid]=\"registrationTid\" [geoHazard]=\"registration.geoHazard\"></app-help-text>\r\n      <app-navigation-buttons [registration]=\"registration\"></app-navigation-buttons>\r\n      <app-save-and-go-back-button [registration]=\"registration\" [registrationTid]=\"registrationTid\"\r\n        (reset)=\"emitReset()\"></app-save-and-go-back-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { IRegistration, RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\n\r\n@Component({\r\n  selector: 'app-registration-content-wrapper',\r\n  templateUrl: './registration-content-wrapper.component.html',\r\n  styleUrls: ['./registration-content-wrapper.component.scss']\r\n})\r\nexport class RegistrationContentWrapperComponent implements OnInit {\r\n  @Input() registration: IRegistration;\r\n  @Input() registrationTid: RegistrationTid;\r\n  @Output() reset = new EventEmitter();\r\n  @Input() isEmpty: boolean;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n\r\n  emitReset() {\r\n    this.reset.emit();\r\n  }\r\n}\r\n","<ion-grid>\r\n  <ion-row>\r\n    <ion-col size=\"12\">\r\n      <ion-button class=\"back-button\" expand=\"block\" fill=\"solid\" color=\"primary\" (click)=\"goBack()\"\r\n        routerDirection=\"backward\">\r\n        {{ 'REGISTRATION.BACK_TO_OBSERVATION' | translate }}\r\n      </ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n  <ion-row class=\"reset-button-row\" *ngIf=\"hasData\">\r\n    <ion-col class=\"ion-text-center\">\r\n      <ion-button class=\"reset-button\" (click)=\"doReset()\" color=\"dark\" size=\"small\" fill=\"clear\">\r\n        <svg-icon src=\"/assets/icon/reset.svg\"></svg-icon>\r\n        {{\"REGISTRATION.RESET\" | translate}}\r\n      </ion-button>\r\n    </ion-col>\r\n  </ion-row>\r\n</ion-grid>","import { Component, OnInit, Input, Output, EventEmitter, OnChanges, SimpleChanges, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\r\nimport { NavController } from '@ionic/angular';\r\nimport { IRegistration, RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\nimport { RegistrationService as CommonRegistrationService } from 'src/app/modules/common-registration/registration.services'; \r\nimport { SmartChanges } from 'src/app/core/helpers/simple-changes.helper';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-save-and-go-back-button',\r\n  templateUrl: './save-and-go-back-button.component.html',\r\n  styleUrls: ['./save-and-go-back-button.component.scss'],\r\n  changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class SaveAndGoBackButtonComponent implements OnInit, OnChanges {\r\n  @Input() registration: IRegistration;\r\n  @Input() registrationTid: RegistrationTid;\r\n  @Output() reset = new EventEmitter();\r\n\r\n  hasData = false;\r\n\r\n  constructor(\r\n    private navContoller: NavController,\r\n    private commonRegistrationService: CommonRegistrationService,\r\n    private cdr: ChangeDetectorRef,\r\n  ) {}\r\n\r\n  ngOnChanges(changes: SimpleChanges & SmartChanges<this>): void {\r\n    if(changes && changes.registration && !changes.registration.isFirstChange()) {\r\n     this.setHasData();\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.setHasData();\r\n  }\r\n\r\n  private setHasData(): void {\r\n    if(this.registration != null && this.registrationTid != null) {\r\n      this.commonRegistrationService.hasAnyDataToShowInRegistrationTypes(this.registration, this.registrationTid)\r\n      .pipe((take(1))).subscribe((hasData) => {\r\n          this.hasData = hasData;\r\n          this.cdr.markForCheck();\r\n      });\r\n    }\r\n  }\r\n\r\n  async goBack() {\r\n    this.navContoller.navigateBack('registration/edit/' + this.registration.id);\r\n  }\r\n\r\n  doReset() {\r\n    this.reset.emit();\r\n  }\r\n}\r\n","<div [ngClass]=\"{'open': showDetails, 'details-small':!showFromMarkerInDetails }\">\r\n  <app-map *ngIf=\"locationMarker\" [showSupportMaps]=\"false\" (mapReady)=\"onMapReady($event)\"\r\n    [center]=\"locationMarker.getLatLng()\"></app-map>\r\n  <ion-grid class=\"bottom-info ion-no-padding\">\r\n    <ion-row>\r\n      <ion-col class=\"confirm-button-col\">\r\n        <ion-button [disabled]=\"isSaveDisabled\" expand=\"block\" color=\"varsom-orange\" (click)=\"confirmLocation()\">{{ confirmLocationText | translate\r\n          }}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row class=\"ion-no-padding\">\r\n      <ion-col class=\"show-details-col ion-no-padding ion-text-center\">\r\n        <ion-button color=\"dark\" size=\"small\" fill=\"clear\" (click)=\"toggleDetails()\">\r\n          <ng-container *ngIf=\"!showDetails\">\r\n            <ion-icon slot=\"start\" name=\"chevron-up\"></ion-icon>\r\n            {{'REGISTRATION.OBS_LOCATION.SHOW_DETAILS' | translate}}\r\n          </ng-container>\r\n          <ng-container *ngIf=\"showDetails\">\r\n            <ion-icon slot=\"start\" name=\"chevron-down\"></ion-icon>\r\n            {{'REGISTRATION.OBS_LOCATION.HIDE_DETAILS' | translate}}\r\n          </ng-container>\r\n        </ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row class=\"details-row\" *ngIf=\"showDetails\">\r\n      <ion-col>\r\n        <ion-grid class=\"ion-no-padding\">\r\n          <ion-row>\r\n            <ion-col class=\"ion-no-padding ion-text-center\" size=\"2\">\r\n              <svg-icon class=\"obs-location-marker\" [src]=\"locationMarkerIconUrl\"></svg-icon>\r\n              <ng-container *ngIf=\"showFromMarkerInDetails\">\r\n                <svg class=\"dotted-line\" width=\"4px\" height=\"15px\" viewBox=\"0 0 4 15\">\r\n                  <line x1=\"1\" x2=\"1\" y1=\"2\" y2=\"14\" stroke=\"#000\" stroke-width=\"2\" stroke-linecap=\"round\"\r\n                    stroke-dasharray=\"1,4\"></line>\r\n                </svg>\r\n                <ion-label class=\"distance-label small-text ion-no-margin\">{{\r\n                  distanceToObservationText }}</ion-label>\r\n                <svg class=\"dotted-line\" width=\"4px\" height=\"15px\" viewBox=\"0 0 4 15\">\r\n                  <line x1=\"1\" x2=\"1\" y1=\"2\" y2=\"14\" stroke=\"#000\" stroke-width=\"2\" stroke-linecap=\"round\"\r\n                    stroke-dasharray=\"1,4\"></line>\r\n                </svg>\r\n                <div class=\"leaflet-usermarker\" *ngIf=\"!fromMarker\"></div>\r\n                <svg-icon *ngIf=\"fromMarker\" [src]=\"fromMarkerIconUrl\"></svg-icon>\r\n              </ng-container>\r\n            </ion-col>\r\n            <ion-col class=\"ion-no-padding\">\r\n              <ion-grid class=\"ion-no-padding\">\r\n                <ion-row class=\"padding-bottom\">\r\n                  <ion-col size=\"12\" class=\"ion-no-padding padding-right\">\r\n                    <ion-grid class=\"arrow-box\" (click)=\"editLocation()\">\r\n                      <ion-icon class=\"edit-icon\" name=\"create\" *ngIf=\"canEditLocationName\"></ion-icon>\r\n                      <ion-row>\r\n                        <ion-col class=\"ion-no-padding\">\r\n                          <ion-label class=\"detail-header ion-text-uppercase ion-no-margin\">{{ locationTitle\r\n                            | translate}}</ion-label>\r\n                        </ion-col>\r\n                      </ion-row>\r\n                      <ng-container *ngIf=\"!editLocationName else editLocationTemplate\">\r\n                        <ion-row *ngIf=\"selectedLocation else viewInfoTemplate\">\r\n                          <ion-col class=\"ion-no-padding\">\r\n                            <ion-label class=\"detail-obs-info ion-no-margin ion-text-wrap\">\r\n                              {{ selectedLocation.Name }}\r\n                            </ion-label>\r\n                          </ion-col>\r\n                        </ion-row>\r\n                      </ng-container>\r\n                      <ion-row>\r\n                        <ion-col class=\"ion-no-padding\">\r\n                          <ion-label class=\"small-text ion-no-margin\">\r\n                            <span>{{ locationMarker.getLatLng().lat | number:'0.3'\r\n                              }}&deg;{{'MAP_CENTER_INFO.NORTH_SHORT'|translate}},\r\n                              {{ locationMarker.getLatLng().lng | number:'0.3'\r\n                              }}&deg;{{'MAP_CENTER_INFO.EAST_SHORT'|translate}}</span>\r\n                            <span *ngIf=\"!isLoading && viewInfo && viewInfo.elevation !== null\">, {{ viewInfo.elevation\r\n                              }}\r\n                              {{'MAP_CENTER_INFO.ABOVE_SEA_LEVEL' |\r\n                              translate}}\r\n                            </span>\r\n                          </ion-label>\r\n                        </ion-col>\r\n                      </ion-row>\r\n                    </ion-grid>\r\n                  </ion-col>\r\n                </ion-row>\r\n                <ion-row *ngIf=\"showFromMarkerInDetails\">\r\n                  <ion-col size=\"12\" class=\"ion-no-padding padding-right\">\r\n                    <ion-label class=\"ion-no-margin arrow-box detail-header block ion-text-uppercase\">{{fromLocationText\r\n                      | translate}}</ion-label>\r\n                  </ion-col>\r\n                </ion-row>\r\n              </ion-grid>\r\n            </ion-col>\r\n          </ion-row>\r\n        </ion-grid>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n</div>\r\n<ng-template #editLocationTemplate>\r\n  <ion-row>\r\n    <ion-col class=\"ion-no-padding\">\r\n      <ion-input #editLocationNameInput type=\"text\" [max]=\"60\" [(ngModel)]=\"locationName\"\r\n        (ionBlur)=\"onLocationEditComplete()\"></ion-input>\r\n    </ion-col>\r\n  </ion-row>\r\n</ng-template>\r\n<ng-template #viewInfoTemplate>\r\n  <ion-row>\r\n    <ion-col class=\"ion-no-padding\">\r\n      <ng-container *ngIf=\"!isLoading\">\r\n        <ng-container *ngIf=\"viewInfo && viewInfo.location\">\r\n          <ion-label class=\"detail-obs-info ion-no-margin ion-text-wrap\">\r\n            <span *ngIf=\"(viewInfo.location.name !== viewInfo.location.adminName)\">{{\r\n                      viewInfo.location.name\r\n                      }},&nbsp;</span>{{viewInfo.location.adminName}}&nbsp;\r\n          </ion-label>\r\n        </ng-container>\r\n      </ng-container>\r\n      <ng-container *ngIf=\"isLoading\">\r\n        <ion-spinner color=\"dark\" name=\"dots\"></ion-spinner>\r\n      </ng-container>\r\n    </ion-col>\r\n  </ion-row>\r\n</ng-template>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  EventEmitter,\r\n  Output,\r\n  OnDestroy,\r\n  NgZone,\r\n  ViewChild\r\n} from '@angular/core';\r\nimport * as L from 'leaflet';\r\nimport { MapService } from '../../../map/services/map/map.service';\r\nimport { HelperService } from '../../../../core/services/helpers/helper.service';\r\nimport { MapSearchService } from '../../../map/services/map-search/map-search.service';\r\nimport { take, switchMap, filter, takeUntil } from 'rxjs/operators';\r\nimport { Position } from '@capacitor/geolocation';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { LocationName } from '../../../map/services/map-search/location-name.model';\r\nimport {\r\n  ObsLocationsResponseDtoV2,\r\n  ObsLocationEditModel\r\n} from '@varsom-regobs-common/regobs-api';\r\nimport { LocationService } from '../../../../core/services/location/location.service';\r\nimport { UtmSource } from '../../pages/obs-location/utm-source.enum';\r\nimport { ViewInfo } from '../../../map/services/map-search/view-info.model';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { IonInput } from '@ionic/angular';\r\nimport { LeafletClusterHelper } from '../../../map/helpers/leaflet-cluser.helper';\r\nimport { GeoPositionService } from '../../../../core/services/geo-position/geo-position.service';\r\n\r\nconst defaultIcon = L.icon({\r\n  iconUrl: 'leaflet/marker-icon.png',\r\n  shadowUrl: 'leaflet/marker-shadow.png',\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  popupAnchor: [1, -34],\r\n  tooltipAnchor: [16, -28],\r\n  shadowSize: [41, 41]\r\n});\r\n\r\nconst previousUsedPlaceIcon = L.icon({\r\n  iconUrl: '/assets/icon/map/prev-used-place.svg',\r\n  iconSize: [25, 41],\r\n  iconAnchor: [12, 41],\r\n  shadowUrl: 'leaflet/marker-shadow.png',\r\n  shadowSize: [41, 41]\r\n});\r\n\r\n@Component({\r\n  selector: 'app-set-location-in-map',\r\n  templateUrl: './set-location-in-map.component.html',\r\n  styleUrls: ['./set-location-in-map.component.scss']\r\n})\r\nexport class SetLocationInMapComponent implements OnInit, OnDestroy {\r\n  @Input() geoHazard: GeoHazard;\r\n  @Input() fromMarker: L.Marker;\r\n  @Input() fromMarkerIconUrl = '/assets/icon/map/obs-location.svg';\r\n  @Input() locationMarker: L.Marker;\r\n  @Input() locationMarkerIconUrl = '/assets/icon/map/obs-location.svg';\r\n  @Output() locationSet = new EventEmitter<ObsLocationEditModel>();\r\n  @Input() showPreviousUsedLocations = true;\r\n  @Input() showUserPosition = true;\r\n  @Input() confirmLocationText = 'REGISTRATION.OBS_LOCATION.CONFIRM_TEXT';\r\n  @Input() fromLocationText = 'REGISTRATION.OBS_LOCATION.CURRENT_LOCATION';\r\n  @Input() locationTitle = 'REGISTRATION.OBS_LOCATION.TITLE';\r\n  @Input() selectedLocation: ObsLocationsResponseDtoV2;\r\n  @Output() mapReady = new EventEmitter<L.Map>();\r\n  @Input() showPolyline = true;\r\n  @Input() showFromMarkerInDetails = true;\r\n  @Input() allowEditLocationName = false;\r\n  @Input() isSaveDisabled = false;\r\n\r\n  private map: L.Map;\r\n  followMode = false;\r\n  private userposition: Position;\r\n  private pathLine: L.Polyline;\r\n  showDetails = false;\r\n  distanceToObservationText = '';\r\n  viewInfo: ViewInfo;\r\n  isLoading = false;\r\n  private locations: ObsLocationsResponseDtoV2[] = [];\r\n  private ngDestroy$ = new Subject<void>();\r\n\r\n  private locationGroup = LeafletClusterHelper.createMarkerClusterGroup();\r\n  editLocationName = false;\r\n  locationName: string;\r\n\r\n  @ViewChild('editLocationNameInput') editLocationNameInput: IonInput;\r\n\r\n  get canEditLocationName() {\r\n    return (\r\n      this.allowEditLocationName &&\r\n      !(this.selectedLocation && this.selectedLocation.Id)\r\n    );\r\n  }\r\n\r\n  constructor(\r\n    private mapService: MapService,\r\n    private helperService: HelperService,\r\n    private ngZone: NgZone,\r\n    private mapSearchService: MapSearchService,\r\n    private geoPositionService: GeoPositionService,\r\n    private locationService: LocationService\r\n  ) {}\r\n\r\n  async ngOnInit(): Promise<void> {\r\n    L.Marker.prototype.options.icon = defaultIcon;\r\n\r\n    const locationMarkerIcon = L.icon({\r\n      iconUrl: this.locationMarkerIconUrl,\r\n      iconSize: [25, 41],\r\n      iconAnchor: [12, 41],\r\n      shadowUrl: 'leaflet/marker-shadow.png',\r\n      shadowSize: [41, 41]\r\n    });\r\n    this.followMode = !this.locationMarker && !this.fromMarker;\r\n    this.mapService.followMode = this.followMode;\r\n    if (!this.locationMarker) {\r\n      if (this.fromMarker) {\r\n        this.locationMarker = L.marker(this.fromMarker.getLatLng(), {\r\n          icon: locationMarkerIcon\r\n        });\r\n      } else {\r\n        const lastView = await this.mapService.mapView$\r\n          .pipe(take(1))\r\n          .toPromise();\r\n        if (lastView) {\r\n          this.locationMarker = L.marker(lastView.center, {\r\n            icon: locationMarkerIcon\r\n          });\r\n        } else {\r\n          this.locationMarker = L.marker(L.latLng(59.1, 10.3), {\r\n            icon: locationMarkerIcon\r\n          });\r\n        }\r\n      }\r\n    }\r\n    this.updateMapViewInfo();\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.ngDestroy$.next();\r\n    this.ngDestroy$.complete();\r\n  }\r\n\r\n  private getLocationsObservable(): Observable<ObsLocationsResponseDtoV2[]> {\r\n    return this.mapService.mapView$.pipe(\r\n      filter(\r\n        (mapView) =>\r\n          mapView &&\r\n          mapView.center !== undefined &&\r\n          mapView.bounds !== undefined\r\n      ),\r\n      switchMap((mapView) =>\r\n        this.locationService.getLocationWithinRadiusObservable(\r\n          this.geoHazard,\r\n          mapView.center.lat,\r\n          mapView.center.lng,\r\n          Math.round(\r\n            mapView.bounds\r\n              .getNorthWest()\r\n              .distanceTo(mapView.bounds.getSouthEast()) / 2\r\n          )\r\n        )\r\n      )\r\n    );\r\n  }\r\n\r\n  private addLocationIfNotExists(loc: ObsLocationsResponseDtoV2): void {\r\n    const existing = this.locations.some((location) => loc.Id === location.Id);\r\n    if (!existing) {\r\n      this.locations.push(loc);\r\n      const marker = L.marker(\r\n        L.latLng(loc.LatLngObject.Latitude, loc.LatLngObject.Longitude),\r\n        { icon: previousUsedPlaceIcon }\r\n      ).addTo(this.locationGroup);\r\n      marker.on('click', () => this.setToPrevouslyUsedLocation(loc));\r\n    }\r\n  }\r\n\r\n  onMapReady(m: L.Map): void {\r\n    this.map = m;\r\n    this.locationMarker.setZIndexOffset(100).addTo(this.map);\r\n    if (this.fromMarker) {\r\n      this.fromMarker.addTo(this.map);\r\n    }\r\n    this.locationGroup.addTo(this.map);\r\n    this.map.on('dragstart', () => {\r\n      this.ngZone.run(() => {\r\n        this.isLoading = true;\r\n      });\r\n    });\r\n    this.map.on('dragend', () => this.updateMapViewInfo());\r\n    this.map.on('drag', () => this.moveLocationMarkerToCenter());\r\n\r\n    if (this.showPreviousUsedLocations) {\r\n      this.getLocationsObservable()\r\n        .pipe(takeUntil(this.ngDestroy$))\r\n        .subscribe((locations) => {\r\n          locations.forEach((loc) => this.addLocationIfNotExists(loc));\r\n        });\r\n    }\r\n\r\n    this.mapService.followMode$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((val) => {\r\n        this.followMode = val;\r\n        if (this.followMode && this.userposition) {\r\n          this.setLocationMarkerLatLng({\r\n            lat: this.userposition.coords.latitude,\r\n            lng: this.userposition.coords.longitude\r\n          });\r\n        }\r\n      });\r\n\r\n    this.mapSearchService.mapSearchClick$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((item) => {\r\n        const latLng = item instanceof L.LatLng ? item : item.latlng;\r\n        this.setLocationMarkerLatLng(latLng);\r\n      });\r\n\r\n    this.geoPositionService.currentPosition$\r\n      .pipe(takeUntil(this.ngDestroy$))\r\n      .subscribe((pos) => this.positionChange(pos));\r\n\r\n    if (!this.followMode) {\r\n      this.map.setView(this.locationMarker.getLatLng(), 15);\r\n    }\r\n\r\n    this.mapReady.emit(this.map);\r\n    this.updatePathAndDistance();\r\n  }\r\n\r\n  private setLocationMarkerLatLng(latLng: L.LatLngExpression): void {\r\n    this.locationMarker.setLatLng(latLng);\r\n    this.updatePathAndDistance();\r\n    this.updateMapViewInfo();\r\n  }\r\n\r\n  private setToPrevouslyUsedLocation(location: ObsLocationsResponseDtoV2): void {\r\n    this.ngZone.run(() => {\r\n      this.mapService.followMode = false;\r\n      this.selectedLocation = location;\r\n      this.setLocationMarkerLatLng(\r\n        L.latLng(\r\n          location.LatLngObject.Latitude,\r\n          location.LatLngObject.Longitude\r\n        )\r\n      );\r\n      this.map.panTo(this.locationMarker.getLatLng());\r\n      this.showDetails = true;\r\n    });\r\n  }\r\n\r\n  private moveLocationMarkerToCenter(): void {\r\n    this.mapService.followMode = false;\r\n    this.selectedLocation = null;\r\n    const center = this.map.getCenter();\r\n    this.locationMarker.setLatLng(center);\r\n    this.updatePathAndDistance();\r\n  }\r\n\r\n  private updateMapViewInfo(): void {\r\n    const latLng = this.locationMarker.getLatLng();\r\n    this.mapSearchService\r\n      .getViewInfo({ center: latLng, bounds: null, zoom: 0 }, this.geoHazard)\r\n      .subscribe(\r\n        (val) => {\r\n          this.ngZone.run(() => {\r\n            this.viewInfo = val;\r\n            this.isLoading = false;\r\n          });\r\n        },\r\n        (_) => {\r\n          this.ngZone.run(() => {\r\n            this.viewInfo = null;\r\n            this.isLoading = false;\r\n          });\r\n        }\r\n      );\r\n  }\r\n\r\n  private positionChange(position: Position) {\r\n    this.userposition = position;\r\n    if (this.followMode) {\r\n      this.setLocationMarkerLatLng({\r\n        lat: position.coords.latitude,\r\n        lng: position.coords.longitude\r\n      });\r\n    } else {\r\n      this.updatePathAndDistance();\r\n    }\r\n  }\r\n\r\n  updatePathAndDistance(): void {\r\n    const from = this.fromMarker\r\n      ? this.fromMarker.getLatLng()\r\n      : this.userposition\r\n        ? L.latLng(\r\n          this.userposition.coords.latitude,\r\n          this.userposition.coords.longitude\r\n        )\r\n        : this.locationMarker.getLatLng();\r\n    const locationMarkerLatLng = this.locationMarker.getLatLng();\r\n    const path = [locationMarkerLatLng, from];\r\n    if (this.map) {\r\n      if (!this.pathLine) {\r\n        this.pathLine = L.polyline(path, {\r\n          color: 'black',\r\n          weight: 6,\r\n          opacity: 0.9,\r\n          dashArray: '1,12'\r\n        });\r\n        if (this.showPolyline) {\r\n          this.pathLine.addTo(this.map);\r\n        }\r\n      } else {\r\n        this.pathLine.setLatLngs(path);\r\n      }\r\n      if (this.fromMarker) {\r\n        if (\r\n          this.fromMarker.getLatLng().equals(this.locationMarker.getLatLng())\r\n        ) {\r\n          this.fromMarker.setOpacity(0);\r\n          this.pathLine.setStyle({ opacity: 0 });\r\n        } else {\r\n          this.fromMarker.setOpacity(1);\r\n          this.pathLine.setStyle({ opacity: 0.9 });\r\n        }\r\n      }\r\n    }\r\n    this.ngZone.run(() => {\r\n      this.distanceToObservationText = this.helperService.getDistanceText(\r\n        locationMarkerLatLng.distanceTo(from)\r\n      );\r\n    });\r\n  }\r\n\r\n  toggleDetails(): void {\r\n    this.ngZone.run(() => {\r\n      this.showDetails = !this.showDetails;\r\n    });\r\n  }\r\n\r\n  getLocationName(location: LocationName): string {\r\n    if (location) {\r\n      return location.adminName !== location.name\r\n        ? `${location.name} / ${location.adminName}`\r\n        : location.name;\r\n    }\r\n    return '';\r\n  }\r\n\r\n  confirmLocation(): void {\r\n    const obsLocation = this.getLocation();\r\n    this.locationSet.emit(obsLocation);\r\n  }\r\n\r\n  getLocation(): ObsLocationEditModel {\r\n    const obsLocation: ObsLocationEditModel = {\r\n      Latitude: this.locationMarker.getLatLng().lat,\r\n      Longitude: this.locationMarker.getLatLng().lng,\r\n      Uncertainty: 0,\r\n      UTMSourceTID: UtmSource.SelectedInMap\r\n    };\r\n    if (\r\n      this.editLocationName &&\r\n      this.locationName &&\r\n      this.locationName.length > 0\r\n    ) {\r\n      obsLocation.ObsLocationID = undefined;\r\n      obsLocation.LocationName = this.locationName.substring(0, 60);\r\n    } else if (this.selectedLocation) {\r\n      obsLocation.ObsLocationID = this.selectedLocation.Id;\r\n      obsLocation.LocationName = this.selectedLocation.Name;\r\n    }\r\n    if (this.viewInfo && this.viewInfo.location) {\r\n      obsLocation.LocationDescription = this.getLocationName(\r\n        this.viewInfo.location\r\n      );\r\n    }\r\n    if (this.followMode && this.userposition) {\r\n      obsLocation.UTMSourceTID = UtmSource.GPS;\r\n      obsLocation.Uncertainty = Math.round(this.userposition.coords.accuracy);\r\n    }\r\n    return obsLocation;\r\n  }\r\n\r\n  editLocation(): void {\r\n    if (this.canEditLocationName) {\r\n      this.editLocationName = true;\r\n      setTimeout(() => {\r\n        if (this.editLocationNameInput) {\r\n          this.editLocationNameInput.setFocus();\r\n        }\r\n      }, 50);\r\n    }\r\n  }\r\n\r\n  onLocationEditComplete(): void {\r\n    if (this.editLocationNameInput.value?.toString().length === 0) {\r\n      // User has deleted all text\r\n      this.editLocationName = false;\r\n      this.updateMapViewInfo();\r\n    }\r\n  }\r\n}\r\n","<ion-list lines=\"full\">\r\n  <ion-list-header class=\"ion-text-uppercase\">\r\n    <ion-label>\r\n      {{ 'REGISTRATION.SNOW.COMPRESSION_TEST.TITLE' | translate}}\r\n    </ion-label>\r\n  </ion-list-header>\r\n  <ion-item tabindex=\"0\" detail=\"true\" (click)=\"addOrEditCompressionTest(i)\" (keyup.enter)=\"addOrEditCompressionTest(i)\"\r\n    *ngFor=\"let compressionTest of tests; let i = index\">\r\n    <ion-label>\r\n      <ng-container *ngIf=\"compressionTest.PropagationTID\">{{compressionTest.PropagationTID | kdvDescription: 'Snow_PropagationKDV' | async}}</ng-container><ng-container *ngIf=\"compressionTest.TapsFracture > 0\">{{compressionTest.TapsFracture}}</ng-container><ng-container *ngIf=\"compressionTest.FractureDepth > 0\">@{{compressionTest.FractureDepth | metersToCm: 0}}cm</ng-container><ng-container>{{ compressionTest.ComprTestFractureTID | kdvDescription: 'Snow_ComprTestFractureKDV' | async }}</ng-container>\r\n    </ion-label>\r\n    <ion-icon slot=\"end\" name=\"link\" *ngIf=\"compressionTest.IncludeInSnowProfile\"></ion-icon>\r\n  </ion-item>\r\n  <ion-item tabindex=\"0\" (click)=\"addOrEditCompressionTest()\" (keyup.enter)=\"addOrEditCompressionTest()\">\r\n    <ion-icon color=\"primary\" name=\"add-circle-outline\" slot=\"start\"></ion-icon>\r\n    <ion-label>{{'REGISTRATION.SNOW.COMPRESSION_TEST.ADD_NEW' | translate}}</ion-label>\r\n  </ion-item>\r\n</ion-list>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { CompressionTestEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { CompressionTestModalPage } from './compression-test-modal/compression-test-modal.page';\r\n@Component({\r\n  selector: 'app-compression-test-list',\r\n  templateUrl: './compression-test-list.component.html',\r\n  styleUrls: ['./compression-test-list.component.scss']\r\n})\r\nexport class CompressionTestListComponent implements OnInit {\r\n  @Input() tests: Array<CompressionTestEditModel>;\r\n  @Input() includeInSnowProfileAsDefault = false;\r\n  @Output() testsChange = new EventEmitter();\r\n  private isOpen = false;\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  async addOrEditCompressionTest(index?: number) {\r\n    if (!this.isOpen) {\r\n      this.isOpen = true;\r\n      const add = index === undefined;\r\n      const modal = await this.modalController.create({\r\n        component: CompressionTestModalPage,\r\n        componentProps: {\r\n          compressionTest: add ? undefined : (this.tests || [])[index],\r\n          includeInSnowProfileAsDefault: this.includeInSnowProfileAsDefault\r\n        }\r\n      });\r\n      modal.present();\r\n      const result = await modal.onDidDismiss();\r\n      this.isOpen = false;\r\n      if (result.data) {\r\n        if (result.data.delete) {\r\n          this.removeTest(index);\r\n        } else {\r\n          const compressionTest: CompressionTestEditModel = result.data;\r\n          if (this.tests === undefined) {\r\n            this.tests = [];\r\n          }\r\n          if (add) {\r\n            this.tests.push(compressionTest);\r\n          } else {\r\n            this.tests[index] = compressionTest;\r\n          }\r\n        }\r\n      }\r\n      this.testsChange.emit(this.tests);\r\n    }\r\n  }\r\n\r\n  private removeTest(index) {\r\n    if (this.tests !== undefined && this.tests.length > 0) {\r\n      this.tests.splice(index, 1);\r\n    }\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>{{'REGISTRATION.SNOW.COMPRESSION_TEST.TITLE' | translate}}</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-list lines=\"full\">\r\n    <ion-item>\r\n      <ion-label>\r\n        {{'REGISTRATION.SNOW.SNOW_PROFILE.COMPRESSION_TEST.INCLUDE_IN_SNOW_PROFILE' | translate}}\r\n      </ion-label>\r\n      <ion-toggle [disabled]=\"includeInSnowProfileDisabled\" slot=\"end\"\r\n        [(ngModel)]=\"compressionTest.IncludeInSnowProfile\" name=\"IncludeInSnowProfile\">\r\n      </ion-toggle>\r\n    </ion-item>\r\n    <app-kdv-select title=\"REGISTRATION.SNOW.COMPRESSION_TEST.TEST_TYPE\" kdvKey=\"Snow_PropagationKDV\"\r\n      [(value)]=\"compressionTest.PropagationTID\" (valueChange)=\"checkIfIncludeInSnowProfileShouldBeDisabled()\">\r\n    </app-kdv-select>\r\n    <ion-item *ngIf=\"tapsFractureVisible()\">\r\n      <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{'REGISTRATION.SNOW.COMPRESSION_TEST.TAPS_FRACTURE'\r\n        | translate}}</ion-label>\r\n      <app-select [(selectedValue)]=\"compressionTest.TapsFracture\" [options]=\"tapsArray\"\r\n        title=\"REGISTRATION.SNOW.COMPRESSION_TEST.TAPS_FRACTURE\"></app-select>\r\n    </ion-item>\r\n    <app-numeric-input *ngIf=\"!isCTNorECTX()\" [(value)]=\"compressionTest.FractureDepth\"\r\n      title=\"REGISTRATION.SNOW.COMPRESSION_TEST.DISTANCE_FROM_TOP\" [min]=\"0\" [max]=\"999\" [decimalPlaces]=\"0\"\r\n      [convertRatio]=\"100\" suffix=\"cm\"></app-numeric-input>\r\n    <app-kdv-select *ngIf=\"!isCTNorECTX()\" title=\"REGISTRATION.SNOW.COMPRESSION_TEST.FRACTURE_TYPE\"\r\n      kdvKey=\"Snow_ComprTestFractureKDV\" [(value)]=\"compressionTest.ComprTestFractureTID\"></app-kdv-select>\r\n    <app-kdv-select *ngIf=\"!isLBT()\" title=\"REGISTRATION.SNOW.COMPRESSION_TEST.STABILITY_EVAL\"\r\n      kdvKey=\"Snow_StabilityEvalKDV\" [(value)]=\"compressionTest.StabilityEvalTID\"></app-kdv-select>\r\n    <app-text-comment title=\"REGISTRATION.DANGER_OBS.COMMENT\" [(value)]=\"compressionTest.Comment\">\r\n    </app-text-comment>\r\n  </ion-list>\r\n  <app-modal-save-or-delete-buttons [saveDisabled]=\"!isValid\" (saveClicked)=\"ok()\" (deleteClicked)=\"delete()\"\r\n    [showDelete]=\"showDelete\">\r\n  </app-modal-save-or-delete-buttons>\r\n</ion-content>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { CompressionTestEditModel } from '@varsom-regobs-common/regobs-api';\r\nimport { IsEmptyHelper } from '../../../../../../core/helpers/is-empty.helper';\r\nimport { SelectOption } from '../../../../../shared/components/input/select/select-option.model';\r\n\r\n@Component({\r\n  selector: 'app-compression-test-modal',\r\n  templateUrl: './compression-test-modal.page.html',\r\n  styleUrls: ['./compression-test-modal.page.scss']\r\n})\r\nexport class CompressionTestModalPage implements OnInit {\r\n  @Input() compressionTest: CompressionTestEditModel;\r\n  @Input() includeInSnowProfileAsDefault = false;\r\n\r\n  showDelete = false;\r\n  tapsArray: SelectOption[] = [];\r\n  includeInSnowProfileDisabled = false;\r\n\r\n  get isValid() {\r\n    const clone = { ...this.compressionTest };\r\n    clone.IncludeInSnowProfile = undefined;\r\n    return !IsEmptyHelper.isEmpty(clone);\r\n  }\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {\r\n    for (let i = 1; i <= 30; i++) {\r\n      this.tapsArray.push({\r\n        id: i,\r\n        text: i.toString()\r\n      });\r\n    }\r\n    if (!this.compressionTest) {\r\n      this.compressionTest = {};\r\n      if (this.includeInSnowProfileAsDefault) {\r\n        this.compressionTest.IncludeInSnowProfile = true;\r\n      }\r\n    } else {\r\n      this.showDelete = true;\r\n    }\r\n    this.checkIfIncludeInSnowProfileShouldBeDisabled();\r\n  }\r\n\r\n  checkIfIncludeInSnowProfileShouldBeDisabled() {\r\n    if (this.isLBT()) {\r\n      this.compressionTest.IncludeInSnowProfile = false;\r\n      this.includeInSnowProfileDisabled = true;\r\n      return;\r\n    }\r\n    this.includeInSnowProfileDisabled = false;\r\n  }\r\n\r\n  tapsFractureVisible() {\r\n    return !(this.isCTNorECTX() || this.isCTVorECTV() || this.isLBT());\r\n  }\r\n\r\n  isCTNorECTX() {\r\n    return (\r\n      this.compressionTest.PropagationTID === 15 ||\r\n      this.compressionTest.PropagationTID === 24\r\n    );\r\n  }\r\n\r\n  isCTVorECTV() {\r\n    return (\r\n      this.compressionTest.PropagationTID === 11 ||\r\n      this.compressionTest.PropagationTID === 21\r\n    );\r\n  }\r\n\r\n  isLBT() {\r\n    return this.compressionTest.PropagationTID === 5;\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  ok() {\r\n    this.modalController.dismiss(this.compressionTest);\r\n  }\r\n\r\n  delete() {\r\n    this.modalController.dismiss({ delete: true });\r\n  }\r\n}\r\n","<ion-item>\r\n  <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{'REGISTRATION.SNOW.AVALANCHE_PROBLEM.EXPOSED_HEIGHT_COMBO'\r\n        | translate}}</ion-label>\r\n  <ion-text class=\"ion-align-self-start ion-text-wrap ion-margin-bottom\">\r\n    <ion-grid class=\"exposedHight\">\r\n      <ion-row class=\"top padding-bottom\" (click)=\"toggleExsposedHeightCombo('top')\"\r\n        [ngClass]=\"{'selected': exposedHeightTop}\">\r\n        <ion-col size=\"12\" class=\"ion-text-center ion-align-self-center\">\r\n          {{ 'REGISTRATION.SNOW.AVALANCHE_PROBLEM.TOP' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row class=\"middle padding-bottom\" (click)=\"toggleExsposedHeightCombo('middle')\"\r\n        [ngClass]=\"{'selected': exposedHeightMiddle}\">\r\n        <ion-col size=\"12\" class=\"ion-text-center ion-align-self-center\">\r\n          {{ 'REGISTRATION.SNOW.AVALANCHE_PROBLEM.MIDDLE' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row (click)=\"toggleExsposedHeightCombo('bottom')\" class=\"bottom\"\r\n        [ngClass]=\"{'selected': exposedHeightBottom}\">\r\n        <ion-col size=\"12\" class=\"ion-text-center ion-align-self-center\">\r\n          {{ 'REGISTRATION.SNOW.AVALANCHE_PROBLEM.BOTTOM' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </ion-text>\r\n</ion-item>\r\n<ion-item *ngIf=\"exposedHeightTop || exposedHeightMiddle || exposedHeightBottom\">\r\n  <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{'REGISTRATION.SNOW.AVALANCHE_PROBLEM.EXPOSED_HEIGHT1'\r\n    | translate}}</ion-label>\r\n  <app-select [(selectedValue)]=\"exposedHight1\" (selectedValueChange)=\"applyChanges()\" [options]=\"heightArray\"\r\n    title=\"REGISTRATION.SNOW.AVALANCHE_PROBLEM.EXPOSED_HEIGHT1\"></app-select>\r\n</ion-item>\r\n<ion-item *ngIf=\"sholdUseExposedHight2()\">\r\n  <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{'REGISTRATION.SNOW.AVALANCHE_PROBLEM.EXPOSED_HEIGHT2'\r\n    | translate}}</ion-label>\r\n  <app-select [(selectedValue)]=\"exposedHight2\" (selectedValueChange)=\"applyChanges()\" [options]=\"lowerHeightArray\"\r\n    title=\"REGISTRATION.SNOW.AVALANCHE_PROBLEM.EXPOSED_HEIGHT2\"></app-select>\r\n</ion-item>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  Output,\r\n  NgZone,\r\n  EventEmitter\r\n} from '@angular/core';\r\nimport { SelectOption } from '../../../../shared/components/input/select/select-option.model';\r\n\r\n@Component({\r\n  selector: 'app-exposed-height',\r\n  templateUrl: './exposed-height.component.html',\r\n  styleUrls: ['./exposed-height.component.scss']\r\n})\r\nexport class ExposedHeightComponent implements OnInit {\r\n  @Input() exposedHeightComboTID: number;\r\n  @Output() exposedHeightComboTIDChange = new EventEmitter();\r\n  @Input() exposedHight1: number;\r\n  @Output() exposedHight1Change = new EventEmitter();\r\n  @Input() exposedHight2: number;\r\n  @Output() exposedHight2Change = new EventEmitter();\r\n\r\n  exposedHeightTop: boolean;\r\n  exposedHeightMiddle: boolean;\r\n  exposedHeightBottom: boolean;\r\n\r\n  get heightArray(): SelectOption[] {\r\n    const options: SelectOption[] = [];\r\n    for (let id = 0; id <= 8000; id += 100) {\r\n      options.push({ id, text: `${id} m` });\r\n    }\r\n    return options;\r\n  }\r\n\r\n  get lowerHeightArray() {\r\n    return this.heightArray.filter(\r\n      (x) => this.exposedHight1 === undefined || x.id < this.exposedHight1\r\n    );\r\n  }\r\n\r\n  constructor(private ngZone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    this.setExposedHeights(this.exposedHeightComboTID);\r\n  }\r\n\r\n  setExposedHeights(exposedHeightComboTID: number) {\r\n    if (exposedHeightComboTID === 0) {\r\n      this.exposedHeightTop = true;\r\n      this.exposedHeightMiddle = true;\r\n      this.exposedHeightBottom = true;\r\n    } else if (exposedHeightComboTID === 1) {\r\n      // Hvit nederst\r\n      this.exposedHeightTop = true;\r\n      this.exposedHeightMiddle = true;\r\n      this.exposedHeightBottom = false;\r\n    } else if (exposedHeightComboTID === 2) {\r\n      // Svart nederst\r\n      this.exposedHeightTop = false;\r\n      this.exposedHeightMiddle = false;\r\n      this.exposedHeightBottom = true;\r\n    } else if (exposedHeightComboTID === 3) {\r\n      // Hvit i midten\r\n      this.exposedHeightTop = true;\r\n      this.exposedHeightMiddle = false;\r\n      this.exposedHeightBottom = true;\r\n    } else if (exposedHeightComboTID === 4) {\r\n      // Svart i midten\r\n      this.exposedHeightTop = false;\r\n      this.exposedHeightMiddle = true;\r\n      this.exposedHeightBottom = false;\r\n    } else {\r\n      this.exposedHeightTop = false;\r\n      this.exposedHeightMiddle = false;\r\n      this.exposedHeightBottom = false;\r\n    }\r\n  }\r\n\r\n  toggleExsposedHeightCombo(position: 'top' | 'middle' | 'bottom') {\r\n    if (position === 'top') {\r\n      this.exposedHeightTop = !this.exposedHeightTop;\r\n    } else if (position === 'middle') {\r\n      this.exposedHeightMiddle = !this.exposedHeightMiddle;\r\n    } else {\r\n      this.exposedHeightBottom = !this.exposedHeightBottom;\r\n    }\r\n    this.applyChanges();\r\n  }\r\n\r\n  sholdUseExposedHight2() {\r\n    return (\r\n      (this.exposedHeightTop &&\r\n        this.exposedHeightBottom &&\r\n        !this.exposedHeightMiddle) ||\r\n      (!this.exposedHeightTop &&\r\n        !this.exposedHeightBottom &&\r\n        this.exposedHeightMiddle)\r\n    );\r\n  }\r\n\r\n  private updateExposedHeightComboTID(\r\n    top: boolean,\r\n    middle: boolean,\r\n    bottom: boolean\r\n  ) {\r\n    if (top && middle && bottom) {\r\n      this.exposedHeightComboTID = 0;\r\n    } else if (!top && middle && !bottom) {\r\n      this.exposedHeightComboTID = 4;\r\n    } else if (top && !middle && bottom) {\r\n      this.exposedHeightComboTID = 3;\r\n    } else if (bottom) {\r\n      this.exposedHeightComboTID = 2;\r\n    } else if (top) {\r\n      this.exposedHeightComboTID = 1;\r\n    } else {\r\n      this.exposedHeightComboTID = undefined;\r\n    }\r\n  }\r\n\r\n  applyChanges() {\r\n    this.updateExposedHeightComboTID(\r\n      this.exposedHeightTop,\r\n      this.exposedHeightMiddle,\r\n      this.exposedHeightBottom\r\n    );\r\n    if (!this.sholdUseExposedHight2()) {\r\n      this.exposedHight2 = undefined;\r\n    }\r\n    this.exposedHeightComboTIDChange.emit(this.exposedHeightComboTID);\r\n    this.exposedHight1Change.emit(this.exposedHight1);\r\n    this.exposedHight2Change.emit(this.exposedHight2);\r\n  }\r\n}\r\n","<ion-item>\r\n  <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{'REGISTRATION.SNOW.AVALANCHE_PROBLEM.VALID_EXPOSITION'\r\n      | translate}}</ion-label>\r\n  <ion-text class=\"ion-align-self-start ion-text-wrap ion-margin-bottom\">\r\n    <ion-grid *ngIf=\"validExpositionCopy\" class=\"exposition ion-no-padding\">\r\n      <ion-row>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(7)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[7] === '1'}\">\r\n          {{ 'DIRECTION.NW' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(0)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[0] === '1'}\">\r\n          {{ 'DIRECTION.N' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(1)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[1] === '1'}\">\r\n          {{ 'DIRECTION.NE' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(6)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[6] === '1'}\">\r\n          {{ 'DIRECTION.W' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"toggleAllExpositions()\"\r\n          [ngClass]=\"{'selected': validExpositionCopy === '11111111'}\">\r\n          {{ 'REGISTRATION.SNOW.AVALANCHE_PROBLEM.ALL' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(2)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[2] === '1'}\">\r\n          {{ 'DIRECTION.E' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(5)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[5] === '1'}\">\r\n          {{ 'DIRECTION.SW' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(4)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[4] === '1'}\">\r\n          {{ 'DIRECTION.S' | translate}}\r\n        </ion-col>\r\n        <ion-col size=\"4\" class=\"ion-text-center\" (click)=\"setExposition(3)\"\r\n          [ngClass]=\"{'selected': validExpositionCopy[3] === '1'}\">\r\n          {{ 'DIRECTION.SE' | translate}}\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </ion-text>\r\n</ion-item>","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  EventEmitter,\r\n  Output,\r\n  NgZone\r\n} from '@angular/core';\r\n\r\nconst EMPTY_EXPOSITION = '00000000';\r\nconst ALL_EXPOSITION = '11111111';\r\n\r\n@Component({\r\n  selector: 'app-valid-exposition',\r\n  templateUrl: './valid-exposition.component.html',\r\n  styleUrls: ['./valid-exposition.component.scss']\r\n})\r\nexport class ValidExpositionComponent implements OnInit {\r\n  @Input() validExposition: string;\r\n  @Output() validExpositionChange = new EventEmitter();\r\n\r\n  validExpositionCopy: string;\r\n\r\n  constructor(private ngZone: NgZone) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.validExposition) {\r\n      this.validExpositionCopy = EMPTY_EXPOSITION;\r\n    } else {\r\n      this.validExpositionCopy = this.validExposition;\r\n    }\r\n  }\r\n\r\n  setExposition(index: number) {\r\n    const existingValue = this.validExpositionCopy.substr(index, 1);\r\n    const newValue = existingValue === '1' ? '0' : '1';\r\n    this.validExpositionCopy =\r\n      this.validExpositionCopy.substr(0, index) +\r\n      newValue +\r\n      this.validExpositionCopy.substr(index + 1);\r\n    this.applyChanges();\r\n  }\r\n\r\n  toggleAllExpositions() {\r\n    this.validExpositionCopy =\r\n      this.validExpositionCopy === ALL_EXPOSITION\r\n        ? EMPTY_EXPOSITION\r\n        : ALL_EXPOSITION;\r\n    this.applyChanges();\r\n  }\r\n\r\n  applyChanges() {\r\n    this.ngZone.run(() => {\r\n      if (this.validExpositionCopy === EMPTY_EXPOSITION) {\r\n        this.validExposition = undefined;\r\n      } else {\r\n        this.validExposition = this.validExpositionCopy;\r\n      }\r\n      this.validExpositionChange.emit(this.validExposition);\r\n    });\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  Input,\r\n  EventEmitter,\r\n  Output,\r\n  NgZone\r\n} from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-text-comment',\r\n  templateUrl: './text-comment.component.html',\r\n  styleUrls: ['./text-comment.component.scss']\r\n})\r\nexport class TextCommentComponent implements OnInit {\r\n  @Input() title: string;\r\n  @Input() placeholder: string;\r\n  @Input() value: string;\r\n  @Output() valueChange = new EventEmitter();\r\n  @Input() rows = 4;\r\n  @Input() disabled = false;\r\n  @Input() max = 1024;\r\n\r\n  constructor() {}\r\n\r\n  ngOnInit() {}\r\n\r\n  onBlur() {\r\n    if (this.value) {\r\n      this.value = this.value.trim();\r\n    }\r\n    this.valueChange.emit(this.value);\r\n  }\r\n}\r\n","<ion-item>\r\n  <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{ title | translate }}</ion-label>\r\n  <ion-textarea autocapitalize=\"sentences\" [maxlength]=\"max\" [disabled]=\"disabled\" type=\"textarea\" (ionBlur)=\"onBlur()\"\r\n    [rows]=\"rows\" [(ngModel)]=\"value\" [autoGrow]=\"true\" (ngModelChange)=\"valueChange.emit($event)\"\r\n    placeholder=\"{{ placeholder | translate}}\"></ion-textarea>\r\n</ion-item>","import { Component, OnInit, Input, Output, EventEmitter } from '@angular/core';\r\nimport { SelectInterface } from '@ionic/core';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { SelectOption } from '../../../shared/components/input/select/select-option.model';\r\n\r\n@Component({\r\n  selector: 'app-yes-no-select',\r\n  templateUrl: './yes-no-select.component.html',\r\n  styleUrls: ['./yes-no-select.component.scss']\r\n})\r\nexport class YesNoSelectComponent {\r\n  @Input() value: boolean;\r\n  @Input() labelColor = 'medium';\r\n  @Input() title: string;\r\n  @Output() valueChange = new EventEmitter();\r\n\r\n  options: SelectOption[] = [\r\n    { id: true, text: 'DIALOGS.YES' },\r\n    { id: false, text: 'DIALOGS.NO' }\r\n  ];\r\n\r\n  constructor() {}\r\n}\r\n","<ion-item>\r\n  <ion-label [color]=\"labelColor\" position=\"stacked\" class=\"ion-text-uppercase\">{{ title | translate}}</ion-label>\r\n  <app-select [(selectedValue)]=\"value\" (selectedValueChange)=\"valueChange.emit($event)\" [title]=\"title\"\r\n    [options]=\"options\"></app-select>\r\n</ion-item>","import { Component, OnInit, Input } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { UrlEditModel } from '@varsom-regobs-common/regobs-api';\r\n\r\n@Component({\r\n  selector: 'app-add-web-url-modal',\r\n  templateUrl: './add-web-url-modal.page.html',\r\n  styleUrls: ['./add-web-url-modal.page.scss']\r\n})\r\nexport class AddWebUrlModalPage implements OnInit {\r\n  @Input() weburl: UrlEditModel;\r\n  urlToSave: UrlEditModel;\r\n  isNew = true;\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {\r\n    if (this.weburl) {\r\n      this.urlToSave = { ...this.weburl };\r\n      this.isNew = false;\r\n    } else {\r\n      this.urlToSave = {};\r\n    }\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  ok() {\r\n    this.modalController.dismiss(this.urlToSave);\r\n  }\r\n\r\n  delete() {\r\n    this.modalController.dismiss({ delete: true });\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ 'REGISTRATION.ADD_WEB_URL.TITLE' | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n\r\n<ion-content>\r\n  <ion-list lines=\"full\">\r\n    <ion-list-header class=\"ion-text-uppercase\">\r\n      <ion-label>\r\n        {{\"REGISTRATION.ADD_WEB_URL.TITLE\" | translate}}\r\n      </ion-label>\r\n    </ion-list-header>\r\n    <app-text-comment [(value)]=\"urlToSave.UrlDescription\" title=\"REGISTRATION.GENERAL_COMMENT.COMMENT_TITLE\" rows=\"2\"></app-text-comment>\r\n    <ion-item>\r\n      <ion-label color=\"medium\" position=\"stacked\" class=\"ion-text-uppercase\">{{ 'REGISTRATION.ADD_WEB_URL.URL' | translate }}</ion-label>\r\n      <ion-input type=\"url\" [(ngModel)]=\"urlToSave.UrlLine\"></ion-input>\r\n    </ion-item>\r\n  </ion-list>\r\n  <app-modal-save-or-delete-buttons [saveDisabled]=\"!urlToSave.UrlLine\" (saveClicked)=\"ok()\" (deleteClicked)=\"delete()\"\r\n    [showDelete]=\"!isNew\">\r\n  </app-modal-save-or-delete-buttons>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { HelpModalPage } from './help-modal.page';\r\nimport { MarkdownModule } from 'ngx-markdown';\r\nimport { SharedModule } from '../../../../shared/shared.module';\r\n\r\n@NgModule({\r\n  imports: [SharedModule, MarkdownModule.forChild()],\r\n  declarations: [HelpModalPage],\r\n  entryComponents: [HelpModalPage]\r\n})\r\nexport class HelpModalPageModule {}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-help-modal',\r\n  templateUrl: './help-modal.page.html',\r\n  styleUrls: ['./help-modal.page.scss']\r\n})\r\nexport class HelpModalPage implements OnInit {\r\n  @Input() helpText: string;\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  ngOnInit() {}\r\n\r\n  close() {\r\n    this.modalController.dismiss();\r\n  }\r\n}\r\n","<ion-header>\r\n  <ion-toolbar appHeaderColor mode=\"ios\">\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"close()\">{{ 'DIALOGS.OK' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{ 'HELP.TITLE' | translate }}\r\n    </ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content class=\"ion-padding\" (click)=\"close()\">\r\n  <markdown [data]=\"helpText\"></markdown>\r\n</ion-content>","import { NgModule } from '@angular/core';\r\nimport { NumericInputModalPage } from './numeric-input-modal.page';\r\nimport { SharedModule } from '../../../../../modules/shared/shared.module';\r\n\r\n@NgModule({\r\n  imports: [SharedModule],\r\n  declarations: [NumericInputModalPage],\r\n  entryComponents: [NumericInputModalPage]\r\n})\r\nexport class NumericInputModalPageModule {}\r\n","<ion-header>\r\n  <ion-toolbar mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">{{ 'DIALOGS.CANCEL' | translate }}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title *ngIf=\"title\">\r\n      {{ title | translate }}\r\n    </ion-title>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"done()\">{{ 'DIALOGS.OK' | translate }}</ion-button>\r\n    </ion-buttons>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <ion-grid class=\"number-pad\">\r\n    <ion-row class=\"ion-justify-content-center\">\r\n      <ion-col size=\"8\" class=\"ion-align-self-center text-value ion-text-right\">\r\n        <ion-text *ngIf=\"isNegative\">&#8722;</ion-text>\r\n        <ion-text>{{localeString}}</ion-text>\r\n        <ion-text *ngIf=\"localeString && suffix\">&nbsp;{{suffix}}</ion-text>\r\n      </ion-col>\r\n      <ion-col size=\"4\" class=\"ion-align-self-center ion-text-right\">\r\n        <ion-button class=\" delete-button\" fill=\"clear\" (click)=\"clear()\">&larr;</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\" *ngFor=\"let i of ['1','2','3']\">\r\n        <ion-button fill=\"clear\" (click)=\"pushNumber(i)\">{{i}}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\" *ngFor=\"let i of ['4','5','6']\">\r\n        <ion-button fill=\"clear\" (click)=\"pushNumber(i)\">{{i}}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\" *ngFor=\"let i of ['7','8','9']\">\r\n        <ion-button fill=\"clear\" (click)=\"pushNumber(i)\">{{i}}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n    <ion-row>\r\n      <ion-col class=\"ion-text-center\">\r\n        <ion-button [fill]=\"isNegative ? 'solid' : 'clear'\" *ngIf=\"min < 0\" (click)=\"toggleNegative()\">+ / -\r\n        </ion-button>\r\n      </ion-col>\r\n      <ion-col class=\"ion-text-center\">\r\n        <ion-button fill=\"clear\" (click)=\"pushNumber('0')\">0</ion-button>\r\n      </ion-col>\r\n      <ion-col class=\"ion-text-center\">\r\n        <ion-button *ngIf=\"decimalPlaces > 0\" fill=\"clear\" (click)=\"pushDecimalSeparator()\">{{decimalSep}}</ion-button>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n</ion-content>","import { Component, OnInit, Input, HostListener } from '@angular/core';\r\nimport { ModalController } from '@ionic/angular';\r\nimport { NumberHelper } from '../../../../../core/helpers/number-helper';\r\n\r\n@Component({\r\n  selector: 'app-numeric-input-modal',\r\n  templateUrl: './numeric-input-modal.page.html',\r\n  styleUrls: ['./numeric-input-modal.page.scss']\r\n})\r\nexport class NumericInputModalPage implements OnInit {\r\n  @Input() value: number;\r\n  @Input() suffix: string;\r\n  @Input() min = -100000;\r\n  @Input() max = 100000;\r\n  @Input() decimalPlaces = 0;\r\n  @Input() decimalSeparator;\r\n  @Input() title: string;\r\n\r\n  decimalSep = '.';\r\n  isNegative = false;\r\n  private numbers: Array<string> = [];\r\n\r\n  get textVal() {\r\n    return this.numbers.join('');\r\n  }\r\n\r\n  get localeString() {\r\n    return this.textVal.replace('.', this.decimalSep);\r\n  }\r\n\r\n  get numberVal() {\r\n    const num = parseFloat(this.textVal);\r\n    if (isNaN(num)) {\r\n      return undefined;\r\n    }\r\n    return parseFloat(this.textVal) * (this.isNegative ? -1 : 1);\r\n  }\r\n\r\n  constructor(private modalController: ModalController) {}\r\n\r\n  @HostListener('window:keyup', ['$event']) keyEvent(event: KeyboardEvent) {\r\n    if (event.key.match('[0-9]')) {\r\n      this.pushNumber(event.key);\r\n    }\r\n    if (event.key.match('[,.]')) {\r\n      this.pushDecimalSeparator();\r\n    }\r\n    if (event.keyCode === 13) {\r\n      // Enter click\r\n      this.done();\r\n    }\r\n    if (event.keyCode === 8) {\r\n      // Backspace\r\n      this.clear();\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    if (this.value !== undefined) {\r\n      this.isNegative = this.value < 0;\r\n      const positiveValue = this.value * (this.isNegative ? -1 : 1);\r\n      this.numbers = NumberHelper.setDecimalPlaces(\r\n        positiveValue,\r\n        this.decimalPlaces\r\n      )\r\n        .toString(10)\r\n        .split('');\r\n    }\r\n    if (this.max !== undefined && this.max <= 0) {\r\n      this.isNegative = true;\r\n    }\r\n    this.decimalSep =\r\n      this.decimalSeparator !== undefined\r\n        ? this.decimalSeparator\r\n        : this.getDecimalSeparatorForBrowser();\r\n  }\r\n\r\n  private getDecimalSeparatorForBrowser() {\r\n    return (1.1).toLocaleString().substring(1, 2);\r\n  }\r\n\r\n  cancel() {\r\n    this.modalController.dismiss();\r\n  }\r\n\r\n  done() {\r\n    this.modalController.dismiss({\r\n      ok: true,\r\n      value: this.numberVal\r\n    });\r\n  }\r\n\r\n  toggleNegative() {\r\n    if (this.max !== undefined && this.max <= 0) {\r\n      return;\r\n    }\r\n    this.isNegative = !this.isNegative;\r\n  }\r\n\r\n  private getNumberOfDecimals() {\r\n    let isDecimal = false;\r\n    let result = 0;\r\n    for (const i of this.numbers) {\r\n      if (isDecimal) {\r\n        result++;\r\n      } else {\r\n        if (i === '.') {\r\n          isDecimal = true;\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  pushNumber(val: string) {\r\n    if (\r\n      this.decimalPlaces > 0 &&\r\n      this.getNumberOfDecimals() >= this.decimalPlaces\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    this.numbers.push(val);\r\n    if (\r\n      (this.max !== undefined && this.numberVal > this.max) ||\r\n      (this.min !== undefined && this.numberVal < this.min)\r\n    ) {\r\n      this.numbers.pop();\r\n    }\r\n  }\r\n\r\n  pushDecimalSeparator() {\r\n    if (this.numbers.indexOf('.') < 0) {\r\n      this.numbers.push('.');\r\n    }\r\n  }\r\n\r\n  clear() {\r\n    this.numbers.pop();\r\n  }\r\n}\r\n","export enum UtmSource {\r\n  SelectedInMap = 35,\r\n  GPS = 40\r\n}\r\n","import { Pipe, PipeTransform, NgZone } from '@angular/core';\r\nimport { KdvService } from '../../../core/services/kdv/kdv.service';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Pipe({\r\n  name: 'kdvDescription'\r\n})\r\nexport class KdvDescriptionPipe implements PipeTransform {\r\n  constructor(private kdvService: KdvService) {}\r\n\r\n  async transform(\r\n    value: number,\r\n    kdvKey: string,\r\n    returnDescription = false\r\n  ): Promise<string> {\r\n    const kdvelements = await this.kdvService\r\n      .getKdvRepositoryByKeyObservable(kdvKey)\r\n      .pipe(take(1))\r\n      .toPromise();\r\n    const kdvelement = kdvelements.find((x) => x.Id === value);\r\n    const result = kdvelement\r\n      ? returnDescription\r\n        ? kdvelement.Description\r\n        : kdvelement.Name\r\n      : '';\r\n    return result.trim();\r\n  }\r\n}\r\n","import { Pipe, PipeTransform } from '@angular/core';\r\nimport { NumberHelper } from '../../../core/helpers/number-helper';\r\n\r\n@Pipe({\r\n  name: 'metersToCm'\r\n})\r\nexport class MetersToCmPipe implements PipeTransform {\r\n  transform(value: any, decimalPlaces = 2): any {\r\n    if (value === undefined || value === null) {\r\n      return value;\r\n    }\r\n    return NumberHelper.setDecimalPlaces(value * 100.0, decimalPlaces);\r\n  }\r\n}\r\n","import { Injectable } from '@angular/core';\r\nimport { DateHelperService } from '../../shared/services/date-helper/date-helper.service';\r\nimport { IRegistration, RegistrationTid } from 'src/app/modules/common-registration/registration.models';\r\nimport { RegistrationService } from 'src/app/modules/common-registration/services/registration/registration.service';\r\nimport { GeoHazard } from '@varsom-regobs-common/core';\r\nimport { ISummaryItem } from '../components/summary-item/summary-item.model';\r\nimport { UserGroupService } from '../../../core/services/user-group/user-group.service';\r\nimport { ObserverGroupDto } from '@varsom-regobs-common/regobs-api';\r\nimport { NavController } from '@ionic/angular';\r\nimport { RouterDirection } from '@ionic/core';\r\nimport { isEmpty } from '@varsom-regobs-common/core';\r\nimport { take } from 'rxjs/operators';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SummaryItemService {\r\n  constructor(\r\n    private registrationService: RegistrationService,\r\n    private dateHelperService: DateHelperService,\r\n    private userGroupService: UserGroupService,\r\n    private navController: NavController\r\n  ) {}\r\n\r\n  async getSummaryItems(\r\n    registration: IRegistration,\r\n    userGroups?: ObserverGroupDto[]\r\n  ) {\r\n    if (!registration) {\r\n      return [];\r\n    }\r\n    const userGroupsToUse = userGroups\r\n      ? userGroups\r\n      : await this.userGroupService.getUserGroups();\r\n    const summaryItems: ISummaryItem[] = [\r\n      {\r\n        id: registration.id,\r\n        href: '/registration/obs-location',\r\n        queryParams: { geoHazard: registration.geoHazard },\r\n        title: 'REGISTRATION.OBS_LOCATION.TITLE',\r\n        subTitle: registration.request.ObsLocation\r\n          ? registration.request.ObsLocation.LocationName ||\r\n            registration.request.ObsLocation.LocationDescription\r\n          : '',\r\n        hasData: !isEmpty(registration.request.ObsLocation)\r\n      },\r\n      {\r\n        id: registration.id,\r\n        href: '/registration/set-time',\r\n        title: 'REGISTRATION.OVERVIEW.DATE_AND_TIME',\r\n        subTitle: registration.request.DtObsTime\r\n          ? await this.dateHelperService.formatDateString(\r\n            registration.request.DtObsTime\r\n          )\r\n          : '',\r\n        hasData: !!registration.request.DtObsTime\r\n      }\r\n    ];\r\n    if (userGroupsToUse.length > 0) {\r\n      summaryItems.push({\r\n        id: registration.id,\r\n        href: '/registration/group',\r\n        title: 'REGISTRATION.OVERVIEW.SHARE_WITH_GROUP',\r\n        subTitle: this.getObservationGroupName(registration, userGroupsToUse),\r\n        hasData: !!registration.request.ObserverGroupID\r\n      });\r\n    }\r\n\r\n    summaryItems.push(... await this.getGeoHazardItems(registration));\r\n\r\n    summaryItems.push(\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/general-comment',\r\n        'REGISTRATION.GENERAL_COMMENT.TITLE',\r\n        registration.request.GeneralObservation\r\n          ? registration.request.GeneralObservation.ObsComment\r\n          : '',\r\n        RegistrationTid.GeneralObservation\r\n      )\r\n    );\r\n\r\n    return summaryItems;\r\n  }\r\n\r\n  async getPreviousAndNext(\r\n    registration: IRegistration,\r\n    url: string\r\n  ): Promise<{ previous: ISummaryItem; next: ISummaryItem }> {\r\n    const summaryItems = await this.getSummaryItems(registration);\r\n    const currentItem = summaryItems.find((x) => url.indexOf(x.href) >= 0);\r\n    const result = { previous: undefined, next: undefined };\r\n    if (currentItem) {\r\n      const index = summaryItems.indexOf(currentItem);\r\n      if (index > 0) {\r\n        result.previous = summaryItems[index - 1];\r\n      }\r\n      const nextIndex = index + 1;\r\n      if (nextIndex < summaryItems.length) {\r\n        result.next = summaryItems[nextIndex];\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  navigateTo(\r\n    registration: IRegistration,\r\n    summaryItem: ISummaryItem,\r\n    direction: RouterDirection = 'forward'\r\n  ) {\r\n    const url = `${summaryItem.href}/${registration.id}`;\r\n    return direction === 'forward'\r\n      ? this.navController.navigateForward(url)\r\n      : this.navController.navigateBack(url);\r\n  }\r\n\r\n  async navigateForward(registration: IRegistration, url: string) {\r\n    const prevAndNext = await this.getPreviousAndNext(registration, url);\r\n    if (prevAndNext.next) {\r\n      return this.navigateTo(registration, prevAndNext.next, 'forward');\r\n    } else {\r\n      return this.navController.navigateRoot(\r\n        `/registration/edit/${registration.id}`\r\n      );\r\n    }\r\n  }\r\n\r\n  private getObservationGroupName(\r\n    registration: IRegistration,\r\n    userGroups: ObserverGroupDto[]\r\n  ) {\r\n    if (registration && registration.request.ObserverGroupID && userGroups) {\r\n      const selectedGroup = userGroups.find(\r\n        (x) => x.Id === registration.request.ObserverGroupID\r\n      );\r\n      if (selectedGroup) {\r\n        return selectedGroup.Name;\r\n      }\r\n    }\r\n    return '';\r\n  }\r\n\r\n  private getGeoHazardItems(registration: IRegistration) {\r\n    switch (registration.geoHazard) {\r\n    case GeoHazard.Water:\r\n      return this.getWaterItems(registration);\r\n    case GeoHazard.Ice:\r\n      return this.getIceItems(registration);\r\n    case GeoHazard.Soil:\r\n      return this.getDirtItems(registration);\r\n    case GeoHazard.Snow:\r\n      return this.getSnowItems(registration);\r\n    }\r\n  }\r\n\r\n  private async getWaterItems(registration: IRegistration) {\r\n    return [\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/water/water-level',\r\n        'REGISTRATION.WATER.WATER_LEVEL.TITLE',\r\n        registration.request.WaterLevel2\r\n          ? registration.request.WaterLevel2.Comment\r\n          : '',\r\n        RegistrationTid.WaterLevel2\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/water/damage',\r\n        'REGISTRATION.WATER.DAMAGE.TITLE',\r\n        '', // this.registration.DamageObs ? this.registration.DamageObs.map((x) => x.Comment).join() : '',\r\n        RegistrationTid.DamageObs\r\n      )\r\n    ];\r\n  }\r\n\r\n  private async getRegItem(\r\n    registration: IRegistration,\r\n    href: string,\r\n    title: string,\r\n    subTitle: string,\r\n    registrationTid: RegistrationTid\r\n  ): Promise<ISummaryItem> {\r\n    return {\r\n      id: registration.id,\r\n      href,\r\n      title,\r\n      subTitle,\r\n      hasData: await this.registrationService.hasAnyDataToShowInRegistrationTypes(registration, registrationTid).pipe(take(1)).toPromise(),\r\n      attachments: await this.registrationService.getAllAttachmentsForRegistrationTid$(registration.id, registrationTid).pipe(take(1)).toPromise()\r\n    };\r\n  }\r\n\r\n  private async getDirtItems(registration: IRegistration) {\r\n    return [\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/danger-obs',\r\n        'REGISTRATION.DANGER_OBS.TITLE',\r\n        '',\r\n        RegistrationTid.DangerObs\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/dirt/landslide-obs',\r\n        'REGISTRATION.DIRT.LAND_SLIDE_OBS.TITLE',\r\n        registration.request.LandSlideObs\r\n          ? registration.request.LandSlideObs.Comment\r\n          : '',\r\n        RegistrationTid.LandSlideObs\r\n      )\r\n    ];\r\n  }\r\n\r\n  private async getIceItems(registration: IRegistration) {\r\n    return [\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/ice/ice-cover',\r\n        'REGISTRATION.ICE.ICE_COVER.TITLE',\r\n        registration.request.IceCoverObs\r\n          ? registration.request.IceCoverObs.Comment\r\n          : '',\r\n        RegistrationTid.IceCoverObs\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/ice/ice-thickness',\r\n        'REGISTRATION.ICE.ICE_THICKNESS.TITLE',\r\n        registration.request.IceThickness\r\n          ? registration.request.IceThickness.Comment\r\n          : '',\r\n        RegistrationTid.IceThickness\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/danger-obs',\r\n        'REGISTRATION.DANGER_OBS.TITLE',\r\n        '',\r\n        RegistrationTid.DangerObs\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/incident',\r\n        'REGISTRATION.INCIDENT.TITLE',\r\n        '',\r\n        RegistrationTid.Incident\r\n      )\r\n    ];\r\n  }\r\n\r\n  private async getSnowItems(registration: IRegistration) {\r\n    return [\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/danger-obs',\r\n        'REGISTRATION.DANGER_OBS.TITLE',\r\n        '',\r\n        RegistrationTid.DangerObs\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/avalanche-obs',\r\n        'REGISTRATION.SNOW.AVALANCHE_OBS.TITLE',\r\n        '',\r\n        RegistrationTid.AvalancheObs\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/avalanche-activity',\r\n        'REGISTRATION.SNOW.AVALANCHE_ACTIVITY.TITLE',\r\n        '',\r\n        RegistrationTid.AvalancheActivityObs2\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/weather',\r\n        'REGISTRATION.SNOW.WEATHER.TITLE',\r\n        '',\r\n        RegistrationTid.WeatherObservation\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/snow-surface',\r\n        'REGISTRATION.SNOW.SNOW_SURFACE.TITLE',\r\n        '',\r\n        RegistrationTid.SnowSurfaceObservation\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/compression-test',\r\n        'REGISTRATION.SNOW.COMPRESSION_TEST.TITLE',\r\n        '',\r\n        RegistrationTid.CompressionTest\r\n      ),\r\n      {\r\n        id: registration.id,\r\n        href: '/registration/snow/snow-profile',\r\n        title: 'REGISTRATION.SNOW.SNOW_PROFILE.TITLE',\r\n        subTitle: '',\r\n        hasData:\r\n          await this.registrationService.hasAnyDataToShowInRegistrationTypes(\r\n            registration,\r\n            RegistrationTid.SnowProfile2\r\n          ).pipe(take(1)).toPromise() ||\r\n          (registration.request.CompressionTest &&\r\n            registration.request.CompressionTest.some(\r\n              (x) => x.IncludeInSnowProfile === true\r\n            )),\r\n        attachments: await this.registrationService.getAllAttachmentsForRegistrationTid$(\r\n          registration.id,\r\n          RegistrationTid.SnowProfile2\r\n        ).pipe(take(1)).toPromise()\r\n      },\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/avalanche-problem',\r\n        'REGISTRATION.SNOW.AVALANCHE_PROBLEM.TITLE',\r\n        '',\r\n        RegistrationTid.AvalancheEvalProblem2\r\n      ),\r\n      await this.getRegItem(\r\n        registration,\r\n        '/registration/snow/avalanche-evaluation',\r\n        'REGISTRATION.SNOW.AVALANCHE_EVALUATION.TITLE',\r\n        '',\r\n        RegistrationTid.AvalancheEvaluation3\r\n      )\r\n    ];\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { SharedModule } from '../shared/shared.module';\r\nimport { SaveAndGoBackButtonComponent } from './components/save-and-go-back-button/save-and-go-back-button.component';\r\nimport { TextCommentComponent } from './components/text-comment/text-comment.component';\r\nimport { AddPictureItemComponent } from './components/add-picture-item/add-picture-item.component';\r\nimport { KdvRadiobuttonListComponent } from './components/kdv-radiobutton-list/kdv-radiobutton-list.component';\r\nimport { NavigationButtonsComponent } from './components/navigation-buttons/navigation-buttons.component';\r\nimport { SetLocationInMapComponent } from './components/set-location-in-map/set-location-in-map.component';\r\nimport { MapModule } from '../map/map.module';\r\nimport { Base64ImageComponent } from './components/base64-image/base64-image.component';\r\nimport { KdvDescriptionPipe } from './pipes/kdv-description.pipe';\r\nimport { AddWebUrlItemComponent } from './components/add-web-url-item/add-web-url-item.component';\r\nimport { ModalSaveOrDeleteButtonsComponent } from './components/modal-save-or-delete-buttons/modal-save-or-delete-buttons.component';\r\nimport { ExposedHeightComponent } from './components/snow/exposed-height/exposed-height.component';\r\nimport { ValidExpositionComponent } from './components/snow/valid-exposition/valid-exposition.component';\r\nimport { RegistrationContentWrapperComponent } from './components/registration-content-wrapper/registration-content-wrapper.component';\r\nimport { HelpTextComponent } from './components/help-text/help-text.component';\r\nimport { HelpModalPageModule } from './pages/modal-pages/help-modal/help-modal.module';\r\nimport { YesNoSelectComponent } from './components/yes-no-select/yes-no-select.component';\r\nimport { NumericInputComponent } from './components/numeric-input/numeric-input.component';\r\nimport { NumericInputModalPageModule } from './pages/modal-pages/numeric-input-modal/numeric-input-modal.module';\r\nimport { MetersToCmPipe } from './pipes/meters-to-cm.pipe';\r\nimport { CompressionTestListComponent } from './components/snow/compression-test-list/compression-test-list.component';\r\nimport { KdvSelectComponent } from './components/kdv-select/kdv-select.component';\r\nimport { BlobImageComponent } from './components/blob-image/blob-image.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    SharedModule,\r\n    MapModule,\r\n    HelpModalPageModule,\r\n    NumericInputModalPageModule\r\n  ],\r\n  exports: [\r\n    SharedModule,\r\n    MapModule,\r\n    SaveAndGoBackButtonComponent,\r\n    AddPictureItemComponent,\r\n    TextCommentComponent,\r\n    KdvRadiobuttonListComponent,\r\n    NavigationButtonsComponent,\r\n    SetLocationInMapComponent,\r\n    Base64ImageComponent,\r\n    KdvDescriptionPipe,\r\n    MetersToCmPipe,\r\n    AddWebUrlItemComponent,\r\n    ModalSaveOrDeleteButtonsComponent,\r\n    ExposedHeightComponent,\r\n    ValidExpositionComponent,\r\n    RegistrationContentWrapperComponent,\r\n    HelpTextComponent,\r\n    HelpModalPageModule,\r\n    YesNoSelectComponent,\r\n    NumericInputComponent,\r\n    NumericInputModalPageModule,\r\n    CompressionTestListComponent,\r\n    KdvSelectComponent,\r\n    BlobImageComponent,\r\n  ],\r\n  declarations: [\r\n    SaveAndGoBackButtonComponent,\r\n    AddPictureItemComponent,\r\n    TextCommentComponent,\r\n    KdvRadiobuttonListComponent,\r\n    NavigationButtonsComponent,\r\n    SetLocationInMapComponent,\r\n    Base64ImageComponent,\r\n    KdvDescriptionPipe,\r\n    MetersToCmPipe,\r\n    AddWebUrlItemComponent,\r\n    ModalSaveOrDeleteButtonsComponent,\r\n    ExposedHeightComponent,\r\n    ValidExpositionComponent,\r\n    RegistrationContentWrapperComponent,\r\n    HelpTextComponent,\r\n    YesNoSelectComponent,\r\n    NumericInputComponent,\r\n    CompressionTestListComponent,\r\n    KdvSelectComponent,\r\n    BlobImageComponent\r\n  ]\r\n})\r\nexport class SharedComponentsModule {}\r\n"]}