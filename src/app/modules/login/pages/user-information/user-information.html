<ion-header *ngIf="loggedInUser$ | async as loggedInUser">
  <ion-toolbar appHeaderColor mode="ios">
    <ion-buttons slot="start">
      <a role="button" (click)="navigateBack()"> <ion-back-button text="" defaultHref="/"></ion-back-button></a>
    </ion-buttons>
    <ion-title>
      {{ loggedInUser.isLoggedIn ? ('MY_PROFILE.TITLE' | translate) : ('LOGIN.TITLE' | translate) }}
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" *ngIf="loggedInUser$ | async as loggedInUser">
  <ion-grid class="grid-container" *ngIf="loggedInUser.isLoggedIn else login">
    <ion-row>
      <ion-col>
        <h2 class="profile-title">{{'MY_PROFILE.TITLE' | translate}}</h2>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="12" size-sm="6" class="ion-align-self-center">
        <div class="flexContainer ion-padding-bottom">
          <ion-icon class="profile-icon" src="./assets/icon/portrait.svg"></ion-icon>
          <ion-label class="ion-text-wrap ion-align-self-center ion-padding-start">
            <ion-text color="primary">{{ loggedInUser.email }}</ion-text>
          </ion-label>
        </div>
      </ion-col>
    </ion-row>

    <ion-row class="flex">
      <div>
        <ion-button
          class="button ion-text-uppercase"
          type="button"
          fill="outline"
          expand="block"
          (click)="openMyPage()"
        >
          <ion-icon slot="end" src="./assets/icon/newTab.svg"></ion-icon>
          {{'MY_PROFILE.MY_NVE_ACCOUNT' | translate }}
        </ion-button>
      </div>
      <div>
        <ion-button
          class="button ion-text-uppercase delete-button"
          type="button"
          fill="outline"
          expand="block"
          (click)="openMyPage('user-data')"
        >
          <ion-icon slot="end" src="./assets/icon/newTab.svg"></ion-icon>
          {{'LOGIN.DELETE_PROFILE' | translate }}
        </ion-button>
      </div>
      <div>
        <ion-button class="button ion-text-uppercase logout" type="submit" fill="outline" (click)="logout()">
          {{ 'LOGIN.LOGOUT' | translate }}</ion-button
        >
      </div>
    </ion-row>

    <!-- TODO: edit functionality in api v5.
       <ion-row>
      <ion-col>
        <h2>{{'MY_PROFILE.NICKNAME' | translate}}</h2>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="12" size-sm="6" size-lg="4">
        <div class="flexContainer">
          <p class="ion-align-self-center">{{ loggedInUser.email }}</p>
           TODO: Add click handler and function to edit nickname
          <ion-button class="button ion-padding-start ion-text-uppercase" fill="clear" expand="block">{{'MY_PROFILE.EDIT' | translate}} <ion-icon class="padding-medium" src="./assets/icon/pencil.svg"></ion-icon></ion-button>
        </div>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col>
        <p class="info-text">{{'MY_PROFILE.NICKNAME_TEXT' | translate}}</p>
      </ion-col>
    </ion-row> -->

    <ion-row>
      <ion-col>
        <div class="flexContainer myPictureContainer">
          <h2>{{'MY_PROFILE.MY_PICTURES' | translate}}</h2>
          <ion-button
            (click)="presentModal()"
            class="button ion-padding-start ion-text-uppercase edit-button"
            fill="clear"
            expand="block"
            >Rediger <ion-icon class="padding-medium" src="./assets/icon/pencil.svg"> </ion-icon>
          </ion-button>
        </div>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col>
        <div class="flexContainer max-div-height margin-mobile">
          <p class="ion-align-self-center no-margin">
            <strong>{{'MY_PROFILE.COPYRIGHT' | translate}}:</strong> {{copyright$ | async}}
          </p>
        </div>
        <div class="flexContainer max-div-height">
          <p class="ion-align-self-center no-margin">
            <strong>{{'MY_PROFILE.PHOTOGRAPHER' | translate}}:</strong> {{photographer$ | async}}
          </p>
        </div>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col>
        <p class="info-text ion-padding-top" [innerHTML]="'MY_PROFILE.PUBLISH_PHOTOS' | translate"></p>
      </ion-col>
    </ion-row>

    <!-- <ion-row>
      <ion-col>
        <h2>
          {{'MY_PROFILE.MY_COMPETENCE' | translate}}
        </h2>
      </ion-col>
    </ion-row>
    <ion-row class="ion-padding-top">
       Generere GeoHazard listen ved å hente de ut
      <ion-col size="3" size-xs="5" size-sm="3" size-md="2">
        <p class="no-margin" *ngFor="let geoHazard of geoHazards">{{geoHazard.GeoHazardName | translate}}</p>
      </ion-col>
       Hente ut kompetansen riktig ved å koble opp mot API
      <ion-col class="star-container" size="auto" size-xs="7" size-sm="9" size-md="10" pullMd="1" pullSm="2" pullXs="1">
        <app-competence class="stars" *ngFor="let geoHazard of geoHazards" [competenceLevel]="getCompetenceFromGeoHazard(geoHazard.GeoHazardTID)"></app-competence>
      </ion-col>
    </ion-row>
    <ion-row class="ion-padding-top">
      <ion-col>
        <p class="info-text" [innerHTML]="'MY_PROFILE.COMPETENCE' | translate"></p>
      </ion-col>
    </ion-row> -->

    <ion-row>
      <ion-col>
        <h2>{{'MY_PROFILE.MY_GROUPS' | translate}}</h2>
      </ion-col>
    </ion-row>
    <ion-row class="ion-padding-top" *ngIf="userGroups$ | async as userGroups">
      <ng-container *ngIf="userGroups.length > 0 else noGroups">
        <ion-col size="12" size-sm="5" size-md="4" size-lg="3" *ngFor="let group of userGroups">
          <div class="flexContainer margin-mobile">
            <ion-icon class="ion-align-self-center" src="./assets/icon/group.svg"></ion-icon>
            <p class="padding-medium no-margin">{{group.Name}}</p>
          </div>
        </ion-col>
      </ng-container>
    </ion-row>
    <ion-row class="ion-padding-top ion-padding-bottom">
      <ion-col>
        <p class="info-text" [innerHTML]="'MY_PROFILE.MY_GROUPS_TEXT' | translate"></p>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<ng-template #login>
  <ion-button class="login-button" expand="block" type="submit" color="varsom-orange" (click)="signIn()">
    {{ 'LOGIN.LOGIN' | translate }}
  </ion-button>
</ng-template>
<ng-template #noGroups>
  <ion-col>
    <p class="info-text">{{'MY_PROFILE.NO_GROUPS' | translate}}</p>
  </ion-col>
</ng-template>
